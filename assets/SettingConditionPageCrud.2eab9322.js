var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,i,o)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[i]=o,l=(e,t)=>{for(var i in t||(t={}))a.call(t,i)&&s(e,i,t[i]);if(o)for(var i of o(t))n.call(t,i)&&s(e,i,t[i]);return e},d=(e,o)=>t(e,i(o));import{j as r,a5 as c,g as u,aq as m,W as p,m as g,o as v,t as f,B as y,D as h,w as C,ap as b,a1 as _,a2 as x,I as w,K as $,U as k,F as S,aZ as q,a_ as V,n as M,y as L,r as A,S as U,_ as j,ay as O,az as D,f as E,a6 as T,O as Q,$ as G,A as I,Q as B,aP as P,ar as F,a$ as N,v as z}from"./vendor.9695fe57.js";import{z as H,f as W,b as J,d as R,j as Y,e as K,r as Z,O as X,u as ee,aj as te,t as ie,_ as oe,S as ae}from"./index.dcc9fc55.js";import{_ as ne}from"./attention-warning.f7b3f9bc.js";import{u as se}from"./index.f40e4a9e.js";import{r as le}from"./index.54844a74.js";import{s as de}from"./vue-multiselect.esm.973e2e45.js";import{d as re,c as ce,m as ue}from"./index.6b6f6369.js";import{V as me}from"./vue-draggable-next.esm-bundler.4467bcb1.js";import{_ as pe}from"./badge.b1ac8285.js";import{_ as ge}from"./tab.10f696d6.js";import{_ as ve}from"./fieldset.7eca078e.js";import{S as fe}from"./select.79191f70.js";import{L as ye}from"./Loading.f47d2599.js";import{B as he}from"./Breadcrumb.5b80dabd.js";import{C as Ce}from"./card.323f324c.js";const be=r("settingConditionGroup",{state:()=>({form:{group_name:void 0,conditions:[],categories:[],is_price_sync:0},priceSyncCompanySource:void 0,getSettingConditionGroup:{result:void 0,isLoading:!1},createSettingConditionGroup:{isLoading:!1},updateSettingConditionGroup:{isLoading:!1},deleteSettingConditionGroup:{isLoading:!1},getSettingConditionGroupDevices:{result:void 0}}),getters:{companyName:e=>e.priceSyncCompanySource,isFormLoading:e=>e.createSettingConditionGroup.isLoading||e.updateSettingConditionGroup.isLoading,isMac:e=>e.form.categories.findIndex((e=>e.is_mac)),isUniqueAndMacDisabled(e){var t;if(!e.form.categories.length>0)return!1;const i=c();return(null==(t=null==i?void 0:i.query)?void 0:t.unique_id)&&this.isMac.value>=0}},actions:{resetSettingConditionGroupForm(){this.$state.form={group_name:void 0,conditions:[],categories:[]}},async $getSettingConditionGroup(e){const t=_e();this.$state.getSettingConditionGroup.isLoading=!0;try{const i=await H({url:`/v1/pos/condition/edit-category/${e.id}`,method:"GET",params:e.params});return this.$state.getSettingConditionGroup.result=i,this.$state.form.group_name=i.group_name,this.$state.form.conditions=i.conditions,this.$state.form.categories=i.categories.filter((e=>!!e.is_checked)),this.$state.form.is_price_sync=i.is_price_sync,t.$state.form.activeConditions=i.conditions,i.price_sync_source&&(this.$state.priceSyncCompanySource=i.price_sync_source),i}finally{this.$state.getSettingConditionGroup.isLoading=!1}},async $createSettingConditionGroup(){const e={group_name:this.$state.form.group_name,categories:JSON.stringify(this.$state.form.categories),conditions:this.$state.form.conditions.map((e=>d(l({},e),{terms:[e.term,...e.terms]})))};return H({url:"/v1/pos/condition/add-category",method:"post",data:e})},async $updateSettingConditionGroup(e){const t={group_name:this.$state.form.group_name,categories:JSON.stringify(this.$state.form.categories),conditions:this.$state.form.conditions};return H({url:`/v1/pos/condition/edit-category/${e.id}`,method:"post",data:t})},$deleteSettingConditionGroup:async e=>H({url:`/v1/pos/condition/delete-category/${e.id}`,method:"post",data:{_method:"DELETE"}}),async $getSettingConditionGroupDevices(){const e=await H({url:"/v1/pos/condition/devices",method:"get"});return this.$state.getSettingConditionGroupDevices.result=e,e}}}),_e=r("settingCondition",{state:()=>({form:{sub_domain:void 0,conditions:[],activeConditions:[],sources:[],selectedSource:void 0,selectedConditions:[]},getSettingConditions:{result:void 0,isLoading:!1},getSettingConditionSources:{result:void 0,isLoading:!1},createSettingCondition:{isLoading:!1},updateSettingCondition:{isLoading:!1},deleteSettingCondition:{isLoading:!1},sortSettingCondition:{isLoading:!1},createSettingConditionQuestionBulk:{isLoading:!1}}),getters:{isMappingSourceLoading:e=>e.getSettingConditions.isLoading||e.getSettingConditionSources.isLoading||e.deleteSettingCondition.isLoading,isMappingListLoading(e){const t=be();return e.createSettingCondition.isLoading||e.updateSettingCondition.isLoading||e.deleteSettingCondition.isLoading||e.sortSettingCondition.isLoading||e.createSettingConditionQuestionBulk.isLoading||t.getSettingConditionGroup.isLoading}},actions:{isConditionActive(e){const t=this.$state.form.activeConditions;return t&&-1!==t.findIndex((t=>{const i=e.name.split(" ").join("");return t.name.split(" ").join("").toLowerCase()===i.toLowerCase()}))},resetSettingConditionForm(){this.$state.form.sub_domain=void 0,this.$state.form.conditions=[],this.$state.form.activeConditions=[],this.$state.form.sources=[],this.$state.form.selectedSource=void 0,this.$state.form.selectedConditions=[]},async $getSettingConditions(e){const t=await H({url:"/v1/pos/pricing/pricesync-conditions",method:"get",params:e.params});return this.$state.getSettingConditions.result=t,this.$state.form.conditions=t.conditions.map((i=>d(l({},i),{group_name:t.name,sub_domain:e.params.sub_domain||e.sub_domain}))),t},async $createSettingCondition(e){e.data.terms=JSON.stringify([e.data.term,...e.data.terms]);return await H({url:`/v1/pos/condition/add/${e.id}`,method:"post",data:e.data})},$updateSettingCondition:async e=>(e.data.terms=JSON.stringify([e.data.term,...e.data.terms]),await H({url:`/v1/pos/condition/edit/${e.id}`,method:"post",data:e.data})),$deleteSettingCondition:async e=>await H({url:`/v1/pos/condition/delete/${e.id}`,method:"post",data:{_method:"DELETE"}}),$sortSettingCondition:async e=>(e.data.sorting=JSON.stringify([...e.data.sorting]),await H({url:"/v1/pos/condition/sort",method:"post",data:e.data})),async $getSettingConditionSources(e){var t,i;const o=(null==(t=e.category_id)?void 0:t.toString().includes("8084"))?null:e.category_id;if(null==(i=e.category_id)?void 0:i.toString().includes("8084")){const e=[];return this.$state.getSettingConditionSources.result=e,this.$state.form.sources=e,e}const a=await H({url:"/v1/pos/pricing/syncable-sources",method:"get",params:{category_id:o,logo:!0}});return this.$state.getSettingConditionSources.result=a,this.$state.form.sources=a,a},$createSettingConditionQuestionBulk:async e=>await H({url:"/v1/pos/condition/bulk/questions",method:"post",data:e.data})}}),xe={class:"lg:w-2/5 space-y-4"},we={class:"flex items-center gap-x-1"},$e={class:"flex gap-x-4 items-center"},ke={class:"flex-1"},Se={key:0,whitelabel:"remove"},qe={class:"xl:max-w-lg max-w-sm",style:{"word-wrap":"break-word"}},Ve={class:"flex gap-x-4 items-center"},Me={class:"flex-1"},Le={class:"text-sm text-grey-03 mb-1"},Ae={key:0,whitelabel:"remove"},Ue={class:"xl:max-w-lg max-w-sm",style:{"word-wrap":"break-word"}},je={__name:"SettingConditionFormCategory",async setup(e,{expose:t}){let i,o;const a=c(),n=ji(),s=be(),l=se({group_name:{required:le},categories:{required:le}},s.$state.form,{$lazy:!0}),d=u((()=>({"multiselect--invalid":l.value.categories.$invalid}))),r=u((()=>s.$state.form.categories.length>0)),q=u((()=>{if(r.value){const e=s.$state.getSettingConditionGroupDevices.result;return s.isMac>=0?e.filter((e=>1===e.is_mac)):e.filter((e=>0===e.is_mac))}return s.$state.getSettingConditionGroupDevices.result}));return n.priceEditor&&(s.$state.form.categories=s.$state.getSettingConditionGroupDevices.result.filter((e=>{var t,i,o;return e.category_id==n.priceEditorCategory.id&&(null==(t=e.name)?void 0:t.toLowerCase())==(null==(o=null==(i=n.priceEditorCategory)?void 0:i.name)?void 0:o.toLowerCase())}))),t({onSubmit:async()=>(await l.value.$validate(),!l.value.$error)}),[i,o]=m((()=>s.$getSettingConditionGroupDevices())),await i,o(),p((()=>{const e=a.query.model;if(e&&q.value.length>0){const t=q.value.find((t=>t.name===e||t.name.toLowerCase()===e.toLowerCase()));t&&(s.$state.form.categories=[t])}})),(e,t)=>{const i=g("Tooltip");return v(),f("div",xe,[y("div",null,[y("div",we,[t[4]||(t[4]=y("label",{for:"CategoryName"},"Category Name",-1)),h(i,{placement:"top"},{content:C((()=>t[2]||(t[2]=[y("div",{class:"w-64 text-sm"}," The category names are internal only and not customer-facing. ",-1)]))),default:C((()=>t[3]||(t[3]=[y("i",{class:"material-icons text-teal-04"},"info",-1)]))),_:1})]),y("div",$e,[y("div",ke,[h(W,{modelValue:b(s).$state.form.group_name,"onUpdate:modelValue":t[0]||(t[0]=e=>b(s).$state.form.group_name=e),name:"CategoryName",type:"text",placeholder:"Category name",class:"w-full",view:b(l).group_name.$invalid?"danger":"default",disabled:b(n).isSynced.value},null,8,["modelValue","view","disabled"]),(v(!0),f(_,null,x(b(l).group_name.$errors.length,(e=>(v(),f("span",{class:"text-red-base mt-2 block",key:e}," Category name is required ")))),128))]),b(n).isSynced.value?(v(),f("div",Se,[h(i,{placement:"right"},{content:C((()=>[y("div",qe,[y("p",null,[t[6]||(t[6]=w(" This item's category name is locked because you are using price sync ")),b(s).companyName?(v(),f(_,{key:0},[t[5]||(t[5]=w(" from ")),y("b",null,$(b(s).companyName),1)],64)):k("",!0),t[7]||(t[7]=w(" . ")),t[8]||(t[8]=y("b",null,[y("a",{href:"https://help.reusely.com/en/articles/9176424-how-price-sync-works",target:"_blank",noreferrer:"",noopener:"",class:"mx-2 text-white underline"}," Read More ")],-1))])])])),default:C((()=>t[9]||(t[9]=[y("i",{class:"material-icons icon-md select-none"},"lock",-1)]))),_:1})])):k("",!0)])]),y("div",null,[t[15]||(t[15]=y("label",null,"Assign Your Condition Item",-1)),y("div",Ve,[y("div",Me,[h(b(de),{modelValue:b(s).$state.form.categories,"onUpdate:modelValue":t[1]||(t[1]=e=>b(s).$state.form.categories=e),placeholder:"Search items",label:"name","track-by":"category_id",options:q.value,multiple:!0,"hide-selected":!1,"show-labels":!1,"show-no-results":!0,"show-no-options":!0,class:S(d.value),disabled:b(n).isSynced.value||b(n).priceEditor||b(s).isUniqueAndMacDisabled,required:""},{option:C((e=>[y("p",Le,$(e.option.brand),1),y("p",null,$(e.option.name),1)])),_:1},8,["modelValue","options","class","disabled"]),(v(!0),f(_,null,x(b(l).categories.$errors.length,(e=>(v(),f("span",{key:e,class:"text-red-base mt-2 block"}," Item is required ")))),128))]),b(n).isSynced.value?(v(),f("div",Ae,[h(i,{placement:"right"},{content:C((()=>[y("div",Ue,[y("p",null,[t[11]||(t[11]=w(" This item's category name is locked because you are using price sync ")),b(s).$state.form.companyName?(v(),f(_,{key:0},[t[10]||(t[10]=w(" from ")),y("b",null,$(b(s).$state.form.companyName),1)],64)):k("",!0),t[12]||(t[12]=w(" . ")),t[13]||(t[13]=y("b",null,[y("a",{href:"https://help.reusely.com/en/articles/9176424-how-price-sync-works",target:"_blank",noreferrer:"",noopener:"",class:"mx-2 text-white underline"}," Read More ")],-1))])])])),default:C((()=>t[14]||(t[14]=[y("i",{class:"material-icons icon-md select-none"},"lock",-1)]))),_:1})])):k("",!0)])])])}}},Oe={key:0,class:"py-12 flex flex-col items-center"},De={class:"w-full flex justify-between mt-8"},Ee={key:1,class:"font-normal mb-5 text-lg"},Te={__name:"SettingConditionFormModalDelete",props:q({loading:{type:Boolean,default:!1},is_price_sync:{type:Boolean,default:!1}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:q(["delete","cancel"],["update:modelValue"]),setup(e,{emit:t}){const i=V(e,"modelValue");return(e,t)=>(v(),M(R,{size:"xs","hide-header":e.$props.is_price_sync,"hide-footer":e.$props.is_price_sync,modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=e=>i.value=e),title:"Delete Condition",onClose:t[4]||(t[4]=t=>e.$emit("cancel"))},{default:C((()=>[e.$props.is_price_sync?(v(),f("div",Oe,[t[7]||(t[7]=y("img",{src:ne,alt:""},null,-1)),t[8]||(t[8]=y("h2",{class:"font-semibold text-2xl mt-6"},"Delete Conditions?",-1)),t[9]||(t[9]=y("p",{class:"mt-3 text-center text-teal-03"},"Deleting conditions will remove all items under these conditions from your widget and remove their price. You can always recreate conditions, set price manually, or enable price sync at any time. Are you sure you want to proceed?",-1)),y("div",De,[h(J,{color:"white",view:"smooth",onClick:t[0]||(t[0]=t=>e.$emit("cancel"))},{default:C((()=>t[5]||(t[5]=[w("Cancel")]))),_:1}),h(J,{color:"teal",loading:e.$props.loading,onClick:t[1]||(t[1]=t=>e.$emit("delete"))},{default:C((()=>t[6]||(t[6]=[w("Confirm")]))),_:1},8,["loading"])])])):(v(),f("h6",Ee,"Are you sure want to delete this condition?"))])),footer:C((()=>[h(J,{color:"red",loading:e.$props.loading,onClick:t[2]||(t[2]=t=>e.$emit("delete"))},{default:C((()=>t[10]||(t[10]=[w("Delete")]))),_:1},8,["loading"])])),_:1},8,["hide-header","hide-footer","modelValue"]))}},Qe={class:"space-y-3"},Ge={key:0},Ie={class:"block"},Be={class:"flex justify-between items-center -mx-2"},Pe={class:"px-2 flex-1"},Fe={key:0},Ne={class:"pb-2 flex items-center -mx-1"},ze={class:"px-1 mx-6"},He={key:0,class:"text-red-base mt-2 block"},We={__name:"SettingConditionFormModalConditionActive",setup(e){const t=Et();p((()=>{var e,i;Array.isArray(null==(i=null==(e=t.form)?void 0:e.value)?void 0:i.terms)||(t.form.value.terms=[]),0===t.form.value.terms.length&&t.form.value.terms.push("")})),L((()=>t.form.value.terms),(e=>{Array.isArray(e)&&0===e.length&&t.form.value.terms.push("")}),{deep:!0});const i=()=>{var e,i;t.state.isSubmitting=!1,Array.isArray(null==(i=null==(e=t.form)?void 0:e.value)?void 0:i.terms)||(t.form.value.terms=[]),t.form.value.terms.push("")};return(e,o)=>(v(),f("div",Qe,[y("div",null,[h(b(W),{modelValue:b(t).form.value.name,"onUpdate:modelValue":o[0]||(o[0]=e=>b(t).form.value.name=e),type:"text",label:"Condition Name",placeholder:"e.g., Broken, Normal, New, etc.",class:"w-full",maxlength:"32",view:b(t).validation.value.name.$invalid?"danger":"default"},null,8,["modelValue","view"]),o[2]||(o[2]=y("span",{class:"text-xs text-grey-04 mt-2 block"},"Maximum 32 Character",-1)),(v(!0),f(_,null,x(b(t).validation.value.name.$errors,((e,t)=>(v(),f("span",{class:"text-red-base mt-2 block",key:t},$(e.$message)+". ",1)))),128))]),y("div",null,[h(b(W),{modelValue:b(t).form.value.term,"onUpdate:modelValue":o[1]||(o[1]=e=>b(t).form.value.term=e),disabled:!b(t).form.value.name,type:"text",label:"Condition Guideline",placeholder:"e.g., Choose if All of the following are true:",maxlength:"200",class:"w-full",view:b(t).validation.value.term.$invalid&&b(t).state.isSubmitting?"danger":"default"},null,8,["modelValue","disabled","view"]),o[3]||(o[3]=y("span",{class:"text-xs text-grey-04 mt-2 block"}," Maximum 200 character ",-1)),b(t).validation.value.term.$error?(v(),f("div",Ge,[(v(!0),f(_,null,x(b(t).validation.value.term.$errors,((e,t)=>(v(),f("span",{key:t,class:"text-red-base mt-2 block"}," Guideline is required. ")))),128))])):k("",!0)]),y("div",Ie,[o[8]||(o[8]=y("label",{class:"mb-2"},"Terms",-1)),h(b(me),{list:b(t).form.value.terms,handle:".dragable__icon"},{default:C((()=>[(v(!0),f(_,null,x(b(t).form.value.terms,((e,i)=>(v(),f("div",{key:i,class:"condition__draggable py-2"},[y("div",Be,[o[6]||(o[6]=y("div",{class:"pb-2"},[y("span",{class:"material-icons text-grey-04 text-2xl mr-3 cursor-move dragable__icon"}," drag_handle ")],-1)),y("div",Pe,[h(b(W),{modelValue:b(t).form.value.terms[i],"onUpdate:modelValue":e=>b(t).form.value.terms[i]=e,disabled:!b(t).form.value.name,placeholder:"e.g., Activation Locked, Device Power On, etc.",maxlength:"200",type:"text",class:"mb-2",block:"",view:b(t).validation.value.terms.$model[i].length<1&&b(t).state.isSubmitting?"danger":"default"},null,8,["modelValue","onUpdate:modelValue","disabled","view"]),b(t).validation.value.terms.$model[i].length<1&&b(t).state.isSubmitting?(v(),f("div",Fe,o[4]||(o[4]=[y("span",{class:"text-red-base mt-2 block"}," It must be at least one characters in length ",-1)]))):k("",!0)]),y("div",Ne,[y("div",ze,[h(b(J),{disabled:1===b(t).form.value.terms.length&&""===b(t).form.value.terms[0],color:"red",dense:"",onClick:e=>(e=>{t.state.isSubmitting=!1,t.form.value.terms.length>1?t.form.value.terms.splice(e,1):t.form.value.terms[0]=""})(i)},{default:C((()=>o[5]||(o[5]=[y("span",{class:"material-icons text-sm"},"delete",-1)]))),_:2},1032,["disabled","onClick"])])])])])))),128))])),_:1},8,["list"]),o[9]||(o[9]=y("span",{class:"text-xs text-grey-04 block"}," Maximum 200 character ",-1)),h(b(J),{class:"mt-4",view:"outlined",color:"teal",dense:"",onClick:i},{default:C((()=>o[7]||(o[7]=[y("span",{class:"mx-2"},"Add Terms",-1)]))),_:1})]),b(t).validation.value.questions.$error?(v(),f("span",He," There's required field on Conditional Questions Tab ")):k("",!0)]))}},Je={__name:"SettingConditionWarningQuestion",setup:e=>(e,t)=>(v(),M(b(Y),{color:"orange",view:"smooth",class:"mb-4",dense:""},{default:C((()=>t[0]||(t[0]=[y("div",{class:"flex items-center space-x-4"},[y("div",null,[y("i",{class:"material-icons"},"info")]),y("div",null," Currently, Conditional Questions are supported only on the API and not on the Widget. ")],-1)]))),_:1}))},Re={key:2,class:"space-y-4 mb-4"},Ye={class:"mb-4"},Ke={class:"flex gap-2"},Ze=["onClick"],Xe={class:"mt-2"},et={class:"flex justify-start gap-x-4"},tt={class:"flex-1"},it={class:"flex justify-between items-center mb-2"},ot={class:"font-semibold"},at=["onClick"],nt={class:"grid grid-cols-3 gap-2"},st={class:"col-span-3"},lt={key:3,class:"text-red-base mt-2 block"},dt={__name:"SettingConditionFormModalConditionQuestion",props:q({validation:Object,isBulk:{type:Boolean,default:!1}},{form:{type:Object,default:{questions:[{id:void 0,action:"edit",question:"",is_required:!1,answer_type:"Single",answers:[{id:void 0,action:"edit",answer:"",type:"Do Nothing",amount_type:"Fixed",amount_price:0}]}]},required:!0},formModifiers:{}}),emits:["update:form"],setup(e){const t=V(e,"form"),i=ji(),o=A({tempQuestions:[]}),a=u((()=>t.value.questions.filter((e=>"delete"!==e.action)))),n=e=>e.filter((e=>"delete"!==e.action)),s=()=>{t.value.has_question?(o.tempQuestions=Z(t.value.questions),t.value.questions.length<1&&l()):(t.value.questions=Z(o.tempQuestions),o.tempQuestions=[])},l=()=>{a.value.length>=3?j({type:"warning",message:"Only 3 questions are allowed per condition"}):t.value.questions.push({id:void 0,action:"edit",question:"",is_required:!1,answer_type:"Single",answers:[{id:void 0,action:"edit",answer:"",type:"Do Nothing",amount_type:"Fixed",amount_price:0}]})};return(o,d)=>(v(),f(_,null,[o.$props.isBulk?(v(),M(Je,{key:1})):(v(),f(_,{key:0},[d[2]||(d[2]=y("p",{class:"font-semibold mb-2"},"Conditional Questions",-1)),h(b(K),{modelValue:t.value.has_question,"onUpdate:modelValue":d[0]||(d[0]=e=>t.value.has_question=e),color:"teal",view:"smooth",type:"toggle",class:"mb-2",onInput:s,block:""},{default:C((()=>d[1]||(d[1]=[w("   ")]))),_:1},8,["modelValue"])],64)),t.value.has_question?(v(),f("div",Re,[(v(!0),f(_,null,x(a.value,((o,s)=>(v(),M(b(ve),null,{label:C((()=>[w("Question "+$(s+1),1)])),default:C((()=>[y("div",Ye,[y("div",Ke,[h(b(W),{modelValue:o.question,"onUpdate:modelValue":e=>o.question=e,type:"text",view:e.validation.questions.$error&&e.validation.questions.$each.$response.$errors[s].question.length>0?"danger":"default",block:""},null,8,["modelValue","onUpdate:modelValue","view"]),a.value.length>1?(v(),f("a",{key:0,href:"#",class:"p-2",onClick:U((e=>(e=>{i.conditionId.value?t.value.questions[e].action="delete":t.value.questions.splice(e,1)})(s)),["prevent"])},d[3]||(d[3]=[y("span",{class:"material-icons text-red-04"},"close",-1)]),8,Ze)):k("",!0)]),e.validation.questions.$error?(v(!0),f(_,{key:0},x(e.validation.questions.$each.$response.$errors[s].question,((e,t)=>(v(),f("span",{class:"text-red-base mt-2 block",key:t},$(e.$message)+". ",1)))),128)):k("",!0),y("div",Xe,[h(b(K),{modelValue:o.is_required,"onUpdate:modelValue":e=>o.is_required=e,"value-off":"false"},{default:C((()=>d[4]||(d[4]=[y("span",{class:"font-medium"},"Required",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue"]),h(b(K),{modelValue:o.answer_type,"onUpdate:modelValue":e=>o.answer_type=e,value:"Multiple","value-off":"Single"},{default:C((()=>d[5]||(d[5]=[y("span",{class:"font-medium"},"Multiple Answers",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue"])])]),d[9]||(d[9]=y("p",{class:"font-semibold mb-4"},"Answers",-1)),h(b(me),{list:n(o.answers),handle:".dragable__icon",class:"space-y-4 mb-4"},{default:C((()=>[(v(!0),f(_,null,x(n(o.answers),((t,a)=>(v(),f("div",{key:t,class:"condition__draggable border border-grey-01 border-solid rounded-md px-6 py-4"},[y("div",et,[d[7]||(d[7]=y("div",null,[y("span",{class:"material-icons text-grey-04 text-2xl cursor-move dragable__icon"}," drag_handle ")],-1)),y("div",tt,[y("div",it,[y("p",ot,"Answer "+$(a+1),1),n(o.answers).length>1?(v(),f("a",{key:0,href:"#",onClick:U((e=>((e,t)=>{i.conditionId.value?e.answers[t].action="delete":e.answers.splice(t,1)})(o,a)),["prevent"])},d[6]||(d[6]=[y("span",{class:"material-icons text-red-04"},"close",-1)]),8,at)):k("",!0)]),y("div",nt,[y("div",st,[h(b(W),{modelValue:t.answer,"onUpdate:modelValue":e=>t.answer=e,type:"text",view:!!e.validation.questions.$error&&e.validation.questions.$each.$response.$errors[s].answers[0]&&e.validation.questions.$each.$response.$errors[s].answers[0].$response.$errors[a].answer.length>0?"danger":"default",block:""},null,8,["modelValue","onUpdate:modelValue","view"]),e.validation.questions.$error&&e.validation.questions.$each.$response.$errors[s].answers[0]?(v(!0),f(_,{key:0},x(e.validation.questions.$each.$response.$errors[s].answers[0].$response.$errors[a].answer,((e,t)=>(v(),f("span",{class:"text-red-base mt-2 block",key:t},$(e.$message)+". ",1)))),128)):k("",!0)]),y("div",null,[h(b(fe),{modelValue:t.type,"onUpdate:modelValue":e=>t.type=e,placeholder:"Please Select",class:"w-full max-w-lg",items:["Do Nothing","Mark Up","Mark Down"]},null,8,["modelValue","onUpdate:modelValue"])]),y("div",null,[h(b(fe),{modelValue:t.amount_type,"onUpdate:modelValue":e=>t.amount_type=e,placeholder:"Please Select",class:"w-full max-w-lg",disabled:"Do Nothing"===t.type,items:["Fixed","Percentage"]},null,8,["modelValue","onUpdate:modelValue","disabled"])]),y("div",null,[h(b(W),{modelValue:t.amount_price,"onUpdate:modelValue":e=>t.amount_price=e,type:"number",disabled:"Do Nothing"===t.type,block:""},null,8,["modelValue","onUpdate:modelValue","disabled"])])])])])])))),128))])),_:2},1032,["list"]),h(b(J),{color:"teal",onClick:e=>(e=>{n(t.value.questions[e].answers).length>=10?j({type:"warning",message:"Only 10 answers are allowed per question"}):t.value.questions[e].answers.push({id:void 0,action:"edit",answer:"",type:"Do Nothing",amount_type:"Fixed",amount_price:0})})(s),dense:""},{default:C((()=>d[8]||(d[8]=[w("Add Answer")]))),_:2},1032,["onClick"])])),_:2},1024)))),256)),h(b(J),{color:"teal",onClick:l,dense:""},{default:C((()=>d[10]||(d[10]=[w("Add Question")]))),_:1})])):k("",!0),!o.$props.isBulk&&(e.validation.name.$error||e.validation.term.$error||e.validation.terms.$error)?(v(),f("span",lt," There's required field on Active Conditions Tab ")):k("",!0)],64))}},rt={key:0},ct={class:"list-decimal pl-4"},ut={key:0},mt={key:0,class:"list"},pt={key:0},gt={class:"text-grey-02"},vt={__name:"SettingConditionFormPreviewConditional",props:{questions:{type:Array,default:()=>[]}},setup(e){const t=e,i=u((()=>t.questions.filter((e=>"delete"!==e.action)))),o=e=>{let t="";return"Do Nothing"===e.type?0:("Mark Up"===e.type?t+="+":"Mark Down"===e.type&&(t+="-"),"Fixed"===e.amount_type?t+=`$${e.amount_price}`:"Percentage"===e.amount_type&&(t+=`${e.amount_price}%`),t)};return(e,t)=>i.value&&i.value.length>0?(v(),f("div",rt,[t[0]||(t[0]=y("div",{class:"mb-2"},"Conditional Questions:",-1)),y("ol",ct,[(v(!0),f(_,null,x(i.value,((e,t)=>{return v(),f(_,{key:t},[e.question?(v(),f("li",ut,[y("p",null,[w($(e.question)+" ",1),e.is_required?(v(),f(_,{key:0},[w("(Required)")],64)):k("",!0)]),e.answers&&e.answers.length>0?(v(),f("ul",mt,[(v(!0),f(_,null,x((i=e.answers,i.filter((e=>"delete"!==e.action))),((e,t)=>(v(),f(_,{key:t},[e.answer?(v(),f("li",pt,[y("p",null,[w($(e.answer)+" ",1),y("span",gt,"("+$(o(e))+")",1)])])):k("",!0)],64)))),128))])):k("",!0)])):k("",!0)],64);var i})),128))])])):k("",!0)}},ft={class:"h-full"},yt={class:"mb-4 p-4 max-w-md break-words"},ht={class:"text-lg mb-4 break-words"},Ct=["innerHTML"],bt={class:"list mb-4 break-words"},_t=["innerHTML"],xt={key:0,class:"max-w-md break-words"},wt={__name:"SettingConditionFormPreview",props:{conditionName:{type:String,default:""},conditionGuideline:{type:String,default:""},conditionTerms:{type:Array,default:()=>[]},questions:{type:Array,default:()=>[]},hasQuestion:{type:Boolean,default:!1}},setup(e){const t=e,i=u((()=>t.conditionTerms.map((e=>X(e||""))))),o=u((()=>X(t.conditionGuideline||"")));return(t,a)=>(v(),f("div",ft,[h(b(ve),{class:"h-full"},{label:C((()=>a[0]||(a[0]=[y("span",{class:"text-grey-04"},"Preview Condition",-1)]))),default:C((()=>[y("div",yt,[y("h2",ht,$(t.$props.conditionName),1),y("div",{innerHTML:o.value,class:"mb-2 break-words"},null,8,Ct),y("ul",bt,[(v(!0),f(_,null,x(i.value,((e,t)=>(v(),f(_,{key:t},[e?(v(),f("li",{key:0,innerHTML:e,class:"break-words"},null,8,_t)):k("",!0)],64)))),128))]),e.hasQuestion?(v(),f("div",xt,[h(vt,{questions:t.$props.questions},null,8,["questions"])])):k("",!0)])])),_:1})]))}};const $t={class:"px-12 py-6"},kt={class:"text-3xl flex items-center gap-4 mb-4"},St={class:"flex justify-between"},qt={__name:"SettingConditionFormModalUpgradePlan",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=V(e,"modelValue");return(e,i)=>(v(),M(R,{modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=e=>t.value=e),title:"Preview Condition",size:"sm","no-padding":"","hide-header":""},{default:C((()=>[i[6]||(i[6]=y("img",{src:"/images/setting-condition-conditional-questions-upgrade-plan.png",alt:"Conditional Questions"},null,-1)),y("div",$t,[y("div",kt,[i[3]||(i[3]=y("p",{class:"font-semibold"},"Conditional Questions",-1)),h(b(pe),{color:"green",style:{"font-size":"1rem"}},{default:C((()=>i[2]||(i[2]=[w("Growth")]))),_:1})]),i[4]||(i[4]=y("p",{class:"text-xl"}," Set conditional questions that determine item prices based on the customer's answers. You can add up to three conditional questions per condition and up to ten answers per question for each category or condition group. ",-1)),i[5]||(i[5]=y("p",{class:"text-xl"}," For example: Is the battery below 80%? If the customer answers yes, $10 is automatically deducted. Be creative and fine-tune every single condition with detailed answers and predefined price adjustments for each question. ",-1))])])),footer:C((()=>[y("div",St,[h(b(J),{color:"teal",view:"outlined",onClick:i[0]||(i[0]=e=>t.value=!1)},{default:C((()=>i[7]||(i[7]=[w("Close")]))),_:1}),h(b(J),{tag:"a",target:"_blank",href:"/setting/plan",color:"teal"},{default:C((()=>i[8]||(i[8]=[w("Upgrade Plan")]))),_:1})])])),_:1},8,["modelValue"]))}};function Vt(e){const t=Symbol(`${e}Context`);return[e=>O(t,e),e=>(D(t,e),e)]}const Mt={class:"flex items-center gap-2"},Lt={class:"font-normal flex items-center gap-1"},At={key:0,class:"mb-4 bg-red-01 rounded-lg px-6 py-4"},Ut={class:"grid md:grid-cols-5 grid-cols-1 gap-6"},jt={key:0,class:"col-span-5"},Ot={class:"col-span-5 md:col-span-3"},Dt={class:"col-span-5 md:col-span-2"},[Et,Tt]=Vt("SettingConditionFormModalCondition"),Qt={__name:"SettingConditionFormModalCondition",props:q({conditions:{type:Array,default:void 0},selectedCondition:{type:Object,default:void 0},isEdit:{type:Boolean,default:!1},selectedTab:{type:String,default:"Active"}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:q(["save","cancel"],["update:modelValue"]),setup(e,{emit:t}){const i=e,o=t,a=V(e,"modelValue"),n=ji(),{me:s}=ee(),l=A({isLoading:!1,isError:!1,isSubmitting:!1,isModalUpgradePlan:!1,selectedTab:We,tabs:[{name:"Active Conditions",component:We},{name:"Conditional Questions",component:dt}]}),d=E({name:"",term:"",terms:[],has_question:!1,questions:[]}),r=se({name:{required:le},term:{required:le},terms:{required:e=>e.every((e=>e.length>0))},questions:{required:re(((e,t)=>t.has_question)),$each:ce.forEach({question:{required:re(((e,t)=>"delete"!==t.action))},is_required:{required:le},answer_type:{required:le},answers:{required:le,$each:ce.forEach({answer:{required:re(((e,t)=>"delete"!==t.action))},type:{required:le},amount_type:{required:re(((e,t)=>"Mark Up"===t.type||"Mark Down"===t.type))},amount_price:{required:re(((e,t)=>"Mark Up"===t.type||"Mark Down"===t.type))}})}})}},d,{$stopPropagation:!0,$lazy:!0}),c=()=>{if(d.value.has_question&&s.value.package_id<17)l.isModalUpgradePlan=!0;else if(l.isSubmitting=!0,r.value.$validate(),!r.value.$invalid&&(()=>{const e=r.value.terms.$model;if(e.length<=0)return!1;for(let t=0;t<e.length;t++)if(te(e[t])||e[t].length<1)return!1;return!0})()){if(-1!==i.conditions.findIndex((e=>e.name.split(" ").join("").toLowerCase()===d.value.name.split(" ").join("").toLowerCase()))&&!n.conditionId.value&&!i.isEdit)return j({type:"warning",message:"Condition name is already taken!"});l.isError=!1,l.isSubmitting=!1,o("save",d.value)}},u=()=>{l.isSubmitting=!1,o("cancel")};return L((()=>[a.value,i.isEdit]),(()=>{a.value&&(l.isSubmitting=!1,r.value.$reset()),a.value&&i.isEdit?(d.value=Z(i.selectedCondition),"Question"===i.selectedTab&&(l.selectedTab=dt)):(l.selectedTab=We,d.value={name:"",term:"",terms:[""],has_question:!1,questions:[]})})),Tt({form:d,validation:r,state:l}),(e,t)=>{const i=g("Tooltip");return v(),f(_,null,[h(b(R),{modelValue:a.value,"onUpdate:modelValue":t[2]||(t[2]=e=>a.value=e),size:"lg",title:e.$props.selectedCondition?"Edit Condition":"Add Condition",onClose:u},{footer:C((()=>[h(b(J),{loading:l.isLoading,disabled:l.isLoading||b(r).$invalid,color:"teal",onClick:c},{default:C((()=>t[7]||(t[7]=[w(" Save ")]))),_:1},8,["loading","disabled"])])),default:C((()=>[y("div",null,[h(b(ge),{modelValue:l.selectedTab,"onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedTab=e),items:l.tabs,color:"teal",view:"smooth",component:""},{title:C((({item:e})=>[y("div",Mt,[y("span",null,$(e.name),1),"Conditional Questions"===e.name?(v(),M(b(pe),{key:0,color:"blue"},{default:C((()=>[y("div",Lt,[t[6]||(t[6]=w(" Beta ")),h(i,{placement:"top"},{content:C((()=>t[4]||(t[4]=[y("div",{class:"w-60"}," Currently, Conditional Questions are supported only on the API and not on the Widget. ",-1)]))),default:C((()=>[t[5]||(t[5]=y("span",{class:"material-icons",style:{"font-size":"0.9rem !important"}},"info",-1))])),_:1})])])),_:1})):k("",!0)])])),_:1},8,["modelValue","items"]),l.isError?(v(),f("div",At,"Condition")):k("",!0),y("div",Ut,["SettingConditionFormModalConditionQuestion"===l.selectedTab.__name?(v(),f("div",jt,[h(Je)])):k("",!0),y("div",Ot,[(v(),M(T(l.selectedTab),{form:d.value,"onUpdate:form":t[1]||(t[1]=e=>d.value=e),validation:b(r)},null,40,["form","validation"]))]),y("div",Dt,[h(wt,{"condition-name":d.value.name,"condition-guideline":d.value.term,"condition-terms":d.value.terms,questions:d.value.questions,"has-question":d.value.has_question},null,8,["condition-name","condition-guideline","condition-terms","questions","has-question"])])])])])),_:1},8,["modelValue","title"]),h(qt,{modelValue:l.isModalUpgradePlan,"onUpdate:modelValue":t[3]||(t[3]=e=>l.isModalUpgradePlan=e)},null,8,["modelValue"])],64)}}},Gt={__name:"SettingConditionFormModalBulkQuestion",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:q(["save"],["update:modelValue"]),setup(e,{emit:t}){const i=t,o=V(e,"modelValue"),{me:a}=ee(),n=A({isModalUpgradePlan:!1}),s=E({has_question:!0,questions:[{id:void 0,action:"edit",question:"",is_required:!1,answer_type:"Single",answers:[{id:void 0,action:"edit",answer:"",type:"Do Nothing",amount_type:"Fixed",amount_price:0}]}]}),l=se({questions:{required:re(((e,t)=>t.has_question)),$each:ce.forEach({question:{required:re(((e,t)=>"delete"!==t.action))},is_required:{required:le},answer_type:{required:le},answers:{required:le,$each:ce.forEach({answer:{required:re(((e,t)=>"delete"!==t.action))},type:{required:le},amount_type:{required:re(((e,t)=>"Mark Up"===t.type||"Mark Down"===t.type))},amount_price:{required:re(((e,t)=>"Mark Up"===t.type||"Mark Down"===t.type))}})}})}},s,{$stopPropagation:!0,$lazy:!0}),d=()=>{s.value.has_question&&a.value.package_id<17?n.isModalUpgradePlan=!0:(l.value.$validate(),l.value.$invalid||i("save",s.value))};return L((()=>o.value),(()=>{o.value&&(s.value={has_question:!0,questions:[{id:void 0,action:"edit",question:"",is_required:!1,answer_type:"Single",answers:[{id:void 0,action:"edit",answer:"",type:"Do Nothing",amount_type:"Fixed",amount_price:0}]}]})})),(e,t)=>(v(),f(_,null,[h(b(R),{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),size:"lg",title:"Add Condition Questions"},{footer:C((()=>[h(b(J),{disabled:b(l).$invalid,color:"teal",onClick:d},{default:C((()=>t[3]||(t[3]=[w("Save")]))),_:1},8,["disabled"])])),default:C((()=>[h(dt,{form:s.value,"onUpdate:form":t[0]||(t[0]=e=>s.value=e),validation:b(l),"is-bulk":""},null,8,["form","validation"])])),_:1},8,["modelValue"]),h(qt,{modelValue:n.isModalUpgradePlan,"onUpdate:modelValue":t[2]||(t[2]=e=>n.isModalUpgradePlan=e)},null,8,["modelValue"])],64))}},It={class:"space-y-8 text-center my-8"},Bt={class:"flex items-center justify-center gap-x-4"},Pt={__name:"SettingConditionFormModalBulkQuestionWarning",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:q(["cancel","continue"],["update:modelValue"]),setup(e,{emit:t}){const i=t,o=V(e,"modelValue"),a=()=>{o.value=!1,i("cancel")},n=()=>{o.value=!1,i("continue")};return(e,t)=>(v(),M(b(R),{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),"hide-header":"","hide-footer":"",size:"xs"},{default:C((()=>[y("div",It,[t[3]||(t[3]=y("span",{style:{fontSize:"8rem !important",lineHeight:"1"},class:"material-icons text-orange-03"}," error_outline ",-1)),t[4]||(t[4]=y("p",{class:"text-xl font-semibold mb-4"},"One or more Conditional Questions Exist!",-1)),t[5]||(t[5]=y("div",{class:"font-normal text-grey-03"},[y("p",null," If you proceed, the existing conditional questions data will be overridden, and changes cannot be undone. We recommend unchecking the conditions that already have conditional questions before proceeding with the bulk add, unless you intend to override all existing conditional questions. ")],-1)),y("div",Bt,[h(b(J),{color:"grey",view:"outlined",onClick:a},{default:C((()=>t[1]||(t[1]=[w("Cancel")]))),_:1}),h(b(J),{color:"teal",onClick:n},{default:C((()=>t[2]||(t[2]=[w("Continue")]))),_:1})])])])),_:1},8,["modelValue"]))}},Ft={key:0,class:"flex w-full"},Nt={class:"flex items-start"},zt={class:"flex-1 mt-1"},Ht={class:"font-semibold mb-4"},Wt=["innerHTML"],Jt={class:"list mb-4 2xl:max-w-7xl xl:max-w-5xl lg:max-w-2xl md:max-w-2xl max-w-xl break-words"},Rt=["innerHTML"],Yt={key:0,class:"lg:opacity-0 group-hover:opacity-100 transition-opacity"},Kt={class:"flex items-center justify-end"},Zt={key:1,class:"text-center border-2 border-grey-01 border-dashed px-6 py-8 rounded-lg"},Xt={key:2,class:"my-4"},[ei,ti]=Vt("SettingConditionFormMappingList"),ii={__name:"SettingConditionFormMappingList",setup(e,{expose:t}){var i;const o=c(),a=Q(),n=ji(),s=be(),r=_e(),u=A({isEdit:!1,selected:void 0,isModalOpen:{edit:!1,delete:!1,bulkQuestion:!1,bulkQuestionWarning:!1},selectedTab:"Active",selectedConditionsBulk:[]}),m=se({activeConditions:{required:le,minLength:ue(1)}},r.$state.form,{$lazy:!0}),p=()=>{u.isEdit=!1,u.selected=null,u.isModalOpen.edit=!0},g=()=>{-1!==u.selectedConditionsBulk.findIndex((e=>r.$state.form.activeConditions.find((t=>t.id===e)).questions.length>0))?u.isModalOpen.bulkQuestionWarning=!0:u.isModalOpen.bulkQuestion=!0},q=()=>{u.isModalOpen.bulkQuestion=!0},V=async e=>{if(u.isModalOpen.bulkQuestion=!1,n.conditionId.value){try{await ie(r.$state.createSettingConditionQuestionBulk,(async()=>{await r.$createSettingConditionQuestionBulk({data:{condition_ids:u.selectedConditionsBulk,questions:e.questions}}),u.selectedConditionsBulk=[],await U()}))}catch(t){404==t.status_code&&await U()}E()}},L=()=>{u.isEdit=!1,u.selected=null,u.selectedTab="Active",Object.keys(u.isModalOpen).forEach((e=>{u.isModalOpen[e]=!1}))},U=async()=>{u.localLoading=!0;try{await s.$getSettingConditionGroup({id:n.conditionId.value,params:{unique_id:o.query.unique_id,is_price_sync:o.query.price_sync}})}catch(e){a.push({name:"settingCondition"})}finally{u.localLoading=!1}},j=async(e,t=!1)=>{if(e=Z(e),u.isModalOpen.edit=!1,u.isEdit)if(n.conditionId.value&&e.id){try{await ie(r.$state.updateSettingCondition,(async()=>{await r.$updateSettingCondition({id:e.id,data:e})})),await U()}catch(i){404==i.status_code&&await U()}E()}else r.$state.form.activeConditions[e.index]=l(l({},Z(r.$state.form.activeConditions[e.index])),e);else if(n.conditionId.value)try{await ie(r.$state.createSettingCondition,(async()=>{await r.$createSettingCondition({id:n.conditionId.value,data:e})})),await U(),E()}catch(i){404==i.status_code&&await U()}else r.$state.form.activeConditions.push(e);t||(r.$state.form.conditions=r.$state.form.conditions.map((e=>(e=Z(e)).added?e:d(l({},e),{exist:r.isConditionActive(e)})))),L()},O=async()=>{if(u.isModalOpen.delete=!1,(()=>{const e=r.$state.form.conditions,t=e.findIndex((e=>{const t=e.name.split(" ").join("");return u.selected.name.split(" ").join("").toLowerCase()===t.toLowerCase()}));e[t]&&(r.$state.form.conditions[t].added=!1,r.$state.form.conditions[t].exist=!1)})(),n.conditionId.value)try{await ie(r.$state.deleteSettingCondition,(async()=>{await r.$deleteSettingCondition({id:u.selected.id})})),await U(),E()}catch(e){404==e.status_code&&await U()}else r.form.activeConditions.splice(u.selected.index,1);L()},D=async()=>{const e=r.form.activeConditions.map(((e,t)=>({id:e.id,sort:t})));n.conditionId.value&&await ie(r.$state.sortSettingCondition,(()=>r.$sortSettingCondition({data:{sorting:e}})))},E=()=>{r.form.activeConditions=s.$state.form.conditions.map((e=>{let t=[];const i=e.condition_term?JSON.parse(e.condition_term):[];return t=Array.isArray(i)?i:[],d(l({},Z(e)),{terms:t?t.splice(1,t.length-1):[""],term:t?t[0]:e.condition_term})}))};return(null==(i=null==n?void 0:n.conditionId)?void 0:i.value)&&E(),ti({state:u,onSaveCondition:j}),t({onSubmit:async()=>(await m.value.$validate(),!m.value.$error),onSaveCondition:j,validation:m,state:u}),(e,t)=>{const i=G("loading");return v(),f(_,null,[y("div",null,[I((v(),f("div",null,[b(r).$state.form.activeConditions.length>0?(v(),f(_,{key:0},[u.selectedConditionsBulk.length>0?(v(),M(J,{key:0,color:"teal",class:"mb-4",onClick:g},{default:C((()=>t[6]||(t[6]=[w(" Bulk Conditional Questions ")]))),_:1})):k("",!0),h(b(me),{modelValue:b(r).$state.form.activeConditions,"onUpdate:modelValue":t[1]||(t[1]=e=>b(r).$state.form.activeConditions=e),handle:".drag_indicator",disabled:b(s).isUniqueAndMacDisabled,onChange:D},{default:C((()=>[(v(!0),f(_,null,x(b(r).$state.form.activeConditions,((e,i)=>(v(),f("div",{class:S([b(n).isSynced.value?"bg-opacity-50":"bg-opacity-10","border rounded-lg mb-4","border-grey-01 border-opacity-50 bg-grey-01","py-4 px-6","condition__draggable group","hover:border-opacity-80 transition-all ease-in-out duration-300"]),key:i},[e?(v(),f("div",Ft,[y("div",Nt,[b(n).isSynced.value?k("",!0):(v(),f("span",{key:0,class:S([b(s).isUniqueAndMacDisabled&&"opacity-30 cursor-not-allowed","material-icons text-grey-04 text-4xl cursor-move drag_indicator mr-4"])}," drag_indicator ",2)),b(n).conditionId.value?(v(),M(b(K),{key:1,modelValue:u.selectedConditionsBulk,"onUpdate:modelValue":t[0]||(t[0]=e=>u.selectedConditionsBulk=e),value:e.id},{default:C((()=>t[7]||(t[7]=[w("   ")]))),_:2},1032,["modelValue","value"])):k("",!0)]),y("div",zt,[y("p",Ht,$(e.name),1),y("div",{innerHTML:e.term,class:"mb-2 2xl:max-w-7xl xl:max-w-5xl lg:max-w-2xl md:max-w-2xl max-w-xl break-words"},null,8,Wt),y("ul",Jt,[(v(!0),f(_,null,x(e.terms||[],((e,t)=>(v(),f(_,{key:t},[e&&e.length?(v(),f("li",{key:0,class:"text-grey-04",innerHTML:b(X)(e)},null,8,Rt)):k("",!0)],64)))),128))]),e.has_question?(v(),M(vt,{key:0,questions:e.questions,class:"2xl:max-w-7xl xl:max-w-5xl lg:max-w-2xl md:max-w-2xl max-w-xl break-words"},null,8,["questions"])):(v(),M(J,{key:1,color:"teal",view:"outlined",onClick:t=>((e,t)=>{u.isEdit=!0,u.selected=d(l({},Z(e)),{index:t}),u.isModalOpen.edit=!0,u.selectedTab="Question"})(e,i),dense:""},{default:C((()=>t[8]||(t[8]=[y("span",{class:"flex items-center justify-center"},[y("i",{class:"material-icons icon-xxs mr-2"},"add"),w(" Conditional Questions ")],-1)]))),_:2},1032,["onClick"]))]),b(s).isUniqueAndMacDisabled?k("",!0):(v(),f("div",Yt,[y("div",Kt,[h(J,{color:"teal",class:"mr-3 text-sm",dense:"",icon:"",onClick:t=>((e,t)=>{u.isEdit=!0,u.selected=d(l({},Z(e)),{index:t}),u.isModalOpen.edit=!0})(e,i)},{default:C((()=>t[9]||(t[9]=[y("span",{class:"material-icons text-sm"},"edit",-1)]))),_:2},1032,["onClick"]),b(n).isSynced.value?k("",!0):(v(),M(J,{key:0,color:"red",dense:"",onClick:t=>((e,t)=>{u.isEdit=!0,u.selected=d(l({},Z(e)),{index:t}),u.isModalOpen.delete=!0})(e,i)},{default:C((()=>t[10]||(t[10]=[y("span",{class:"material-icons text-sm"},"delete",-1)]))),_:2},1032,["onClick"]))])]))])):k("",!0)],2)))),128))])),_:1},8,["modelValue","disabled"])],64)):(v(),f("div",Zt,t[11]||(t[11]=[y("p",{class:"text-grey-02 max-w-lg mx-auto w-full text-sm"},' Use the "Add New Condition" button below to create your item conditions from scratch, or save time and use our Preset Conditions ',-1)]))),b(n).isSynced.value?k("",!0):(v(),f("div",Xt,[h(J,{class:"block w-full",color:"teal",disabled:!b(s).form.categories||!b(s).form.categories.length||!b(s).form.group_name||b(s).isUniqueAndMacDisabled,onClick:p},{default:C((()=>t[12]||(t[12]=[y("span",{class:"flex items-center justify-center"},[y("i",{class:"material-icons mr-2"},"add"),w(" Add New Condition ")],-1)]))),_:1},8,["disabled"])]))])),[[i,b(r).isMappingListLoading]]),h(Qt,{modelValue:u.isModalOpen.edit,"onUpdate:modelValue":t[2]||(t[2]=e=>u.isModalOpen.edit=e),"selected-condition":u.selected,"selected-tab":u.selectedTab,conditions:b(r).$state.form.activeConditions,"is-edit":u.isEdit,onSave:j,onCancel:L},null,8,["modelValue","selected-condition","selected-tab","conditions","is-edit"]),h(Gt,{modelValue:u.isModalOpen.bulkQuestion,"onUpdate:modelValue":t[3]||(t[3]=e=>u.isModalOpen.bulkQuestion=e),onSave:V},null,8,["modelValue"]),h(Pt,{modelValue:u.isModalOpen.bulkQuestionWarning,"onUpdate:modelValue":t[4]||(t[4]=e=>u.isModalOpen.bulkQuestionWarning=e),onCancel:L,onContinue:q},null,8,["modelValue"]),h(Te,{modelValue:u.isModalOpen.delete,"onUpdate:modelValue":t[5]||(t[5]=e=>u.isModalOpen.delete=e),is_price_sync:!!b(s).$state.form.is_price_sync,onCancel:L,onDelete:O},null,8,["modelValue","is_price_sync"])]),(v(!0),f(_,null,x(b(m).activeConditions.$errors.length,(e=>(v(),f("div",{key:e,class:"bg-red-lighten rounded-lg py-4 px-6 my-6"},t[13]||(t[13]=[y("span",{class:"text-red-base block"},"Please add at least 1 condition",-1)]))))),128))],64)}}},oi={class:"space-y-8 text-center my-8"},ai={class:"flex items-center justify-center gap-x-4"},ni={__name:"SettingConditionFormModalDuplicate",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:q(["cancel","continue"],["update:modelValue"]),setup(e,{emit:t}){const i=t,o=V(e,"modelValue"),a=()=>{o.value=!1,i("cancel")},n=()=>{o.value=!1,i("continue")};return(e,t)=>(v(),M(R,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),"hide-header":"","hide-footer":"",size:"xs"},{default:C((()=>[y("div",oi,[t[3]||(t[3]=y("span",{style:{fontSize:"8rem !important",lineHeight:"1"},class:"material-icons text-orange-03"}," error_outline ",-1)),t[4]||(t[4]=y("div",{class:"font-normal text-grey-03"},[y("p",null," You have conditions with the same title already in the active conditions. If you continue, it will replace the existing condition. "),y("p",null,"Are you sure you want to proceed?")],-1)),y("div",ai,[h(J,{color:"grey",view:"outlined",onClick:a},{default:C((()=>t[1]||(t[1]=[w("Cancel")]))),_:1}),h(J,{color:"teal",onClick:n},{default:C((()=>t[2]||(t[2]=[w("Continue")]))),_:1})])])])),_:1},8,["modelValue"]))}};const si={class:"flex flex-col gap-y-8 py-4 px-2"},li={class:"space-y-2"},di={class:"flex items-center gap-x-4"},ri={class:"flex-1 flex items-center gap-x-1"},ci={key:0,class:"material-icons text-green-04"},ui={key:0,class:"space-y-6"},mi={class:"space-y-4"},pi={class:"font-semibold title"},gi={class:"material-icons"},vi=["innerHTML"],fi={class:"list-outside list-disc ml-6"},yi=["innerHTML"];var hi=oe({__name:"SettingConditionFormMappingSource",emits:["onSaveCondition","onEditCondition"],setup(e,{emit:t}){const i=be(),o=_e(),a=ji(),n=ei(),s=A({replacer:void 0,isAddAll:!1,isModalOpen:!1}),r=t,c=u((()=>{if(i.$state.form.categories&&i.$state.form.categories.length)return i.$state.form.categories})),m=u((()=>!!(!i.$state.form.group_name||!c.value||c.value.length>1||o.isMappingSourceLoading||a.isSynced.value))),p=()=>{let e=[];const t=o.$state.form.conditions;o.$state.form.conditions=t.map((t=>{const i=JSON.parse(t.condition_term);return e=Array.isArray(i)?i:[],d(l({},t),{term:e?e[0]:t.condition_term,terms:e?e.splice(1,e.length-1):[""],added:!1,exist:o.isConditionActive(t)})}))},q=(e,t=-1)=>{if(!(e=Z(e))||-1===t)return;if(e.exist)return s.replacer=d(l({},e),{index:t}),void(s.isModalOpen=!0);o.$state.form.selectedConditions.push(e),o.$state.form.conditions[t].added=!0,n&&r("onEditCondition",!1);const i=e;delete i.id,a.conditionId.value?r("onSaveCondition",{condition:i,source:!0}):o.$state.form.activeConditions.push(d(l({},i),{has_question:!1,questions:[]}))},V=()=>{const e=o.$state.form.conditions.length&&o.$state.form.conditions.filter((e=>e.exist))||[];if(e.length)return s.replacer=Z(e),s.isAddAll=!0,void(s.isModalOpen=!0);o.$state.form.conditions.forEach(((e,t)=>{e.added||q(e,t)}))},U=async e=>{if(o.$state.form.sources)return o.$state.form.selectedSource=o.$state.form.sources.find((t=>t.sub_domain===e)),await(async()=>{const e=o.$state.form.selectedSource,t=c.value?c.value[0]:[];e.sub_domain&&t&&(await ie(o.$state.getSettingConditions,(()=>o.$getSettingConditions({params:{sub_domain:e.sub_domain,category_id:t.category_id,is_mac:t.is_mac}}))),p())})();o.$state.form.selectedSource={}},j=()=>s.isAddAll?(()=>{const e=Z(o.$state.form.conditions),t=Z(o.$state.form.activeConditions);o.$state.form.conditions=e.map((e=>d(l({},e),{added:!0}))),o.$state.form.selectedConditions=e,o.$state.form.selectedConditions.forEach((e=>{var i,n,s,c;const u=t.findIndex((t=>{const i=t.name.split(" ").join(""),o=e.name.split(" ").join("");return i.toLowerCase()===o.toLowerCase()}));u>-1?(r("onEditCondition",!0),a.conditionId.value&&t[u].id?r("onSaveCondition",{condition:{id:null!=(n=null==(i=o.$state.form.activeConditions[u])?void 0:i.id)?n:void 0,name:e.name,term:e.term,terms:e.terms},source:!0}):o.$state.form.activeConditions[u]=l(l({},t[u]),e)):(r("onEditCondition",!1),a.conditionId.value?r("onSaveCondition",{condition:{id:null!=(c=null==(s=o.$state.form.activeConditions[u])?void 0:s.id)?c:void 0,name:e.name,term:e.term,terms:e.terms},source:!0}):o.$state.form.activeConditions.push(d(l({},e),{has_question:!1,questions:[]})))}))})():(()=>{const e=o.$state.form.activeConditions,t=o.$state.form.conditions,i=e.findIndex((e=>{const t=s.replacer.name.split(" ").join(""),i=e.name.split(" ").join("");return t.toLowerCase()===i.toLowerCase()}));if(i>-1){const e=Z(t[s.replacer.index]);o.$state.form.selectedConditions=[...new Set([...Z(o.$state.form.selectedConditions),e])],o.$state.form.conditions[s.replacer.index].added=!0,o.$state.form.activeConditions[i]=l({},e)}O()})(),O=()=>{s.isModalOpen=!1,s.isAddAll=!1,s.replacer=void 0};return L((()=>[c.value,a.isSynced.value]),(async()=>{c.value&&!a.isSynced.value?await ie(o.$state.getSettingConditionSources,(()=>o.$getSettingConditionSources(c.value[0]))):o.resetSettingConditionForm()}),{deep:!0,immediate:!0}),(e,t)=>{const i=g("Tooltip"),a=G("loading");return v(),f(_,null,[y("div",si,[y("div",li,[t[2]||(t[2]=y("div",null,[y("div",{class:"bg-green-04 rounded-full text-white inline-flex px-4 items-center justify-center gap-1 text-sm"},[y("span",{class:"material-icons"},"verified"),w(" Recomended ")])],-1)),t[3]||(t[3]=y("p",null," Save time by using these presets to define your conditions without having to start from scratch. ",-1)),h(ae,{modelValue:b(o).$state.form.selectedSource,"onUpdate:modelValue":[t[0]||(t[0]=e=>b(o).$state.form.selectedSource=e),U],items:b(o).$state.form.sources,style:{width:"100%",boxShadow:"unset"},disabled:m.value,loading:b(o).isMappingSourceLoading,placeholder:"Choose Preset Condition","max-height":"200px",by:"sub_domain",name:"name","no-border":""},{item:C((({item:e})=>[y("div",di,[y("div",{style:B({backgroundImage:`url(${e.logo})`}),class:"w-28 h-7 flex items-center justify-center bg-center bg-contain bg-no-repeat"},null,4),y("div",ri,[w($(e.name)+" ",1),b(o).$state.form.selectedSource?(v(),f(_,{key:0},[(null==e?void 0:e.sub_domain)===b(o).$state.form.selectedSource.sub_domain?(v(),f("i",ci," check_circle ")):k("",!0)],64)):k("",!0)])])])),_:1},8,["modelValue","items","disabled","loading"])]),b(o).$state.form.selectedSource?I((v(),f("div",ui,[(v(!0),f(_,null,x(b(o).$state.form.conditions,((e,o)=>(v(),f("div",{key:o,class:S(["condition-source-outline",!e.added&&!!e.exist&&"condition-source-outline--warning",!!e.added&&"condition-source-outline--success"])},[y("div",mi,[y("div",pi,[w($(e.name)+" ",1),e.added||e.exist?(v(),M(i,{key:0,placement:"top"},{content:C((()=>t[4]||(t[4]=[y("p",{class:"w-80 text-sm"}," A condition with this name is already exists. To use this condition please rename the existing one or delete it first. ",-1)]))),default:C((()=>[y("span",gi,$(e.added?"check_circle":"info"),1)])),_:2},1024)):k("",!0)]),y("div",null,[y("div",{innerHTML:e.term},null,8,vi),y("ul",fi,[(v(!0),f(_,null,x(e.terms||[],((e,t)=>(v(),f(_,{key:t},[e&&(null==e?void 0:e.length)?(v(),f("li",{key:0,class:"text-grey-04",innerHTML:b(X)(e)},null,8,yi)):k("",!0)],64)))),128))])]),e.added?k("",!0):(v(),M(J,{key:0,view:"outlined",color:e.exist?"orange":"teal",block:"",dense:"",onClick:t=>q(e,o)},{default:C((()=>t[5]||(t[5]=[y("div",{class:"flex items-center justify-center gap-2"},[y("span",null,"Add to Active Conditions"),y("span",{class:"material-icons"},"arrow_forward")],-1)]))),_:2},1032,["color","onClick"]))])],2)))),128)),b(o).$state.form.conditions&&b(o).$state.form.conditions.length>=2&&b(o).$state.form.conditions.length!==b(o).$state.form.selectedConditions.length?(v(),M(J,{key:0,color:"teal",block:"",dense:"",onClick:V},{default:C((()=>t[6]||(t[6]=[y("div",{class:"flex items-center justify-center gap-2"},[y("span",null,"Add All To Active Conditions"),y("span",{class:"material-icons"},"arrow_forward")],-1)]))),_:1})):k("",!0)])),[[a,b(o).isMappingSourceLoading]]):k("",!0)]),h(ni,{modelValue:s.isModalOpen,"onUpdate:modelValue":t[1]||(t[1]=e=>s.isModalOpen=e),onContinue:j,onCancel:O},null,8,["modelValue"])],64)}}},[["__scopeId","data-v-65b73775"]]);const Ci={class:"flex flex-col lg:flex-row gap-4"},bi={class:"lg:w-1/4"},_i={class:"flex-1"},xi={__name:"SettingConditionFormMapping",setup(e,{expose:t}){const i=P("refMappingList");t({onSubmit:()=>i.value.onSubmit()});const o=e=>i.value.onSaveCondition(e.condition,e.source),a=e=>i.value.state.isEdit=e;return(e,t)=>(v(),f("div",Ci,[y("div",bi,[h(ve,{class:"rounded-lg"},{label:C((()=>t[0]||(t[0]=[w("Preset Condition")]))),default:C((()=>[h(hi,{onOnEditCondition:a,onOnSaveCondition:o})])),_:1})]),y("div",_i,[h(ve,{class:"rounded-lg"},{label:C((()=>t[1]||(t[1]=[w("Active Conditions and Conditional Questions")]))),default:C((()=>[(v(),M(F,null,{default:C((()=>[h(ii,{ref_key:"refMappingList",ref:i},null,512)])),_:1}))])),_:1})])]))}};const wi={class:"flex flex-col gap-6"},$i={class:"space-y-4"},ki={class:"lg:ml-14"},Si={class:"space-y-4"},qi={class:"lg:ml-14"},Vi={key:0,class:"mt-10 -mx-6 -mb-6 px-10 py-6 border-t border-grey-01"},Mi={class:S(["flex items-center justify-end"])},Li={key:0,class:"py-12 flex flex-col items-center"},Ai={class:"w-full flex justify-between mt-8"},Ui={key:1,class:"text-lg font-normal mb-5"},[ji,Oi]=Vt("SettingConditionForm");var Di=oe({__name:"SettingConditionForm",props:{isPriceSync:{type:Boolean,default:!1},companySource:{type:String,default:""},priceEditor:{type:Boolean,default:!1},priceEditorCategory:Object},async setup(e,{expose:t}){let i,o;const a=e,n=c(),s=Q(),l=be(),d=_e(),r=A({isModalDelete:!1}),p=P("refMapping"),g=P("refCategory"),_=u((()=>n.params&&n.params.conditionId)),x=u((()=>!!n.query.unique_id&&1==n.query.sync)),$=u((()=>"1"==l.$state.form.is_price_sync)),S=async()=>{_.value&&(r.isModalDelete=!1,await ie(l.$state.deleteSettingConditionGroup,(()=>l.$deleteSettingConditionGroup({id:_.value}).then((()=>{s.push({name:"settingCondition"})})).catch((()=>{s.push({name:"settingCondition"})})))))},{priceEditor:q,priceEditorCategory:V}=N(a);return Oi({priceEditor:q.value,priceEditorCategory:V.value,conditionId:_,isSynced:x}),t({onSubmit:async()=>{const e=await g.value.onSubmit(),t=await p.value.onSubmit();l.$state.form.conditions=d.$state.form.activeConditions,e&&t&&(_.value?await ie(l.$state.updateSettingConditionGroup,(()=>l.$updateSettingConditionGroup({id:_.value}).then((()=>{a.priceEditor||s.push({name:"settingCondition"})})))):await ie(l.$state.createSettingConditionGroup,(()=>l.$createSettingConditionGroup().then((()=>{a.priceEditor||s.push({name:"settingCondition"})})))))}}),_.value&&([i,o]=m((()=>l.$getSettingConditionGroup({id:_.value,params:{unique_id:n.query.unique_id,is_price_sync:n.query.price_sync}}).catch((()=>{s.push({name:"settingCondition"})})))),await i,o()),(e,t)=>{const i=G("loading");return v(),f("div",null,[y("div",wi,[y("div",$i,[t[4]||(t[4]=z('<div class="flex items-center gap-6" data-v-25f50773><div class="flex items-center justify-center bg-teal-04 rounded-full text-white font-semibold w-8 h-8" data-v-25f50773><span data-v-25f50773>1</span></div><h6 class="text-lg text-teal-04" data-v-25f50773>Set Category</h6></div><div class="lg:ml-14 flex items-center text-left border-l-4 border-orange-02 px-4 py-2 gap-2 mb-2 info-warning" data-v-25f50773><i class="material-icons" data-v-25f50773>info_outline</i><p data-v-25f50773>To assign a Preset Condition to more than one item in a group, first select one item, apply a preset, and then add more items as needed.</p></div>',2)),y("div",ki,[h(je,{ref_key:"refCategory",ref:g},null,512)])]),y("div",Si,[t[5]||(t[5]=y("div",{class:"flex items-center gap-6"},[y("div",{class:"flex items-center justify-center bg-teal-04 rounded-full text-white font-semibold w-8 h-8"},[y("span",null,"2")]),y("h6",{class:"text-lg text-teal-04"},"Set Condition")],-1)),y("div",qi,[h(xi,{ref_key:"refMapping",ref:p},null,512)])])]),x.value||e.$props.priceEditor?k("",!0):(v(),f("div",Vi,[y("div",Mi,[_.value?I((v(),f("a",{key:0,href:"#",class:"text-red-04 hover:text-red-02 focus:text-red-02",onClick:t[0]||(t[0]=U((e=>r.isModalDelete=!0),["prevent"]))},t[6]||(t[6]=[w(" Delete ")]))),[[i,b(l).isFormLoading]]):k("",!0)])])),_.value&&!x.value?(v(),M(R,{key:1,modelValue:r.isModalDelete,"onUpdate:modelValue":t[3]||(t[3]=e=>r.isModalDelete=e),title:"Delete Category",size:"xs","hide-footer":$.value,"hide-header":$.value},{default:C((()=>[$.value?(v(),f("div",Li,[t[9]||(t[9]=y("img",{src:ne,alt:""},null,-1)),t[10]||(t[10]=y("h2",{class:"font-semibold text-2xl mt-6"},"Delete Category?",-1)),t[11]||(t[11]=y("p",{class:"mt-3 text-center text-teal-03"},"Deleting conditions will remove all items under these conditions from your widget and remove their price. You can always recreate conditions, set price manually, or enable price sync at any time. Are you sure you want to proceed?",-1)),y("div",Ai,[h(J,{color:"white",view:"smooth",disabled:b(l).$state.deleteSettingConditionGroup.isLoading,onClick:t[1]||(t[1]=e=>r.isModalDelete=!1)},{default:C((()=>t[7]||(t[7]=[w("Cancel")]))),_:1},8,["disabled"]),h(J,{color:"teal",loading:b(l).$state.deleteSettingConditionGroup.isLoading,onClick:S},{default:C((()=>t[8]||(t[8]=[w("Confirm")]))),_:1},8,["loading"])])])):(v(),f("h6",Ui,"Are you sure want to delete this category?"))])),footer:C((()=>[h(J,{view:"outlined",color:"teal",class:"mr-5",disabled:b(l).$state.deleteSettingConditionGroup.isLoading,onClick:t[2]||(t[2]=e=>r.isModalDelete=!1)},{default:C((()=>t[12]||(t[12]=[w(" Cancel ")]))),_:1},8,["disabled"]),h(J,{view:"smooth",color:"red",loading:b(l).$state.deleteSettingConditionGroup.isLoading,onClick:S},{default:C((()=>t[13]||(t[13]=[w(" Delete ")]))),_:1},8,["loading"])])),_:1},8,["modelValue","hide-footer","hide-header"])):k("",!0)])}}},[["__scopeId","data-v-25f50773"]]);const Ei={class:"flex justify-between items-center mt-2 mb-8"},Ti={__name:"SettingConditionPageCrud",props:{breadcrumb:{type:Array,default:()=>[]},title:String,backTo:Object},setup(e){const t=P("form"),i=be();return(e,o)=>(v(),f("div",null,[y("div",Ei,[h(he,{pageTitle:e.$props.title,backTo:e.$props.backTo,items:e.$props.breadcrumb,class:"w-full"},{right:C((()=>[h(J,{color:"teal",loading:b(i).isFormLoading,onClick:o[0]||(o[0]=e=>b(t).onSubmit())},{default:C((()=>o[1]||(o[1]=[w(" Save Changes ")]))),_:1},8,["loading"])])),_:1},8,["pageTitle","backTo","items"])]),h(Ce,{class:"mb-24"},{default:C((()=>[(v(),M(F,null,{fallback:C((()=>[h(ye)])),default:C((()=>[h(Di,{ref:"form"},null,512)])),_:1}))])),_:1})]))}};export{Ti as _,_e as a,be as u};
