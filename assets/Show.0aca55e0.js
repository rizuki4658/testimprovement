var a=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(e,t,i)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,o=(a,e)=>{for(var t in e||(e={}))l.call(e,t)&&s(a,t,e[t]);if(i)for(var t of i(e))n.call(e,t)&&s(a,t,e[t]);return a};import{k as d,f as r,y as p,m as c,a0 as u,o as m,t as g,B as v,D as _,a2 as h,a3 as f,K as b,A as y,n as k,w as x,_ as w,U as I,a5 as D,r as C,I as P}from"./vendor.f1efedad.js";import{j as S,m as V,h as j,o as U,d as $}from"./invoice.634d0f8a.js";import{_ as M}from"./badge.b59865a3.js";import{f as T,_ as O,b as N,d as A,a9 as F,r as L}from"./index.9aa6481b.js";import{C as q}from"./card.dfb8e6f7.js";import{P as B}from"./PaymentMethod.4ef04a05.js";import{I as E}from"./InputPhone.e8268c4d.js";import{u as z}from"./index.32689823.js";import{r as K,e as R,v as G}from"./index.a87b789d.js";import{c as H,r as J}from"./index.05b14cb2.js";import{I as Q}from"./Detail.b57bdb2e.js";import{T as W}from"./TextLimit.bf4160ce.js";import{n as X,f as Y}from"./date.f86face7.js";import"./tab.065d46d3.js";import"./Custom.10acc1a6.js";import"./buyback.8c173696.js";import"./payment.6f5ea1dc.js";import"./select.15c77568.js";import"./TremendousCard.bcd69752.js";import"./SelectCountry.3e7bff58.js";import"./setting.2daa7691.js";const Z=d({components:{Input:T,InputPhone:E},props:{data:{type:Object,default:()=>{}}},emits:["update:data"],setup(a,{emit:e}){const t=r(null),i=r(null);t.value=a.data,t.value.valid=""!==a.data.sipping_address_text||null!==a.data.sipping_address_text;const l={customer_email:{required:K,email:R},shipping_firstname:{required:K},shipping_lastname:{required:K},valid:{sameAs:G},shipping_phone:{required:K,invalidNumber:H.withMessage("Phone number is invalid",(()=>{var a;return!t.shipping_phone||(null==(a=i.value)?void 0:a.isValid)}))}},n=z(l,t.value,{$lazy:!0});return p((()=>o({},t.value)),(()=>{e("update:data",t.value)})),{data:t,refShippingPhone:i,address:{valid:"valid",route:"shipping_address1",locality:"shipping_city",administrative_area_level_1:"shipping_state",formatted_address:"shipping_address_text",country:"shipping_country",postal_code:"shipping_zip"},validation:n,validate:()=>(n.value.$validate(),!n.value.$invalid)}}}),aa={class:"space-y-3"};var ea=O(Z,[["render",function(a,e,t,i,l,n){const s=c("Input"),o=c("InputPhone"),d=u("gmap");return m(),g("div",aa,[v("div",null,[_(s,{modelValue:a.data.customer_email,"onUpdate:modelValue":e[0]||(e[0]=e=>a.data.customer_email=e),type:"email",label:"Email",class:"w-full",view:a.validation.customer_email.$invalid?"danger":"default"},null,8,["modelValue","view"]),(m(!0),g(h,null,f(a.validation.customer_email.$errors,((a,e)=>(m(),g("small",{class:"text-red-base",key:e},b(a.$message)+". ",1)))),128))]),v("div",null,[_(s,{modelValue:a.data.shipping_firstname,"onUpdate:modelValue":e[1]||(e[1]=e=>a.data.shipping_firstname=e),type:"text",label:"First Name",class:"w-full",view:a.validation.shipping_firstname.$invalid?"danger":"default"},null,8,["modelValue","view"]),(m(!0),g(h,null,f(a.validation.shipping_firstname.$errors,((a,e)=>(m(),g("small",{class:"text-red-base",key:e},"First Name is required")))),128))]),v("div",null,[_(s,{modelValue:a.data.shipping_lastname,"onUpdate:modelValue":e[2]||(e[2]=e=>a.data.shipping_lastname=e),type:"text",label:"Last Name",class:"w-full",view:a.validation.shipping_lastname.$invalid?"danger":"default"},null,8,["modelValue","view"]),(m(!0),g(h,null,f(a.validation.shipping_lastname.$errors,((a,e)=>(m(),g("small",{class:"text-red-base",key:e},"Last Name is required")))),128))]),v("div",null,[y((m(),k(s,{modelValue:a.data.shipping_address_text,"onUpdate:modelValue":e[3]||(e[3]=e=>a.data.shipping_address_text=e),onFocusIn:e[4]||(e[4]=a=>a.target.setAttribute("autocomplete","no")),type:"text",label:"Street address, P.O box, company name, c/o.",class:"w-full",view:a.validation.valid.$invalid?"danger":"default",icon:"","icon-block":""},{icon:x((()=>e[8]||(e[8]=[v("i",{class:"material-icons"},"location_on",-1)]))),_:1},8,["modelValue","view"])),[[d,a.address]]),(m(!0),g(h,null,f(a.validation.valid.$errors,((a,e)=>(m(),g("small",{class:"text-red-base",key:e},b(a.$message)+". ",1)))),128))]),v("div",null,[_(s,{modelValue:a.data.shipping_suite,"onUpdate:modelValue":e[5]||(e[5]=e=>a.data.shipping_suite=e),type:"text",label:"Apartment, suite, unit, building, floor, etc.",class:"w-full"},null,8,["modelValue"])]),v("div",null,[_(o,{ref:"refShippingPhone",modelValue:a.data.shipping_phone,"onUpdate:modelValue":e[6]||(e[6]=e=>a.data.shipping_phone=e),label:"Phone Number",block:"","country-autofill-setting":""},null,8,["modelValue"]),(m(!0),g(h,null,f(a.validation.shipping_phone.$errors,((a,e)=>(m(),g("small",{class:"text-red-base",key:e},b(a.$message),1)))),128))]),v("div",null,[_(s,{modelValue:a.data.shipping_company_name,"onUpdate:modelValue":e[7]||(e[7]=e=>a.data.shipping_company_name=e),type:"text",label:"Company Name",class:"w-full"},null,8,["modelValue"]),e[9]||(e[9]=v("small",{class:"text-gray-base"},"*If the company name is filled it will appear on the invoice",-1))])])}]]);const ta=d({components:{Input:T,Button:N},props:{data:{type:Object,default:()=>({box_id:null,shipping_tracking:null})}},emits:["update"],setup(a,{emit:e}){const{loading:t,actionShippingTrackingUpdate:i,actionAll:l,actionShippingTrackingDelete:n}=S("invoice"),s=r(a.data),o=r(null==s.value.shipping_tracking?"canAdd":"canEdit"),d=r({shipping_tracking:null}),c=z({shipping_tracking:{required:J}},d,{$lazy:!0}),u=()=>(c.value.$validate(),!c.value.$invalid);return p((()=>a.data),(()=>{s.value=a.data})),{loading:t,data:s,add:()=>{o.value="canUpdate"},save:async a=>{if(!u())return;await i({box_id:a.box_id,data:{shipping_tracking:d.value.shipping_tracking}})&&(w({type:"success",message:"Tracking number changed."}),o.value="canEdit",a.shipping_tracking=d.value.shipping_tracking,await l("all"),e("update",!0))},cancel:()=>{d.value.shipping_tracking?o.value="canEdit":o.value="canAdd"},edit:a=>{o.value="canUpdate",d.value.shipping_tracking=a},newData:d,validation:c,validate:u,shippingTrackingForm:o,remove:async a=>{await n({box_id:a.box_id})&&(w({type:"success",message:"Tracking number removed."}),d.value.shipping_tracking=null,o.value="canAdd")}}}}),ia={key:0,class:"flex items-center"},la={key:1},na={class:"flex flex-wrap items-center my-2"},sa={class:"mr-4"},oa={key:2},da={class:"flex flex-wrap items-center my-2"},ra=["href"],pa={key:1,class:"mr-6"},ca={class:"w-full h-full flex justify-center items-center"},ua={key:0,class:"whitespace-pre-line"};const ma=d({components:{Badge:M,Button:N,Card:q,Modal:A,PaymentMethod:B,InvoiceDetail:Q,TextLimit:W,CustomerInvoiceForm:ea,ShippingTrackingDetail:O(ta,[["render",function(a,e,t,i,l,n){const s=c("Button"),o=c("Input"),d=c("Popover");return"canAdd"==a.shippingTrackingForm?(m(),g("div",ia,[e[7]||(e[7]=v("p",{class:"mr-4"},"No tracking number ",-1)),_(s,{color:"teal",class:"mr-2",onClick:e[0]||(e[0]=e=>a.add()),dense:""},{default:x((()=>e[6]||(e[6]=[v("span",{class:"material-icons text-xl"},"edit",-1)]))),_:1})])):"canUpdate"==a.shippingTrackingForm?(m(),g("div",la,[v("div",na,[v("div",sa,[_(o,{class:"w-full",modelValue:a.newData.shipping_tracking,"onUpdate:modelValue":e[1]||(e[1]=e=>a.newData.shipping_tracking=e),placeholder:"Tracking number"},null,8,["modelValue"]),(m(!0),g(h,null,f(a.validation.shipping_tracking.$errors,(a=>(m(),g("span",{class:"text-red-base block",key:a},b(a.$message)+". ",1)))),128))]),v("div",null,[_(s,{color:"teal",class:"mr-2",loading:a.loading.update_shipping_tracking,onClick:e[2]||(e[2]=e=>a.save(a.data)),dense:""},{default:x((()=>e[8]||(e[8]=[v("i",{class:"material-icons text-lg"},"check",-1)]))),_:1},8,["loading"]),_(s,{color:"red",loading:a.loading.update_shipping_tracking,onClick:e[3]||(e[3]=e=>a.cancel()),dense:""},{default:x((()=>e[9]||(e[9]=[v("i",{class:"material-icons text-lg"},"close",-1)]))),_:1},8,["loading"])])])])):(m(),g("div",oa,[v("div",da,[v("div",null,[a.data.shipping_tracking_link?(m(),g("a",{key:0,href:a.data.shipping_tracking_link,class:"float-left mr-6",color:"teal"},b(a.data.shipping_tracking),9,ra)):(m(),g("span",pa,b(a.data.shipping_tracking),1))]),v("div",null,[_(s,{color:"teal",class:"mr-2",loading:a.loading.delete_shipping_tracking,onClick:e[4]||(e[4]=e=>a.edit(a.data.shipping_tracking)),dense:""},{default:x((()=>e[10]||(e[10]=[v("i",{class:"material-icons text-lg"},"edit",-1)]))),_:1},8,["loading"]),_(d,{width:"400",trigger:"hover"},{reference:x((()=>[_(s,{color:"red",loading:a.loading.delete_shipping_tracking,onClick:e[5]||(e[5]=e=>a.remove(a.data)),dense:""},{default:x((()=>e[11]||(e[11]=[v("i",{class:"material-icons text-lg"},"delete",-1)]))),_:1},8,["loading"])])),default:x((()=>[v("div",ca,[(m(),g("span",ua,"Delete Tracking Number"))])])),_:1})])])]))}]])},async setup(){const{state:a,loading:i,modal:l,openModal:n,closeModal:s,action:d}=V("invoice"),{state:p,loading:c,actionAll:u,actionUpdate:m}=j("invoice"),{loading:g,actionUpdate:v,modal:_,openModal:h,actionUpdateV2:f}=U("invoice"),{loading:b,actionPaperCheck:y}=$(),k=r(null),x=r(null),w=D();await Promise.all([d(w.params.buybackId),u(w.params.buybackId)]);const I=r({box_id:a.value.box_id,shipping_tracking:a.value.shipping.shipping_tracking,shipping_tracking_link:a.value.shipping.shipping_tracking_link}),P=r(null);P.value=Object.assign({},a.value.billing);const S=C({invoice_date:X(a.value.invoice_date)._date,payment_term_id:a.value.payment_term_id,payment_term_list:a.value.payment_term_list,reference:a.value.reference,due_date:X(a.value.due_date)._date,payment_method:a.value.billing.payment_method}),M=()=>{var i,l;k.value=(i=o({},L(a.value.shipping)),l={shipping_suite:a.value.address.suite,shipping_company_name:a.value.shipping.shipping_company_name,customer_email:a.value.customer.email,box_id:a.value.box_id},e(i,t(l)))};M();const T=()=>{I.value={box_id:a.value.box_id,shipping_tracking:a.value.shipping.shipping_tracking,shipping_tracking_link:a.value.shipping.shipping_tracking_link}};return{data:P,stateShow:a,statePaymentMethod:p,loadingPaymentMethod:c,loadingPrint:b,customerPayload:k,customerInvoiceForm:x,loadingInvoiceDetail:g,actionUpdateV2:f,modal:l,modalInvoiceDetail:_,openModal:n,openInvoiceDetailModal:h,paperCheck:()=>y(w.params.buybackId),updatePaymentMethod:()=>m(w.params.buybackId,P.value,(async()=>{l.paymentMethod=!1,await d(w.params.buybackId)})),updateInvoiceDetail:async()=>{let a=o({},S);a.invoice_date=Y(a.invoice_date),a.due_date=Y(a.due_date),delete a.payment_term_list,await v(w.params.buybackId,a),await d(w.params.buybackId)},invoiceDetailData:S,setPayload:M,updateCustomer:async()=>{x.value.validate()&&await f(k.value).then((async()=>{s("customer"),await Promise.all([d(w.params.buybackId),u(w.params.buybackId)])}))},openCustomerModal:()=>{n("customer")},updateCustomerPayload:a=>{k.value=o({},a)},phoneNumber:F,shippingTrackingDetailData:I,handleShippingLabel:()=>{var e;window.open((null==(e=a.value)?void 0:e.shipping_label)||"#","_blank")},updateShippingTracking:async()=>{await d(w.params.buybackId),T()}}}}),ga={class:"flex space-x-2"},va={class:"my-auto"},_a={key:0,class:"my-4"},ha={class:"relative"},fa={class:"flex items-center justify-between"},ba={class:"flex-auto mr-6"},ya={class:"my-1"},ka={class:"mb-2 text-teal-04"},xa={class:"mb-2"},wa={class:"flex space-x-4"},Ia={class:"my-auto"},Da={class:"flex space-x-4"},Ca={class:"my-auto"},Pa={class:"flex space-x-4"},Sa={class:"my-auto"},Va={class:"flex justify-between items-center"},ja={class:"mb-2"},Ua={class:"mb-2"},$a={class:"flex space-x-4"},Ma={class:"my-auto"};var Ta=O(ma,[["render",function(a,e,t,i,l,n){const s=c("Badge"),o=c("ShippingTrackingDetail"),d=c("Button"),r=c("Card"),p=c("TextLimit"),u=c("router-link"),f=c("PaymentMethod"),y=c("Modal"),k=c("CustomerInvoiceForm"),w=c("InvoiceDetail");return m(),g(h,null,[_(r,{class:"mb-4"},{header:x((()=>[v("div",ha,[v("div",fa,[v("div",ba,[v("h6",ya,"Invoice ID #"+b(a.$route.params.buybackId),1),v("div",null,"Reference: "+b(a.invoiceDetailData.reference),1)]),v("div",null,[_(d,{class:"",color:"teal",onClick:e[0]||(e[0]=e=>a.openInvoiceDetailModal("update")),dense:""},{default:x((()=>e[8]||(e[8]=[v("div",{class:"flex items-center"},[v("i",{class:"material-icons text-base mr-1"},"edit"),P(" Update ")],-1)]))),_:1})])])])])),default:x((()=>[v("div",ga,[e[6]||(e[6]=v("span",{class:"material-icons text-base my-auto"},"date_range",-1)),v("span",va,b(a.stateShow.invoice_date),1)]),_(s,{color:"red"},{default:x((()=>[P(b(a.stateShow.due_date?a.stateShow.due_date:"NOT SET")+" - (Due Date)",1)])),_:1}),e[9]||(e[9]=v("p",{class:"font-bold mt-4"},"Tracking Number: ",-1)),_(o,{data:a.shippingTrackingDetailData,onUpdate:a.updateShippingTracking},null,8,["data","onUpdate"]),a.stateShow.shipping_label?(m(),g("div",_a,[_(d,{onClick:a.handleShippingLabel,dense:"",color:"teal"},{default:x((()=>e[7]||(e[7]=[v("i",{class:"material-icons"},"download",-1),P(" Shipping Label ")]))),_:1},8,["onClick"])])):I("",!0)])),_:1}),_(r,{class:"mb-4"},{header:x((()=>[v("div",Va,[e[15]||(e[15]=v("h6",null,"Customer",-1)),_(d,{color:"teal",onClick:a.openCustomerModal,dense:""},{default:x((()=>e[14]||(e[14]=[v("i",{class:"material-icons text-base"},"edit",-1),P(" Edit ")]))),_:1},8,["onClick"])])])),default:x((()=>{var t,i,l,n,s,o,d;return[_(u,{to:{name:"customerDetail",params:{customerId:null==(i=null==(t=a.stateShow)?void 0:t.customer)?void 0:i.id,category:"in-store"}}},{default:x((()=>{var e,t;return[_(p,{text:`${null==(e=a.stateShow.shipping)?void 0:e.shipping_firstname} ${null==(t=a.stateShow.shipping)?void 0:t.shipping_lastname}`},{default:x((a=>[v("h6",ka,b(a.text),1)])),_:1},8,["text"])]})),_:1},8,["to"]),v("div",xa,[e[13]||(e[13]=v("p",{class:"font-bold mb-2"},"Contact Information",-1)),v("div",wa,[e[10]||(e[10]=v("i",{class:"material-icons text-base my-auto"},"email",-1)),v("span",Ia,b(a.stateShow.customer.email),1)]),v("div",Da,[e[11]||(e[11]=v("i",{class:"material-icons text-base my-auto"},"location_on",-1)),v("span",Ca,b((null==(l=a.stateShow.shipping)?void 0:l.shipping_address_text)?(null==(n=a.stateShow.address)?void 0:n.suite)?`${null==(s=a.stateShow.address)?void 0:s.suite}, ${null==(o=a.stateShow.shipping)?void 0:o.shipping_address_text}`:null==(d=a.stateShow.shipping)?void 0:d.shipping_address_text:"-"),1)]),v("div",Pa,[e[12]||(e[12]=v("i",{class:"material-icons text-base my-auto"},"call",-1)),v("span",Sa,b(a.phoneNumber(a.stateShow.address.phone)),1)])])]})),_:1}),_(r,{class:"mb-4"},{header:x((()=>e[18]||(e[18]=[v("h6",null,"Sales Person",-1)]))),default:x((()=>[_(p,{text:`${a.stateShow.sales_person.first_name||""} ${a.stateShow.sales_person.last_name||""}`},{default:x((a=>[v("h6",ja,b(a.text),1)])),_:1},8,["text"]),v("div",Ua,[e[17]||(e[17]=v("p",{class:"font-bold mb-2"},"Contact Information",-1)),v("div",$a,[e[16]||(e[16]=v("i",{class:"material-icons text-base my-auto"},"email",-1)),v("span",Ma,b(a.stateShow.sales_person.email),1)])])])),_:1}),_(y,{modelValue:a.modal.paymentMethod,"onUpdate:modelValue":e[2]||(e[2]=e=>a.modal.paymentMethod=e),title:"Update Payout Method"},{footer:x((()=>[_(d,{color:"teal",loading:a.loadingPaymentMethod.update,onClick:a.updatePaymentMethod},{default:x((()=>e[19]||(e[19]=[P("Save Payment")]))),_:1},8,["loading","onClick"])])),default:x((()=>[_(f,{data:a.data,"onUpdate:data":e[1]||(e[1]=e=>a.data=e),items:a.statePaymentMethod},null,8,["data","items"])])),_:1},8,["modelValue"]),_(y,{modelValue:a.modal.customer,"onUpdate:modelValue":e[3]||(e[3]=e=>a.modal.customer=e),title:"Update Customer"},{footer:x((()=>[_(d,{color:"teal",loading:a.loadingInvoiceDetail.customer,onClick:a.updateCustomer},{default:x((()=>e[20]||(e[20]=[P("Save Customer")]))),_:1},8,["loading","onClick"])])),default:x((()=>[_(k,{ref:"customerInvoiceForm",data:a.customerPayload,"onUpdate:data":a.updateCustomerPayload},null,8,["data","onUpdate:data"])])),_:1},8,["modelValue"]),_(y,{modelValue:a.modalInvoiceDetail.update,"onUpdate:modelValue":e[5]||(e[5]=e=>a.modalInvoiceDetail.update=e),title:"Update Invoice Details"},{footer:x((()=>[_(d,{color:"teal",loading:a.loadingInvoiceDetail.update,onClick:a.updateInvoiceDetail},{default:x((()=>e[21]||(e[21]=[P("Update")]))),_:1},8,["loading","onClick"])])),default:x((()=>[_(w,{data:a.invoiceDetailData,"onUpdate:data":e[4]||(e[4]=e=>a.invoiceDetailData=e)},null,8,["data"])])),_:1},8,["modelValue"])],64)}]]);export{Ta as default};
