{"version":3,"file":"DeviceSearch.02c0c24e.js","sources":["../../src/components/Device/Form/DeviceSearch.vue"],"sourcesContent":["<template>\n  <div>\n    <BDropdown prevent-toggle block>\n      <template #default>\n        <Input\n          ref=\"elSearchInput\"\n          :modelValue=\"query\"\n          @update:modelValue=\"handleSearch\"\n          @focus-in=\"isCollapse = true\"\n          :view=\"error ? 'danger' : 'default'\"\n          :label=\"label\"\n          :placeholder=\"placeholder\"\n          block\n          icon\n        >\n          <template #icon>\n            <span class=\"material-icons\">search</span>\n          </template>\n        </Input>\n      </template>\n      <template #dropdown=\"{ collapse }\">\n        <div>\n          <template v-if=\"!isDisabledCustomProduct\">\n            <a\n              v-if=\"!showCategoryOnly && showAddCustomProduct\"\n              @click.prevent=\"\n                () => {\n                  handleCustomProduct(null)\n                  collapse()\n                }\n              \"\n              tabindex=\"1\"\n              class=\"auto-complete-product auto-complete-product__group-item\"\n            >\n              <span class=\"flex items-center flex-wrap\">\n                <i class=\"material-icons mr-2\">add</i>Add Custom Item\n              </span>\n            </a>\n          </template>\n          <div class=\"overflow-y-auto\" :style=\"{ maxHeight: '200px' }\">\n            <template v-if=\"products.length > 0 || categories.length > 0\">\n              <template\n                v-if=\"!activeProductUnprice && !isDisabledCustomProduct && categories.length > 0\"\n              >\n                <div\n                  v-if=\"categories.length > 0\"\n                  class=\"auto-complete-product auto-complete-product__group\"\n                >\n                  <span\n                    class=\"auto-complete-product auto-complete-product__group-label\"\n                    >Items</span\n                  >\n                  <a\n                    v-for=\"(item, n) in categories\"\n                    :key=\"`${item.category_id}_${n}`\"\n                    @click.prevent=\"\n                      () => {\n                        handleSelectItem(item)\n                        collapse()\n                      }\n                    \"\n                    tabindex=\"1\"\n                    class=\"auto-complete-product auto-complete-product__group-item\"\n                  >\n                    <div\n                      class=\"mr-4\"\n                      :style=\"{\n                        width: '30px',\n                        height: '30px',\n                        backgroundImage: `url(${item.image})`,\n                        backgroundSize: 'contain',\n                        backgroundPosition: 'center',\n                        backgroundRepeat: 'no-repeat'\n                      }\"\n                    ></div>\n                    {{ item.name }}\n                  </a>\n                </div>\n              </template>\n              <template v-if=\"!activeProductUnprice && products.length > 0 && !showCategoryOnly\">\n                <div\n                  v-for=\"(product, m) in products\"\n                  :key=\"`${product.category_name}_${m}`\"\n                  class=\"auto-complete-product auto-complete-product__group\"\n                >\n                  <span\n                    class=\"auto-complete-product auto-complete-product__group-label\"\n                    >{{ product.category_name }}</span\n                  >\n                  <a\n                    v-for=\"product in product.products\"\n                    :key=\"product.product_id\"\n                    @click.prevent=\"\n                      () => {\n                        handleSelectItem(product)\n                        collapse()\n                      }\n                    \"\n                    tabindex=\"1\"\n                    class=\"auto-complete-product auto-complete-product__group-item\"\n                  >\n                    <div\n                      class=\"mr-4\"\n                      :style=\"{\n                        width: '30px',\n                        height: '30px',\n                        backgroundImage: `url(${product.image})`,\n                        backgroundSize: 'contain',\n                        backgroundPosition: 'center',\n                        backgroundRepeat: 'no-repeat'\n                      }\"\n                    ></div>\n                    {{ product.product_name }}\n                  </a>\n                </div>\n              </template>\n              <template v-else>\n                <div class=\"flex items-center justify-center md:px-8 px-4 py-2 md:py-6 text-red-04\">\n                  Data not found due to missing prices in your catalog. Please check your\n                  <span>&nbsp;<router-link :to=\"{ name: 'settingBulkPriceEditor' }\" class=\"underline hover:no-underline\">pricing settings</router-link></span>.\n                </div>\n              </template>\n            </template>\n            <template\n              v-else-if=\"query && products.length < 1 && products.length < 1\"\n            >\n              <div class=\"my-8\">\n                <p v-if=\"loading\" class=\"text-center\">\n                  Please wait...\n                </p>\n                <p\n                  v-if=\"!loading && !activeProductUnprice\"\n                  class=\"text-center text-grey-04\">\n                  No data to show\n                </p>\n                <div\n                  v-if=\"!loading && activeProductUnprice\"\n                  class=\"flex items-center justify-center text-red-04\">\n                  Data not found due to missing prices in your catalog. Please check your\n                  <span>&nbsp;<router-link :to=\"{ name: 'settingBulkPriceEditor' }\" class=\"underline hover:no-underline\">pricing settings</router-link></span>.\n                </div>\n              </div>\n            </template>\n            <template\n              v-else-if=\"\n                isDisabledCustomProduct && (!query || products.length < 1)\n              \"\n            >\n              <div class=\"my-4\">\n                <p class=\"text-left ml-4 text-grey-03\">Search for item</p>\n              </div>\n            </template>\n          </div>\n        </div>\n      </template>\n    </BDropdown>\n  </div>\n</template>\n<script>\nimport { computed, defineComponent, onUnmounted, ref } from 'vue'\n\nimport Input from 'bbUi/components/input/input.vue'\nimport Select from 'components/Select.vue'\nimport BDropdown from 'components/BDropdown/BDropdown.vue'\n\nexport default defineComponent({\n  components: {\n    Input,\n    Select,\n    BDropdown\n  },\n  props: {\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    query: {\n      type: String\n    },\n    products: {\n      type: Array,\n      default: () => []\n    },\n    categories: {\n      type: Array,\n      default: () => []\n    },\n    showCategoryOnly: {\n      type: Boolean,\n      default: false\n    },\n    error: {\n      type: Boolean,\n      default: false\n    },\n    isDisabledCustomProduct: {\n      type: Boolean,\n      default: false\n    },\n    label: {\n      type: String,\n      default: 'Item Name'\n    },\n    placeholder: {\n      type: String,\n      default: 'Search Item'\n    },\n    showAddCustomProduct: {\n      type: Boolean,\n      default: true\n    },\n    activeProductUnprice: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['update:query', 'search', 'select', 'customProduct'],\n  setup(props, { emit }) {\n    const elContainer = ref(null)\n    const elSearchInput = ref(null)\n    const elDeviceSearchSheet = ref(null)\n    const isCollapse = ref(false)\n    const dropdownWidth = computed(() =>\n      elContainer.value ? `${elContainer.value.offsetWidth}px` : `0px`\n    )\n    const closeDropdown = () => {\n      isCollapse.value = false\n      elSearchInput.value?.blur()\n    }\n    const handleOutside = () => closeDropdown()\n    const handleSelectItem = (item) => {\n      emit('select', item)\n      closeDropdown()\n    }\n    const handleCustomProduct = (item = null) => {\n      emit('customProduct', item)\n      closeDropdown()\n    }\n    const handleSearch = (query) => {\n      emit('update:query', query)\n      emit('search')\n    }\n    const handleScroll = (ev) => {\n      const elSheet = elDeviceSearchSheet?.value\n      if (!elSheet) return\n      const isScrollOutsideSheetElement = elSheet.contains(ev.target)\n      if (isScrollOutsideSheetElement) return\n      closeDropdown()\n    }\n    window.addEventListener('scroll', handleScroll, true)\n    onUnmounted(() => {\n      window.removeEventListener('scroll', handleScroll)\n    })\n\n    return {\n      elContainer,\n      elSearchInput,\n      elDeviceSearchSheet,\n      isCollapse,\n      handleSearch,\n      dropdownWidth,\n      handleOutside,\n      handleSelectItem,\n      handleCustomProduct\n    }\n  }\n})\n</script>\n<style lang=\"scss\">\n.auto-complete-product {\n  &__sheet {\n    @apply fixed bg-white border border-grey-01 rounded-lg my-2 overflow-y-auto;\n  }\n\n  &__group-label {\n    @apply font-semibold block text-sm px-4 py-2;\n  }\n\n  &__group-item {\n    @apply flex items-center flex-wrap p-4 w-full block text-black;\n    &:hover {\n      @apply text-black bg-grey-lighten;\n    }\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","components","Input","Select","BDropdown","props","loading","type","Boolean","default","query","String","products","Array","categories","showCategoryOnly","error","isDisabledCustomProduct","label","placeholder","showAddCustomProduct","activeProductUnprice","emits","[object Object]","emit","elContainer","ref","elSearchInput","elDeviceSearchSheet","isCollapse","dropdownWidth","computed","value","offsetWidth","closeDropdown","_a","blur","handleScroll","ev","elSheet","contains","target","window","addEventListener","onUnmounted","removeEventListener","handleSearch","handleOutside","handleSelectItem","item","handleCustomProduct","_hoisted_2","class","key","_hoisted_4","_openBlock","_createElementBlock","_createVNode","_component_BDropdown","prevent-toggle","_withCtx","_component_Input","modelValue","_ctx","onUpdate:modelValue","onFocusIn","_cache","$event","view","block","icon","collapse","_createCommentVNode","_Fragment","tabindex","_createElementVNode","length","_hoisted_3","_renderList","n","category_id","height","product","m","category_name","_hoisted_5","_toDisplayString","product2","product_id","_createTextVNode","_component_router_link","to","_hoisted_8","_hoisted_12"],"mappings":"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"}