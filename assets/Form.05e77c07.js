var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,t=(a,l,s)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s,i=(e,i)=>{for(var d in i||(i={}))l.call(i,d)&&t(e,d,i[d]);if(a)for(var d of a(i))s.call(i,d)&&t(e,d,i[d]);return e};import{f as d,_ as n}from"./index.67cab78b.js";import{I as o}from"./InputPhone.bc7f0d85.js";import{c as r}from"./countries.62f07ce8.js";import{k as u,r as c,f as m,g as p,y as v,m as b,$ as g,o as y,t as f,B as h,A as _,n as x,w as V,U as w,a1 as k,a2 as $,K as I,D as A,F as P,W as M,I as B,q as j}from"./vendor.9695fe57.js";import{r as q,e as L}from"./index.54844a74.js";import{u as O}from"./index.f40e4a9e.js";import{c as R}from"./index.6b6f6369.js";const S=u({name:"Address",components:{Input:d},props:{address:{type:Object,default:void 0},validationResult:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},restricted:{type:Boolean,default:!0}},emits:["update:address"],setup(e,{emit:a}){const l=c({components:{address:null,address_text:null,suite:null,street:null,city:null,state:null,zip_code:null,country:null,lat:null,lon:null,valid:!1}}),s=m(!1),t=p({get:()=>e.address&&e.address||l.components,set:e=>{t.address_components=e,a("update:address",e)}}),i=p((()=>s.value&&t.value.address_text&&""!==t.value.address_text.trim()&&!t.value.lat));v((()=>t.value.address_text),(e=>{e&&""!==e.trim()||(s.value=!1)}));const d={valid:"valid",route:"street",locality:"city",administrative_area_level_1:"state",postal_code:"zip_code",country:"country",formatted_address:"address_text",subpremise:"suite",geo:{lat:"lat",lng:"lon"},noComponentRestriction:!e.restricted,bypassValidation:!0};return{data:t,gmapAddressSettings:d,countriesWithoutState:r,showAddressError:i,handleAddressBlur:()=>{t.value.address_text&&""!==t.value.address_text.trim()&&(s.value=!0)},handleAddressInput:()=>{t.value.lat=null,t.value.address_text&&""!==t.value.address_text.trim()||(s.value=!1)}}}}),z={class:"grid grid-cols-2 gap-4"},U={class:"col-span-2"},W={key:0,class:"text-red-base block mt-2"},C={class:"xl:col-span-2 lg:col-span-2 md:col-span-2 col-span-2"},E={class:"col-span-2"},N={key:0},F={class:"font-semibold"};const G=u({components:{Input:d,InputPhone:o,Address:n(S,[["render",function(e,a,l,s,t,i){var d,n,o,r,u,c,m,p,v,M,B,j,q,L,O,R,S;const G=b("Input"),D=g("gmap");return y(),f("div",z,[h("div",U,[_((y(),x(G,{modelValue:e.data.address_text,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.address_text=a),type:"text",class:"w-full",placeholder:"Search for your business address",disabled:e.disabled,icon:"","icon-block":"",view:(null==(d=e.validationResult)?void 0:d.address_text.$invalid)||e.showAddressError?"danger":"",onBlur:e.handleAddressBlur,onFocusOut:e.handleAddressBlur,onInput:e.handleAddressInput},{icon:V((()=>a[5]||(a[5]=[h("span",{class:"material-icons"},"location_on",-1)]))),label:V((()=>a[6]||(a[6]=[h("span",{class:"font-semibold"},"Physical Business Street Address",-1)]))),_:1},8,["modelValue","disabled","view","onBlur","onFocusOut","onInput"])),[[D,e.gmapAddressSettings]]),e.showAddressError?(y(),f("small",W," Invalid address selection. Please select an address from the dropdown suggestions. ")):w("",!0),(y(!0),f(k,null,$(null==(o=null==(n=e.validationResult)?void 0:n.address_text)?void 0:o.$errors,((e,a)=>(y(),f("span",{class:"text-red-base my-2 block",key:a},I(e.$message)+". ",1)))),128)),(y(!0),f(k,null,$(null==(u=null==(r=e.validationResult)?void 0:r.valid)?void 0:u.$errors,((e,a)=>(y(),f("span",{class:"text-red-base my-2 block",key:a},I(e.$message)+". ",1)))),128))]),h("div",C,[A(G,{modelValue:e.data.suite,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.suite=a),type:"text",class:"w-full",disabled:e.disabled},{label:V((()=>a[7]||(a[7]=[h("span",{class:"font-semibold"},"Apartment, suite, unit, building, floor. (optional)",-1)]))),_:1},8,["modelValue","disabled"])]),h("div",E,[h("div",{class:P(["grid gap-4","gap-4 grid-cols-1",e.countriesWithoutState.includes(e.data.country)?"md:grid-cols-2":"md:grid-cols-3"])},[h("div",null,[A(G,{modelValue:e.data.city,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.city=a),placeholder:"City",block:"",view:(null==(m=null==(c=e.validationResult)?void 0:c.city)?void 0:m.$invalid)?"danger":"default"},{label:V((()=>a[8]||(a[8]=[h("span",{class:"font-semibold"},"City",-1)]))),_:1},8,["modelValue","view"]),(y(!0),f(k,null,$(null==(v=null==(p=e.validationResult)?void 0:p.city)?void 0:v.$errors,((e,a)=>(y(),f("span",{class:"text-red-base my-2 block",key:a},I(e.$message)+". ",1)))),128))]),e.countriesWithoutState.includes(e.data.country)?w("",!0):(y(),f("div",N,[A(G,{modelValue:e.data.state,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.state=a),placeholder:"State",block:"",view:(null==(B=null==(M=e.validationResult)?void 0:M.state)?void 0:B.$invalid)?"danger":"default"},{label:V((()=>a[9]||(a[9]=[h("span",{class:"font-semibold"},"State",-1)]))),_:1},8,["modelValue","view"]),(y(!0),f(k,null,$(null==(q=null==(j=e.validationResult)?void 0:j.state)?void 0:q.$errors,((e,a)=>(y(),f("span",{class:"text-red-base my-2 block",key:a},I(e.$message)+". ",1)))),128))])),h("div",null,[A(G,{modelValue:e.data.zip_code,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.zip_code=a),placeholder:"GB"===e.data.country?"Postcode":"Postal Code",block:"",view:(null==(O=null==(L=e.validationResult)?void 0:L.zip_code)?void 0:O.$invalid)?"danger":"default"},{label:V((()=>[h("span",F,I("GB"===e.data.country?"Postcode":"Postal Code"),1)])),_:1},8,["modelValue","placeholder","view"]),(y(!0),f(k,null,$(null==(S=null==(R=e.validationResult)?void 0:R.zip_code)?void 0:S.$errors,((a,l)=>(y(),f("span",{class:"text-red-base my-2 block",key:l},I("GB"===e.data.country?"Postcode":"Postal Code")+" "+I(a.$message)+". ",1)))),128))])],2)])])}]])},props:{data:{type:Object,default:()=>({address:null,address_text:null,name:null,email:null,suite:"",street:null,phone:null,city:null,state:null,zip_code:null,country:null,lon:0,lat:0,is_on:1,is_mailin:1,valid:!1})},disabled:{type:Boolean,default:!1},edit:{type:Boolean,default:!1},disableForm:{type:Object,default:()=>({name:!1})},isMailinAvailable:{type:Boolean,default:!1}},setup(e){const a=c(e.data);a.valid=""!==a.address_text&&null!==a.address_text;const l=m(null),s=m(""),t=e=>{if(!e)return{isValid:!0,message:""};const a=e.toLowerCase(),l=["call us","contact us","email us","text us"];for(const t of l)if(a.includes(t))return{isValid:!1,message:`Location name cannot contain the phrase "${t}"`};if(e.includes("@"))return{isValid:!1,message:'Location name cannot contain the "@" character'};if(/[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}/.test(e))return{isValid:!1,message:"Location name cannot contain email addresses"};if(/\.(com|net|org|edu|gov|io|co|us|uk|ca|biz|info|me|tv|app)\b/i.test(e))return{isValid:!1,message:"Location name cannot contain domain names"};const s=e.replace(/\D/g,"");if(/\d{5,}/.test(s))return{isValid:!1,message:"Location name cannot contain phone numbers (maximum 4 consecutive digits allowed)"};if(s.length>6){if(!/^.*?(store|location|branch|outlet|shop|#|no\.?)\s*\d{1,4}$/i.test(e))return{isValid:!1,message:"Location name has too many numbers (might look like a phone number)"}}return{isValid:!0,message:""}},d=()=>{if(!a.name)return void(s.value="");const e=t(a.name);s.value=e.isValid?"":e.message},n=R.withMessage((e=>t(e.$model).message||"Invalid location name"),(e=>!e||t(e).isValid)),o=c({valid:"valid",route:"street",locality:"city",administrative_area_level_1:"state",postal_code:"zip_code",country:"country",formatted_address:"address_text",subpremise:"suite",geo:{lat:"lat",lng:"lon"},bypassValidation:!0}),u=p((()=>!!e.isMailinAvailable&&!e.edit)),b=p((()=>[{label:"Mail-In",value:"1",disabled:e.edit?!a.is_mailin:u.value},{label:"In-Store",value:"0",disabled:!!e.edit&&!!a.is_mailin}])),g=p((()=>{const e=[a.address_text,a.city,a.zip_code,a.name,a.email,a.phone,a.lon,a.lat];return r.includes(a.country)||e.push(a.state),e.filter((e=>!e)).length>0})),y=p((()=>({address_text:{required:R.withMessage("Street address is required",q)},city:{required:R.withMessage("City is required",q)},state:i({},!r.includes(a.country)&&{required:R.withMessage("State is required",q)}),zip_code:{required:R.withMessage("is required",q)},name:{required:R.withMessage("Location name is required",q),noEmailOrPhone:n},email:{required:q,email:L},phone:{required:q,invalidNumber:R.withMessage("Phone number is invalid",(()=>{var e;return!a.phone||(null==(e=l.value)?void 0:e.isValid)}))}}))),f=O(y,a,{$lazy:!0});return M((()=>{e.edit&&(f.value.$validate(),d())})),v(u,(()=>{u.value&&(a.is_mailin=0)}),{immediate:!0}),{data:a,refPhone:l,validation:f,address:o,purchasingMethods:b,hasActiveMailinLocation:u,hasEmptyRequiredField:g,validate:()=>(f.value.$validate(),!f.value.$invalid),validateLocationNameInput:d,locationNameWarning:s,countriesWithoutState:r}}}),D={class:"grid grid-cols-2 gap-4"},Y={key:0,class:"col-span-2 bg-orange-lighten text-orange-04 py-3 px-5 rounded-lg flex items-center gap-2"},K={class:"xl:col-span-2 lg:col-span-2 md:col-span-2 col-span-2 space-y-2"},Z={class:"space-y-1"},H={key:0,class:"bg-blue-lighten text-blue-04 py-3 px-5 rounded-lg flex gap-x-4"},J={class:"xl:col-span-2 lg:col-span-2 md:col-span-2 col-span-2"},Q={key:0,class:"text-red-base mt-2 block"},T={class:"xl:col-span-2 lg:col-span-2 md:col-span-2 col-span-2"},X={class:"col-span-2"},ee={class:"col-span-2"};var ae=n(G,[["render",function(e,a,l,s,t,i){var d;const n=b("RadioButton"),o=b("RadioGroup"),r=b("Input"),u=b("Address"),c=b("InputPhone");return y(),f("div",D,[e.hasActiveMailinLocation?(y(),f("div",Y,a[5]||(a[5]=[h("i",{class:"material-icons"},"info",-1),h("p",null,"Only one mail-in location is allowed",-1)]))):w("",!0),h("div",K,[h("div",Z,[a[6]||(a[6]=h("label",{class:"block"},"Purchasing Method",-1)),A(o,{modelValue:e.data.is_mailin,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.is_mailin=a),modelModifiers:{number:!0}},{default:V((()=>[(y(!0),f(k,null,$(e.purchasingMethods,(e=>(y(),x(n,{key:e.value,label:e.value,disabled:e.disabled},{default:V((()=>[B(I(e.label),1)])),_:2},1032,["label","disabled"])))),128))])),_:1},8,["modelValue"])]),e.data.is_mailin?(y(),f("div",H,a[7]||(a[7]=[h("i",{class:"material-icons"},"info",-1),h("p",null,[h("b",null,"You must set up shipping integration"),B(" before generating shipping labels. You can find instructions on how to set it up "),h("a",{href:"https://help.reusely.com/en/articles/9682274-shipping-integration-for-mail-in-offers",target:"_blank",class:"font-semibold text-blue-04 underline hover:text-blue-03"},"here"),B(". ")],-1)]))):w("",!0)]),h("div",J,[A(r,{modelValue:e.data.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.name=a),type:"text",label:"Location Name",class:"w-full",placeholder:"Location name",view:e.locationNameWarning||e.validation.name.$invalid?"danger":"default",disabled:e.disabled||(null==(d=e.disableForm)?void 0:d.name),onInput:e.validateLocationNameInput},null,8,["modelValue","view","disabled","onInput"]),(y(!0),f(k,null,$(e.validation.name.$errors,((e,a)=>(y(),f("span",{class:"text-red-base mt-2 block",key:a},I(e.$message)+". ",1)))),128)),e.locationNameWarning&&!e.validation.name.$invalid?(y(),f("span",Q,I(e.locationNameWarning),1)):w("",!0)]),h("div",T,[A(r,{modelValue:e.data.email,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.email=a),type:"email",label:"Email",class:"w-full",placeholder:"Email",view:e.validation.email.$invalid?"danger":"default",disabled:e.disabled},null,8,["modelValue","view","disabled"]),(y(!0),f(k,null,$(e.validation.email.$errors,((e,a)=>(y(),f("span",{class:"text-red-base mt-2 block",key:a},I(e.$message)+". ",1)))),128))]),h("div",X,[A(u,{address:e.data,"onUpdate:address":a[3]||(a[3]=a=>e.data=a),"validation-result":e.validation,disabled:e.disabled},null,8,["address","validation-result","disabled"])]),h("div",ee,[A(c,{ref:"refPhone",modelValue:e.data.phone,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.phone=a),label:"Phone",block:"","country-autofill-setting":"",autocomplete:"",disabled:e.disabled},null,8,["modelValue","disabled"]),(y(!0),f(k,null,$(e.validation.phone.$errors,((e,a)=>(y(),f("span",{class:"text-red-base mt-2 block",key:a},I(e.$message)+". ",1)))),128))]),j(e.$slots,"onboarding",{},void 0,!0)])}],["__scopeId","data-v-5a7c64e6"]]);export{ae as M};
