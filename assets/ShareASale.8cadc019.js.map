{"version":3,"file":"ShareASale.8cadc019.js","sources":["../../src/views/integration/share-a-sale/form.vue","../../src/composable/integration/shareASale.js","../../src/views/integration/ShareASale.vue"],"sourcesContent":["<template>\n  <div v-loading=\"loadingIntegration.fetch\">\n    <div\n      v-if=\"credentials.is_connected === 1\"\n      :class=\"['label', 'label--verified']\"\n    >\n      <i class=\"material-icons mr-3\">check_circle</i>\n      <span>Verified</span>\n    </div>\n    <div\n      v-else\n      class=\"flex items-center text-blue-04 px-3 py-2 rounded-lg bg-blue-lighten w-max\"\n    >\n      <i class=\"material-icons mr-4\">info</i>\n      <p>\n        Make sure to complete your ShareASale onboarding process to unlock more\n        features from this integration.\n      </p>\n    </div>\n    <Input\n      v-model=\"data.shareasale_merchant_account_id\"\n      :view=\"\n        validation.shareasale_merchant_account_id.$invalid\n          ? 'danger'\n          : 'default'\n      \"\n      class=\"my-4\"\n      label=\"Merchant ID\"\n      placeholder=\"\"\n      block\n    />\n    <small\n      class=\"text-red-base block mb-4\"\n      v-for=\"(error, errorIndex) of validation.shareasale_merchant_account_id\n        .$errors\"\n      :key=\"errorIndex\"\n      >{{ error.$message }}.\n    </small>\n    <Input\n      v-model=\"data.shareasale_token\"\n      :view=\"validation.shareasale_token.$invalid ? 'danger' : 'default'\"\n      class=\"my-4\"\n      label=\"Token\"\n      placeholder=\"\"\n      block\n    />\n    <small\n      class=\"text-red-base block mb-4\"\n      v-for=\"(error, errorIndex) of validation.shareasale_token.$errors\"\n      :key=\"errorIndex\"\n      >{{ error.$message }}.\n    </small>\n    <Input\n      v-model=\"data.shareasale_api_secret\"\n      :view=\"validation.shareasale_api_secret.$invalid ? 'danger' : 'default'\"\n      class=\"my-4\"\n      label=\"API Key\"\n      placeholder=\"\"\n      block\n    />\n    <small\n      class=\"text-red-base block mb-4\"\n      v-for=\"(error, errorIndex) of validation.shareasale_api_secret.$errors\"\n      :key=\"errorIndex\"\n      >{{ error.$message }}.\n    </small>\n  </div>\n</template>\n\n<script>\n// import { defineComponent, computed, watch } from 'vue'\nimport { defineComponent } from 'vue'\nimport { useShowAll } from 'composable/integration'\nimport { useAll } from 'composable/integration/shareASale'\nimport { useVuelidate } from '@vuelidate/core'\n// import { required } from '@/validations/index'\nimport Button from 'bbUi/components/button/button.vue'\nimport Alert from 'bbUi/components/alert/alert.vue'\nimport Input from 'bbUi/components/input/input.vue'\nimport { ElMessage } from 'element-plus'\nimport { isFunction } from '@/utils/is'\n\nexport default defineComponent({\n  components: {\n    Button,\n    Alert,\n    Input\n  },\n  emits: ['ready'],\n  async setup(props, { emit }) {\n    // const { state, data, actionAll, actionUpdate, loading } = useShowAll()\n    const { data } = useShowAll()\n    const {\n      credentials,\n      loading: loadingIntegration,\n      fetchCredentials,\n      updateCredentials\n    } = useAll()\n\n    const rules = {\n      shareasale_merchant_account_id: {\n        // required\n      },\n      shareasale_token: {\n        // required\n      },\n      shareasale_api_secret: {\n        // required\n      }\n    }\n    const validation = useVuelidate(rules, data, {\n      $lazy: true\n    })\n    const validate = () => {\n      validation.value.$validate()\n      return !validation.value.$invalid\n    }\n    const fetchCredential = async () =>\n      await fetchCredentials((err) => {\n        if (err) return\n        Object.assign(data, {\n          shareasale_merchant_account_id:\n            credentials.value.shareasale_merchant_account_id,\n          shareasale_token: credentials.value.shareasale_token,\n          shareasale_api_secret: credentials.value.shareasale_api_secret\n        })\n      })\n    const update = async (callback = () => {}) => {\n      const isValid = validate()\n      if (!isValid) return\n      const payload = Object.assign(\n        {},\n        {\n          shareasale_merchant_account_id: data.shareasale_merchant_account_id,\n          shareasale_token: data.shareasale_token,\n          shareasale_api_secret: data.shareasale_api_secret\n        }\n      )\n      await updateCredentials(payload, async (err) => {\n        if (err) return\n        ElMessage({\n          type: 'success',\n          message: 'Settings has been saved'\n        })\n        await fetchCredential()\n        isFunction(callback) && callback()\n      })\n    }\n\n    // watch(\n    //   () => ({ ...data }),\n    //   () => {\n    //     const isReady =\n    //       !!data.shareasale_merchant_account_id &&\n    //       !!data.shareasale_token &&\n    //       !!data.shareasale_api_secret\n    //     emit('ready', isReady)\n    //   }\n    // )\n\n    await fetchCredential()\n\n    return {\n      // state,\n      data,\n      loadingIntegration,\n      credentials,\n      validation,\n      update\n    }\n  }\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.label {\n  @apply flex items-center bg-orange-lighten text-orange-04 py-2 px-4 w-max rounded-full my-3;\n  &--verified {\n    @apply bg-green-lighten text-green-04;\n  }\n}\n</style>\n","import { computed } from 'vue'\nimport store from 'store'\nimport { isFunction } from 'utils/is'\n\nconst useAll = () => {\n  const credentials = computed(\n    () => store.state.integration.shareASale.credentials\n  )\n  const loading = computed(() => store.state.integration.shareASale.loading)\n  const fetchCredentials = async (callback) => {\n    try {\n      store.commit('integration/shareASale/SET_LOADING_FETCH', true)\n      await store.dispatch('integration/shareASale/fetchCredential')\n      isFunction(callback) && callback(null)\n    } catch (err) {\n      isFunction(callback) && callback(err)\n    } finally {\n      store.commit('integration/shareASale/SET_LOADING_FETCH', false)\n    }\n  }\n\tconst updateCredentials = async(payload={}, callback) => {\n\t\ttry{\n\t\t\tstore.commit('integration/shareASale/SET_LOADING_UPDATE_CREDENTIAL', true)\n\t\t\tawait store.dispatch('integration/shareASale/updateCredential', payload)\n\t\t\tisFunction(callback) && callback(null)\n\t\t}catch(err){\n\t\t\tisFunction(callback) && callback(err)\n\t\t}finally{\n\t\t\tstore.commit('integration/shareASale/SET_LOADING_UPDATE_CREDENTIAL', false)\n\t\t}\n\t}\n  return {\n    credentials,\n    loading,\n    fetchCredentials,\n\t\tupdateCredentials\n  }\n}\n\nexport { useAll }\n","<template>\n  <div>\n    <Breadcrumb\n      class=\"mb-8 mt-4\"\n      pageTitle=\"ShareASale Settings\"\n      :backTo=\"{ name: 'integration' }\"\n      :items=\"[\n        {\n          text: 'Add-ons',\n          to: {\n            name: 'integration'\n          }\n        },\n        {\n          text: 'ShareASale Settings'\n        }\n      ]\"\n    />\n    <Card hide-footer>\n      <Transition name=\"slide-fade\">\n        <Suspense>\n          <template #default>\n            <form @submit.prevent=\"handleSave\">\n              <!-- <ShareASaleForm\n                ref=\"refForm\"\n                @ready=\"handleFormReadyStatusChange\"\n              />\n              <Button\n                color=\"teal\"\n                view=\"smooth\"\n                :loading=\"refForm?.loading?.update\"\n                :disabled=\"!isFormReady\"\n                >Save</Button\n              > -->\n              <ShareASaleForm ref=\"refForm\" />\n              <Button\n                color=\"teal\"\n                :loading=\"refForm?.loadingIntegration?.credential?.update\"\n                >Save</Button\n              >\n            </form>\n          </template>\n          <template #fallback>\n            <div class=\"w-full flex items-center justify-center\">\n              <BaseLoading />\n            </div>\n          </template>\n        </Suspense>\n      </Transition>\n    </Card>\n  </div>\n</template>\n<script>\nimport { defineComponent, ref } from 'vue'\nimport BaseLoading from 'components/BaseLoading.vue'\nimport ShareASaleForm from 'views/integration/share-a-sale/form.vue'\nimport Button from 'bbUi/components/button/button.vue'\nimport Card from 'bbUi/components/card/card.vue'\nimport Breadcrumb from 'components/Breadcrumb.vue'\n\nexport default defineComponent({\n  name: 'IntegrationShareASale',\n  components: {\n    BaseLoading,\n    ShareASaleForm,\n    Button,\n    Card,\n    Breadcrumb\n  },\n  setup() {\n    const refForm = ref(null)\n    // const isFormReady = ref(false)\n    const handleSave = () => {\n      if (!refForm.value) return\n      refForm.value.update()\n    }\n    // const handleFormReadyStatusChange = (status) => (isFormReady.value = status)\n\n    return {\n      refForm,\n      // isFormReady,\n      handleSave\n      // handleFormReadyStatusChange\n    }\n  }\n})\n</script>\n"],"names":["_sfc_main","defineComponent","components","Button","Alert","Input","emits","[object Object]","props","emit","data","useShowAll","credentials","loading","loadingIntegration","fetchCredentials","updateCredentials","computed","store","state","integration","shareASale","async","callback","commit","dispatch","isFunction","err","payload","validation","useVuelidate","shareasale_merchant_account_id","shareasale_token","shareasale_api_secret","$lazy","fetchCredential","Object","assign","value","update","$validate","$invalid","_u","type","message","key","name","BaseLoading","ShareASaleForm","_withDirectives","_openBlock","_createElementBlock","_ctx","is_connected","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_createVNode","_component_Input","modelValue","onUpdate:modelValue","$event","class","label","placeholder","openBlock","_Fragment","_renderList","view","$errors","error","errorIndex","Card","Breadcrumb","refForm","ref","handleSave","_component_Breadcrumb","pageTitle","backTo","hide-footer","_withCtx","_Suspense","_component_ShareASaleForm","_component_Button","color","fallback"],"mappings":"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"}