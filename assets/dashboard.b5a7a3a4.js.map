{"version":3,"file":"dashboard.b5a7a3a4.js","sources":["../../src/composable/dashboard.js"],"sourcesContent":["import { reactive, computed, ref } from 'vue'\nimport { default as axios } from 'axios'\nimport store from 'store'\nimport { isFunction } from 'utils/is'\nimport date from 'utils/date'\nimport { deepClone } from 'utils/deep-clone'\nimport { useConditionAll } from './setting'\nimport { ElMessage } from 'element-plus'\n\nconst useOrders = () => {\n\tconst tempDate = date()\n\tconst data = reactive({\n\t\tmonth: 'all',\n\t\t// month: tempDate.month,\n\t\tyear: 'all',\n\t\t// year: tempDate.year,\n\t\tsource: null\n\t})\n\n\tconst state = ref([])\n\tconst orders = async (statusId, callback = () => {}) => {\n\t\tconst payload = { ...data }\n\t\tstate.value = await store.dispatch('dashboard/orders', {\n\t\t\tid: statusId,\n\t\t\tdata: payload\n\t\t})\n\t\tisFunction(callback) && callback()\n\t}\n\tconst arrivingToday = async (_, callback = () => {}) => {\n\t\tstate.value = await store.dispatch('dashboard/arrivingToday')\n\t\tisFunction(callback) && callback()\n\t}\n\tconst inTransit = async (_, callback = () => {}) => {\n\t\tstate.value = await store.dispatch('dashboard/inTransit')\n\t\tisFunction(callback) && callback()\n\t}\n\tconst getFormatted = computed(() => {\n\t\treturn store.getters['dashboard/GET_ORDERS_FORMATTED']\n\t})\n\n\treturn {\n\t\tdata,\n\t\tstate,\n\t\tgetFormatted,\n\t\torders,\n\t\tarrivingToday,\n\t\tinTransit\n\t}\n}\n\nconst useCustomers = () => {\n\tconst tempDate = date()\n\tconst data = reactive({\n\t\tmonth: tempDate.month,\n\t\tyear: tempDate.year\n\t})\n\tconst state = ref([])\n\tconst customers = async (callback = () => {}) => {\n\t\tstate.value = await store.dispatch('dashboard/customers', data)\n\t\tisFunction(callback) && callback()\n\t}\n\tconst getFormatted = computed(() => {\n\t\treturn store.getters['dashboard/GET_FORMATTED']('customers')\n\t})\n\n\treturn {\n\t\tdata,\n\t\tstate,\n\t\tgetFormatted,\n\t\tcustomers\n\t}\n}\n\nconst useAffiliates = () => {\n\tconst tempDate = date()\n\tconst data = reactive({\n\t\tmonth: tempDate.month,\n\t\tyear: tempDate.year\n\t})\n\tconst state = ref([])\n\tconst affiliates = async (callback = () => {}) => {\n\t\tstate.value = await store.dispatch('dashboard/affiliates', data)\n\t\tisFunction(callback) && callback()\n\t}\n\tconst getFormatted = computed(() => {\n\t\treturn store.getters['dashboard/GET_FORMATTED']('affiliates')\n\t})\n\n\treturn {\n\t\tdata,\n\t\tstate,\n\t\tgetFormatted,\n\t\taffiliates\n\t}\n}\n\nconst useChart = () => {\n\tconst tempDate = date()\n\tconst data = reactive({\n\t\tlocal: '',\n\t\tmonth: '',\n\t\tyear: tempDate.year,\n\t\tbuyback_type: store.state.user && store.state.user.me && store.state.user.me.is_location_mail_in ? 1 : 2\n\t})\n\n\tconst state = ref([])\n\tconst chart = async (callback = () => {}) => {\n\t\tstate.value = await store.dispatch('dashboard/chart', {\n\t\t\t...data,\n\t\t\tleads: data.local === 'leads' || data.local === '' ? true : false,\n\t\t\tpaid: data.local === 'paid' || data.local === '' ? true : false,\n\t\t\tmonth: !data.month ? 'all' : data.month\n\t\t})\n\t\tisFunction(callback) && callback()\n\t}\n\n\treturn {\n\t\tdata,\n\t\tstate,\n\t\tchart\n\t}\n}\n\nconst useScanIn = () => {\n\tconst scanInData = reactive({\n\t\tsearch: '',\n\t\tdata: []\n\t})\n\tconst scanIn = async (callback = () => {}) => {\n\t\tconst result = await store.dispatch('dashboard/scanIn', {\n\t\t\tq: scanInData.search\n\t\t})\n\t\tisFunction(callback) && callback(result)\n\t}\n\n\treturn {\n\t\tscanInData,\n\t\tscanIn\n\t}\n}\n\nconst useSearch = () => {\n\tconst cancelToken = ref(null)\n\tconst data = reactive({\n\t\tsearch: '',\n\t\tdata: []\n\t})\n\tconst actionSearch = async (callback = () => {}) => {\n\t\tif (cancelToken.value) cancelToken.value.cancel()\n\t\tcancelToken.value = axios.CancelToken.source()\n\n\t\tconst response = await store.dispatch('dashboard/search', {\n\t\t\tq: data.search,\n\t\t\tcancelToken: cancelToken.value && cancelToken.value.token,\n\t\t})\n\t\tdata.data = response\n\t\tisFunction(callback) && callback(response)\n\t}\n\treturn {\n\t\tdata,\n\t\tcancelToken,\n\t\tactionSearch\n\t}\n}\n\nconst useLocations = () => {\n\tconst state = computed(() => deepClone({...store.state.dashboard.location}))\n\tconst stateFiltered = computed(() => deepClone({...store.state.dashboard.locationFiltered}))\n\tconst stateLocationPermission = computed(() => deepClone({...store.state.dashboard.locationPremission}))\n\tconst query = reactive({\n\t\tpage: 1,\n\t\tlimit: 10,\n\t\tsearch: '',\n\t\tsort_by: '',\n\t\torder_by: '',\n\t\tis_addtional_info: 1,\n\t\tlocation_type: null\n\t})\n\tconst queryLocationPermission = reactive({\n\t\tpage: 1,\n\t\tlimit: 10,\n\t\tsearch: '',\n\t\tsort_by: '',\n\t\torder_by: '',\n\t\tis_addtional_info: 1,\n\t\tloaded: [],\n\t\tlocation_type: null\n\t})\n\tconst loading = reactive({\n\t\tall: false\n\t})\n\tconst locations = async (callback = () => {}, admin = undefined) => {\n\t\ttry{\n\t\t\tloading.all = true\n\t\t\tconst result = await store.dispatch('dashboard/locations', {\n\t\t\t\t...query,\n\t\t\t\t...(admin && { admin_id: admin })\n\t\t\t})\n\t\t\tif(typeof result === 'object' && !Array.isArray(result)){\n\t\t\t\tObject.assign(state, deepClone(result))\n\t\t\t}\n\t\t\tisFunction(callback) && callback(result)\n\t\t}finally{\n\t\t\tloading.all = false\n\t\t}\n\t}\n\tconst locationsPremission = async (callback = () => {}, admin = undefined) => {\n\t\ttry{\n\t\t\tloading.all = true\n\t\t\tconst result = await store.dispatch(`dashboard/locationsPermission`, {\n\t\t\t\t...queryLocationPermission,\n\t\t\t\t...(admin && { admin_id: admin })\n\t\t\t})\n\t\t\tif(typeof result === 'object' && !Array.isArray(result)){\n\t\t\t\tObject.assign(stateLocationPermission, deepClone(result))\n\t\t\t}\n\t\t\tisFunction(callback) && callback(result)\n\t\t}finally{\n\t\t\tloading.all = false\n\t\t}\n\t}\n\n\tconst mailInLocation = computed(() => stateFiltered.value.mailin_location_id ? ({\n\t\tid: stateFiltered.value.mailin_location_id || null,\n\t\tname: stateFiltered.value.mailin_location_name || ''\n\t}) : null)\n\tconst currentLocation = computed(() => stateFiltered.value.current_location_id ? ({\n\t\tid: stateFiltered.value.current_location_id || null,\n\t\tname: stateFiltered.value.current_location_name || '',\n    is_default_mail_in: mailInLocation.value.id ? stateFiltered.value.current_location_id == mailInLocation.value.id : false\n\t}) : null)\n\n\treturn {\n\t\tquery,\n\t\tqueryLocationPermission,\n\t\tstate,\n\t\tstateFiltered,\n\t\tstateLocationPermission,\n\t\tloading,\n\t\tmailInLocation,\n\t\tcurrentLocation,\n\t\tlocations,\n\t\tlocationsPremission\n\t}\n}\n\nconst useDevice = () => {\n\tconst state = computed(() => store.state.setting.condition)\n\tconst { data, actionConditionDeviceWidgetAvailability, actionConditionDeviceConditionAvailability  } = useConditionAll()\n\n\treturn {\n\t\tstate,\n\t\tdata,\n\t\tactionConditionDeviceWidgetAvailability,\n\t\tactionConditionDeviceConditionAvailability\n\t}\n}\n\nconst usePersonalize = () => {\n\tconst loading  = ref(false)\n\tconst abortController = ref(null)\n\n\tconst getPersonalize = async (payload) => {\n\t\ttry {\n\t\t\tloading.value = true\n\t\t\tconst response = await store.dispatch('dashboard/personalize', payload)\n\t\t\treturn response\n\t\t} finally {\n\t\t\tloading.value = false\n\t\t}\n\t}\n\tconst updatePersonalize = async (payload) => {\n\t\tif (abortController.value) {\n\t\t\tabortController.value.abort()\n\t\t}\n\n\t\tconst controller = new AbortController()\n\t\tabortController.value = controller\n\n\t\ttry {\n\t\t\tloading.value = true\n\t\t\tawait store.dispatch('dashboard/updatePersonalize', {\n\t\t\t\tdata: payload,\n\t\t\t\tsignal: controller.signal\n\t\t\t})\n\t\t\tElMessage({\n\t\t\t\tmessage: 'Personlize Dashboard Updated!',\n\t\t\t\ttype: 'success'\n\t\t\t})\n\t\t\tabortController.value = null\n\t\t} catch {\n\t\t\tElMessage({\n\t\t\t\tmessage: 'Failed to update!',\n\t\t\t\ttype: 'error'\n\t\t\t})\n\t\t} finally {\n\t\t\tloading.value = false\n\t\t}\n\t}\n\n\treturn {\n\t\tloading,\n\t\tgetPersonalize,\n\t\tupdatePersonalize\n\t}\n}\n\nexport {\n\tuseOrders,\n\tuseCustomers,\n\tuseAffiliates,\n\tuseChart,\n\tuseScanIn,\n\tuseSearch,\n\tuseDevice,\n\tuseLocations,\n\tusePersonalize\n}\n"],"names":["useOrders","date","data","reactive","month","year","source","state","ref","getFormatted","computed","store","getters","orders","async","statusId","callback","payload","__spreadValues","value","dispatch","id","isFunction","arrivingToday","_","inTransit","useCustomers","tempDate","customers","useAffiliates","affiliates","useChart","local","buyback_type","user","me","is_location_mail_in","chart","leads","paid","useScanIn","scanInData","search","scanIn","result","q","useSearch","cancelToken","actionSearch","cancel","axios","CancelToken","response","token","useLocations","deepClone","dashboard","location","stateFiltered","locationFiltered","stateLocationPermission","locationPremission","query","page","limit","sort_by","order_by","is_addtional_info","location_type","queryLocationPermission","loaded","loading","all","mailInLocation","mailin_location_id","name","mailin_location_name","currentLocation","current_location_id","current_location_name","is_default_mail_in","locations","admin","admin_id","Array","isArray","Object","assign","locationsPremission","useDevice","setting","condition","actionConditionDeviceWidgetAvailability","actionConditionDeviceConditionAvailability","useConditionAll","usePersonalize","abortController","getPersonalize","updatePersonalize","abort","controller","AbortController","signal","_u","message","type"],"mappings":"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"}