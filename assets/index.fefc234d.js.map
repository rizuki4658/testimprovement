{"version":3,"file":"index.fefc234d.js","sources":["../../src/views/integration/repair-desk/index.vue","../../src/views/integration/repair-desk/index.js"],"sourcesContent":["<template>\n  <div>\n    <Alert view=\"smooth\" color=\"blue\" class=\"mb-8\">\n      <div class=\"flex gap-x-2 -mx-4 -my-2 py-1\">\n        <i class=\"material-icons\">info</i>\n        <span whitelabel=\"text-replace\" data-label=\"domain custom alert\">\n          Connect your RepairDesk account to your Reusely account to\n          automatically move completed trade-in tickets and inventory from your\n          Reusely account to your RepairDesk account.\n        </span>\n      </div>\n    </Alert>\n    <Tab v-model=\"selectedTab\" :items=\"tab\" name=\"name\" by=\"id\" component />\n    <template v-if=\"selectedTab === 'location'\">\n      <Input\n        v-model=\"data.search\"\n        placeholder=\"Search everything...\"\n        class=\"w-full mb-4\"\n        icon\n        @input=\"handleSearch\"\n      >\n        <template #icon>\n          <span class=\"material-icons\">search</span>\n        </template>\n      </Input>\n      <div class=\"mb-4\">\n        <Table v-loading=\"loading\" :data=\"data.items\">\n          <TableColumn label=\"Store Name\" width=\"250\">\n            <template #default=\"{ row }\">\n              <span class=\"text-teal-04 font-semibold mb-2\">{{\n                row.name\n              }}</span>\n              <p class=\"text-sm text-grey-02\">{{ row.email }}</p>\n              <p class=\"text-sm text-grey-02\">{{ row.address_text }}</p>\n              <p class=\"text-sm text-grey-02\">{{ row.phone }}</p>\n            </template>\n          </TableColumn>\n          <TableColumn label=\"Selling Method\" width=\"150\">\n            <template #default=\"{ row }\">\n              <div\n                :class=\"[\n                  row.is_mailin == 1\n                    ? 'text-teal-04 bg-teal-01'\n                    : 'text-blue-04 bg-blue-01',\n                  'inline-block text-xs px-2',\n                  'rounded-full py-0.5'\n                ]\"\n              >\n                {{ row.is_mailin ? 'Mail-In' : 'In-Store' }}\n              </div>\n            </template>\n          </TableColumn>\n          <TableColumn label=\"Repairdesk Private App API Key\">\n            <template #default=\"{ row, $index }\">\n              <div\n                v-if=\"!row.repairdesk_api_key && !row.is_edit\"\n                class=\"lg:opacity-0 group-hover:opacity-100 transition-opacity\"\n                @click.stop\n              >\n                <Button\n                  color=\"teal\"\n                  dense\n                  @click=\"row.is_edit = true\"\n                  >Add API Key</Button\n                >\n              </div>\n              <div\n                v-if=\"\n                  (!row.repairdesk_api_key && row.is_edit) ||\n                  (row.repairdesk_api_key && row.is_edit)\n                \"\n                class=\"flex items-center gap-x-2 w-full\"\n                @click.stop\n              >\n                <Input\n                  v-model=\"data.apiKeys[`apiKey${row.id}`]\"\n                  dense\n                  class=\"flex-1 max-w-xs\"\n                />\n                <Button\n                  color=\"teal\"\n                  dense\n                  @click=\"\n                    handleTestConnection(row, data.apiKeys[`apiKey${row.id}`])\n                  \"\n                >\n                  Test Connection & Save\n                </Button>\n              </div>\n              <div\n                v-if=\"row.repairdesk_api_key && !row.is_edit\"\n                class=\"flex items-center gap-x-2 flex-wrap\"\n              >\n                <span class=\"text-sm\">{{ row.repairdesk_api_key }}</span>\n                <div\n                  class=\"lg:opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-x-2\"\n                >\n                  <Button\n                    color=\"teal\"\n                    dense\n                    @click=\"row.is_edit = true\"\n                  >\n                    <i class=\"material-icons text-lg\">edit</i>\n                  </Button>\n                  <Button\n                    color=\"red\"\n                    dense\n                    @click=\"handleDeleteApiKey(row, $index)\"\n                  >\n                    <i class=\"material-icons text-lg\">delete</i>\n                  </Button>\n                </div>\n              </div>\n            </template>\n          </TableColumn>\n        </Table>\n      </div>\n      <Pagination\n        v-model:page=\"data.page\"\n        v-model:limit=\"data.limit\"\n        :data=\"tableOptions\"\n      />\n    </template>\n    <template v-else>\n      <div class=\"my-8 grid grid-cols-3\">\n        <div class=\"col-span-3 lg:col-span-1\">\n          <Fieldset>\n            <template #label>\n              <span>What identify do you use in RepairDesk?</span>\n            </template>\n            <template #default>\n              <RadioGroup\n                :disabled=\"loadingConfigs.update || loadingConfigs.fetch\"\n                :modelValue=\"configs.identifier\"\n                @update:modelValue=\"\n                  (value) =>\n                    handleUpdateConfig({\n                      identifier: value\n                    })\n                \"\n                class=\"radio--full\"\n              >\n                <RadioButton label=\"Imei\">IMEI</RadioButton>\n                <RadioButton label=\"Serial\">Serial Number</RadioButton>\n              </RadioGroup>\n            </template>\n          </Fieldset>\n        </div>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nimport { defineComponent, computed, ref, watch } from 'vue'\nimport { useRepairdesk } from 'composable/integration'\nimport Button from 'bbUi/components/button/button.vue'\nimport Alert from 'bbUi/components/alert/alert.vue'\nimport Input from 'bbUi/components/input/input.vue'\nimport Pagination from 'components/Pagination.vue'\nimport Tab from 'bbUi/components/tab/tab.vue'\nimport Fieldset from 'bbUi/components/fieldset/fieldset.vue'\nimport debounce from 'utils/debounce'\nimport { ElMessage } from 'element-plus'\n\nexport default defineComponent({\n  components: {\n    Pagination,\n    Button,\n    Alert,\n    Input,\n    Tab,\n    Fieldset\n  },\n  async setup() {\n    const {\n      data,\n      loading,\n      configs,\n      loadingConfigs,\n      actionShow,\n      actionUpdate,\n      actionDelete,\n      updateConfig,\n      setConfig\n    } = useRepairdesk()\n    const selectedTab = ref('location')\n    const tab = [\n      {\n        id: 'location',\n        name: 'Locations'\n      },\n      // {\n      //   id: 'setting',\n      //   name: 'Settings'\n      // }\n    ]\n    const totalEntries = computed(() => data.items.length)\n    const lastPage = computed(() => data.lastPage)\n    const tableOptions = computed(() => {\n      return {\n        from: data.limit * data.page - data.limit + 1,\n        to:\n          data.limit * data.page > totalEntries.value\n            ? totalEntries.value\n            : data.limit * data.page,\n        last_page: lastPage.value,\n        total: totalEntries.value\n      }\n    })\n    const handleSearch = debounce(async () => {\n      await actionShow({\n        search: data.search,\n        page: data.page,\n        limit: data.limit\n      })\n    }, 300)\n    const handleTestConnection = async (row, key) => {\n      await actionUpdate({ id: row.id, repairdesk_api_key: key }, async () => {\n        row.repairdesk_api_key = key\n        row.is_edit = false\n        await actionShow({\n          search: data.search,\n          page: data.page,\n          limit: data.limit\n        })\n      })\n    }\n    const handleDeleteApiKey = async (row, key) => {\n      await actionDelete(row.id, async () => {\n        row.is_edit = false\n        row.repairdesk_api_key = undefined\n        data.apiKeys[`apiKey${data.items[key].key}`] = undefined\n        await actionShow({\n          search: data.search,\n          page: data.page,\n          limit: data.limit\n        })\n      })\n    }\n    const handleUpdateConfig = async (configs = undefined) => {\n      if (!configs) return\n      setConfig(configs)\n      await updateConfig(async () => {\n        ElMessage({\n          type: 'success',\n          message: 'Repairdesk settings updated'\n        })\n        await actionShow()\n      })\n    }\n\n    watch(\n      () => ({ limit: data.limit, page: data.page }),\n      debounce(async () => {\n        await actionShow({\n          search: data.search,\n          page: data.page,\n          limit: data.limit\n        })\n      })\n    )\n\n    await Promise.all([actionShow()])\n\n    return {\n      data,\n      loading,\n      tableOptions,\n      tab,\n      selectedTab,\n      configs,\n      loadingConfigs,\n      setConfig,\n      handleSearch,\n      handleDeleteApiKey,\n      handleTestConnection,\n      handleUpdateConfig\n    }\n  }\n})\n</script>\n","import { defineComponent, h, ref, reactive } from 'vue'\nimport { useSuspense } from 'composable/components'\nimport { useRoute } from 'vue-router'\n// useRouter\nimport Modal from 'bbUi/components/modal/modal.vue'\n// import Button from 'bbUi/components/button/button.vue'\nimport Index from './index.vue'\n\nexport default defineComponent({\n  async setup() {\n    const { genSuspense } = useSuspense()\n    const refComponent = ref(null)\n    const route = useRoute()\n    // const router = useRouter()\n    \n    // const saveChanges = () => {\n    //   refComponent.value.update(() => {\n    //     router.push({\n    //       name: 'integration',\n    //       params: {\n    //         enable: route.params?.id || ''\n    //       }\n    //     })\n    //   })\n    // }\n    // const genSaveButton = () => h(Button, {\n    //   color: 'teal',\n    //   view: 'smooth',\n    //   loading: refComponent.value && refComponent.value?.loading?.update,\n    //   onClick: saveChanges\n    // }, {\n    //   default: () => 'Save'\n    // })\n    const genComponent = () => genSuspense(h(Index, {\n      ref: refComponent\n    }))\n    const modalProps = reactive({\n      modelValue: true,\n      closeTo: {\n        name: 'integration',\n        query: {\n          reload: 1\n        }\n      },\n      size: 'lg',\n      // hideFooters: false\n    })\n    const modalSlots = reactive({\n      header: () => 'RepairDesk Config',\n      default: () => genComponent()\n      // footer: () => genSaveButton()\n    })\n    const modalComponent = h(Modal, modalProps, modalSlots)\n    return () => h('div', [modalComponent])\n  }\n})\n"],"names":["_sfc_main","defineComponent","components","Pagination","Button","Alert","Input","Tab","Fieldset","data","loading","configs","loadingConfigs","actionShow","actionUpdate","actionDelete","updateConfig","setConfig","useRepairdesk","selectedTab","ref","totalEntries","computed","items","length","lastPage","tableOptions","from","limit","page","to","value","last_page","total","handleSearch","debounce","async","search","watch","Promise","all","tab","id","name","handleDeleteApiKey","row","key","is_edit","repairdesk_api_key","apiKeys","handleTestConnection","handleUpdateConfig","configs2","_u","type","message","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_7","_openBlock","_createElementBlock","_createVNode","_component_Alert","view","color","_withCtx","_cache","_createElementVNode","whitelabel","onUpdate:modelValue","$event","_ctx","by","_Fragment","_component_Input","modelValue","placeholder","icon","_createBlock","_component_Table","_component_TableColumn","label","default","_toDisplayString","email","address_text","_normalizeClass","$index","_component_Button","dense","onClick","_createCommentVNode","_hoisted_6","_hoisted_8","_component_Pagination","onUpdate:page","onUpdate:limit","_hoisted_9","_hoisted_10","_component_RadioGroup","disabled","update","fetch","identifier","index","[object Object]","genSuspense","useSuspense","refComponent","useRoute","modalProps","reactive","closeTo","query","reload","size","modalSlots","header","h","Index","modalComponent","Modal"],"mappings":"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"}