{"version":3,"file":"Widget.7d263cff.js","sources":["../../src/views/dashboard/Widget.vue"],"sourcesContent":["<template>\n  <Suspense>\n    <div v-if=\"state.is_available_device\">\n      <template v-if=\"widgetOnly\">\n        <div\n          class=\"bg-white p-4 overflow-y-auto rounded-lg\"\n          :style=\"{ minHeight: '450px', maxHeight: '600px' }\"\n        >\n          <div class=\"buyback-widget\" />\n        </div>\n      </template>\n      <template v-else>\n        <Card class=\"shadow-lg h-full\">\n          <template #header>\n            <div class=\"flex\">\n              <div class=\"flex-grow\">\n                <div class=\"flex items-center flex-wrap\">\n                  <p class=\"font-medium text-teal-04 text-lg mr-4\">{{ orderTitle }}</p>\n                </div>\n              </div>\n            </div>\n          </template>\n          <div class=\"overflow-y-auto\">\n            <div class=\"buyback-widget\" />\n          </div>\n        </Card>\n      </template>\n    </div>\n    <div v-else>\n      <Card class=\"shadow-lg h-full\">\n        <template #header>\n          <div class=\"flex\">\n            <div class=\"flex-grow\">\n              <div class=\"flex items-center flex-wrap\">\n                <p class=\"font-semibold mr-4\">{{ orderTitle }}</p>\n              </div>\n            </div>\n          </div>\n        </template>\n        <div class=\"overflow-y-auto\">\n          <WidgetUnvailable />\n        </div>\n      </Card>\n    </div>\n  </Suspense>\n</template>\n\n<script>\nimport { defineComponent, ref } from 'vue'\nimport { useUser } from 'composable/user'\nimport { useDevice } from 'composable/dashboard'\nimport { useFeatureFlag } from 'composable/whitelabel'\n\nimport { onDemand } from 'utils/script-loader'\n\nimport Card from 'bbUi/components/card/card.vue'\nimport WidgetUnvailable from 'components/Widget/Unavailable/index.vue'\n\nexport default defineComponent({\n  components: {\n    Card,\n    WidgetUnvailable\n  },\n  props: {\n    statusId: {\n      type: Number,\n      default: null\n    },\n    orderTitle: {\n      type: String,\n      default: ''\n    },\n    buyback_type: {\n      type: [String, Number],\n      default: 2\n    },\n    widgetOnly: {\n      type: Boolean,\n      default: false\n    }\n  },\n  async setup(props) {\n    const { widgetOptions } = useUser()\n    const { state, actionConditionDeviceWidgetAvailability } = useDevice()\n    const { features } = useFeatureFlag()\n    const buyback = ref(null)\n\n    const initWidget = () => {\n      if (buyback.value) {\n        buyback.value.update({\n          tenantId: widgetOptions.value.tenantId,\n          apiKey: widgetOptions.value.apiKey,\n          ...(JSON.parse(window.localStorage.getItem('white-label')) && { whiteLabel: features.value.whitelabelWidget }),\n          disableFloatButton: false\n        })\n        return null\n      }\n      buyback.value = new Buyback({\n        tenantId: widgetOptions.value.tenantId,\n        apiKey: widgetOptions.value.apiKey,\n        ...(JSON.parse(window.localStorage.getItem('white-label')) && { whiteLabel: features.value.whitelabelWidget }),\n        disableFloatButton: false\n      })\n      return null\n    }\n\n    const callWidget = async () => {\n      const sourceURL = JSON.parse(window.localStorage.getItem('white-label')) && features.value.whitelabelWidget ? import.meta.env.VITE_WIDGET_URL_WHITE_LABEL : import.meta.env.VITE_WIDGET_URL\n      const scriptUrl = `${sourceURL}/v3.js`\n      const hasWidgetScriptLoaded =\n        document.querySelector(\n          `script[src*=\"${sourceURL}\"]`\n        )\n      if (hasWidgetScriptLoaded) hasWidgetScriptLoaded.remove()\n\n      onDemand(scriptUrl).load(initWidget)\n    }\n\n    await actionConditionDeviceWidgetAvailability()\n\n    if (state.value.is_available_device) await callWidget()\n\n    return {\n      state,\n      buyback\n    }\n  }\n})\n</script>\n"],"names":["_sfc_main","defineComponent","components","Card","WidgetUnvailable","props","statusId","type","Number","default","orderTitle","String","buyback_type","widgetOnly","Boolean","[object Object]","widgetOptions","useUser","state","actionConditionDeviceWidgetAvailability","useDevice","features","useFeatureFlag","buyback","ref","initWidget","value","update","__spreadProps","__spreadValues","tenantId","apiKey","JSON","parse","window","localStorage","getItem","whiteLabel","whitelabelWidget","disableFloatButton","Buyback","is_available_device","async","sourceURL","scriptUrl","hasWidgetScriptLoaded","document","querySelector","remove","onDemand","load","callWidget","key","class","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_createBlock","_Suspense","_withCtx","_createElementBlock","_hoisted_1","_ctx","_hoisted_2","_cache","header","_createElementVNode","_createVNode","_hoisted_12"],"mappings":"0vBA0DA,MAAKA,EAAaC,EAAa,CAC7BC,WAAY,CACVC,KAAAA,EACAC,iBAAAA,GAEFC,MAAO,CACLC,SAAU,CACRC,KAAMC,OACNC,QAAS,MAEXC,WAAY,CACVH,KAAMI,OACNF,QAAS,IAEXG,aAAc,CACZL,KAAM,CAACI,OAAQH,QACfC,QAAS,GAEXI,WAAY,CACVN,KAAMO,QACNL,SAAS,IAAAM,YAGDV,GACV,MAAMW,cAAEA,GAAkBC,KACpBC,MAAEA,0CAAOC,GAA4CC,KACrDC,SAAEA,GAAaC,IACfC,EAAUC,EAAI,MAEdC,EAAa,IACbF,EAAQG,OACVH,EAAQG,MAAMC,OAAOC,EAAAC,EAAA,CACnBC,SAAUd,EAAcU,MAAMI,SAC9BC,OAAQf,EAAcU,MAAMK,QACxBC,KAAKC,MAAMC,OAAOC,aAAaC,QAAQ,iBAAmB,CAAEC,WAAYhB,EAASK,MAAMY,mBAHxE,CAInBC,oBAAoB,KAEf,OAEDhB,EAAAG,MAAQ,IAAIc,QAAQZ,EAAAC,EAAA,CAC1BC,SAAUd,EAAcU,MAAMI,SAC9BC,OAAQf,EAAcU,MAAMK,QACxBC,KAAKC,MAAMC,OAAOC,aAAaC,QAAQ,iBAAmB,CAAEC,WAAYhB,EAASK,MAAMY,mBAHjE,CAI1BC,oBAAoB,KAEf,MAmBF,aAJDpB,IAEFD,EAAMQ,MAAMe,0BAdGC,WACX,MAAAC,EAAYX,KAAKC,MAAMC,OAAOC,aAAaC,QAAQ,iBAAmBf,EAASK,MAAMY,iBAAmB,mCAA8C,kCACtJM,EAAY,GAAGD,UACfE,EACJC,SAASC,cACP,gBAAgBJ,OAEhBE,GAA6CA,EAAAG,SAEjDC,EAASL,GAAWM,KAAKzB,IAKgB0B,GAEpC,CACLjC,MAAAA,EACAK,QAAAA,mBAvHI6B,IAAK,EACJC,MAAO,uFASCC,EAAA,CAAAD,MAAM,QACJE,EAAA,CAAAF,MAAM,aACNG,EAAA,CAAAH,MAAM,iFAcZI,EAAA,CAAAL,IAAK,GACHM,EAAA,CAAAL,MAAM,QACJM,EAAA,CAAAN,mBACAO,EAAA,CAAAP,MAAM,+BAKZQ,EAAA,CAAAR,MAAM,kJAZTS,EAAAC,EAAA,KAAA,CAzBKtD,QAAAuD,GAAyB,IAAA,8BACRC,IAAAA,EAAA,MAAAC,EAAA,CACxBC,EAAAtD,YAIgCoD,IAAAA,EAApB,MAAiBG,EAAAC,EAAA,KAAAA,EAAA,GAAA,yDAIvBjB,IAAK,4BACE,CACTkB,OAAAN,GAAA,KACEO,EAAA,QAIM,CAHJA,EAAA,QAEM,GADiE,MAArEf,EAAqE,uDAM7C,KAAAa,EAAA,GAAAE,EAAH,MAAA,CAAAlB,MAAA,mBAAA,2DAmB1BY,EAbI,MAAmBR,EAAA,CACjBe,IAOH,CAAAnB,MAAA,oBAAA,CANNiB,OAAAN,GAAA,KACEO,EAAA,QAIM,CAHJA,EAAA,QAEM,GAD8C,MAAlDX,EAAkD,qCAK1DnD,QAAAuD,GAAA,OACsB,MAAAS,EAAA"}