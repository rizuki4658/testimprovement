var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{k as d,g as r,o as i,t as u,a1 as c,a2 as m,F as p,B as v,Q as y,K as b,D as g,w as h,A as _,I as f,L as k,T as x,f as w,y as S,aG as C,r as B,m as V,$,U as A,a5 as P,O as I,W as j,z as F,S as O}from"./vendor.9695fe57.js";import{d as T}from"./onboarding.69c55570.js";import{_ as D,f as U,N as z,b as E}from"./index.6438e939.js";import{S as M}from"./SelectCountry.e5d7e4ac.js";import{S as L}from"./SelectCurrency.911a2a7f.js";import{u as G}from"./index.f40e4a9e.js";import{c as N}from"./countries.62f07ce8.js";import"./index.54844a74.js";import"./index.6b6f6369.js";import"./setting.1af98a84.js";const W=d({props:{modelValue:{type:Number,default:()=>null}},emits:["update:modelValue"],setup(e,{emit:d}){const i=r((()=>e.modelValue)),u=r((()=>[{name:"Mail-In",description:"Automatically generate return shipping labels for your customers",icon_url:"/icon/onboarding/buyback-type_mailin.svg",value:1},{name:"In-Store",description:"Increase trade-in traffic to your local store",icon_url:"/icon/onboarding/buyback-type_instore.svg",value:2}].map((e=>{return d=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&o(e,l,a[l]);if(t)for(var l of t(a))n.call(a,l)&&o(e,l,a[l]);return e})({},e),r={is_selected:i.value===e.value},a(d,l(r));var d,r}))));return{selectedBuybackType:i,buybackTypeOptions:u,handleSelectBuybackType:e=>{d("update:modelValue",e)}}}}),Y={class:"buyback-type"},H=["onClick"],K={class:"buyback-type__title"},Q={class:"buyback-type__description"},R={class:"bg-blue-lighten text-blue-04 py-3 px-5 rounded-lg flex gap-x-4"};var q=D(W,[["render",function(e,a,l,t,s,n){return i(),u("div",Y,[(i(!0),u(c,null,m(e.buybackTypeOptions,(a=>(i(),u("div",{key:a.value,onClick:l=>e.handleSelectBuybackType(a.value),class:p(["buyback-type__option",a.is_selected?"buyback-type__option--selected":""])},[v("div",{class:"buyback-type__icon",style:y(`-webkit-mask-image: url('${a.icon_url}')`)},null,4),v("div",K,b(a.name),1),v("div",Q,b(a.description),1)],10,H)))),128)),g(x,{name:"fade"},{default:h((()=>[_(v("div",R,a[0]||(a[0]=[v("i",{class:"material-icons"},"info",-1),v("p",null,[v("b",null,"You must set up shipping integration"),f(" before generating shipping labels. You can find instructions on how to set it up "),v("a",{href:"https://help.reusely.com/en/articles/9682274-shipping-integration-for-mail-in-offers",target:"_blank",class:"font-semibold text-blue-04 underline hover:text-blue-03"},"here"),f(". ")],-1)]),512),[[k,1==e.selectedBuybackType]])])),_:1})])}],["__scopeId","data-v-2dd64b09"]]);const J=d({components:{Input:U,SelectCountry:M,SelectCurrency:L},props:{data:{type:Object,default:()=>({name:null,country_code:null,country_name:null,currency:null,currency_symbol:null,address:null,city:null,zip:null,state:null,suite:null,address_text:null,location_type:null,valid:!1})},countries:{type:Array,default:()=>[]},currencies:{type:Array,default:()=>[]}},emits:["update:data"],setup(e,{emit:a}){const{validationRules:l,actionSetCurrency:t}=T(),s=w(!1),n=w(!1),o=r({get:()=>e.data,set:e=>a("update:data",e)}),d=r((()=>s.value&&o.value.address_text&&""!==o.value.address_text.trim()&&!o.value.valid));S((()=>o.value.valid),(e=>{e&&(s.value=!1)})),S((()=>o.value.address_text),(e=>{e&&""!==e.trim()||(s.value=!1)})),C((()=>{o.value.country_code&&Object.assign(u,{restrictCountries:z(o.value.country_code)?[o.value.country_code]:[]})})),S((()=>o.value.country_code),(async(e,a)=>{void 0!==a&&e!==a&&(o.value.address=null,o.value.address_text=null,o.value.city=null,o.value.state=null,o.value.zip=null,o.value.suite=null,o.value.valid=!1,s.value=!1,n.value=!1)}));const i=G(l,o,{$lazy:!0}),u=B({valid:"valid",route:"address",locality:"city",administrative_area_level_1:"state",formatted_address:"address_text",postal_code:"zip",geo:{lat:"lat",lng:"lon"},restrictCountries:[]});return{data:o,addressTouched:s,addressFocused:n,showAddressError:d,address:u,handleAddressFocus:()=>{n.value=!0},handleAddressBlur:()=>{n.value=!1,o.value.address_text&&""!==o.value.address_text.trim()&&(s.value=!0)},handleAddressInput:()=>{o.value.address_text&&""!==o.value.address_text.trim()||(s.value=!1)},handleSelectCountry:e=>{o.value.country_code=e.country_code,o.value.country_name=e.nicename,s.value=!1,n.value=!1,o.value.valid=!1,o.value.address_text=null},handleSelectCurrency:e=>{t({symbol:e.symbol,currency:e.currency_code}),o.value.currency=e.currency_code,o.value.currency_symbol=e.symbol},validate:()=>(i.value.$validate(),!i.value.$invalid),validation:i,countriesWithoutState:N}}}),X={class:"grid grid-cols-2 gap-6"},Z={class:"col-span-2"},ee={class:"col-span-2"},ae={class:"flex items-center gap-x-2"},le={class:"col-span-2"},te={key:0,class:"text-red-base block mt-2"},se={class:"col-span-2"},ne={key:0,class:"col-span-2"},oe={class:"text-red-base my-2 block"},de={key:0},re={class:"text-red-base my-2 block"},ie={class:"text-red-base my-2 block"};const ue=d({components:{Button:E,BuybackType:q,FormPurchasingMethod:D(J,[["render",function(e,a,l,t,s,n){var o,d,r,y,f,k,x,w,S,C,B,P,I,j;const F=V("Input"),O=V("Tooltip"),T=V("SelectCountry"),D=V("SelectCurrency"),U=$("gmap");return i(),u("div",X,[v("div",Z,[g(F,{modelValue:e.data.legal_business_name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.legal_business_name=a),placeholder:"Legal Business Name",label:"Legal Business Name",block:"",view:e.validation.legal_business_name.$invalid?"danger":""},null,8,["modelValue","view"]),(i(!0),u(c,null,m(e.validation.legal_business_name.$errors,((e,a)=>(i(),u("small",{class:"text-red-base block mt-2",key:a},b(e.$message)+". ",1)))),128))]),v("div",ee,[g(F,{modelValue:e.data.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.name=a),placeholder:"Doing Business As (DBA)",label:"Doing Business As (DBA)",block:"",view:e.validation.name.$invalid?"danger":""},{label:h((()=>[v("div",ae,[a[9]||(a[9]=v("p",null,"Doing Business As (DBA)",-1)),g(O,{placement:"top"},{content:h((()=>a[7]||(a[7]=[v("p",{class:"text-sm max-w-sm"},"Your DBA (Doing Business As) is the name that will appear on your shipping labels for Mail-In shipments when Mail-In is enabled.",-1)]))),default:h((()=>[a[8]||(a[8]=v("i",{class:"material-icons"},"info",-1))])),_:1})])])),_:1},8,["modelValue","view"]),(i(!0),u(c,null,m(e.validation.name.$errors,((e,a)=>(i(),u("small",{class:"text-red-base block mt-2",key:a},b(e.$message)+". ",1)))),128))]),v("div",null,[g(T,{onSelect:e.handleSelectCountry,placeholder:"Select Country",label:"Business Country",countries:e.countries,"no-border":"",rounded:""},null,8,["onSelect","countries"]),(i(!0),u(c,null,m(e.validation.country_code.$errors,((e,a)=>(i(),u("small",{class:"text-red-base block mt-2",key:a},b(e.$message)+". ",1)))),128))]),v("div",null,[g(D,{onChange:e.handleSelectCurrency,placeholder:"Select Currency",label:"Business Currency",currencies:e.currencies},null,8,["onChange","currencies"]),(i(!0),u(c,null,m(e.validation.currency.$errors,((e,a)=>(i(),u("small",{class:"text-red-base block mt-2",key:a},b(e.$message)+". ",1)))),128))]),v("div",le,[g(O,{placement:"top",disabled:(null==(d=null==(o=e.data)?void 0:o.country_code)?void 0:d.length)>0},{content:h((()=>a[10]||(a[10]=[v("p",{class:"text-sm max-w-sm"},"Please select a country before searching for your business address.",-1)]))),default:h((()=>[_(g(F,{disabled:!e.data.country_code,modelValue:e.data.address_text,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.address_text=a),placeholder:"Search for your business address",label:"Physical Business Street Address",block:"",view:e.validation.address_text.$invalid||e.showAddressError?"danger":"",onBlur:e.handleAddressBlur,onFocusOut:e.handleAddressBlur,onFocus:e.handleAddressFocus,onInput:e.handleAddressInput},null,8,["disabled","modelValue","view","onBlur","onFocusOut","onFocus","onInput"]),[[U,e.address]])])),_:1},8,["disabled"]),e.showAddressError?(i(),u("small",te," Invalid address selection. Please select an address from the dropdown suggestions. ")):A("",!0),(i(!0),u(c,null,m(e.validation.address_text.$errors,((e,a)=>(i(),u("small",{class:"text-red-base block mt-2",key:a},b(e.$message)+". ",1)))),128))]),v("div",se,[g(F,{modelValue:e.data.suite,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.suite=a),block:"",label:"Apartment, suite, unit, building, floor (optional)"},null,8,["modelValue"])]),e.data.country_code?(i(),u("div",ne,[v("div",{class:p(["grid gap-4","gap-4 grid-cols-1",e.countriesWithoutState.includes(e.data.country_code)?"md:grid-cols-2":"md:grid-cols-3"])},[v("div",null,[g(F,{modelValue:e.data.city,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.city=a),label:"City",placeholder:"City",block:"",view:(null==(y=null==(r=e.validation)?void 0:r.city)?void 0:y.$invalid)?"danger":"default"},null,8,["modelValue","view"]),(i(!0),u(c,null,m(null==(k=null==(f=e.validation)?void 0:f.city)?void 0:k.$errors,(e=>(i(),u("span",oe,b(e.$message)+". ",1)))),256))]),e.countriesWithoutState.includes(e.data.country_code)?A("",!0):(i(),u("div",de,[g(F,{modelValue:e.data.state,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.state=a),label:"State",placeholder:"State",block:"",view:(null==(w=null==(x=e.validation)?void 0:x.state)?void 0:w.$invalid)?"danger":"default"},null,8,["modelValue","view"]),(i(!0),u(c,null,m(null==(C=null==(S=e.validation)?void 0:S.state)?void 0:C.$errors,(e=>(i(),u("span",re,b(e.$message)+". ",1)))),256))])),v("div",null,[g(F,{modelValue:e.data.zip,"onUpdate:modelValue":a[6]||(a[6]=a=>e.data.zip=a),label:"GB"===e.data.country_code?"Postcode":"Postal Code",placeholder:"GB"===e.data.country_code?"Postcode":"Postal Code",block:"",view:(null==(P=null==(B=e.validation)?void 0:B.zip)?void 0:P.$invalid)?"danger":"default"},null,8,["modelValue","label","placeholder","view"]),(i(!0),u(c,null,m(null==(j=null==(I=e.validation)?void 0:I.zip)?void 0:j.$errors,(a=>(i(),u("span",ie,b("GB"===e.data.country_code?"Postcode":"Postal Code")+" "+b(a.$message)+". ",1)))),256))])],2)])):A("",!0)])}]])},async setup(){const e=w(null),{data:a,loading:l,isIncompleteForm:t,isShowForm:s,countries:n,currencies:o,action:d,actionCurrencies:r,actionCountries:i}=T(),u=P(),c=I(),m=e=>{let l=0;return Object.keys(a).forEach((e=>{"valid"!==e&&"location_type"!==e&&a[e]&&a[e].toString().length&&(l+=1)})),l>0&&e.preventDefault()};return j((()=>{window.addEventListener("beforeunload",m)})),F((()=>{window.removeEventListener("beforeunload",m)})),await Promise.all([r(),i()]),{refFormPurchasingMethod:e,data:a,loading:l,countries:n,currencies:o,isIncompleteForm:t,isShowForm:s,handleSubmit:async()=>{if(e.value){e.value.validate()&&(u.name.includes("newCompany")?a.token=localStorage.getItem("token"):a.token&&delete a.token,await d((()=>{c.push({name:u.name.includes("newCompany")?"newCompanySyncProducts":"onboardingSyncProducts"})}),u.name.includes("newCompany")))}}}}}),ce={class:"flex h-full"},me={class:"lg:my-auto mx-auto px-20 2xl:mx-56"},pe={class:"max-w-3xl"},ve={class:"mt-8 mb-6 w-full"},ye={class:"w-full"};var be=D(ue,[["render",function(e,a,l,t,s,n){const o=V("BuybackType"),d=V("FormPurchasingMethod"),r=V("Button");return i(),u("div",ce,[v("div",me,[a[4]||(a[4]=v("div",{class:"max-w-4xl mx-3"},[v("h2",{class:"text-3xl font-semibold"}," How do you intend on purchasing Items? "),v("p",{class:"text-black my-4"}," This will determine how your customers can sell their items to you through your buyback widget. Choose your primary method and you can always add the other one later. ")],-1)),v("div",pe,[v("div",ve,[g(o,{modelValue:e.data.location_type,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.location_type=a),class:"w-full"},null,8,["modelValue"])]),v("div",ye,[v("form",{onSubmit:a[2]||(a[2]=O(((...a)=>e.handleSubmit&&e.handleSubmit(...a)),["prevent"]))},[g(x,{name:"slide-fade"},{default:h((()=>[_(g(d,{ref:"refFormPurchasingMethod",data:e.data,"onUpdate:data":a[1]||(a[1]=a=>e.data=a),countries:e.countries,currencies:e.currencies},null,8,["data","countries","currencies"]),[[k,e.isShowForm]])])),_:1}),g(r,{class:"my-6",loading:e.loading,color:"teal",disabled:e.isIncompleteForm},{default:h((()=>a[3]||(a[3]=[f("Continue "),v("i",{class:"material-icons ml-2"},"east",-1)]))),_:1},8,["loading","disabled"])],32)])])])])}]]);export{be as default};
