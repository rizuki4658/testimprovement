{"version":3,"file":"Statuses.d47912b9.js","sources":["../../src/views/buyback/local/detail/Statuses.vue"],"sourcesContent":["<template>\n  <Card v-loading=\"loading.all\" class=\"my-6\">\n    <Timeline>\n      <TimelineItem v-for=\"(status, index) in state\" view=\"filled\" :color=\"color(status.short_name)\" :key=\"index\">\n        <template #datetime>{{ status.created_at }}</template>  \n        <template #content>\n          <Badge :color=\"color(status.short_name)\">{{ status.status_name }}</Badge>\n          <small class=\"block mt-4\">{{ status.notes }}</small>\n        </template>\n      </TimelineItem>\n    </Timeline>\n    <template #header>\n      <div class=\"flex justify-between items-center\">\n        <h6>Status</h6>\n        <Button :disabled=\"stateShow?.deleted_at != null\" color=\"teal\" @click=\"openModalEdit('update')\" dense><i class=\"material-icons text-base\">edit</i> Update Status</Button>\n      </div>\n    </template>\n  </Card>\n  <Modal v-model=\"modal.update\" title=\"Update Status\" @close=\"unsetData\" size=\"lg\">\n    <template #default>\n      <div class=\"grid grid-cols-5 gap-6\">\n        <div class=\"col-span-2 border-r border-grey-01\">\n          <div class=\"px-4\">\n            <p class=\"text-md font-semibold\">Choose Status</p>\n          </div>\n          <Tab color=\"teal\" view=\"smooth\" v-model=\"data.status_id\" by=\"id\" name=\"short_name\" :items=\"stateStatuses\" component type=\"vertical\" />\n        </div>\n        <div class=\"col-span-3\">\n          <StatusesForm :data=\"data\" />\n        </div>\n      </div>\n    </template>\n    <template #footer>\n      <Button color=\"teal\" :loading=\"loading.update\" @click=\"updateStatus\">Update Status</Button>\n    </template>\n  </Modal>\n</template>\n\n<script>\nimport { defineComponent, onUnmounted, watch } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { useStatuses, useShow, useShowStatuses } from 'composable/buyback'\nimport Badge from \"bbUi/components/badge/badge.vue\"\nimport Button from \"bbUi/components/button/button.vue\"\nimport Card from \"bbUi/components/card/card.vue\"\nimport Modal from 'bbUi/components/modal/modal.vue'\nimport Timeline from \"bbUi/components/timeline/timeline.vue\"\nimport TimelineItem from \"bbUi/components/timeline-item/timeline-item.vue\"\nimport Tab from \"bbUi/components/tab/tab.vue\"\nimport StatusesForm from './StatusesForm'\nimport { color } from 'utils/status'\nimport debounce from 'utils/debounce'\n\n\nexport default defineComponent({\n  components: {\n    Badge,\n    Button,\n    Card,\n    Modal,\n    Timeline,\n    TimelineItem,\n    Tab,\n    StatusesForm\n  },\n  async setup() {\n    const { data, modal, state, loading, openModal, unsetData, actionAll, actionUpdate } = useShowStatuses('local')\n    const { state: stateShow, action: actionShow } = useShow('local')\n    const { state: stateStatuses, action: actionAllStatuses } = useStatuses('local')\n    const route = useRoute()\n\n    const stopWatcher = watch(() => route.params.buybackId, debounce(async (newBubyackId, oldBuybackId) => {\n      if(newBubyackId && oldBuybackId) await Promise.all([\n        actionAll(route.params.buybackId),\n        actionAllStatuses(route.params.buybackId)\n      ])\n    }))\n    onUnmounted(() => stopWatcher())\n\n    await Promise.all([\n      actionAll(route.params.buybackId),\n      actionAllStatuses(route.params.buybackId),\n      actionShow(route.params.buybackId)\n    ])\n    const openModalEdit = target => openModal(target, () => {\n      data.status_id = stateShow.value.status_id\n    })\n    const updateStatus = async () => {\n      await actionUpdate(route.params.buybackId, async () => {\n        await actionShow(route.params.buybackId)\n      })\n    }\n    return {\n      data,\n      state,\n      stateStatuses,\n      stateShow,\n      modal,\n      loading,\n      openModalEdit,\n      unsetData,\n      updateStatus,\n      color\n    }\n  }\n})\n</script>"],"names":["_sfc_main","defineComponent","components","Badge","Button","Card","Modal","Timeline","TimelineItem","Tab","StatusesForm","[object Object]","data","modal","state","loading","openModal","unsetData","actionAll","actionUpdate","useShowStatuses","stateShow","action","actionShow","useShow","stateStatuses","actionAllStatuses","useStatuses","route","useRoute","stopWatcher","watch","params","buybackId","debounce","async","newBubyackId","oldBuybackId","Promise","all","onUnmounted","openModalEdit","target","status_id","value","updateStatus","color","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_Fragment","_withDirectives","_createBlock","_component_Card","header","_withCtx","_createElementVNode","_cache","_component_Button","disabled","_a","_ctx","deleted_at","onClick","$event","default","_renderList","status","index","_openBlock","_component_TimelineItem","view","short_name","datetime","_createVNode","_component_Badge","_component_Modal","modelValue","update","onUpdate:modelValue","title","onClose","_component_Tab","by","name","items","component","_hoisted_5"],"mappings":"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"}