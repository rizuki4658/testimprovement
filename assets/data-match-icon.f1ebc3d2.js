var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,l,i)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[l]=i,d=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&n(e,l,a[l]);if(i)for(var l of i(a))s.call(a,l)&&n(e,l,a[l]);return e},o=(e,i)=>a(e,l(i));import{e as u}from"./bulkquote.f2b8aab4.js";import{j as p,k as r,N as c,f as m,g,y as v,_ as h,m as b,a0 as _,o as f,t as y,n as k,w as S,A as w,I as x,a2 as C,a3 as V,B as L,F as I,D as U,K as N,U as $,S as j,W as O,s as q,T as B,L as K,ap as T,r as P,a5 as A}from"./vendor.f1efedad.js";import{z as D,d as Q,b as F,_ as W,R as z,t as E,W as M,f as R,a9 as G,j as Y}from"./index.e231b017.js";import{g as H}from"./buyback.362c230f.js";import{u as J}from"./notes.a1013ac0.js";import{_ as X}from"./fieldset.32ceb9ab.js";import{_ as Z}from"./BuybackNotesWarning.bdbf8010.js";import{B as ee}from"./BTable.e686e826.js";import{u as ae}from"./index.32689823.js";import{c as le,r as ie,f as te,g as se}from"./index.1c09f422.js";import{r as ne,v as de}from"./index.2fb3814c.js";import{I as oe}from"./InputPhone.f8d9b657.js";import{c as ue}from"./copy.ef53d68d.js";import{d as pe}from"./setting.86482221.js";const re=p("buybackShipping",{state:()=>({shippingInfo:{isLoading:!1,modal:!1,result:void 0},additionalShipping:{isLoading:!1,modal:!1,result:void 0},shippingKit:{isLoading:!1,modal:!1,result:void 0}}),actions:{async $createMultipleLabels(e={id:void 0,data:void 0}){const a=await D({url:`/v1/pos/order/shipping-label/generate-multiple/${e.id}`,method:"post",data:e.data});this.additionalShipping.result=a},$actionCheckCustomTracking:async e=>await D({url:`/v1/pos/order/custom-tracking/check-courier?shipping_tracking=${e}`,method:"get"}),$actionSaveCustomTracking:async e=>await D({url:`/v1/pos/order/custom-tracking/${e.id}`,method:"post",data:e.data}),$downloadShippingKit:async(e={id:void 0,params:void 0})=>await D({url:`/v1/shipping/kit/print/${e.id}`,method:"get",params:e.params,responseType:"arraybuffer"}),$downloadBulkShippingKit:async(e={id:void 0,params:void 0})=>await D({url:`/v1/pos/order/shipping-label/print-batch/${e.id}`,method:"post",params:e.params,responseType:"arraybuffer"})}}),ce=r({name:"BulkQuoteDetailFormStatus",components:{Modal:Q,Button:F,Fieldset:X,BuybackNotesWarning:Z},props:{modelValue:{type:Boolean,default:!1},quoteId:{type:String,default:void 0,required:!0},status:{type:Object,default:void 0},order:{type:Object,default:void 0}},emits:["update:modelValue","updateStatus"],setup(e,a){const l=J(),i=c(),t=m(!1),s=m(!1),n=g({get:()=>e.modelValue,set:e=>a.emit("update:modelValue",e)}),u=m(!1),p=m(0),r=m([]),b=m(void 0),_=g((()=>{var a;return 0!==(null==(a=null==e?void 0:e.order)?void 0:a.is_signature_exist)})),f=m(!1),y=m(!1),k=m(!1),{state:S,actionAll:w}=H("online"),x=async()=>{var n,d;if(s.value=!0,t.value=!0,[3,7].includes(null==(n=b.value)?void 0:n.id)&&(l.warningNotes.ids=[null==(d=e.order)?void 0:d.id],!l.warningNotes.isReviewed&&await l.$getNotesUnread(),l.warningNotes.notes.length))return l.warningNotes.modal=!0,t.value=!1,void(s.value=!1);await i.dispatch("bulkQuote/updateQuoteStatus",{id:e.quoteId,data:{status_id:b.value.id,new_step:b.value.step_bulk}}).then((()=>{s.value=!1,t.value=!1,u.value=!1,h({message:"Quote status updated successfully.",type:"success"}),a.emit("updateStatus",!0)})).catch((()=>{s.value=!1,t.value=!1,u.value=!1})),k.value&&callback&&callback()};return v((()=>n.value),(async()=>{n.value?await(async()=>{t.value=!0,s.value=!0;try{const[a,l]=await Promise.all([i.dispatch("bulkQuote/getQuoteStatuses"),i.dispatch("bulkQuote/getBulkQuoteItemInfo",{id:e.quoteId})]);(null==a?void 0:a.length)?(r.value=a.map((a=>{var l,i;return o(d({},a),{disabled:!![9e3,9001].includes(null==(l=e.status)?void 0:l.id)&&![9e3,9001].includes(a.id),active:a.id===(null==(i=e.status)?void 0:i.id)})})),b.value=r.value.find((a=>{var l;return a.id===(null==(l=e.status)?void 0:l.id)}))):(r.value=[],b.value=void 0),f.value=(null==l?void 0:l.total_reconcile)>0}catch{r.value=[],b.value=void 0}finally{t.value=!1,s.value=!1}})():r.value=[]})),{show:n,selected:b,showWarning:u,warningType:p,loading:t,loadingUpdate:s,listStatus:r,isSignedContract:_,reviewed:y,showNotesWarning:k,notes:S,showNotes:w,handleSave:()=>{var a,l,i,t,s,n,d,o,c,m,g,v,h,y,k;if((null==(a=b.value)?void 0:a.id)===(null==(l=e.status)?void 0:l.id)||!e.quoteId)return;if(9001===(null==(i=e.status)?void 0:i.id)&&9e3===(null==(t=b.value)?void 0:t.id)||9e3===(null==(s=e.status)?void 0:s.id)&&9001===(null==(n=b.value)?void 0:n.id))return p.value=9e3===(null==(d=e.status)?void 0:d.id)&&9001===(null==(o=b.value)?void 0:o.id)?0:1,void(u.value=!0);if(f.value&&[9003,9004].includes(null==(c=e.status)?void 0:c.id)&&[9e3,9001,9002,2].includes(null==(m=b.value)?void 0:m.id))return p.value=1,void(u.value=!0);if(_&&9e3!==(null==(g=b.value)?void 0:g.id)&&9001!==(null==(v=b.value)?void 0:v.id))return void x();const S=[...r.value].slice(0,r.value.findIndex((a=>{var l;return a.id===(null==(l=e.status)?void 0:l.id)}))).some((e=>{var a;return e.id===(null==(a=b.value)?void 0:a.id)}))&&(null==(h=e.order)?void 0:h.is_signature_exist)||[9004,3].includes(null==(y=e.status)?void 0:y.id)&&![9004,3].includes(null==(k=b.value)?void 0:k.id);p.value=S?0:1,u.value=!0},handleCancelUpdate:()=>{u.value=!1,p.value=0},handleUpdateStatus:x,handleSelectStatus:e=>{e.active||e.disabled||(b.value=e,r.value=r.value.map((e=>o(d({},e),{active:b.value.id===e.id}))))}}}}),me={key:0,class:"border-grey-01 border"},ge=["onClick"],ve={key:0,class:"my-0 border-grey-01"},he={class:"flex items-center justify-end"},be={key:0,class:"flex flex-col gap-6 items-center my-6"},_e={class:"flex flex-wrap items-center justify-center gap-14"},fe={key:1,class:"flex flex-col gap-6 items-center my-6"},ye={class:"flex flex-wrap items-center justify-center gap-14"};const ke=r({name:"BulkQuoteDetailStatus",components:{Button:F,BulkQuoteDetailFormStatus:W(ce,[["render",function(e,a,l,i,t,s){const n=b("Tooltip"),d=b("Fieldset"),o=b("Button"),u=b("Modal"),p=b("BuybackNotesWarning"),r=_("loading");return f(),y("div",null,[e.showWarning?$("",!0):(f(),k(u,{key:0,modelValue:e.show,"onUpdate:modelValue":a[0]||(a[0]=a=>e.show=a),title:"Update Status",size:"xs",class:""},{default:S((()=>[w((f(),k(d,{class:"rounded-md"},{label:S((()=>a[4]||(a[4]=[x("Choose Status")]))),default:S((()=>{var l;return[(null==(l=e.listStatus)?void 0:l.length)?(f(),y("ul",me,[(f(!0),y(C,null,V(e.listStatus,((l,i)=>(f(),y("li",{key:i},[L("div",{class:I(["px-2 py-1.5 text-center",!l.disabled&&!l.active&&!e.loadingUpdate&&"hover:bg-teal-01 hover:bg-opacity-50 cursor-pointer text-grey-02",!l.disabled&&!!l.active&&!e.loadingUpdate&&"bg-teal-02 bg-opacity-40 cursor-pointer",(!!l.disabled||!!e.loadingUpdate)&&"bg-teal-01 bg-opacity-30 cursor-not-allowed text-grey-01"]),onClick:a=>e.handleSelectStatus(l)},[U(n,{placement:"top",disabled:!l.disabled},{content:S((()=>a[5]||(a[5]=[L("div",null,[L("p",null,"Quote must be signed first to unlock this status")],-1)]))),default:S((()=>[L("p",null,N(l.status_name),1)])),_:2},1032,["disabled"])],10,ge),i!==e.listStatus.length-1?(f(),y("hr",ve)):$("",!0)])))),128))])):$("",!0)]})),_:1})),[[r,e.loading]])])),footer:S((()=>{var l,i;return[L("div",he,[U(o,{color:"teal",disabled:!e.selected||(null==(l=e.selected)?void 0:l.id)==(null==(i=e.status)?void 0:i.id),loading:e.loadingUpdate,onClick:e.handleSave},{default:S((()=>a[6]||(a[6]=[x(" Update Status ")]))),_:1},8,["disabled","loading","onClick"])])]})),_:1},8,["modelValue"])),U(u,{modelValue:e.showWarning,"onUpdate:modelValue":a[3]||(a[3]=a=>e.showWarning=a),class:I(e.showNotesWarning&&"hidden"),size:"xs","hide-header":"","hide-footer":""},{default:S((()=>[0==e.warningType?(f(),y("div",be,[a[8]||(a[8]=L("img",{src:z},null,-1)),a[9]||(a[9]=L("h6",{class:"text-3xl font-medium"},"Proceed With Quote?",-1)),a[10]||(a[10]=L("p",{class:"text-grey-02 text-center"}," Ensure the payout is correct, then make sure to send the Customer Portal link to the customer for contract access and review. ",-1)),L("div",_e,[L("a",{href:"",onClick:a[1]||(a[1]=j(((...a)=>e.handleCancelUpdate&&e.handleCancelUpdate(...a)),["prevent"])),class:"px-6 py-4 hover:text-teal-03"}," Cancel "),U(o,{loading:e.loading,color:"teal",onClick:e.handleUpdateStatus},{default:S((()=>a[7]||(a[7]=[x(" Yes, proceed ")]))),_:1},8,["loading","onClick"])])])):$("",!0),1==e.warningType?(f(),y("div",fe,[a[12]||(a[12]=L("img",{src:z},null,-1)),a[13]||(a[13]=L("h6",{class:"text-3xl font-medium"},"Change Status?",-1)),a[14]||(a[14]=L("p",{class:"text-grey-02 text-center"}," Your reconciled quantity will be reset to the original quoted quantity. ",-1)),L("div",ye,[U(o,{loading:e.loading,color:"teal",onClick:e.handleUpdateStatus},{default:S((()=>a[11]||(a[11]=[x(" Yes, change status ")]))),_:1},8,["loading","onClick"]),L("a",{href:"",onClick:a[2]||(a[2]=j(((...a)=>e.handleCancelUpdate&&e.handleCancelUpdate(...a)),["prevent"])),class:"px-6 py-4 hover:text-teal-03"}," Cancel ")])])):$("",!0)])),_:1},8,["modelValue","class"]),U(p,{onProceed:e.handleUpdateStatus},null,8,["onProceed"])])}]])},props:{status:{type:Object,default:()=>({id:null,name:null,short_name:null})},statusNameKey:{type:String,default:"name"},statusShortNameKey:{type:String,default:"short_name"},statusIdKey:{type:String,default:"id"},loading:{type:Boolean,default:!1},quoteId:{type:String,required:!0},disabled:{type:Boolean,default:!1},order:{type:Object,default:void 0}},emits:["updateStatus"],setup(e,{emit:a}){const{statuses:l,loading:i,getQuoteStatuses:t,updateQuoteStatus:s}=u(),n=m(!1),d=g((()=>({id:e.status[e.statusIdKey]||"",name:e.status[e.statusNameKey]||"Quote Status",short_name:e.status[e.statusShortNameKey]||"Quote Status"})));return O((async()=>{await t()})),{modalFormUpdateStatus:n,currentStatus:d,loadingQuoteStatus:i,handleUpdateStatus:async(e=!1)=>{n.value=!0},handleConfirmUpdateStatus:()=>{n.value=!1,a("updateStatus",!0)}}}}),Se={class:"flex flex-wrap items-center gap-4"},we={class:"quote-status"},xe={class:"quote-status__status"},Ce={class:"quote-status__status-badge"},Ve={class:"block"},Le=["disabled"];var Ie=W(ke,[["render",function(e,a,l,i,t,s){const n=b("BulkQuoteDetailFormStatus"),d=_("loading");return f(),y("div",null,[L("div",Se,[a[3]||(a[3]=L("label",{class:"font-medium"},"Status:",-1)),w((f(),y("div",we,[L("div",xe,[L("div",Ce,[L("span",Ve,N(e.currentStatus.short_name),1)])]),L("button",{class:I(["quote-status__action",e.disabled&&"quote-status__action--disabled"]),onClick:a[0]||(a[0]=(...a)=>e.handleUpdateStatus&&e.handleUpdateStatus(...a)),disabled:e.disabled,tabindex:"0"},a[2]||(a[2]=[L("i",{class:"material-icons"},"edit",-1)]),10,Le)])),[[d,e.loadingQuoteStatus||e.loading]])]),U(n,{modelValue:e.modalFormUpdateStatus,"onUpdate:modelValue":a[1]||(a[1]=a=>e.modalFormUpdateStatus=a),quoteId:e.quoteId,status:e.currentStatus,order:e.order,onUpdateStatus:e.handleConfirmUpdateStatus},null,8,["modelValue","quoteId","status","order","onUpdateStatus"])])}],["__scopeId","data-v-6eb997e4"]]);const Ue={class:"space-y-4"},Ne={key:0,class:"flex-width"},$e={key:1,class:"flex-width",style:{"min-width":"80px"}},je={key:0},Oe={key:0},qe={key:1},Be={key:1,class:"w-10"},Ke=["onClick"],Te=["onMouseenter","onMouseleave"],Pe={__name:"BuybackShippingKitDownload",props:{id:"-",shippings:{type:Array,default:()=>[]}},setup(e){const a=c(),l=re(),i=e,t=m([]),s=m([{key:"order_shipping_label",column_name:"Label",meta:{}},{key:"shipping_tracking",column_name:"Tracking Number",meta:{}},{key:"shipping_label_status",column_name:"Label Status",meta:{}},{key:"action",column_name:"",meta:{}}]),n=g((()=>{var e;return null!=(e=null==i?void 0:i.shippings)?e:[]}));v(n,(e=>{e&&e.length>0&&q((()=>{t.value=[...e]}))}),{immediate:!0}),v((()=>l.shippingKit.modal),(e=>{e&&n.value.length>0&&q((()=>{t.value=[...n.value]}))}));const d=g((()=>{var e,l,i;return null==(i=null==(l=null==(e=a.state)?void 0:e.shipping)?void 0:l.processing)?void 0:i.loadingDownload})),o=()=>{l.shippingKit.modal=!1},u=async()=>{await E(l.shippingKit,(async()=>{await l.$downloadBulkShippingKit({id:i.id,params:{order_shipping_label_id:n.value.map((e=>e.order_shipping_label))}}).then((()=>{h({message:"Download in progress... Feel free to navigate away or close the window",type:"info"}),a.dispatch("notification/closeNotification","NotificationShippingKitDownload",{root:!0}),a.commit("shipping/SET_PROCESSING_DOWNLOAD_SHIPPING_KIT_PROGRESS",{progress:1,path:null,type:"zip",loading:!0},{root:!0}),a.commit("notification/OPEN_NOTIFICATION","NotificationShippingKitDownload",{root:!0}),a.commit("notification/SET_NOTIFICATION_CLOSABLE",{name:"NotificationShippingKitDownload",closable:!1},{root:!0})}))}))};return(e,a)=>{const p=_("loading");return f(),k(Q,{modelValue:T(l).shippingKit.modal,"onUpdate:modelValue":a[1]||(a[1]=e=>T(l).shippingKit.modal=e),size:"md","hide-footer":"",onClose:o},{header:S((()=>a[2]||(a[2]=[L("h5",{class:"text-2xl font-medium"}," Shipping Kit Download ",-1)]))),default:S((()=>[w((f(),y("div",Ue,[U(B,{name:"fade"},{default:S((()=>{var e;return[w(U(F,{view:"outlined",color:"teal",dense:"",onClick:u},{default:S((()=>a[3]||(a[3]=[L("div",{class:"flex items-center justify-center gap-x-4"},[L("span",{class:"material-icons"}," print "),L("span",null,"Bulk Download Shipping Kit")],-1)]))),_:1},512),[[K,!!(null==(e=t.value)?void 0:e.length)]])]})),_:1}),U(ee,{selected:t.value,"onUpdate:selected":a[0]||(a[0]=e=>t.value=e),headers:s.value,items:n.value,"item-value":"order_shipping_label",selectable:n.value.length>1},{header:S((({header:e})=>["action"!==e.key?(f(),y("th",Ne,N(e.column_name),1)):(f(),y("th",$e,N(e.column_name),1))])),column:S((({row:e,key:t,preventRowClick:s,resetRowClick:n})=>["shipping_label_status"===t?(f(),y("td",je,[(null==e?void 0:e.shipping_tracking)?(f(),y("span",Oe,N("Available"))):(f(),y("span",qe,N("Unavailable")))])):"action"===t?(f(),y("td",Be,[L("a",{class:I(d.value?"opacity-50 cursor-not-allowed":"opacity-100"),color:"white",onClick:j((a=>(async e=>{await E(l.shippingKit,(async()=>{await l.$downloadShippingKit({id:i.id,params:{order_shipping_label_id:e.order_shipping_label}}).then((e=>{M(e)}))}))})(e)),["prevent"])},a[4]||(a[4]=[L("span",{class:"material-icons"}," print ",-1)]),10,Ke)])):(f(),y("td",{key:2,onMouseenter:s,onMouseleave:n},N(e[t]),41,Te))])),_:1},8,["selected","headers","items","selectable"])])),[[p,T(l).shippingKit.isLoading]])])),_:1},8,["modelValue"])}}};var Ae="/assets/show-original.c4e04b0d.svg";const De=r({name:"ShippingLabelInfo",components:{Input:R,InputPhone:oe},props:{data:{type:Object,default:()=>({shipping_firstname:null,shipping_lastname:null,shipping_address1:null,shipping_suite:"",shipping_city:null,shipping_country:null,shipping_state:null,shipping_zip:null,shipping_phone:null,shipping_address_text:null,company_name:null,custom_fields:null})},isEasyOffer:{type:Boolean,default:!1}},emits:["update:data"],setup(e,{emit:a}){const l=P(e.data),i=m(null);Object.assign(l,{valid:l.shipping_address_text&&""!==l.shipping_address_text&&null!==l.shipping_address_text});const t={shipping_firstname:{required:ne},shipping_lastname:{required:ne},shipping_phone:{required:ne,invalidNumber:le.withMessage("Phone number is invalid",(()=>{var e;return!l.shipping_phone||(null==(e=i.value)?void 0:e.isValid)}))},valid:{sameAs:de}},s=ae(t,l,{$lazy:!0});return v((()=>d({},l)),(()=>{a("update:data",l)})),{phoneNumber:G,data:l,refInputPhone:i,validation:s,validate:()=>(s.value.$validate(),!s.value.$invalid),address:{valid:"valid",route:"shipping_address1",locality:"shipping_city",administrative_area_level_1:"shipping_state",formatted_address:"shipping_address_text",postal_code:"shipping_zip",country:"shipping_country",disallowCustomAddress:!0,subpremise:"shipping_suite"}}}}),Qe={class:"grid grid-cols-2 gap-6"},Fe={key:0,class:"col-span-2"},We={class:"col-span-2"},ze={class:"col-span-2"},Ee={class:"col-span-2"};var Me=W(De,[["render",function(e,a,l,i,t,s){const n=b("Input"),d=b("InputPhone"),o=_("gmap");return f(),y("div",Qe,[L("div",null,[U(n,{modelValue:e.data.shipping_firstname,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.shipping_firstname=a),label:"First Name",block:"",view:e.validation.shipping_firstname.$invalid?"danger":"default"},null,8,["modelValue","view"]),(f(!0),y(C,null,V(e.validation.shipping_firstname.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),L("div",null,[U(n,{modelValue:e.data.shipping_lastname,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.shipping_lastname=a),label:"Last Name",block:""},null,8,["modelValue"]),(f(!0),y(C,null,V(e.validation.shipping_lastname.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),e.isEasyOffer?(f(),y("div",Fe,[U(n,{modelValue:e.data.company_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.company_name=a),label:"Company Name",block:""},null,8,["modelValue"])])):$("",!0),L("div",We,[w(U(n,{modelValue:e.data.shipping_address_text,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.shipping_address_text=a),label:"Street Address",block:""},null,8,["modelValue"]),[[o,e.address]]),a[6]||(a[6]=L("small",null,"Street address, P.O box, company name, c/o.",-1)),(f(!0),y(C,null,V(e.validation.valid.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),L("div",ze,[U(n,{modelValue:e.data.shipping_suite,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.shipping_suite=a),block:""},null,8,["modelValue"]),a[7]||(a[7]=L("small",null,"Apartment, suite, unit, building, floor, etc.",-1))]),L("div",Ee,[U(d,{ref:"refInputPhone",modelValue:e.data.shipping_phone,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.shipping_phone=a),label:"Phone",block:"","country-autofill-setting":""},null,8,["modelValue"]),(f(!0),y(C,null,V(e.validation.shipping_phone.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),e.data.custom_fields&&e.isEasyOffer?(f(!0),y(C,{key:1},V(Object.entries(e.data.custom_fields),(([a,l])=>(f(),y("div",{key:a,class:"col-span-2"},[U(n,{modelValue:e.data.custom_fields[a],"onUpdate:modelValue":l=>e.data.custom_fields[a]=l,label:a,block:""},null,8,["modelValue","onUpdate:modelValue","label"])])))),128)):$("",!0)])}]]);const Re={key:0,class:"border border-grey-01 rounded-xl p-6 w-full mb-6"},Ge={class:"space-y-4"},Ye={class:"flex items-center justify-between"},He={class:"font-medium text-xl"},Je={class:"grid grid-cols-2 gap-4"},Xe={class:"flex items-end gap-x-1"},Ze={class:"grid grid-cols-2 gap-4"},ea={class:"flex items-end gap-x-1"},aa={class:"flex justify-between"},la={class:"text-grey-02"},ia={class:"text-grey-02"},ta={class:"mx-auto"},sa={class:"text-grey-02"},na={__name:"BuybackShippingInformation",props:{id:"-",shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},regenerateShippingLabel:{type:Function,default:()=>{}}},emits:["saved"],setup(e,{emit:a}){const l=re(),i=e,t=a,s=m({}),n=m(i.shippings),u=()=>{l.shippingInfo.modal=!1,s.value={},n.value={}};return v((()=>i.shippings),(e=>{e&&e.length>0&&(n.value=e.map((e=>o(d({},e),{isLoading:!1}))))}),{deep:!0,immediate:!0}),v((()=>l.shippingInfo.modal),(()=>{l.shippingInfo.modal?n.value=i.shippings.map((e=>o(d({},e),{isLoading:!1}))):n.value=[]})),(a,d)=>(f(),k(Q,{modelValue:T(l).shippingInfo.modal,"onUpdate:modelValue":d[0]||(d[0]=e=>T(l).shippingInfo.modal=e),size:"sm","hide-footer":"",onClose:u},{header:S((()=>d[1]||(d[1]=[L("h5",{class:"text-2xl font-medium"}," Shipping Information ",-1)]))),default:S((()=>["1"!==e.shippingLabelStatus?(f(),y("div",Re,[d[3]||(d[3]=L("div",{class:"flex items-center gap-2 mb-4"},[L("i",{class:"material-icons text-red-base icon-md"},"warning"),L("p",{class:"text-2xl font-bold"},"Regenerate Shiping Label")],-1)),d[4]||(d[4]=L("p",null,"Shipping label fails to generates. Once the root cause is resolved, you can use this option to regenerate both the shipping label and shipping kit. Once regenerated, the new tracking number and shipping kit will be automatically attached to the offer. ",-1)),U(F,{class:"btn btn-teal btn-outlined mt-6",rounded:"",dense:"",onClick:e.regenerateShippingLabel},{default:S((()=>d[2]||(d[2]=[L("div",{class:"flex items-center gap-2 px-2 py-1"},[L("i",{class:"material-icons text-base"},"refresh"),L("span",{class:"font-medium"},"Regenerate Shiping Label")],-1)]))),_:1},8,["onClick"])])):$("",!0),L("div",Ge,[(f(!0),y(C,null,V(n.value,((e,a)=>(f(),y("div",{key:a,class:"border border-grey-01 rounded-xl p-5 space-y-4"},[L("div",Ye,[L("h5",He,N(`Shipping Label ${e.order_shipping_label}`),1),U(F,{disabled:!(null==e?void 0:e.custom_tracking)||!(null==e?void 0:e.custom_tracking.length),loading:e.isLoading,view:"outlined",color:"teal",dense:"",onClick:a=>(async e=>{var a,n,d,o;if(e.isLoading=!0,await E(l.shippingInfo,(()=>l.$actionCheckCustomTracking(e.shipping_tracking).then((e=>{const[a]=e;s.value=a})).catch((()=>{s.value={}})))),(null==(a=s.value)?void 0:a.courier_code)&&(null==(n=s.value)?void 0:n.courier_name)){const a={id:i.id,data:{order_shipping_label_id:e.order_shipping_label,shipping_tracking:e.custom_tracking,courier_code:null==(d=null==s?void 0:s.value)?void 0:d.courier_code,courier_name:null==(o=null==s?void 0:s.value)?void 0:o.courier_name,force_courier_code:0}};await E(l.shippingInfo,(()=>l.$actionSaveCustomTracking(a).then((()=>{t("saved"),u()})).catch((()=>{s.value={}}))))}e.isLoading=!1})(e)},{default:S((()=>d[5]||(d[5]=[x(" Save ")]))),_:2},1032,["disabled","loading","onClick"])]),L("div",Je,[L("div",Xe,[U(R,{modelValue:e.shipping_tracking,"onUpdate:modelValue":a=>e.shipping_tracking=a,disabled:"",block:""},{label:S((()=>d[6]||(d[6]=[L("span",{class:"font-medium"}," Tracking Number ",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue"]),U(F,{color:"teal",view:"outlined",icon:"",class:"btn-action w-16",style:{paddingRight:0,paddingLeft:0},onClick:a=>T(ue)(null==e?void 0:e.shipping_tracking)},{default:S((()=>d[7]||(d[7]=[L("span",{class:"material-icons"},"content_copy",-1)]))),_:2},1032,["onClick"])]),L("div",Ze,[L("div",ea,[U(R,{modelValue:e.shipping_tracking,"onUpdate:modelValue":a=>e.shipping_tracking=a,disabled:"",block:""},{label:S((()=>d[8]||(d[8]=[L("span",{class:"font-medium"}," Tracking Number ",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue"]),U(F,{color:"teal",view:"outlined",icon:"",class:"btn-action w-16",style:{paddingRight:0,paddingLeft:0},onClick:a=>T(ue)(null==e?void 0:e.shipping_tracking)},{default:S((()=>d[9]||(d[9]=[L("span",{class:"material-icons"},"content_copy",-1)]))),_:2},1032,["onClick"])]),L("div",null,[U(R,{modelValue:e.custom_tracking,"onUpdate:modelValue":a=>e.custom_tracking=a,disabled:e.isLoading,block:""},{label:S((()=>d[10]||(d[10]=[L("span",{class:"font-medium"}," Custom Tracking Number ",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),L("div",aa,[L("div",null,[d[11]||(d[11]=L("p",{class:"block font-medium"},"Date Created",-1)),L("span",la,N(null==e?void 0:e.created_at),1)]),L("div",null,[d[12]||(d[12]=L("p",{class:"block font-medium"},"Label Status",-1)),L("span",ia,N(e.shipping_label_status?"Available":"Unavailable"),1)])]),L("div",ta,[d[13]||(d[13]=L("p",{class:"block font-medium"},"Shipment Status",-1)),L("span",sa,N(e.shipping_status_summary||"No Shipping Information"),1)])])])])))),128))])])),_:1},8,["modelValue"]))}},da={class:"space-y-8"},oa={class:"space-y-6"},ua={key:0,class:"text-grey-02 text-xs"},pa={key:1,class:"text-red-04 text-xs"},ra={key:0},ca={rows:"8",class:"block w-full border border-grey-01 rounded-md px-4 py-4 text-grey-02"},ma={class:"space-y-6"},ga={class:"space-y-2"},va={class:"flex items-center justify-between gap-4"},ha={__name:"BuybackShippingAdditional",props:{id:"-",total:0,shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},offerType:{type:String,default:"Mail-In"}},emits:["created","failed"],setup(e,{emit:a}){const l=re(),i=e,t=a,s=pe(),n=P({add_shipping_label_number:1}),u=m({is_enable_multiple_label:0,label_qty:1}),p=g((()=>n.add_shipping_label_number>=4?3:n.add_shipping_label_number>1?n.add_shipping_label_number:1)),r=g((()=>{var e,a;return null!=(a=null==(e=null==i?void 0:i.shippings[0])?void 0:e.shipping_tracking)?a:"e.g., 10000000000000000"})),c=g((()=>{var e;const a=I.value<0,l=n.add_shipping_label_number<=0,i=0==(null==(e=u.value)?void 0:e.is_enable_multiple_label)&&n.add_shipping_label_number>1;return a||i||l})),b=g((()=>{var e,a,l,t;return(null!=(a=null==(e=null==u?void 0:u.value)?void 0:e.label_qty)?a:1)-(null!=(t=null==(l=i.shippings)?void 0:l.length)?t:1)})),_=g((()=>({add_shipping_label_number:{required:ie,minValue:te(1),maxValue:se(b.value)}}))),w=ae(_,n,{$lazy:!0}),I=g((()=>b.value-n.add_shipping_label_number)),j=e=>{var a;const l=Number(null==(a=null==e?void 0:e.target)?void 0:a.value),i=Number(b.value);l<=0?n.add_shipping_label_number=1:l>i&&(n.add_shipping_label_number=i)},O=async()=>{await w.value.$validate()},q=()=>{n.add_shipping_label_number=1,l.additionalShipping.modal=!1,w.value.$reset()},B=async()=>{await w.value.$validate()&&await E(l.additionalShipping,(async()=>{await l.$createMultipleLabels({id:i.id,data:n}).then((()=>{var e,a;h({message:null==(a=null==(e=l.additionalShipping)?void 0:e.result)?void 0:a.message,type:"info"}),t("created"),q()})).catch((()=>{t("failed")}))}))};return v((()=>l.additionalShipping.modal),(async e=>{e&&(l.additionalShipping.isLoading=!0,await s.actionAll(!0,(e=>{var a,l,t,s,n;const p=null!=(l=null==(a=e.param)?void 0:a.shipping_rules_multiple_label)?l:[];if(p.length){const a=p.find((e=>e.offer_type===i.offerType));u.value=o(d({},null!=a?a:{}),{is_enable_multiple_label:Number(null!=(s=null==(t=null==e?void 0:e.param)?void 0:t.is_enable_multiple_label)?s:0),label_qty:null!=(n=Number(null==a?void 0:a.label_qty))?n:1})}else u.value={is_enable_multiple_label:0,label_qty:1}})),l.additionalShipping.isLoading=!1)})),(a,i)=>(f(),k(Q,{modelValue:T(l).additionalShipping.modal,"onUpdate:modelValue":i[1]||(i[1]=e=>T(l).additionalShipping.modal=e),size:"xs",onClose:q},{header:S((()=>i[2]||(i[2]=[L("h5",{class:"text-2xl font-medium"}," Additional Shipping Info ",-1)]))),default:S((()=>{var a,t,s;return[L("div",da,[U(Y,{color:"blue",view:"smooth",dense:""},{default:S((()=>i[3]||(i[3]=[L("div",{class:"flex items-center gap-x-4"},[L("span",{class:"material-icons",style:{"line-height":"1"}},"info"),L("p",null,"Labels will be created using the first shipping data")],-1)]))),_:1}),L("div",oa,[L("div",null,[U(R,{modelValue:n.add_shipping_label_number,"onUpdate:modelValue":i[0]||(i[0]=e=>n.add_shipping_label_number=e),disabled:T(l).additionalShipping.isLoading,view:T(w).add_shipping_label_number.$error?"danger":"default",type:"number",block:"",ltr:"",onInput:O,onChange:j},{label:S((()=>i[4]||(i[4]=[L("span",{class:"font-medium"},"Number of Additional Labels",-1)]))),_:1},8,["modelValue","disabled","view"]),L("p",null,[(f(!0),y(C,null,V(T(w).add_shipping_label_number.$errors,((e,a)=>(f(),y("small",{key:a,class:"text-red-04"},N(e.$message),1)))),128))]),T(w).add_shipping_label_number.$error||(null==(t=null==(a=T(l))?void 0:a.additionalShipping)?void 0:t.isLoading)?$("",!0):(f(),y(C,{key:0},[I.value>0?(f(),y("small",ua,N(I.value)+" "+N(I.value>1?"labels":"label")+" left to generate. ",1)):(f(),y("small",pa,N("Has reached maximum limit")))],64))]),1==e.shippingLabelStatus?(f(),y("div",ra,[L("div",ca,[L("div",ma,[i[7]||(i[7]=L("h6",{class:"font-medium text-lg text-grey-04"},"Preview:",-1)),L("div",ga,[L("div",null,[i[5]||(i[5]=L("span",{class:"font-medium text-grey-04"},"Base Tracking:",-1)),x(" "+N(null!=(s=r.value)?s:"-"),1)]),i[6]||(i[6]=L("p",null,"New labels will have tracking numbers like:",-1)),L("div",null,[(f(!0),y(C,null,V(p.value,(e=>(f(),y("p",{key:e},N(r.value?`${r.value}-${e}`:`-${e}`)+" "+N(p.value===e&&p.value>1?".etc":""),1)))),128))])])])])])):$("",!0)])])]})),footer:S((()=>[L("div",va,[U(F,{disabled:T(l).additionalShipping.isLoading,color:"white",onClick:q},{default:S((()=>i[8]||(i[8]=[x(" Cancel ")]))),_:1},8,["disabled"]),U(F,{disabled:T(l).additionalShipping.isLoading||c.value,loading:T(l).additionalShipping.isLoading,color:"teal",onClick:B},{default:S((()=>i[9]||(i[9]=[x(" Create Labels ")]))),_:1},8,["disabled","loading"])])])),_:1},8,["modelValue"]))}},ba={__name:"BuybackShippingOptions",props:{id:"-",multiple:!1,total:0,shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},regenerateShippingLabel:{type:Function,default:()=>{}}},emits:["succeed","failed"],setup(e,{emit:a}){const l=A(),i=re(),t=e,s=a,n=g((()=>{var e,a;return(null==(e=null==l?void 0:l.name)?void 0:e.toLowerCase().includes("bulkquote"))?"Bulk Offer":(null==(a=null==l?void 0:l.name)?void 0:a.toLowerCase().includes("easyoffer"))?"Easy Offer":"Mail-In"})),d=e=>{1==e?i.shippingInfo.modal=!0:2==e&&(i.additionalShipping.modal=!0)},o=()=>{s("succeed")},u=()=>{s("failed")},p=()=>{s("succeed")};return(e,a)=>{const l=b("DropdownItem"),i=b("DropdownMenu"),s=b("Dropdown");return f(),y(C,null,[U(s,{trigger:"click",placement:"bottom-end","hide-on-click":"",onCommand:d},{dropdown:S((()=>[U(i,null,{default:S((()=>[U(l,{command:"1"},{default:S((()=>a[1]||(a[1]=[L("div",{class:"flex items-center gap-2 text-base"},[L("span",{class:"material-icons"},"local_shipping"),x(" Shipping Information ")],-1)]))),_:1}),U(l,{command:"2"},{default:S((()=>a[2]||(a[2]=[L("div",{class:"flex items-center gap-2 text-base"},[L("span",{class:"material-icons"},"add"),x(" Additional Shipping Label ")],-1)]))),_:1})])),_:1})])),default:S((()=>[U(F,{color:"teal",view:"outlined",dense:"",icon:"",class:"btn-action"},{default:S((()=>a[0]||(a[0]=[L("span",{class:"material-icons"},"more_horiz",-1)]))),_:1})])),_:1}),U(na,{id:t.id,shippings:t.shippings,shippingLabelStatus:t.shippingLabelStatus,regenerateShippingLabel:t.regenerateShippingLabel,onSaved:p},null,8,["id","shippings","shippingLabelStatus","regenerateShippingLabel"]),U(ha,{id:t.id,total:t.total,shippings:t.shippings,shippingLabelStatus:t.shippingLabelStatus,"offer-type":n.value,onCreated:o,onFailed:u},null,8,["id","total","shippings","shippingLabelStatus","offer-type"])],64)}}};var _a="/assets/no-item.d2e9bfac.svg",fa="/assets/data-match-icon.5fe238bc.svg";export{Ie as B,Me as S,Pe as _,Ae as a,ba as b,_a as c,fa as d,re as u};
