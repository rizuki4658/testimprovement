{"version":3,"file":"index.58da00b6.js","sources":["../../src/views/setting/manage-location/edit/index.vue"],"sourcesContent":["<template>\n  <div>\n    <Modal v-model=\"isShow\" :title=\"modalTitle\" @close=\"handleCloseLocation\">\n      <div class=\"grid grid-cols-1\">\n        <ManageLocationForm\n          ref=\"refComponent\"\n          :data=\"data\"\n          :is-mailin-available=\"hasActiveMailinLocation\"\n          edit\n        />\n      </div>\n      <template #footer>\n        <div class=\"flex justify-between\">\n          <Button @click=\"handleCloseLocation\" color=\"white\" class=\"btn-white--borderless\">\n            Cancel\n          </Button>\n          <Button\n            color=\"teal\"\n            :loading=\"loading.form || loadingLocation?.all\"\n            :disabled=\"hasEmptyRequiredField\"\n            @click=\"updateLocation\"\n          >\n            Save Changes\n          </Button>\n        </div>\n      </template>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { defineComponent, inject, ref, onMounted, computed } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useStore } from 'vuex'\nimport { useManageLocationForm } from 'composable/setting'\nimport { useLocations } from 'composable/dashboard'\nimport { storeLocationSymbols } from 'composable/location'\nimport Button from 'bbUi/components/button/button.vue'\nimport Modal from 'bbUi/components/modal/modal.vue'\nimport Breadcrumb from 'components/Breadcrumb.vue'\nimport ManageLocationForm from 'components/ManageLocation/Form.vue'\n\nexport default defineComponent({\n  components: {\n    Button,\n    Modal,\n    ManageLocationForm,\n    Breadcrumb\n  },\n  async setup() {\n    const store = useStore()\n    const route = useRoute()\n    const router = useRouter()\n    const { data, loading, actionShow, actionUpdate } = useManageLocationForm()\n    const { locations } = useLocations()\n    const refComponent = ref(null)\n    const isShow = ref(false)\n\n    const breadcrumb = ref([\n      {\n        text: 'Settings',\n        to: {\n          name: 'setting'\n        }\n      },\n      {\n        text: 'Manage Locations',\n        to: {\n          name: 'settingManageLocation'\n        }\n      },\n      {\n        text: route.query['switch-mailin']\n          ? 'Edit Mail-in Location'\n          : 'Edit Location'\n      }\n    ])\n\n    const isSwitchMailinLocation = computed(\n      () => !!route.query['switch-mailin']\n    )\n    const modalTitle = computed(() =>\n      isSwitchMailinLocation.value ? 'Edit Mail-in Location' : 'Edit Location'\n    )\n    const hasActiveMailinLocation = computed(\n      () =>\n        store.state.setting.manageLocation.all?.mailin_location\n          ?.is_enable_mailin == 1\n    )\n    const hasEmptyRequiredField = computed(\n      () => refComponent.value?.hasEmptyRequiredField\n    )\n\n    const actionLocation = inject(storeLocationSymbols.actionAll)\n    const loadingLocation = inject(storeLocationSymbols.loading)\n\n    const updateLocation = async () => {\n      if (refComponent.value.validate()) {\n        await actionUpdate(route.params.locationId, async () => {\n          await Promise.all([\n            actionLocation(store.state.user.me.id),\n            locations(() => {}, store.state.user.me.id)\n          ])\n\n          if (isSwitchMailinLocation.value) {\n            router.push({\n              name: 'settingManageLocation',\n              query: {\n                'switch-mailin': 1\n              }\n            })\n            return\n          }\n          router.push({\n            name: 'settingManageLocation'\n          })\n        })\n      }\n    }\n    const handleCloseLocation = async () =>\n      router.push({ name: 'settingManageLocation' })\n\n    onMounted(() => {\n      isShow.value = true\n      if (isSwitchMailinLocation.value) {\n        Object.assign(data, {\n          name: 'Mail-in',\n          is_mailin: 1\n        })\n      }\n    })\n\n    await actionShow({\n      id: route.params.locationId,\n      is_store: 1\n    })\n\n    return {\n      data,\n      loading,\n      loadingLocation,\n      breadcrumb,\n      refComponent,\n      isShow,\n      modalTitle,\n      isSwitchMailinLocation,\n      hasActiveMailinLocation,\n      hasEmptyRequiredField,\n      updateLocation,\n      handleCloseLocation\n    }\n  }\n})\n</script>\n"],"names":["_sfc_main","defineComponent","components","Button","Modal","ManageLocationForm","Breadcrumb","[object Object]","store","useStore","route","useRoute","router","useRouter","data","loading","actionShow","actionUpdate","useManageLocationForm","locations","useLocations","refComponent","ref","isShow","breadcrumb","text","to","name","query","isSwitchMailinLocation","computed","modalTitle","value","hasActiveMailinLocation","_b","_a","state","setting","manageLocation","all","mailin_location","is_enable_mailin","hasEmptyRequiredField","actionLocation","inject","storeLocationSymbols","actionAll","loadingLocation","onMounted","Object","assign","is_mailin","id","params","locationId","is_store","updateLocation","async","validate","Promise","user","me","push","switch-mailin","handleCloseLocation","_hoisted_1","class","_openBlock","_createElementBlock","onUpdate:modelValue","_cache","$event","_ctx","title","footer","_withCtx","_hoisted_2","_createVNode","_component_Button","onClick","color","form","disabled","default","_component_ManageLocationForm","is-mailin-available"],"mappings":"6oBA0CA,MAAKA,EAAaC,EAAa,CAC7BC,WAAY,CACVC,OAAAA,QACAC,EACAC,mBAAAA,EACAC,WAAAA,GAAAC,cAGA,MAAMC,EAAQC,IACRC,EAAQC,IACRC,EAASC,KACTC,KAAEA,EAAAC,QAAMA,EAASC,WAAAA,EAAAC,aAAYA,GAAiBC,KAC9CC,UAAEA,GAAcC,IAChBC,EAAeC,EAAI,MACnBC,EAASD,GAAI,GAEbE,EAAaF,EAAI,CACrB,CACEG,KAAM,WACNC,GAAI,CACFC,KAAM,YAGV,CACEF,KAAM,mBACNC,GAAI,CACFC,KAAM,0BAGV,CACEF,KAAMf,EAAMkB,MAAM,iBACd,wBACA,mBAIFC,EAAyBC,GAC7B,MAAQpB,EAAMkB,MAAM,mBAEhBG,EAAaD,GAAS,IAC1BD,EAAuBG,MAAQ,wBAA0B,kBAErDC,EAA0BH,GAC9B,aACE,OACwB,IADxB,OAAAI,EAAA,OAAAC,EAAA3B,EAAM4B,MAAMC,QAAQC,eAAeC,UAAK,EAAAJ,EAAAK,0BACpCC,qBAEFC,EAAwBZ,GAC5B,WAAM,OAAA,OAAAK,EAAAd,EAAaW,YAAO,EAAAG,EAAAO,yBAGtBC,EAAiBC,EAAOC,EAAqBC,WAC7CC,EAAkBH,EAAOC,EAAqB9B,SA2C7C,OAfPiC,GAAU,KACRzB,EAAOS,OAAQ,EACXH,EAAuBG,OACzBiB,OAAOC,OAAOpC,EAAM,CAClBa,KAAM,UACNwB,UAAW,aAKXnC,EAAW,CACfoC,GAAI1C,EAAM2C,OAAOC,WACjBC,SAAU,IAGL,CACLzC,KAAAA,EACAC,QAAAA,EACAgC,gBAAAA,EACAvB,WAAAA,EACAH,aAAAA,EACAE,OAAAA,EACAQ,WAAAA,EACAF,uBAAAA,EACAI,wBAAAA,EACAS,sBAAAA,EACAc,eApDqBC,UACjBpC,EAAaW,MAAM0B,kBACfzC,EAAaP,EAAM2C,OAAOC,YAAYG,gBACpCE,QAAQpB,IAAI,CAChBI,EAAenC,EAAM4B,MAAMwB,KAAKC,GAAGT,IACnCjC,GAAU,QAAUX,EAAM4B,MAAMwB,KAAKC,GAAGT,MAGtCvB,EAAuBG,MACzBpB,EAAOkD,KAAK,CACVnC,KAAM,wBACNC,MAAO,CACLmC,gBAAiB,KAKvBnD,EAAOkD,KAAK,CACVnC,KAAM,8BAmCZqC,oBA9B0BP,SAC1B7C,EAAOkD,KAAK,CAAEnC,KAAM,8BA5GbsC,EAAA,CAAAC,MAAM,2JAcPC,OAAAA,IAAAC,EAAA,MAAA,KAAA,KAxBc,qBAAGC,sBAAiBC,EAAA,OAAA,GAAAC,GAAAC,EAAAjD,OAAAgD,GAAGE,MAAKD,EAAqBzC,0CAS1D,CACT2C,OAAAC,GAAA,oBAGW,MAAAC,EAAA,CAFAC,EAA0BC,EAAA,CAAEC,QAAaP,EAAAR,oBAACgB,MAAM,uDAEzDV,EAAA,OAAA,GAAA,wBAQS,EAAA,CAAA,YANPO,EAAYC,EAAA,CACXE,MAAO,OACPjE,UAA+BA,QAAAkE,OAAA,OAAA9C,EAAAqC,EAAAzB,sBAAA,EAAAZ,EAAAI,KAC/B2C,SAAqBV,EAAA9B,gEAGxB4B,EAAA,OAAA,GAAA,wEApBJa,QAAAR,GAAA,OAMI,MAAAV,EAAA,CAJAY,EAAkBO,EAAA,CACjB9D,mBACAR,KAAA0D,EAAA1D,KACDuE,sBAAIb,EAAAvC"}