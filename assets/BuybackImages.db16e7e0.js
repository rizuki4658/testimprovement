import{j as e,_ as a,a5 as t,W as s,m as i,$ as o,o as r,n as l,w as n,A as c,B as d,D as u,t as m,a1 as p,a2 as h,ap as g,F as f,ar as y}from"./vendor.9695fe57.js";import{z as w}from"./index.35a87af4.js";import{C as b}from"./card.85454cb1.js";import{L as v}from"./LoadingCard.fae900cb.js";import{M as I}from"./MultipleInputFile.8e270ece.js";const $=e("buybackImages",{state:()=>({routeParams:null,isLoading:!1,images:[]}),getters:{},actions:{setRoute(e={}){this.routeParams=e},async $getImages(e){var a,t;this.isLoading=!0,this.images=[];try{const s=await w({url:`/v1/pos/order/picture/${null==(t=null==(a=this.routeParams)?void 0:a.params)?void 0:t.buybackId}`,method:"get",params:e});Object.keys(s).forEach((e=>{this.images=[...this.images,...s[e]]}))}catch(s){console.error("Failed to fetch pictures",s)}finally{this.isLoading=!1}},async $uploadImage(e){this.isLoading=!0;try{await w({url:`/v1/pos/order/picture/${this.routeParams.params.buybackId}`,method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}}),a({message:"Picture uploaded!",type:"success"})}catch(t){console.error("Failed to upload pictures",t)}finally{this.isLoading=!1}},async $deleteImage(e){this.isLoading=!0;try{await w({url:`/v1/pos/order/picture/${e}`,method:"post",data:{_method:"DELETE"}}),a({message:"Picture deleted!",type:"success"})}catch(t){console.error("Failed to upload pictures",t)}finally{this.isLoading=!1}}}}),k={class:"flex items-center gap-2"},L={class:"w-full flex flex-wrap justify-center"},x=["onClick"],j=["alt","src","onClick"],_={__name:"BuybackImages",setup(e){const a=t(),w=$();w.setRoute(a);const _=async e=>{if(!(null==e?void 0:e.length))return;const a=new FormData;for(let[t,s]of Object.entries(e))a.append(`picture_files[${t}]`,s);await w.$uploadImage(a),await w.$getImages()};return s((async()=>{await w.$getImages()})),(e,a)=>{const t=i("Tooltip"),s=o("loading");return r(),l(y,null,{default:n((()=>[c((r(),l(b,null,{header:n((()=>[d("div",k,[a[2]||(a[2]=d("h6",null,"Share Files with Customer",-1)),u(t,{placement:"right"},{content:n((()=>a[0]||(a[0]=[d("div",null,[d("p",{class:"mb-2"},"Upload or drag a file here to share with the customer for the following statuses:"),d("ul",{class:"list-disc pl-4 space-y-1"},[d("li",null,"ON HOLD (General or Activation Lock) or Not As Described."),d("li",{class:"list-none"},"File must be uploaded before changing the status."),d("li",{class:"list-none"},"Once the status is updated and a note is added, the customer will be notified and can view the details in their Customer Portal.")])],-1)]))),default:n((()=>[a[1]||(a[1]=d("span",{class:"material-icons cursor-default"},"info",-1))])),_:1})])])),default:n((()=>[u(I,{preview:"",onInput:_},{preview:n((()=>[d("div",L,[(r(!0),m(p,null,h(g(w).images,((e,t)=>(r(),m("div",{class:f(["m-4 relative transition duration-200","transform hover:scale-105 cursor-pointer"]),key:t},[d("div",{class:f(["absolute top-0 right-0","bg-teal-04 w-1 h-1 p-4","box-content flex items-center","justify-center transform -translate-x-2","-translate-y-1/2 rounded-full font-semibold","text-white hover:bg-white hover:text-teal-04","transition duration-200 cursor-pointer"]),onClick:a=>(async e=>{await w.$deleteImage(e),await w.$getImages()})(e.id)},a[3]||(a[3]=[d("i",{class:"material-icons text-lg"},"close",-1)]),8,x),d("img",{alt:`picture-${t}`,src:e.picture,class:"rounded-md",onClick:a=>{var t;(t=e.picture)&&window.open(t,"_blank")}},null,8,j)])))),128))])])),_:1})])),_:1})),[[s,g(w).isLoading]])])),fallback:n((()=>[u(v)])),_:1})}}};export{_ as default};
