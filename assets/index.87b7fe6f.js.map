{"version":3,"file":"index.87b7fe6f.js","sources":["../../src/components/EmailTemplate/TimeDelay/index.vue"],"sourcesContent":["<template>\n  <div>\n    <Fieldset class=\"rounded-lg\">\n      <template #label>Trigger Settings</template>\n      <div class=\"space-y-8\">\n        <div>\n          <div class=\"flex items-center gap-x-2\">\n            <label>How many triggers do you want to set?</label>\n            <Tooltip placement=\"top\">\n              <template #content>\n                <div>\n                  <p>\n                    Choose how many notifications you want to send.\n                  </p>\n                  <ul class=\"list-disc pl-5 mt-2 space-y-1\">\n                    <li>1 trigger sends a single notification.</li>\n                    <li>2 or 3 triggers send follow-up notifications at the intervals you set.</li>\n                  </ul>\n                </div>\n              </template>\n              <i class=\"text-teal-04 material-icons cursor-pointer\">info</i>\n            </Tooltip>\n          </div>\n          <div class=\"w-56\">\n            <RadioGroup\n              v-model=\"localSendingTimes\"\n              class=\"radio--full\">\n              <RadioButton \n                v-for=\"num in ['1', '2', '3']\" \n                :key=\"num\" \n                :label=\"num\">\n                {{ num }}\n              </RadioButton>\n            </RadioGroup>\n          </div>\n        </div>\n\n        <div v-if=\"localSendingTimes > 0\">\n          <div class=\"p-4 border border-grey-01 rounded-lg mb-2\">\n            <div class=\"flex items-center gap-x-2 mb-4\">\n              <label class=\"font-semibold\">Time Delay</label>\n              <Tooltip placement=\"top\">\n                <template #content>\n                  <div style=\"width: 400px;\">\n                    <p>\n                      Notifications are sent based on the intervals you specify (e.g., X days or X hours), starting from the moment the offer status is met.\n                    </p>\n                  </div>\n                </template>\n                <i class=\"text-teal-04 material-icons cursor-pointer\">info</i>\n              </Tooltip>\n            </div>\n            <div class=\"grid sm:grid-cols-3 md:grid-cols-2 xl:grid-cols-3 gap-4\">\n              <div v-for=\"index in localSendingTimes\" :key=\"index\">\n                <label>{{ getTriggerLabel(index) }}</label>\n                <div class=\"flex gap-x-2\">\n                  <Input\n                    v-model.number=\"localTimesJson[index - 1].times_value\"\n                    type=\"number\"\n                    min=\"1\"\n                    :disabled=\"localTimesJson[index - 1].type === 'immediately'\"\n                    style=\"max-width: 60px;\"\n                    @update:modelValue=\"updateTriggerValue(index - 1)\"\n                  />\n                  <Select\n                    v-model=\"localTimesJson[index - 1].type\"\n                    :items=\"timeDelayOptions\"\n                    by=\"value\"\n                    name=\"name\"\n                    no-border\n                    class=\"flex-1\"\n                    @update:modelValue=\"updateTriggerType(index - 1)\"\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Fieldset>\n  </div>\n</template>\n\n<script>\nimport { computed, defineComponent, ref, watch } from 'vue'\nimport Select from 'bbUi/components/select/select.vue'\nimport Input from 'bbUi/components/input/input.vue'\nimport Fieldset from 'bbUi/components/fieldset/fieldset.vue'\n\nexport default defineComponent({\n  name: 'EmailTemplateTimeDelay',\n  components: {\n    Fieldset,\n    Select,\n    Input,\n  },\n  props: {\n    sendingTimes: {\n      type: Number,\n      default: 0,\n      validator: (value) => value >= 0 && value <= 3\n    },\n    sendingTimesJson: {\n      type: Array,\n      default: () => []\n    },\n    isWorkflow: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['update:sendingTimes', 'update:sendingTimesJson'],\n  setup(props, { emit }) {\n    const timeDelayOptions = computed(() => {\n      return props.isWorkflow\n        ? [\n          { name: 'Immediately', value: 'immediately' },\n          { name: 'Day', value: 'day' },\n          { name: 'Hour', value: 'hour' },\n        ] : [\n          { name: 'Day', value: 'day' },\n          { name: 'Hour', value: 'hour' },\n        ]\n    })\n\n    const fullStateTimesJson = ref([\n      { times_value: 1, type: 'day' },\n      { times_value: 1, type: 'day' },\n      { times_value: 1, type: 'day' }\n    ])\n    \n    const localTimesJson = ref([])\n\n    function initializeTimesJson() {\n      props.sendingTimesJson.forEach((item, index) => {\n        fullStateTimesJson.value[index] = { ...item }\n      })\n      updateTimesJson(props.sendingTimes)\n    }\n\n    watch(() => props.sendingTimesJson, (newValue) => {\n      if (newValue.length > 0) {\n        const isDifferent = !arraysEqual(newValue, fullStateTimesJson.value)\n        if (isDifferent) {\n          newValue.forEach((item, index) => {\n            fullStateTimesJson.value[index] = { ...item }\n          })\n          updateTimesJson(props.sendingTimes)\n        }\n      }\n    }, { deep: true })\n\n    watch(() => props.sendingTimes, (newValue) => {\n      updateTimesJson(newValue)\n    })\n\n    const localSendingTimes = computed({\n      get: () => props.sendingTimes,\n      set: (value) => {\n        const numValue = Number(value)\n        if (numValue !== props.sendingTimes) {\n          emit('update:sendingTimes', numValue)\n          updateTimesJson(numValue)\n        }\n      }\n    })\n\n    function updateTimesJson(count) {\n      const newTimesJson = fullStateTimesJson.value.slice(0, count)\n      if (!arraysEqual(newTimesJson, localTimesJson.value)) {\n        localTimesJson.value = newTimesJson\n        emit('update:sendingTimesJson', newTimesJson)\n      }\n    }\n\n    function getTriggerLabel(index) {\n      const suffixes = ['st', 'nd', 'rd']\n      return `${index}${suffixes[index - 1] || 'th'} Trigger Time Delay`\n    }\n\n    function updateTriggerValue(index) {\n      const updatedValue = { ...localTimesJson.value[index] }\n      updatedValue.times_value = Number(updatedValue.times_value)\n      \n      if (updatedValue.times_value !== fullStateTimesJson.value[index].times_value) {\n        fullStateTimesJson.value[index] = updatedValue\n        emit('update:sendingTimesJson', [...localTimesJson.value])\n      }\n    }\n\n    function updateTriggerType(index) {\n      if (localTimesJson.value[index].type === 'immediately') {\n        localTimesJson.value[index].times_value = null\n      } else if (!localTimesJson.value[index].times_value) {\n        localTimesJson.value[index].times_value = 1\n      }\n\n      if (localTimesJson.value[index].type !== fullStateTimesJson.value[index].type) {\n        fullStateTimesJson.value[index] = { ...localTimesJson.value[index] }\n        emit('update:sendingTimesJson', [...localTimesJson.value])\n      }\n    }\n\n    function arraysEqual(a, b) {\n      if (a.length !== b.length) return false\n      for (let i = 0; i < a.length; i++) {\n        if (JSON.stringify(a[i]) !== JSON.stringify(b[i])) return false\n      }\n      return true\n    }\n\n    initializeTimesJson()\n\n    return {\n      localSendingTimes,\n      localTimesJson,\n      timeDelayOptions,\n      getTriggerLabel,\n      updateTriggerValue,\n      updateTriggerType\n    }\n  }\n})\n</script>"],"names":["_sfc_main","defineComponent","name","components","Fieldset","Select","Input","props","sendingTimes","type","Number","default","validator","value","sendingTimesJson","Array","isWorkflow","Boolean","emits","[object Object]","emit","timeDelayOptions","computed","fullStateTimesJson","ref","times_value","localTimesJson","watch","newValue","length","arraysEqual","forEach","item","index","__spreadValues","updateTimesJson","deep","localSendingTimes","get","set","numValue","count","newTimesJson","slice","a","b","i","JSON","stringify","getTriggerLabel","updateTriggerValue","updatedValue","updateTriggerType","_hoisted_1","class","_hoisted_2","_hoisted_4","key","_hoisted_5","_hoisted_6","_hoisted_7","_openBlock","_createElementBlock","_createVNode","_cache","_withCtx","_createElementVNode","placement","_hoisted_3","onUpdate:modelValue","$event","_ctx","_Fragment","_renderList","num","_component_RadioButton","width","_toDisplayString","_hoisted_8","modelValue","modelModifiers","number","min","disabled","items","by","no-border"],"mappings":"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"}