var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,o=(e,o)=>{for(var d in o||(o={}))t.call(o,d)&&s(e,d,o[d]);if(a)for(var d of a(o))l.call(o,d)&&s(e,d,o[d]);return e};import{u as d}from"./components.3d07dc59.js";import{F as i}from"./setting.ec7e7a35.js";import{k as n,r,f as c,m,o as u,t as p,B as f,D as v,a1 as g,a2 as y,K as x,n as b,w,I as k,a0 as h,O as _,y as C,$ as V,A as S,U as j,_ as O}from"./vendor.9695fe57.js";import{C as $}from"./card.afeb5d7a.js";import{f as M,b as P,_ as T,P as U,j as I,r as B,ac as E,g as K}from"./index.9c4dcead.js";import{S as A}from"./select.399034f1.js";import{B as D}from"./Breadcrumb.faa47922.js";import{u as F}from"./index.f40e4a9e.js";import{r as L}from"./index.54844a74.js";import"./LoadingCard.ab052f4a.js";import"./breadcrumb.bd47f77c.js";import"./index.6b6f6369.js";const q=n({name:"Company",components:{Input:M,Button:P},props:{data:{type:Object,default:()=>({description:"",keywords:[],title:""})}},emits:["data-changed"],setup(e,{emit:a}){const t=r(e.data),l={description:{},title:{required:L},keywords:{}},s=c(""),o=F(l,t,{$lazy:!0}),d=()=>{a("data-changed")};return{data:t,validation:o,keywords:s,validate:()=>(o.value.$validate(),!o.value.$invalid),removeKeyword:e=>{d(),t.keywords.splice(e,1)},addKeyword:()=>{s.value&&t.keywords.push(s.value),d(),s.value=""},dataChanged:d}}}),z={class:"grid grid-cols-3 gap-4"},J={class:"col-span-1"},N={class:"col-span-2 col-start-1"},R={class:"col-span-1 col-start-1"},G={class:"border border-grey-01 p-4 rounded"},H=["onClick"],Q={class:"flex flex-row items-center mt-4"};const W=n({components:{Card:$,Input:M,Select:A,Button:P,Breadcrumb:D,Pagination:U,SeoFormV2:T(q,[["render",function(e,a,t,l,s,o){const d=m("Input"),i=m("Button");return u(),p("div",z,[f("div",J,[v(d,{modelValue:e.data.title,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.title=a),view:e.validation.title.$invalid?"danger":"default",type:"text",label:"Title*",onInput:e.dataChanged,block:""},null,8,["modelValue","view","onInput"]),(u(!0),p(g,null,y(e.validation.title.$errors,((e,a)=>(u(),p("small",{class:"text-red-base mt-2 block",key:a},x(e.$message)+". ",1)))),128))]),f("div",N,[v(d,{modelValue:e.data.description,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.description=a),view:e.validation.description.$invalid?"danger":"default",type:"textarea",label:"Description",onInput:e.dataChanged,block:""},null,8,["modelValue","view","onInput"]),(u(!0),p(g,null,y(e.validation.description.$errors,((e,a)=>(u(),p("small",{class:"text-red-base mt-2 block",key:a},x(e.$message)+". ",1)))),128))]),f("div",R,[a[3]||(a[3]=f("span",{class:"font-bold block mb-1"},"Keyword",-1)),f("div",G,[(u(!0),p(g,null,y(e.data.keywords,((a,t)=>(u(),b(i,{key:t,class:"mr-2 my-2",color:"grey",view:"smooth",dense:""},{default:w((()=>[k(x(a)+" ",1),f("i",{onClick:a=>e.removeKeyword(t),class:"material-icons text-lg ml-1"},"close",8,H)])),_:2},1024)))),128)),f("div",Q,[v(d,{modelValue:e.keywords,"onUpdate:modelValue":a[2]||(a[2]=a=>e.keywords=a),onKeyup:h(e.addKeyword,["enter"]),block:""},null,8,["modelValue","onKeyup"])])])])])}]]),Alert:I},async setup(e,{emit:a}){const{state:t,stateV2:l,data:s,loading:d,actionAll:n,actionAllV2:m,actionDelete:u,actionUpdate:p}=i(),f=_(),v=c(null),g=c(null),y=r({description:"",keywords:[],title:"",name:"",index:null});await Promise.all([n(),m()]);const x=c([]),b=()=>{var e;x.value=Object.entries(B(l.value)).map(((e,a)=>{const t=E(e[0].replace("meta_","")).split(" ").join("");return o({index:`meta_${t.toLowerCase()}`,name:t,value:e[0],is_save:!0},e[1])})),x.value=[(e=x.value).find((e=>"meta_category"===e.index)),e.find((e=>"meta_brand"===e.index)),e.find((e=>"meta_device"===e.index)),e.find((e=>"meta_model"===e.index))]};b();const w=K((async()=>{x.value=x.value.map((e=>e.index===y.index?(e.is_save=!1,e.keywords=y.keywords,e.title=y.title,e.description=y.description,e):e)),await k()}),700),k=async()=>{if(!v.value.validate())return;const e=g.value.value;await p({[`${e}_description`]:y.description,[`${e}_keywords`]:JSON.stringify(y.keywords),[`${e}_title`]:y.title},(async()=>{O({type:"success",message:"SEO meta updated!"}),await m(),b(),g.value=x.value.find((e=>e.index===y.index)),x.value.find((e=>e.index===y.index)).is_save=!0}))};return C((()=>({search:s.search})),(()=>{s.page=1})),C((()=>o({},s)),K((async()=>{await n()}),300),{deep:!0}),{state:t,stateV2:l,data:s,refSeoFormV2:v,selectedMeta:g,metaPayload:y,mapSeoV2:x,changeMeta:()=>{y.description=g.value.description,y.keywords=g.value.keywords||[],y.title=g.value.title,y.name=g.value.name,y.index=`meta_${g.value.name.toLowerCase()}`},copyText:e=>{navigator.clipboard.writeText(e).then((()=>{O({type:"success",message:"Text copied to clipboard"})}))},loading:d,dataChanged:w,breadcrumb:[{text:"Settings",to:{name:"setting"}},{text:"SEO"}],router:f,editMeta:e=>{f.push({name:"settingSeoEdit",params:{id:e}})},updateMetaV2:k,deleteMeta:async e=>{await u(e,(async()=>{O({type:"success",message:"SEO updated!"}),await n()}))}}}}),X={class:"flex xl:flex-row flex-col justify-between mb-8"},Y={class:"flex flex-col mt-4 mb-4"},Z={class:"flex flex-row 2xl:flex-nowrap xl:flex-nowrap lg:flex-nowrap flex-wrap"},ee={class:"flex-grow md:mr-3 md:mb-0 mb-3"},ae={class:"flex flex-col"},te={class:"flex items-center justify-center lg:opacity-0 group-hover:opacity-100 transition-opacity"},le={class:"flex"},se={class:"mr-2"},oe=["onClick"];var de=T(W,[["render",function(e,a,t,l,s,o){const d=m("Breadcrumb"),i=m("Button"),n=m("Input"),r=m("Alert"),c=m("TableColumn"),y=m("Table"),h=m("Pagination"),_=m("Card"),C=m("Select"),O=m("SeoFormV2"),$=V("loading");return u(),p(g,null,[f("div",X,[v(d,{pageTitle:"SEO",backTo:{name:"setting"},items:e.breadcrumb},null,8,["items"]),v(i,{color:"teal",view:"smooth",to:{name:"settingSeoCreate"},link:""},{default:w((()=>a[5]||(a[5]=[f("i",{class:"material-icons text-lg"},"add",-1),k(" Add Meta Page")]))),_:1})]),S((u(),b(_,null,{default:w((()=>[f("div",Y,[f("div",Z,[f("div",ee,[v(n,{modelValue:e.data.search,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.search=a),placeholder:"Search everything",class:"w-full",icon:""},{icon:w((()=>a[6]||(a[6]=[f("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue"])])])]),v(r,{color:"orange",view:"smooth",dense:"",class:"mb-5"},{left:w((()=>a[7]||(a[7]=[f("span",{class:"material-icons text-4xl"},"info",-1)]))),default:w((()=>[a[8]||(a[8]=f("div",{class:"flex items-center h-full"},[f("p",{class:"text-lg"}," These will override any SEO rules made in the page structure rules below ")],-1))])),_:1}),f("div",ae,[S((u(),b(y,{data:e.state.data},{default:w((()=>[v(c,{prop:"title",label:"Title"}),v(c,{prop:"url",label:"Url"}),v(c,{label:""},{default:w((t=>[f("div",te,[v(i,{onClick:a=>e.editMeta(t.row.id),view:"smooth",color:"blue",class:"mx-2",dense:""},{default:w((()=>a[9]||(a[9]=[f("span",{class:"material-icons text-xl"},"edit",-1)]))),_:2},1032,["onClick"]),v(i,{onClick:a=>e.deleteMeta(t.row.id),loading:e.loading.delete[t.row.id],view:"smooth",color:"red",class:"mx-2",dense:""},{default:w((()=>a[10]||(a[10]=[f("span",{class:"material-icons text-xl"},"delete",-1)]))),_:2},1032,["onClick","loading"])])])),_:1})])),_:1},8,["data"])),[[$,e.loading.all]]),v(h,{page:e.data.page,"onUpdate:page":a[1]||(a[1]=a=>e.data.page=a),limit:e.data.limit,"onUpdate:limit":a[2]||(a[2]=a=>e.data.limit=a),data:e.state},null,8,["page","limit","data"])])])),_:1})),[[$,e.loading.all]]),v(_,{class:"mt-6"},{default:w((()=>[a[11]||(a[11]=f("div",{class:"font-semibold mb-1"}," Page Structure SEO Rules ",-1)),v(C,{modelValue:e.selectedMeta,"onUpdate:modelValue":a[3]||(a[3]=a=>e.selectedMeta=a),class:"mb-4 w-56",items:e.mapSeoV2,name:"name",onChange:e.changeMeta},null,8,["modelValue","items","onChange"]),e.selectedMeta?(u(),b(O,{key:0,data:e.metaPayload,"onUpdate:data":a[4]||(a[4]=a=>e.metaPayload=a),ref:"refSeoFormV2",onDataChanged:e.dataChanged},null,8,["data","onDataChanged"])):j("",!0),e.selectedMeta?(u(),b(y,{key:1,class:"mt-4",data:e.stateV2[e.selectedMeta.value].short_code},{default:w((()=>[v(c,{label:"Code"},{default:w((a=>[f("div",le,[f("span",se,x(a.row.code),1),f("i",{class:"material-symbols-outlined text-lg text-teal-04",onClick:t=>e.copyText(a.row.code)},"content_copy",8,oe)])])),_:1}),v(c,{prop:"description",label:"Description"})])),_:1},8,["data"])):j("",!0)])),_:1})],64)}]]),ie=n({setup(){const{genSuspense:e}=d();return()=>e(de)}});export{ie as default};
