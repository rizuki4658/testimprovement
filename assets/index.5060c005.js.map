{"version":3,"file":"index.5060c005.js","sources":["../../src/views/setting/bulk-price-editor/index.vue","../../src/views/setting/bulk-price-editor/index.js"],"sourcesContent":["<template>\n  <div>\n    <div class=\"flex justify-between items-center mb-8\">\n      <Breadcrumb pageTitle=\"Price Editor\" :backTo=\"{ name: 'setting' }\" :items=\"breadcrumb\" />\n    </div>\n    <Card>\n        <div class=\"flex items-stretch mb-2\">\n          <Tab ref=\"tabElement\" class=\"categories-tab w-full\" :items=\"categoryList\">\n            <template #title=\"scope\">\n              <div v-if=\"scope.item?.image\" class=\"svg-load h-8 w-8 mr-4 bg-teal-04\" :style=\"`-webkit-mask-image: url('${scope.item?.image}')`\"></div>\n              {{scope.item.name}}\n            </template>\n          </Tab>\n          <!-- <Popover v-if=\"isLimit\" :visible=\"isShowCategoryDropdown\" :width=\"180\"> -->\n          <Popover v-if=\"isLimit\" :visible=\"isShowCategoryDropdown\" :width=\"180\">\n            <template #default>\n              <div style=\"max-height: 500px; overflow-y: auto; overflow-x: hidden\">\n                <div v-for=\"(item, itemIndex) of moreCategoryList\" @click=\"handleSelectSubCategoryDropdownItem(item.to)\" :key=\"itemIndex\" class=\"flex items-center px-3 py-4 cursor-pointer hover:bg-grey-lighten text-left\" style=\"word-break: break-word\">\n                  <div class=\"svg-load h-10 w-10 mr-4 bg-teal-04\" :style=\"`-webkit-mask-image: url('${item?.image}')`\"></div>\n                  <span class=\"w-full\">{{item.name}}</span>\n                </div>\n              </div>\n            </template>\n            <template #reference>\n              <div v-outside=\"handleClickOutsideDropdown\" @click=\"isShowCategoryDropdown = !isShowCategoryDropdown\" class=\"flex items-center justify-center w-full max-w-max px-4 bg-grey-01 overflow-hidden cursor-pointer\">\n                <span class=\"whitespace-nowrap mr-2\">{{isActiveItemOnMoreCategory && currentActiveCategory ? currentActiveCategory?.name : 'More Categories'}}</span>\n                <i class=\"material-icons\">arrow_drop_down</i>\n              </div>\n            </template>\n          </Popover>\n        </div>\n        <router-view v-if=\"tab.length > 0\" />\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { defineComponent, ref, computed, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useCategories } from 'composable/pricing'\nimport Card from 'bbUi/components/card/card.vue'\nimport Tab from 'bbUi/components/tab/tab.vue'\nimport Breadcrumb from 'components/Breadcrumb.vue'\nimport Button from 'bbUi/components/button/button.vue'\n\nexport default defineComponent({\n  components: {\n    Card,\n    Tab,\n    Breadcrumb,\n    Button\n  },\n  async setup() {\n    const { actionCategories, stateCategories } = useCategories()\n    const router = useRouter()\n    const route = useRoute()\n    const isShowCategoryDropdown = ref(false)\n    const tab = ref([])\n    const tabElement = ref(null)\n\n    const breadcrumb = [{\n      text: 'Settings',\n      to: {\n        name: 'setting'\n      }\n    }, {\n      text: 'Price Editor'\n    }]\n\n    const limitItemNumber = computed(() => {\n      let sumWidth = 0\n      let limitIndex = 0\n      if(!tabElement.value) return 0\n      for(let [itemIndex, item] of Object.entries(Array.from(tabElement.value.$el.children))){\n        const itemStyle = window.getComputedStyle(item)\n        if(sumWidth > tabElement.value.$el.offsetWidth) break\n        sumWidth += parseFloat(itemStyle.width) + parseFloat(itemStyle.marginRight) + parseFloat(itemStyle.marginLeft) + 1\n        limitIndex = itemIndex\n      }\n      return limitIndex\n    })\n    const isLimit = computed(() => limitItemNumber.value < tab.value.length-1)\n    const categoryList = computed(() => limitCategories(0, isLimit.value ? limitItemNumber.value : 0))\n    const moreCategoryList = computed(() => limitCategories(limitItemNumber.value, tab.value.length))\n    const isActiveItemOnMoreCategory = computed(() => moreCategoryList.value.map(category => category.to.params.tab).includes(route.params.tab))\n    const currentActiveCategory = computed(() => tab.value.find(tab => tab.to.params.tab === route.params.tab) || null)\n    const limitCategories = (fromIndex, toIndex) => {\n      if(toIndex === 0) return tab.value\n      if(fromIndex < tab.value.length) return tab.value.slice(fromIndex, toIndex)\n      return tab.value \n    }\n    const handleSelectSubCategoryDropdownItem = (to) => {\n      if(!!to) router.push(to)\n      isShowCategoryDropdown.value = false\n    }\n    const handleClickOutsideDropdown = () => isShowCategoryDropdown.value = false\n    const showIntercom = () => {\n      window.CustomerSupport.use('show')\n    }\n\n    await actionCategories(() => {\n      if (Array.isArray(stateCategories.value)) {\n        tab.value = stateCategories.value\n          .map((category, i) => {\n            return {\n              id: i,\n              to: {\n                name: 'settingBulkPriceEditorTab',\n                params: {\n                  tab: category.name ? category.name.toLowerCase() : 'gadgets'\n                }\n              },\n              ...category\n            }\n          })\n          .filter((value) => value != undefined)\n\n        const isNotEmptyCategories = categoryList.value.length > 0\n        const isEmptyCategoryRoute = !route.params.tab\n        if (isNotEmptyCategories && isEmptyCategoryRoute)\n          router.push({\n          ...categoryList.value[0].to,\n          query: route.query\n        })\n      }\n    })\n\n    watch(() => JSON.stringify(route.params), (val) => {\n      if (val === '{}') router.push({\n        name: 'setting'\n      })\n    })\n\n    return {\n      route,\n      tab,\n      tabElement,\n      breadcrumb,\n      limitItemNumber,\n      isLimit,\n      isShowCategoryDropdown,\n      isActiveItemOnMoreCategory,\n      currentActiveCategory,\n      limitCategories,\n      categoryList,\n      moreCategoryList,\n      handleSelectSubCategoryDropdownItem,\n      handleClickOutsideDropdown,\n      showIntercom\n    }\n  }\n})\n</script>\n<style lang=\"scss\" scoped>\n.categories-tab{\n  margin: 0 !important\n}\n.svg-load{\n  -webkit-mask-size: contain; \n  -webkit-mask-position: center; \n  -webkit-mask-repeat: no-repeat;\n}\n</style>","import { defineComponent } from 'vue'\nimport { useSuspense } from 'composable/components'\nimport index from './index.vue'\n\nexport default defineComponent({\n  setup() {\n    const { genSuspense } = useSuspense()\n\n    return () => genSuspense(index)\n  }\n})"],"names":["_sfc_main","defineComponent","components","Card","Tab","Breadcrumb","Button","actionCategories","stateCategories","useCategories","router","useRouter","route","useRoute","isShowCategoryDropdown","ref","tab","tabElement","limitItemNumber","computed","sumWidth","limitIndex","value","itemIndex","item","Object","entries","Array","from","$el","children","itemStyle","window","getComputedStyle","offsetWidth","parseFloat","width","marginRight","marginLeft","isLimit","length","categoryList","limitCategories","moreCategoryList","isActiveItemOnMoreCategory","map","category","to","params","includes","currentActiveCategory","find","tab2","fromIndex","toIndex","slice","isArray","i","__spreadValues","id","name","toLowerCase","filter","isNotEmptyCategories","isEmptyCategoryRoute","push","query","watch","JSON","stringify","val","breadcrumb","text","handleSelectSubCategoryDropdownItem","handleClickOutsideDropdown","showIntercom","CustomerSupport","use","_hoisted_1","class","_hoisted_2","_hoisted_4","_hoisted_5","_openBlock","_createElementBlock","_createVNode","_component_Breadcrumb","pageTitle","backTo","default","_withCtx","_component_Tab","scope","key","_createCommentVNode","visible","_ctx","_createElementVNode","_hoisted_3","_Fragment","_renderList","onClick","$event","_cache","_hoisted_6","_toDisplayString","_a","index","[object Object]","genSuspense","useSuspense"],"mappings":"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"}