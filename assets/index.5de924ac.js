var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o,s=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&n(e,l,a[l]);if(o)for(var l of o(a))i.call(a,l)&&n(e,l,a[l]);return e},d=(e,o)=>a(e,l(o));import{u as c}from"./components.0003aa88.js";import{k as r,a5 as u,f as m,W as p,g as v,y,_,m as h,a0 as f,o as b,t as g,D as k,w as C,I as w,B as S,a2 as x,n as I,a1 as L,S as V,U as P,A as j,K as D,a3 as U,N as B,r as F,s as M,O as E,aO as A,L as O,ar as N}from"./vendor.f1efedad.js";import{b as H,c as T,d as R,a as G,e as q,f as $,g as z,h as Q}from"./inventory.1a6b0ea6.js";import{e as K,g as W}from"./setting.2daa7691.js";import{a as J,u as Y,i as X,l as Z}from"./device.a2017acf.js";import{f as ee,b as ae,d as le,u as oe,_ as te,g as ie,j as ne,aj as se,i as de,ac as ce,a5 as re,e as ue,r as me}from"./index.9aa6481b.js";import{F as pe}from"./FormCreate.9d1d27ab.js";import{l as ve,r as ye}from"./dymo.fbcd861f.js";import{P as _e}from"./PrintLabel.d570b4e8.js";import{C as he}from"./card.dfb8e6f7.js";import{_ as fe}from"./fieldset.49a14fc7.js";import{S as be}from"./select.15c77568.js";import{_ as ge}from"./auto-complete.fcac299e.js";import{e as ke}from"./buyback.8c173696.js";import{u as Ce}from"./integration.e60a49c9.js";import{B as we}from"./BSelect.7ebc3354.js";import{P as Se}from"./Info.9c0ebd31.js";import{C as xe}from"./CustomConditionInput.9a53bf28.js";import{u as Ie}from"./index.32689823.js";import{u as Le}from"./golf.1b742650.js";import{A as Ve}from"./Accordion.aa2f77e1.js";import{D as Pe,C as je}from"./DeviceGolfSpec.38b16c28.js";import{_ as De}from"./badge.b59865a3.js";import{B as Ue}from"./Breadcrumb.8dffad84.js";import{_ as Be}from"./changelog.c96fc65d.js";import{_ as Fe}from"./attention-warning.f7b3f9bc.js";import{C as Me}from"./Currency.ae08941b.js";import"./LoadingCard.be59eb97.js";import"./date.f86face7.js";import"./index.05b14cb2.js";import"./BDropdown.7a2c3a7d.js";import"./BBTable.41f49256.js";import"./breadcrumb.296b7b59.js";const Ee=r({components:{Fieldset:fe,Input:ee,BSelect:we,Button:ae,AutoComplete:ge,Modal:le,PhonecheckInfo:Se,CustomConditionInput:xe},props:{isSelected:{type:Boolean,default:!1}},emits:["unset-spec","update-inventory","device-selected:get-spec-data","fetch-inventory"],setup(e,{emit:a}){const{loading:l,actionImeiCheck:o,actionImeiCheckPrint:t}=ke("online"),{openModal:i,modal:n}=H(),{stateEnabledIntegration:c,actionEnabledIntegration:r}=Ce(),{me:h}=oe(),f=u(),{conditionOptions:b,actionGet:g,loading:k,createCustomCondition:C,getConditions:w,actionDelete:S}=K(),{action:x}=J(),I=X,L=Z,{action:V,actionUpdate:P,actionDelete:j}=T(),{unsetData:D}=Y(),U=m({update:{},delete:{}}),B=m(null),F=m(null),M=m(null),E=m(!1),A=m(!1),O=m(null),N=m([]),G=m([]),q=m(null),$=m(null);p((async()=>{if(R.value.product_id){const e=await w({product_id:R.value.product_id});N.value=e.conditions.map((e=>({id:e.id,condition_name:e.name}))),G.value=e.custom_conditions.map((e=>({id:e.id,condition_name:e.name})))}R.value.condition&&(q.value=R.value.condition)})),r();const z=v((()=>h.value.package_id>=4&&1==c.value.is_phonecheck_enable)),Q=Ie({condition:{required:!0}},R,{$lazy:!0}),ee=()=>(Q.value.$validate(),!Q.value.$invalid),ae=ie((async e=>{ne(),await o(f.params.buybackId,{imei:[{id:R.value.id,imei_sn:R.value.imei_sn}],origin:"inventory"}),te()}),500),le=v({get:()=>{var e,a,l,o;return{id:null==(a=null==(e=R)?void 0:e.value)?void 0:a.condition,condition_name:null==(o=null==(l=R)?void 0:l.value)?void 0:o.condition}},set:e=>{R.value.condition=e.id,R.value.condition_name=e.name}}),te=ie((async e=>{await x({q:e})}),500),ne=(e=null)=>{ee()&&a("update-inventory",e)},se=v((()=>0===R.value.condition.length)),de=v((()=>(null==G?void 0:G.value.some((e=>{var a,l,o;return(null==(a=null==e?void 0:e.condition_name)?void 0:a.toLowerCase())===(null==(o=null==(l=R)?void 0:l.value)?void 0:o.condition.toLowerCase())})))||(null==N?void 0:N.value.some((e=>{var a,l,o;return(null==(a=null==e?void 0:e.condition_name)?void 0:a.toLowerCase())===(null==(o=null==(l=R)?void 0:l.value)?void 0:o.condition.toLowerCase())}))))),ce=ie((async e=>{await P(R.value.inventory_more_price[e]),a("fetch-inventory")}),500);return y((()=>R.value.product_id),(async e=>{if(e)try{const a=await w({product_id:e});a&&(N.value=a.conditions.map((e=>({id:e.id,condition_name:e.name}))),G.value=a.custom_conditions.map((e=>({id:e.id,condition_name:e.name}))))}catch(a){console.error("Error fetching conditions:",a)}})),{me:h,data:R,items:I,searchLoading:L,doSearch:te,conditionLoading:k,stateConditions:W,conditionOptions:b,selectDevice:async l=>{if(R.value.name=l.name,R.value.product_id=l.value.product_id,R.value.is_mac=l.value.is_mac,R.value.color_id=null,R.value.color=null,a("unset-spec"),D(!1),1==R.value.is_mac&&a("device-selected:get-spec-data",l.value.product_id),ne(),1===l.value.is_mac)return;if(!e.isSelected)return;const o=await w({product_id:R.value.product_id});o&&(N.value=o.conditions.map((e=>({id:e.id,condition_name:e.name}))),G.value=o.custom_conditions.map((e=>({id:e.id,condition_name:e.name}))))},removeCost:async e=>{U.value.delete[e]=!0;if(!!R.value.inventory_more_price[e].id)return await j(R.value.inventory_more_price[e].id),a("fetch-inventory"),void(U.value.delete[e]=!1);R.value.inventory_more_price.splice(e,1),U.value.delete[e]=!1},inputPrice:(e,a)=>{const l=d(s({},R.value.inventory_more_price[a]),{price:e.target.value});R.value.inventory_more_price[a]=s({},l)},inputNote:(e,a)=>{const l=d(s({},R.value.inventory_more_price[a]),{note:e.target.value});R.value.inventory_more_price[a]=s({},l)},addCost:()=>{const e={id:null,inventory_id:f.params.inventoryId,note:"",price:"",show:!0};R.value.inventory_more_price=[...R.value.inventory_more_price,e]},storeMorePrice:async e=>{R.value.inventory_more_price[e].id?ce(e):R.value.inventory_more_price[e].price&&R.value.inventory_more_price[e].note&&(await V(R.value.inventory_more_price[e]),a("fetch-inventory"))},updateInventory:ne,mapDevices:e=>e.map((e=>({name:e.product_name,value:e}))),modal:n,refPhonecheckInfo:B,PhonecheckInfoData:F,isErrorSelectedPhonecheck:E,viewPhoneCheckData:e=>{F.value=JSON.parse(e.phonecheck_info),M.value=e,i("phonecheck_info")},PhonecheckDevice:M,printPhoneCheck:async e=>{await t(f.params.buybackId,{id:e.id,imei:e.imei_sn,origin:"inventory"})},importPhoneCheck:ae,hasEnablePhonecheck:z,importSinglePhoneCheck:async e=>{var a;let l=[{id:e.id,imei_sn:e.imei_sn}],t=await o(f.params.buybackId,{imei:l,origin:"inventory"});if(0==t.data.length&&1!==(null==t?void 0:t.is_phonecheck_error))return _({message:"IMEI/SN not found",type:"warning"});F.value=null==(a=t.data[0])?void 0:a.info,M.value=e,t.data.length&&!t.is_phonecheck_error?E.value=!1:E.value=!t.is_phonecheck_error||1==t.is_phonecheck_error,i("phonecheck_info")},loading:l,selectCondition:async e=>{R.value.condition=e.condition_name,R.value.condition_name=e.condition_name,q.value=e.condition_name,ne()},selectedCondition:le,isCustomCondition:A,validation:Q,validate:ee,refCustomConditionInput:O,confirmCondition:async()=>{try{await C({condition_name:R.value.condition,condition_term:"[]"}),q.value=R.value.condition,ne();const e=await w({product_id:R.value.product_id});e&&(N.value=e.conditions.map((e=>({id:e.id,condition_name:e.name}))),G.value=e.custom_conditions.map((e=>({id:e.id,condition_name:e.name})))),A.value=!1}catch(e){console.log(e)}},optionConditions:N,optionCustomConditions:G,deleteCustomCondition:async e=>{try{$.value=e,await S(e),G.value=G.value.filter((a=>a.id!==e))}catch(a){console.log(a)}finally{$.value=null}},deleting:$,isEmptyConditionInput:se,isAlreadyExistCondition:de,initialCondition:q}}}),Ae={class:"mx-5 pb-5 space-y-5"},Oe={key:0,class:"flex xl:flex-row flex-col xl:justify-between justify-start xl:items-center items-start"},Ne={class:"w-full mr-6"},He={key:0,src:"https://d18hvo5uozp8li.cloudfront.net/public/images/phonecheck.svg",alt:"",class:"h-4"},Te={class:"w-full flex justify-end"},Re={key:1,class:"block"},Ge={key:0,class:"text-red-base block mt-2"},qe=["onClick"],$e={class:"space-y-3"},ze={class:"flex space-x-5"},Qe={class:"w-1/2"},Ke={class:"w-1/2"},We={class:"w-2/4"},Je={class:"w-full"},Ye={key:0,class:"w-auto"},Xe={class:"grid grid-cols-2 gap-x-5"},Ze={class:"w-full"},ea={class:"modal__content-header-title"};var aa=te(Ee,[["render",function(e,a,l,o,t,i){var n;const s=h("AutoComplete"),d=h("Input"),c=h("Button"),r=h("Popover"),u=h("CustomConditionInput"),m=h("BSelect"),p=h("Fieldset"),v=h("PhonecheckInfo"),y=h("Modal"),_=f("loading");return b(),g(x,null,[k(p,{class:"rounded-md space-y-5"},{label:C((()=>a[24]||(a[24]=[w("Item Details")]))),default:C((()=>{var l,o,t,i;return[S("div",Ae,[S("div",null,[a[25]||(a[25]=S("label",{class:"block"},"Item",-1)),k(s,{placeholder:"Search item",name:"name",value:e.data.name,"item-text":"name","item-value":"value.product_id",items:e.mapDevices(e.items.devices),loading:e.searchLoading.devices,onChange:e.doSearch,onSelect:e.selectDevice,disabled:0!=e.data.status&&5!=e.data.status||e.isSelected},null,8,["value","items","loading","onChange","onSelect","disabled"])]),e.data.imei_required?(b(),g(x,{key:0},[e.hasEnablePhonecheck?(b(),g("div",Oe,[S("div",Ne,[a[26]||(a[26]=S("label",{class:"block"},"IMEI/SN",-1)),"exists"==e.data.phonecheck_status?(b(),I(d,{key:0,modelValue:e.data.imei_sn,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.imei_sn=a),type:"text",class:"mt-2",onInput:a[1]||(a[1]=a=>e.importPhoneCheck()),onKeypress:a[2]||(a[2]=L(V((()=>{}),["prevent"]),["space"])),disabled:e.isSelected,block:"",icon:""},{icon:C((()=>["exists"==e.data.phonecheck_status?(b(),g("img",He)):P("",!0)])),_:1},8,["modelValue","disabled"])):(b(),I(d,{key:1,modelValue:e.data.imei_sn,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.imei_sn=a),type:"text",class:"w-full mt-2",onInput:a[4]||(a[4]=a=>e.importPhoneCheck()),disabled:e.isSelected,block:""},null,8,["modelValue","disabled"]))]),S("div",Te,["exists"==e.data.phonecheck_status?(b(),I(c,{key:0,color:"teal",loading:e.loading.import.has(e.data.id),class:"my-4 xl:mt-12",onClick:a[5]||(a[5]=a=>e.importSinglePhoneCheck(e.data)),dense:""},{default:C((()=>a[27]||(a[27]=[w("View Phonecheck Data")]))),_:1},8,["loading"])):(b(),I(r,{key:1,width:"400",trigger:"hover"},{reference:C((()=>[k(c,{color:"teal",loading:e.loading.import.has(e.data.id),class:"my-4 xl:mt-12",onClick:a[6]||(a[6]=a=>e.importSinglePhoneCheck(e.data)),dense:""},{default:C((()=>a[28]||(a[28]=[w("View Phonecheck Data")]))),_:1},8,["loading"])])),default:C((()=>[a[29]||(a[29]=S("div",{class:"w-full h-full flex justify-center items-center"},[S("span",{class:"whitespace-pre-line"},"IMEI not found")],-1))])),_:1}))])])):(b(),g("div",Re,[a[30]||(a[30]=S("label",{class:"block"},"IMEI/SN",-1)),k(d,{modelValue:e.data.imei_sn,"onUpdate:modelValue":a[7]||(a[7]=a=>e.data.imei_sn=a),type:"text",class:"w-full",onInput:a[8]||(a[8]=a=>e.updateInventory()),onKeypress:a[9]||(a[9]=L(V((()=>{}),["prevent"]),["space"])),disabled:e.isSelected},null,8,["modelValue","disabled"])]))],64)):P("",!0),S("div",null,[a[35]||(a[35]=S("label",{class:"block"},"Condition",-1)),(null==(o=null==(l=e.data)?void 0:l.order_detail)?void 0:o.category_id)||-1!=(null==(i=null==(t=e.data)?void 0:t.order_detail)?void 0:i.product_id)?e.isCustomCondition?(b(),g(x,{key:1},[k(u,{modelValue:e.data.condition,"onUpdate:modelValue":a[11]||(a[11]=a=>e.data.condition=a),disabled:1===e.data.is_mac&&(!e.data.processor_speed||!e.data.memory||!e.data.hard_drive||!e.data.graphics)||e.isSelected,placeholder:"Input condition",onConfirm:e.confirmCondition,onCancel:a[12]||(a[12]=()=>{e.data.condition=e.initialCondition,e.isCustomCondition=!1}),ref:e.refCustomConditionInput,error:e.isEmptyConditionInput||e.isAlreadyExistCondition},null,8,["modelValue","disabled","onConfirm","error"]),e.isEmptyConditionInput||e.isAlreadyExistCondition?(b(),g("small",Ge,D(e.isEmptyConditionInput?"This field is required.":"This custom condition already exists."),1)):P("",!0)],64)):j((b(),I(m,{key:2,modelValue:e.selectedCondition,"onUpdate:modelValue":[a[14]||(a[14]=a=>e.selectedCondition=a),e.selectCondition],"item-name":"condition_name",type:"text",class:"w-full",block:"",placeholder:"Select Condition",items:e.optionConditions,disabled:1===e.data.is_mac&&(!e.data.processor_speed||!e.data.memory||!e.data.hard_drive||!e.data.graphics)||e.isSelected},{prepend:C((()=>a[31]||(a[31]=[S("label",{class:"p-4"},"Active Condition",-1)]))),append:C((({collapse:l})=>[e.optionCustomConditions.length>0?(b(),g(x,{key:0},[a[33]||(a[33]=S("label",{class:"px-5 pt-4 pb-2"},"Saved Custom Condition",-1)),(b(!0),g(x,null,U(e.optionCustomConditions,(o=>(b(),g("div",{key:o.id,class:"group flex items-center justify-between gap-2 pl-6 border-t border-grey-01 p-4 hover:bg-grey-lighten w-full"},[S("p",{onClick:()=>{e.data.condition=o.condition_name,l(),e.updateInventory()},class:"cursor-pointer w-full"},D(o.condition_name),9,qe),k(c,{onClick:a=>e.deleteCustomCondition(o.id),loading:e.deleting==o.id,color:"red",dense:"",view:"smooth",class:"group-hover:opacity-100 opacity-0"},{default:C((()=>a[32]||(a[32]=[S("i",{class:"material-icons"},"delete",-1)]))),_:2},1032,["onClick","loading"])])))),128))],64)):P("",!0),S("button",{onClick:a[13]||(a[13]=()=>{e.isCustomCondition=!0,e.data.condition=""}),class:"flex items-center gap-2 pl-6 border-t border-grey-01 p-4 hover:bg-grey-lighten w-full"},a[34]||(a[34]=[S("i",{class:"material-icons"},"add",-1),w(" Add Custom Condition ")]))])),_:1},8,["modelValue","onUpdate:modelValue","items","disabled"])),[[_,e.conditionLoading.get]]):j((b(),I(d,{key:0,modelValue:e.data.condition,"onUpdate:modelValue":a[10]||(a[10]=a=>e.data.condition=a),type:"text",class:"w-full",block:"",disabled:1===e.data.is_mac&&(!e.data.processor_speed||!e.data.memory||!e.data.hard_drive||!e.data.graphics)||e.isSelected},null,8,["modelValue","disabled"])),[[_,e.conditionLoading.get]])]),S("div",null,[k(d,{modelValue:e.data.notes,"onUpdate:modelValue":a[15]||(a[15]=a=>e.data.notes=a),onInput:a[16]||(a[16]=a=>e.updateInventory("notes")),label:"Notes",type:"textarea",class:"w-full"},null,8,["modelValue"])]),S("div",$e,[S("div",ze,[S("div",Qe,[a[36]||(a[36]=S("label",{class:"block"},"Original Cost",-1)),k(d,{type:"text",modelValue:e.data.paid,"onUpdate:modelValue":a[17]||(a[17]=a=>e.data.paid=a),class:"w-full",currency:!0,placeholder:"00.00",disabled:"",icon:""},{icon:C((()=>[w(D(e.me.currency_symbol),1)])),_:1},8,["modelValue"])]),S("div",Ke,[a[37]||(a[37]=S("label",{class:"block"},"After Calculated Cost",-1)),k(d,{type:"text",modelValue:e.data.total_inventory_paid,"onUpdate:modelValue":a[18]||(a[18]=a=>e.data.total_inventory_paid=a),currency:!0,class:"w-full",placeholder:"00.00",disabled:"",icon:""},{icon:C((()=>[w(D(e.me.currency_symbol),1)])),_:1},8,["modelValue"])])]),S("div",null,[e.isSelected?P("",!0):(b(),I(c,{key:0,class:"whitespace-nowrap",color:"teal",onClick:e.addCost,dense:""},{default:C((()=>a[38]||(a[38]=[w(" Add Cost ")]))),_:1},8,["onClick"]))])]),(b(!0),g(x,null,U(e.data.inventory_more_price,((l,o)=>(b(),g("div",{class:"flex space-x-5",key:o},[S("div",We,[k(d,{value:e.data.inventory_more_price[o].price,onInput:a=>e.inputPrice(a,o),type:"number",currency:!0,class:"w-full",onChange:a=>e.storeMorePrice(o),placeholder:"00.00",disabled:e.isSelected,icon:""},{icon:C((()=>[w(D(e.me.currency_symbol),1)])),_:2},1032,["value","onInput","onChange","disabled"])]),S("div",Je,[k(d,{value:e.data.inventory_more_price[o].note,onInput:a=>e.inputNote(a,o),type:"text",class:"w-full",onChange:a=>e.storeMorePrice(o),disabled:e.isSelected,placeholder:"Adjustment Cost"},null,8,["value","onInput","onChange","disabled"])]),e.isSelected?P("",!0):(b(),g("div",Ye,[k(c,{class:"whitespace-nowrap",color:"red",onClick:a=>e.removeCost(o),dense:""},{default:C((()=>a[39]||(a[39]=[S("span",{class:"material-icons text-2xl m-2"}," delete ",-1)]))),_:2},1032,["onClick"])]))])))),128)),S("div",Xe,[k(d,{modelValue:e.data.price,"onUpdate:modelValue":a[19]||(a[19]=a=>e.data.price=a),onInput:e.updateInventory,type:"number",class:"w-full",currency:!0,placeholder:"00.00",label:"Price",disabled:null!=e.data.shopify_variant_id||null!=e.data.backmarket_listing_id,icon:""},{icon:C((()=>[w(D(e.me.currency_symbol),1)])),_:1},8,["modelValue","onInput","disabled"])])])]})),_:1}),k(y,{modelValue:e.modal.phonecheck_info,"onUpdate:modelValue":a[22]||(a[22]=a=>e.modal.phonecheck_info=a),title:null==(n=e.PhonecheckDevice)?void 0:n.name,onClose:a[23]||(a[23]=a=>e.isErrorSelectedPhonecheck=!1)},{header:C((()=>{var l;return[S("div",Ze,[S("h5",ea,D(null==(l=e.PhonecheckDevice)?void 0:l.name),1),k(c,{color:"teal",class:"ml-2 mb-2 mt-4 absolute inset-y-2 right-11",onClick:a[20]||(a[20]=a=>e.printPhoneCheck(e.PhonecheckDevice)),dense:""},{default:C((()=>a[40]||(a[40]=[S("i",{class:"material-icons text-lg"},"print",-1)]))),_:1})])]})),default:C((()=>[k(v,{ref:"refPhonecheckInfo",data:e.PhonecheckInfoData,"onUpdate:data":a[21]||(a[21]=a=>e.PhonecheckInfoData=a),"is-error":e.isErrorSelectedPhonecheck},null,8,["data","is-error"])])),_:1},8,["modelValue","title"])],64)}],["__scopeId","data-v-1d345cfa"]]);const la=r({components:{Fieldset:fe,Select:be,Alert:ne,Input:ee,Accordion:Ve,BSelect:we,DeviceGolfSpec:Pe,AutoComplete:ge,ColorSearch:je},props:{isSelected:{type:Boolean,default:!1},productId:{type:String,default:""}},setup(e,{emit:a}){const l=X;B();const{actionGet:o}=K(),t=u(),{actionCreateTag:i,actionUpdate:n,actionShow:c,actionGetColors:r}=G(),{transformSeperateCustomSpecs:h,golfSpecs:f}=Le(),b=m(!1),g=m(null),k=m(!1),C=m(null),w=F([]),S=m(!1),x=v((()=>{var e;return{id:R.value.color_id||null,name:(null==(e=(w||[]).find((e=>e.id===R.value.color_id)))?void 0:e.name)||null}})),I=async()=>{2==R.value.status&&(soldButtonLoading.value=!0,R.value.is_continue=1),await n({id:t.params.inventoryId,data:d(s({},R.value),{condition_name:R.value.condition})}).then((async()=>{2==R.value.status&&(soldButtonLoading.value=!1,soldPriceModal.value=!1),await L()}))},L=async()=>{await c(t.params.inventoryId)},V=ie((async e=>{var a,l;try{if((null==e?void 0:e.length)<2&&-1==(null==(a=R.value)?void 0:a.product_id))return void w.splice(0,w.length);S.value=!0;const o=await r({search:e,product_id:null==(l=R.value)?void 0:l.product_id});w.splice(0,w.length,...o)}catch(o){console.error("Error fetching colors:",o)}finally{S.value=!1}}),500),P=v((()=>!!e.isSelected||!se(R.value.shopify_price)&&!se(R.value.shopify_grading_id))),j=v((()=>!(!R.value.processor_speed||!R.value.memory||!R.value.hard_drive||!R.value.graphics||!R.value.graphics&&""===R.value.graphics))),D=ie((async(e={})=>{b.value=!0,Object.entries(e).forEach((([e,a])=>{f.hasOwnProperty(e)&&(f[e]={selected:a.selected||null,is_custom:a.is_custom||!1})})),R.value=s(s({},R.value),h(f)),await I(),b.value=!1}),300),U=async()=>{var e,a;if((null==(e=R.value)?void 0:e.product_id)&&-1!=(null==(a=R.value)?void 0:a.product_id))try{S.value=!0;const e=await r({product_id:R.value.product_id});w.splice(0,w.length,...e)}catch(l){console.error("Error fetching initial colors:",l)}finally{S.value=!1}else w.splice(0,w.length)};return y((()=>R.value.product_id),(e=>{e?U():w.splice(0,w.length)})),y(R,((e={})=>{!!e.custom_color&&(k.value=!0,C.value=e.custom_color),Object.entries(f).forEach((([a])=>{f[a].selected=e[a]||e[`custom_${a}`]||null,f[a].is_custom=!!e[`custom_${a}`]}))}),{deep:!0,immediate:!0}),p((async()=>{R.value.product_id&&U()})),{data:R,isCustomColor:k,customColor:C,selectedColor:x,isAllSpecSelected:j,items:l,selectColor:e=>{R.value.color_id=e.target.value,I()},disableForm:P,selectSpec:async()=>{if(1==R.value.is_mac&&!j.value)return null;b.value=!0;const e="string"==typeof R.value.product_id?R.value.product_id.split("-")[0]:R.value.product_id;(()=>{if(!j.value)return null;let e=[R.value.product_id.split("-")[0]];l.processor.map((a=>{a.name===R.value.processor_speed&&e.push(a.id)})),l.memory.map((a=>{a.name===R.value.memory&&e.push(a.id)})),l.hardDrive.map((a=>{a.name===R.value.hard_drive&&e.push(a.id)})),l.graphicsCard.map((a=>{a.name===R.value.graphics&&e.push(a.id)})),R.value.product_id=e.join("-")})();try{await i({id:t.params.inventoryId,product_name:R.value.device.product_name,processor_speed:R.value.processor_speed,memory:R.value.memory,graphics:R.value.graphics,storage:R.value.hard_drive,color:R.value.color?R.value.color.name:null,condition:R.value.condition?R.value.condition.name:null}),await Promise.all([o({product_id:e,is_mac:R.value.is_mac,processor:R.value.processor_speed,memory:R.value.memory,hdd:R.value.hard_drive,graphics:R.value.graphics,condition:1}),I()])}catch{_({type:"error",message:"Failed to update device spec"})}finally{b.value=!1}},loadingUpdate:b,loadingSearch:Z,golfSpecs:f,handleUpdateGolfSpecs:D,handleUpdateColor:async e=>{const{id:a}=e||{};R.value.color_id=a,R.value.color=e.name,b.value=!0,await I(),b.value=!1},handleResetCustomColor:()=>{k.value=!1,C.value=null,R.value.custom_color=null,R.value.color_id=null},handleApplyCustomColor:async()=>{b.value=!0,R.value.color_id=null,R.value.color=null,R.value.custom_color=C.value,await I(),b.value=!1},doSearch:V,colorOptions:w,loadingSearchColor:S,initializeColors:U,refCustomColor:g,handleCustomColor:async()=>{k.value=!0,await M(),g.value.focus()}}}}),oa={class:"mx-5 pb-5 space-y-5"},ta={key:0,class:"grid grid-cols-2"},ia={class:"text-black font-normal text-md mb-1"},na={class:"text-black font-normal text-md mb-1"},sa={class:"text-black font-normal text-md mb-1"},da={class:"text-black font-normal text-md mb-1"},ca={class:"text-black font-normal text-md mb-1"},ra={class:"text-black font-normal text-md mb-1"},ua={key:1,class:"grid grid-cols-2"},ma={class:"text-black font-normal text-md mb-1"},pa={class:"text-black font-normal text-md mb-1"},va={key:0},ya={key:1};const _a=r({components:{Card:he,Fieldset:fe,Input:ee,Select:be,Button:ae,AutoComplete:ge,Loading:de,PrintLabel:_e,Modal:le,FormDeviceDetails:aa,FormSpecifications:te(la,[["render",function(e,a,l,o,t,i){const n=h("Alert"),s=h("Accordion"),d=h("Select"),c=h("DeviceGolfSpec"),r=h("Input"),u=h("ColorSearch"),m=h("Fieldset"),p=f("loading");return b(),I(m,{class:"rounded-md space-y-5"},{label:C((()=>a[5]||(a[5]=[w("Specifications")]))),default:C((()=>{var l,o,t,i,m,v,y;return[S("div",oa,[e.data.shopify_price&&e.data.shopify_grading_id?(b(),I(n,{key:0,view:"smooth",color:"orange"},{default:C((()=>a[6]||(a[6]=[w(" Remove all eCommerce listings first to edit specs. ")]))),_:1})):P("",!0),k(s,{label:"Original Specs",block:""},{default:C((()=>[1==e.data.is_mac?(b(),g("div",ta,[S("div",null,[S("p",ia,[a[7]||(a[7]=S("span",{class:"font-semibold text-grey-04"},"Product Name: ",-1)),w(" "+D(e.data.ori_name||"-"),1)]),S("p",na,[a[8]||(a[8]=S("span",{class:"font-semibold text-grey-04"},"Processor: ",-1)),w(" "+D(e.data.ori_processor_speed||"-"),1)]),S("p",sa,[a[9]||(a[9]=S("span",{class:"font-semibold text-grey-04"},"Hard Drive: ",-1)),w(" "+D(e.data.ori_hard_drive||"-"),1)]),S("p",da,[a[10]||(a[10]=S("span",{class:"font-semibold text-grey-04"},"Memory: ",-1)),w(" "+D(e.data.ori_memory||"-"),1)]),S("p",ca,[a[11]||(a[11]=S("span",{class:"font-semibold text-grey-04"},"Graphic Card: ",-1)),w(" "+D(e.data.ori_graphics||"-"),1)])]),S("div",null,[S("p",ra,[a[12]||(a[12]=S("span",{class:"font-semibold text-grey-04"},"Date Added: ",-1)),w(" "+D(e.data.created_at||"-"),1)])])])):(b(),g("div",ua,[S("div",null,[S("p",ma,[a[13]||(a[13]=S("span",{class:"font-semibold text-grey-04"},"Product Name: ",-1)),w(" "+D(e.data.ori_name||"-"),1)])]),S("div",null,[S("p",pa,[a[14]||(a[14]=S("span",{class:"font-semibold text-grey-04"},"Date Added: ",-1)),w(" "+D(e.data.created_at||"-"),1)])])]))])),_:1}),1===e.data.is_mac?(b(),g(x,{key:1},[S("div",null,[a[15]||(a[15]=S("label",{class:"block"},"Processor",-1)),j(k(d,{modelValue:e.data.processor_speed,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.processor_speed=a),placeholder:"Select Processor",name:"name",by:"name",class:"w-full",onChange:e.selectSpec,items:e.items.processor,disabled:e.disableForm},null,8,["modelValue","onChange","items","disabled"]),[[p,e.loadingUpdate||e.loadingSearch.processor]])]),S("div",null,[a[16]||(a[16]=S("label",{class:"block"},"Memory",-1)),j(k(d,{modelValue:e.data.memory,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.memory=a),placeholder:"Select Memory",name:"name",by:"name",class:"w-full",onChange:e.selectSpec,items:e.items.memory,disabled:e.disableForm},null,8,["modelValue","onChange","items","disabled"]),[[p,e.loadingUpdate||e.loadingSearch.memory]])]),S("div",null,[a[17]||(a[17]=S("label",{class:"block"},"Hard Drive",-1)),j(k(d,{modelValue:e.data.hard_drive,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.hard_drive=a),placeholder:"Select Hard Drive",name:"name",by:"name",class:"w-full",onChange:e.selectSpec,items:e.items.hardDrive,disabled:e.disableForm},null,8,["modelValue","onChange","items","disabled"]),[[p,e.loadingUpdate||e.loadingSearch.hardDrive]])]),S("div",null,[a[18]||(a[18]=S("label",{class:"block"},"Graphics Card",-1)),j(k(d,{modelValue:e.data.graphics,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.graphics=a),placeholder:"Select Graphic Card",name:"name",by:"name",class:"w-full",onInput:e.selectSpec,items:e.items.graphicsCard,disabled:e.disableForm},null,8,["modelValue","onInput","items","disabled"]),[[p,e.loadingUpdate||e.loadingSearch.graphicsCard]])])],64)):P("",!0),(null==(o=null==(l=e.data)?void 0:l.golf_step)?void 0:o.length)?(b(),I(c,{key:2,onUpdateSpecs:e.handleUpdateGolfSpecs,item:{product_id:e.data.product_id},specs:e.golfSpecs,steps:(null==(t=e.data)?void 0:t.golf_step)||[],loading:e.loadingUpdate},null,8,["onUpdateSpecs","item","specs","steps","loading"])):P("",!0),S("div",null,[e.isCustomColor?(b(),g("div",va,[a[19]||(a[19]=S("label",null,"Color",-1)),k(r,{ref:"refCustomColor",modelValue:e.customColor,"onUpdate:modelValue":a[4]||(a[4]=a=>e.customColor=a),onFocusOut:e.handleApplyCustomColor,block:"",placeholder:"Input your custom color",clearable:!0,disabled:e.loadingUpdate,"clearable-fixed":!0,onClear:e.handleResetCustomColor},null,8,["modelValue","onFocusOut","disabled","onClear"])])):(b(),g("div",ya,[k(u,{items:e.colorOptions,loading:e.loadingSearchColor,modelValue:(null==(m=null==(i=e.data)?void 0:i.color)?void 0:m.name)||e.selectedColor.name,productId:null==(v=e.data)?void 0:v.product_id,disabled:e.loadingUpdate,isCustomItem:-1==(null==(y=e.data)?void 0:y.product_id),onSearch:e.doSearch,onSelect:e.handleUpdateColor,onCustomColor:e.handleCustomColor},null,8,["items","loading","modelValue","productId","disabled","isCustomItem","onSearch","onSelect","onCustomColor"])]))])])]})),_:1})}]]),Badge:De,Breadcrumb:Ue},props:{id:{type:[String,Number]},edit:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["fetch-specs"],setup(e,{emit:a}){const{me:l}=oe(),o=u(),t=E(),{loading:i,actionShow:n,actionUpdate:c}=G(),{data:r,stateLocations:p,loading:y,modal:h,dropdown:f,actionLocation:b,actionMoveLocation:g}=q(),k=v((()=>"string"==typeof R.product_id?R.product_id.split("-")[0]:R.product_id)),C=m([]),w=m(""),S=m(!1),x=m(!1),I=m(!1),L=m(!1),V=m("qr"),P=v((()=>"Deleted"===R.value.status_name||"Sold"===R.value.status_name||"Pending"===R.value.status_name)),j=async e=>{2==R.value.status&&(I.value=!0,R.value.is_continue=1),L.value=!0,await c({id:o.params.inventoryId,data:d(s({},R.value),{condition_name:R.value.condition})}).then((a=>{if(0!=a){"notes"!==e&&B();const{status:l,message:o}=a;2==R.value.status&&(I.value=!1,x.value=!1),_({message:null!==o&&"string"==typeof o?ce(o):o,type:"200"===l?"success":"danger"})}})),L.value=!1},D=ie((async e=>{await j(e)}),500),U=ie((async e=>{await j(e)}),0),B=ie((async()=>{await n(o.params.inventoryId),await b()}),500),F=v((()=>{let e=[{id:5,name:"Not Available"}];return 1==R.value.status?e.push({id:1,name:"Pending"}):e=e.concat([{id:0,name:"Available"},{id:2,name:"Sold"}]),e}));b();const M=()=>h.value=!1;return{breadcrumb:[{text:"Inventory",to:{name:"inventory"}},{text:"Edit Inventory"}],me:l,data:R,isSelected:P,productId:k,loading:i,statuses:F,soldButtonLoading:I,modalPrint:S,soldPriceModal:x,printLabelData:C,labelFunc:w,unsetStatus:()=>{R.value.status=0,R.value.sold=0,x.value=!1,L.value=!1},unsetSpecs:()=>{R.value.processor_speed=null,R.value.memory=null,R.value.hard_drive=null,R.value.graphics=null,a("fetch-specs",!0)},updateInventory:j,updateInventoryDebounced:D,updateInventoryImmediate:U,fetchInventory:B,updateSoldPrice:async()=>{await D()},handleChangeStatus:async()=>{2==R.value.status&&(x.value=!0,L.value=!0),2!=R.value.status&&await U()},printBuybackLabel:async e=>{var a,t,i,s;V.value=e,await n(o.params.inventoryId);const d=R.value.order_detail.id,c=R.value.is_mac,r=R.value.condition||"-",u=R.value.name,m=[null==(a=R.value)?void 0:a.processor_speed,null==(t=R.value)?void 0:t.hard_drive,null==(i=R.value)?void 0:i.memory,null==(s=R.value)?void 0:s.graphics].join(", "),p=R.value.box_id,v=R.value.imei_sn,y=R.value.price&&re(l.value,R.value.price)||"",_=ve({id:d,productName:u,isMac:c,detail:m,condition:r,buybackId:p,imei:v,price:y});C.value=[_],w.value="labelBuyback",S.value=!0},printRetailLabel:async e=>{V.value=e;const a=R.value.order_detail_id,o=R.value.name,t=R.value.condition,i=R.value.color_options.length>0?R.value.color_options.filter((e=>e.id==R.value.color_id)):[],n=1===i.length?i[0].name:"-",s=R.value.is_mac,d=[R.value.processor_speed,R.value.hard_drive,R.value.memory,R.value.graphics].join(", "),c=R.value.price&&re(l.value,R.value.price)||"",r=R.value.imei_sn,u=ye({id:a,productName:o,condition:t,color:n,isMac:s,detail:d,price:c,imei:r});C.value=[u],w.value="labelRetail",S.value=!0},openInventoryChangelog:()=>t.push({name:"inventoryChangelog",params:{inventoryId:o.params.inventoryId}}),moveInventory:async()=>r.value.location_id?(await g({id:o.params.inventoryId,data:{location_id:r.value.location_id}}),_({message:"Inventory moved.",type:"success"}),M(),f.value.selected=null,r.value.location_id=null,t.push({name:"inventory"})):_({message:"Location must be selected",type:"warning"}),handleModalMoveInventory:()=>h.value=!0,handleCloceModalMoveInventory:M,modalMoveLocation:h,loadingMoveInvoice:y,stateLocations:p,dataMoveLocation:r,dropdownLocation:f,statusChangeLoading:L,handleLocationChange:e=>{r.value.location_id=e.id,f.value.is_visibled=!1,f.value.selected=e.name},handleClickOutsideLocation:()=>{f.value.is_visibled=!1},labelType:V}}}),ha={class:"flex flex-wrap items-center justify-between gap-4"},fa={class:"w-full flex justify-between items-center py-4"},ba={class:"flex items-center gap-2"},ga={key:0},ka={class:"lg:flex w-full space-y-5 lg:space-y-0 lg:space-x-6 p-4"},Ca={class:"w-full lg:w-1/2"},wa={class:"w-full lg:w-1/2 space-y-5"},Sa={class:"mx-5 pb-5 space-y-5 gap-4"},xa={class:"flex gap-5"},Ia={class:"w-1/2"},La={class:"w-1/2"},Va={key:0,class:"space-y-4"},Pa={class:"flex w-full space-x-2"},ja={class:"text-center py-10"},Da={class:"mt-8 mb-10"},Ua={class:"relative h-full w-full inline-flex border border-grey-01 rounded-md text-left flex items-center justify-start"},Ba={class:"text-base"},Fa={class:"absolute left-0 transform translate-y-14 w-full bg-white align-items absolute z-50 border rounded border-grey-01 shadow py-4 top-100",style:{"min-width":"144px","margin-top":"15rem"}},Ma={class:"mt-4 max-h-60 overflow-x-auto"},Ea=["onClick"],Aa={class:"-mx-2 px-4 text-sm"},Oa={class:"flex items-center"},Na={class:"flex flex-row"};var Ha=te(_a,[["render",function(e,a,l,o,t,i){const n=h("Breadcrumb"),s=h("Button"),d=h("DropdownItem"),c=h("Popover"),r=h("DropdownMenu"),u=h("Dropdown"),m=h("Select"),p=h("FormDeviceDetails"),v=h("FormSpecifications"),y=h("router-link"),_=h("Input"),L=h("Fieldset"),V=h("PrintLabel"),B=h("Modal"),F=h("Card"),M=h("Badge"),E=f("loading"),N=f("outside");return b(),g(x,null,[S("div",ha,[k(n,{class:"mb-8 mt-4",pageTitle:"Edit Inventory",backTo:{name:"inventory"},items:e.breadcrumb},null,8,["items"]),k(u,{placement:"bottom","hide-on-click":!1},{default:C((()=>[k(s,{style:{padding:".8rem"},color:"teal"},{default:C((()=>a[15]||(a[15]=[S("i",{class:"material-icons"},"more_vert",-1)]))),_:1})])),dropdown:C((()=>[k(r,null,{default:C((()=>[e.data.source&&e.data.source.toLowerCase().indexOf("manual entry")<0?(b(),I(d,{key:0,onClick:a[0]||(a[0]=a=>e.printBuybackLabel("qr"))},{default:C((()=>a[16]||(a[16]=[S("i",{class:"material-symbols-outlined mr-2"},"qr_code",-1),w(" Buyback Label QR")]))),_:1})):(b(),I(d,{key:1},{default:C((()=>[k(c,{trigger:"hover",width:"400"},{reference:C((()=>a[17]||(a[17]=[S("div",null,[S("span",{class:"text-grey-02"},[S("i",{class:"material-symbols-outlined mr-2"},"qr_code"),w(" Buyback Label QR ")])],-1)]))),default:C((()=>[a[18]||(a[18]=S("div",{class:"w-full h-full justify-center items-center"},[S("div",{class:"font-semibold whitespace-pre-line"}," Manual Entry "),S("div",{class:"whitespace-normal"}," No Buyback Label QR Available. ")],-1))])),_:1})])),_:1})),e.data.source&&e.data.source.toLowerCase().indexOf("manual entry")<0?(b(),I(d,{key:2,onClick:a[1]||(a[1]=a=>e.printBuybackLabel("barcode"))},{default:C((()=>a[19]||(a[19]=[S("i",{class:"material-symbols-outlined mr-2"},"barcode",-1),w(" Buyback Label Barcode")]))),_:1})):(b(),I(d,{key:3},{default:C((()=>[k(c,{trigger:"hover",width:"400"},{reference:C((()=>a[20]||(a[20]=[S("div",null,[S("span",{class:"text-grey-02"},[S("i",{class:"material-symbols-outlined mr-2"},"barcode"),w(" Buyback Label Barcode ")])],-1)]))),default:C((()=>[a[21]||(a[21]=S("div",{class:"w-full h-full justify-center items-center"},[S("div",{class:"font-semibold whitespace-pre-line"}," Manual Entry "),S("div",{class:"whitespace-normal"}," No Buyback Label Barcode Available. ")],-1))])),_:1})])),_:1})),k(d,{onClick:e.openInventoryChangelog},{default:C((()=>a[22]||(a[22]=[S("img",{src:Be,alt:"changelog",class:"inline-block mr-2"},null,-1),w(" Changelog")]))),_:1},8,["onClick"]),k(d,{onClick:e.handleModalMoveInventory},{default:C((()=>a[23]||(a[23]=[S("span",{class:"material-icons mr-2"},"drive_file_move",-1),w(" Move Inventory")]))),_:1},8,["onClick"])])),_:1})])),_:1})]),k(F,null,{header:C((()=>[S("div",fa,[a[27]||(a[27]=S("h6",{class:"text-2xl text-gray-900 ml-5 my-auto"}," Item Information ",-1)),S("div",ba,[k(s,{color:"teal",view:"outlined",dense:"",onClick:a[2]||(a[2]=a=>e.printRetailLabel("qr"))},{default:C((()=>a[24]||(a[24]=[S("span",{class:"material-symbols-outlined text-lg mr-2"},"qr_code",-1),w(" Retail Label QR")]))),_:1}),k(s,{color:"teal",view:"outlined",dense:"",onClick:a[3]||(a[3]=a=>e.printRetailLabel("barcode"))},{default:C((()=>a[25]||(a[25]=[S("span",{class:"material-symbols-outlined text-lg mr-2"},"barcode",-1),w(" Retail Label Barcode")]))),_:1}),a[26]||(a[26]=S("label",{class:"ml-4 my-auto text-gray-900 text-lg"},"Status",-1)),"Deleted"!==e.data.status_name?(b(),I(m,{key:0,modelValue:e.data.status,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.status=a),items:e.statuses,name:"name",by:"id",onChange:e.handleChangeStatus,class:"w-72",loading:e.statusChangeLoading,disabled:e.isSelected||e.statusChangeLoading},null,8,["modelValue","items","onChange","loading","disabled"])):(b(),I(m,{key:1,modelValue:e.data.status,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.status=a),items:[{id:0,name:"Deleted"}],name:"name",by:"id",class:"w-72",loading:e.statusChangeLoading,disabled:e.isSelected||e.statusChangeLoading},null,8,["modelValue","loading","disabled"]))])])])),default:C((()=>[""!=e.data.name?(b(),g("div",ga,[S("div",ka,[S("div",Ca,[k(p,{"is-selected":e.isSelected,onUpdateInventory:e.updateInventoryDebounced,onFetchInventory:e.fetchInventory,onUnsetSpec:e.unsetSpecs},null,8,["is-selected","onUpdateInventory","onFetchInventory","onUnsetSpec"])]),S("div",wa,[k(v,{"is-selected":e.isSelected,"product-id":e.productId},null,8,["is-selected","product-id"]),k(L,{class:"rounded-md"},{label:C((()=>a[28]||(a[28]=[w("Inventory Details")]))),default:C((()=>[S("div",Sa,[S("div",xa,[S("div",Ia,[a[30]||(a[30]=S("label",{class:"block"},"Source",-1)),k(_,{modelValue:e.data.source,"onUpdate:modelValue":a[6]||(a[6]=a=>e.data.source=a),type:"text",class:"w-full",icon:"","icon-block":"",right:"",disabled:""},A({_:2},[e.data.order_detail?{name:"icon",fn:C((()=>[e.data.order_detail.order.box_id?(b(),I(y,{key:0,tag:"a",class:"font-semibold",to:{name:"buybackLocalDetail",params:{buybackId:e.data.order_detail.order.box_id}},target:"_blank"},{default:C((()=>a[29]||(a[29]=[S("span",{class:"material-icons cursor-pointer"}," open_in_new ",-1)]))),_:1},8,["to"])):P("",!0)])),key:"0"}:void 0]),1032,["modelValue"])]),S("div",La,[a[31]||(a[31]=S("label",{class:"block"},"Age of Product",-1)),k(_,{value:`${e.data.age} Days`,type:"text",class:"w-full",disabled:""},null,8,["value"])])]),P("",!0)])])),_:1})])])])):P("",!0),k(B,{modelValue:e.modalPrint,"onUpdate:modelValue":a[9]||(a[9]=a=>e.modalPrint=a),title:"Label Print"},{default:C((()=>[k(V,{data:e.printLabelData,"label-type":e.labelType,onCloseModal:a[8]||(a[8]=a=>e.modalPrint=!1),func:e.labelFunc},null,8,["data","label-type","func"])])),_:1},8,["modelValue"]),k(B,{modelValue:e.soldPriceModal,"onUpdate:modelValue":a[11]||(a[11]=a=>e.soldPriceModal=a),title:"Sold Price",onClose:e.unsetStatus},{default:C((()=>[2==e.data.status?(b(),g("div",Va,[k(_,{modelValue:e.data.sold,"onUpdate:modelValue":a[10]||(a[10]=a=>e.data.sold=a),type:"number",placeholder:"00.00",currency:!0,class:"w-full",disabled:e.isSelected,icon:""},{icon:C((()=>[w(D(e.me.currency_symbol),1)])),_:1},8,["modelValue","disabled"]),S("div",Pa,[k(s,{class:"ml-auto",color:"red",onClick:e.unsetStatus},{default:C((()=>a[33]||(a[33]=[w(" Cancel ")]))),_:1},8,["onClick"]),k(s,{color:"teal",loading:e.soldButtonLoading,onClick:e.updateSoldPrice},{default:C((()=>a[34]||(a[34]=[w(" Save ")]))),_:1},8,["loading","onClick"])])])):P("",!0)])),_:1},8,["modelValue","onClose"])])),_:1}),k(B,{class:"modal--overflow-none",style:{margin:"0 !important"},size:"xs",modelValue:e.modalMoveLocation,"onUpdate:modelValue":a[14]||(a[14]=a=>e.modalMoveLocation=a),"hide-header":"","hide-footer":"",onClose:e.handleCloceModalMoveInventory},{default:C((()=>[S("div",ja,[a[41]||(a[41]=S("img",{class:"mb-10 mx-auto",src:Fe,alt:"Success Icon"},null,-1)),S("div",Da,[a[37]||(a[37]=S("h5",{class:"mb-4"},"Move this inventory?",-1)),a[38]||(a[38]=S("p",{class:"mb-4 text-left"},[S("strong",null,"Which location to move selected inventory to")],-1)),j((b(),g("div",Ua,[S("div",{class:"flex items-left justify-between cursor-pointer py-2 pl-4 pr-2 w-full",onClick:a[12]||(a[12]=a=>e.dropdownLocation.is_visibled=!e.dropdownLocation.is_visibled)},[S("span",Ba,D(e.dropdownLocation.selected?e.dropdownLocation.selected:"Choose Location"),1),a[35]||(a[35]=S("span",{class:"inline-block ml-4"},[S("span",{class:"material-icons text-lg"}," arrow_drop_down ")],-1))]),j((b(),g("div",Fa,[S("div",Ma,[S("ul",null,[(b(!0),g(x,null,U(e.stateLocations,((l,o)=>(b(),g("li",{key:o,onClick:a=>e.handleLocationChange(l),class:"text-left p-2 hover:bg-grey-lighten cursor-pointer px-4"},[S("div",Aa,[S("div",Oa,[S("div",Na,[S("span",null,D(l.name),1),e.me.current_location_id==l.id?(b(),I(M,{key:0,class:"whitespace-nowrap",color:"teal"},{default:C((()=>a[36]||(a[36]=[w("Mail-In")]))),_:1})):P("",!0)])])])],8,Ea)))),128))])])])),[[O,e.dropdownLocation.is_visibled],[E,e.dropdownLocation.is_loading]])])),[[N,e.handleClickOutsideLocation]])]),k(s,{color:"teal",disabled:e.loadingMoveInvoice,onClick:a[13]||(a[13]=a=>e.modalMoveLocation=!1)},{default:C((()=>a[39]||(a[39]=[w("Cancel")]))),_:1},8,["disabled"]),k(s,{color:"orange",class:"ml-3",loading:e.loadingMoveInvoice,onClick:e.moveInventory},{default:C((()=>a[40]||(a[40]=[w("Proceed")]))),_:1},8,["loading","onClick"])])])),_:1},8,["modelValue","onClose"])],64)}]]);const Ta=r({components:{Alert:ne,Fieldset:fe,Card:he,Badge:De,Button:ae,Input:ee,Select:be,Checkbox:ue,AutoComplete:ge},async setup(){const{me:e}=oe(),a=m(0),l=m(!1),o=m(!1),{actionUpdate:t,actionShow:i,stateUpdate:n,actionSearchBackmarket:c,stateBackmarket:r}=G(),{actionDelete:p,loading:y}=$(),h=u(),f=X,b=m(!1),g=m(!1),k=Z,C=m(!1),w=m(!1),S=m(null);R.value.backmarket_price&&(a.value=1),se(R.value.shopify_price)||se(R.value.shopify_grading_id)||(o.value=!0,b.value=!0,g.value=!0);const x=v((()=>R.value.tags.split(","))),I=v((()=>!(1!==R.value.is_mac||!(se(R.value.processor_speed)||se(R.value.memory)||se(R.value.hard_drive)||se(R.value.graphics)||se(R.value.color_id)))||!(0!==R.value.is_mac||!se(R.value.color_id)))),L=ie((async()=>{await t({id:h.params.inventoryId,data:d(s({},R.value),{condition_name:R.value.condition})}).finally((()=>{C.value=!1,g.value=!0,b.value=!0,D()}))}),500),V=ie((async()=>{await t({id:h.params.inventoryId,data:d(s({},R.value),{condition_name:R.value.condition})})}),500),P=async()=>{await c(R.value.backmarket_id);const e=[...r.value],a=R.value.backmarket_id;if(e.length&&a){const a=e.filter((e=>e.backmarket_id===R.value.backmarket_id));S.value=1===a.length?a[0]:null}},j=ie((async()=>{w.value=!0,await t({id:h.params.inventoryId,data:d(s({},R.value),{condition_name:R.value.condition})}).then((async()=>{R.value=s(s({},R.value),me(n.value.data?n.value.data:n.value));!!R.value.backmarket_id&&0==R.value.is_new&&1==R.value.is_backmarket?await P():S.value=null,1===R.value.is_poup&&(o.value=!0),w.value=!1}))}),500),D=ie((async()=>{await i(h.params.inventoryId).then((()=>o.value=!0))}),500),U=v((()=>!!g.value||(0===R.value.is_new&&0===R.value.is_backmarket&&null==R.value.backmarket_id||(0===R.value.is_new&&1===R.value.is_backmarket&&null==R.value.backmarket_id||0===R.value.is_new&&1===R.value.is_backmarket&&!se(R.value.backmarket_id))))),B=v((()=>0===R.value.is_new&&1===R.value.is_backmarket&&!se(R.value.backmarket_id))),F=v((()=>"Sold"===R.value.status_name));B||(R.value.backmarket_price=null);const M=ie((async e=>{await c(e)}),500);return R.value.backmarket_id&&P(),{me:e,data:R,items:f,searchLoading:k,updateLoading:C,loadingShopify:y,customPrice:a,showShopifyForm:l,tags:x,checkSpecifications:I,showFormBackmarket:o,shopifyUpdate:()=>{R.value.shopify_price&&R.value.shopify_grading_id&&(R.value.is_continue=null,g.value=!1,j())},mapDevices:e=>e.map((e=>({name:e.product_name,value:e}))),doSearch:M,selectDevice:async e=>{R.value.backmarket_id=e.backmarket_id},isReadonly:U,isLoadingShopify:w,autoFill:B,isSold:F,updateECommerceListings:()=>{C.value=!0,0==a.value&&(R.value.backmarket_price=R.value.shopify_price),null==R.value.backmarket_price&&(R.value.backmarket_price=R.value.shopify_price),R.value.backmarket_new_price=R.value.backmarket_price,1==R.value.is_enable_backmarket&&1==o.value&&(R.value.is_continue=1),1==R.value.is_enable_shopify&&0==R.value.is_enable_backmarket&&(R.value.is_continue=1),L()},clearECommerceListings:()=>{R.value.shopify_grading_id=null,R.value.shopify_price=null,R.value.backmarket_id=null,R.value.backmarket_price=null,R.value.backmarket_new_price=null,l.value=!1,o.value=!1,b.value=!1,g.value=!1,(async()=>{await p(h.params.inventoryId,(()=>{_({type:"success",message:"Shopify inventory deleted"})}))})(),V()},editECommerceListings:()=>{b.value=!1,g.value=!1},backmarketPriceInput:e=>{R.backmarket_new_price=e.target.value},disableForm:g,disableShopify:b,stateBackmarket:r,backmarketSelectedItem:S}}}),Ra={class:"flex"},Ga={class:"w-1/2"},qa={key:0,class:"py-4 w-full flex"},$a={class:"mx-auto"},za={key:1,class:"mx-5 pb-4 space-y-5"},Qa={class:"w-1/2"},Ka={class:"gap-2 flex flex-wrap"},Wa={class:"mx-5 py-4 flex"};var Ja=te(Ta,[["render",function(e,a,l,o,t,i){const n=h("Button"),s=h("Popover"),d=h("Input"),c=h("Select"),r=h("Badge"),u=h("Fieldset"),m=h("Card");return b(),g("div",null,[k(m,{"hide-footer":e.isSold},A({header:C((()=>[a[3]||(a[3]=S("h6",{class:"text-2xl text-gray-900 ml-5 my-auto w-1/2 py-4"}," eCommerce Listings ",-1))])),default:C((()=>[S("div",Ra,[S("div",Ga,[k(u,{class:"m-4 rounded-lg"},{label:C((()=>a[4]||(a[4]=[w(" Shopify ")]))),default:C((()=>[e.data.shopify_price||e.showShopifyForm||e.data.shopify_grading_id?(b(),g("div",za,[S("div",Qa,[a[8]||(a[8]=S("label",{class:"block"},"Price",-1)),k(d,{modelValue:e.data.shopify_price,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.shopify_price=a),type:"text",class:"w-full",placeholder:"00.00",onInput:e.shopifyUpdate,disabled:e.disableShopify||e.updateLoading,icon:""},{icon:C((()=>[w(D(e.me.currency_symbol),1)])),_:1},8,["modelValue","onInput","disabled"])]),S("div",null,[a[9]||(a[9]=S("label",{class:"block"},"Condition",-1)),k(c,{modelValue:e.data.shopify_grading_id,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.shopify_grading_id=a),items:e.data.grading_backmarket_shopify_options,name:"grade",by:"id",type:"text",class:"w-full",disabled:e.disableShopify||e.updateLoading,onChange:e.shopifyUpdate},null,8,["modelValue","items","disabled","onChange"])]),S("div",null,[a[10]||(a[10]=S("label",{class:"block"},"Tags",-1)),S("div",Ka,[(b(!0),g(x,null,U(e.tags,((e,a)=>(b(),I(r,{key:`tag-${a}`,class:"whitespace-nowrap",color:"grey"},{default:C((()=>[w(D(e),1)])),_:2},1024)))),128))])])])):(b(),g("div",qa,[e.checkSpecifications?(b(),I(s,{key:0,trigger:"hover",width:"600"},{reference:C((()=>[S("div",$a,[k(n,{class:"whitespace-nowrap",color:"teal",disabled:e.checkSpecifications},{default:C((()=>a[5]||(a[5]=[S("span",{class:"material-icons text-2xl"},"add",-1),w(" Add Shopify Inventory ")]))),_:1},8,["disabled"])])])),default:C((()=>[a[6]||(a[6]=S("div",{class:"w-full h-full flex justify-center items-center"},[S("span",{class:"font-semibold whitespace-pre-line"}," You must complete the specifications form first. ")],-1))])),_:1})):(b(),I(n,{key:1,onClick:a[0]||(a[0]=a=>e.showShopifyForm=!0),class:"whitespace-nowrap mx-auto",color:"teal",disabled:e.checkSpecifications,loading:e.loadingShopify.delete},{default:C((()=>a[7]||(a[7]=[S("span",{class:"material-icons text-2xl"},"add",-1),w(" Add Shopify Inventory ")]))),_:1},8,["disabled","loading"]))]))])),_:1})])])])),_:2},[e.data.shopify_price||e.showShopifyForm||e.data.shopify_grading_id?{name:"footer",fn:C((()=>[S("div",Wa,[k(n,{onClick:e.clearECommerceListings,color:"red",loading:e.loadingShopify.delete,disabled:e.updateLoading||e.isLoadingShopify},{default:C((()=>a[11]||(a[11]=[w(" Clear All ")]))),_:1},8,["onClick","loading","disabled"]),e.disableShopify||e.disableForm?(b(),I(n,{key:1,onClick:e.editECommerceListings,class:"ml-auto",color:"teal"},{default:C((()=>a[13]||(a[13]=[w(" Edit ")]))),_:1},8,["onClick"])):(b(),I(n,{key:0,onClick:e.updateECommerceListings,loading:e.updateLoading||e.isLoadingShopify,disabled:e.loadingShopify.delete,class:"ml-auto",color:"teal"},{default:C((()=>a[12]||(a[12]=[w(" Save ")]))),_:1},8,["onClick","loading","disabled"]))])])),key:"0"}:void 0]),1032,["hide-footer"])])}]]);const Ya=r({components:{Card:he,Currency:Me},props:{data:{type:Object}}});const Xa=r({components:{FormCreate:pe,FormInformationDefails:Ha,FormECommerceListings:Ja,TableSellingHistory:te(Ya,[["render",function(e,a,l,o,t,i){const n=h("TableColumn"),s=h("Currency"),d=h("Table"),c=h("Card");return b(),I(c,null,{header:C((()=>a[0]||(a[0]=[S("h6",{class:"text-2xl text-gray-900 ml-5 my-auto w-1/2 py-4"}," Selling History ",-1)]))),default:C((()=>[k(d,{data:e.data.data},{default:C((()=>[k(n,{prop:"sold_date",label:"Sold Date",width:"170"}),k(n,{prop:"condition",label:"Condition",width:"170"}),k(n,{prop:"sold",label:"Price"},{default:C((e=>[k(s,{value:parseFloat(e.row.sold)},null,8,["value"])])),_:1})])),_:1},8,["data"])])),_:1})}]]),Card:he},props:{id:{type:[Number,String]},sellingHistories:{type:Object},transferHistories:{type:Object},notes:{type:Object},disabled:{type:Boolean,default:!1},edit:{type:Boolean,default:!1}},emits:["update:data","fetch-specs"],setup:(e,{emit:a})=>({data:R,handleFetchSpecs:()=>a("fetch-specs",!0)})}),Za={class:"space-y-7"};var el=te(r({components:{InventoryForm:te(Xa,[["render",function(e,a,l,o,t,i){const n=h("FormInformationDefails"),s=h("FormECommerceListings"),d=h("Card"),c=h("TableSellingHistory"),r=f("loading");return b(),g("div",Za,[e.edit?(b(),I(n,{key:0,onFetchSpecs:e.handleFetchSpecs,id:e.id},null,8,["onFetchSpecs","id"])):P("",!0),(b(),I(N,null,{default:C((()=>[1==e.data.is_enable_shopify?(b(),I(s,{key:0})):P("",!0)])),fallback:C((()=>[j(k(d,null,null,512),[[r,!0]])])),_:1})),e.edit?(b(),I(c,{key:1,data:e.sellingHistories},null,8,["data"])):P("",!0)])}]])},async setup(){const e=u();E();const{action:a}=J("inventory"),{getConditions:l}=K(),{loading:o,actionShow:t,actionUpdate:i}=G(),{action:n,state:c}=z(),{action:r,state:m}=Q(),p=X;oe();const y=v((()=>({notes:R.notes,notes_updated_by:R.notes_updated_by,notes_updated_at:R.notes_updated_at}))),_=e.params.inventoryId,h=async()=>{await Promise.all(["Processor","Hard Drive","Memory","Graphics Card"].map((e=>a(d(s({},f.value&&{product_id:f.value}),{is_mac:f.value?1:0,type:e})))))};await Promise.all([t(e.params.inventoryId),n(e.params.inventoryId),r(e.params.inventoryId)]);const f=v((()=>"string"==typeof R.value.product_id?R.value.product_id.split("-")[0]:R.value.product_id));return await a({q:R.value.name,is_many:0,type:"detail"}),R.value.device=p.detail[0],await h(),await l(d(s({},"-1  "!=R.value.product_id&&{product_id:R.value.product_id}),{processor:1==R.value.is_mac?R.value.processor:null,memory:1==R.value.is_mac?R.value.memory:null,hdd:1==R.value.is_mac?R.value.hard_drive:null,graphics:1==R.value.is_mac?R.value.graphics:null,is_mac:R.value.is_mac,condition:1})),{data:R,loading:o,inventoryId:_,stateSellingHistories:c,stateTransferHistories:m,inventoryNotes:y,getAvailableSpecs:h}}}),[["render",function(e,a,l,o,t,i){const n=h("InventoryForm");return b(),I(n,{id:e.inventoryId,sellingHistories:e.stateSellingHistories,transferHistories:e.stateTransferHistories,notes:e.inventoryNotes,edit:"",onFetchSpecs:e.getAvailableSpecs},null,8,["id","sellingHistories","transferHistories","notes","onFetchSpecs"])}]]),al=r({setup(){const{genSuspense:e}=c();return()=>e(el)}});export{al as default};
