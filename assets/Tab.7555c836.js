var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{k as o,f as s,y as n,_ as r,m as d,o as c,t as u,D as p,w as m,B as g,I as f,S as v,a2 as _,a3 as b,K as h,U as k,a5 as w,O as y,g as x,a0 as I,A as D,n as C,a4 as S}from"./vendor.f1efedad.js";import{j as T,k as j,l as P}from"./invoice.f6db67cd.js";import{f as A,b as F,_ as O,e as V,d as B,P as U,j as L,u as $,n as z,a7 as M,g as E,a5 as N}from"./index.e231b017.js";import{c as R}from"./status.6f59bf91.js";import{_ as G}from"./tab.9f764545.js";import{_ as J}from"./badge.3a8a2c41.js";import{_ as q}from"./group-container.4951adfc.js";import{C as K}from"./card.de1f0319.js";import{S as H}from"./select.04e4ee62.js";import{C as Q}from"./Currency.3768e3b3.js";import{T as W}from"./TextLimit.43017255.js";import{u as X}from"./index.32689823.js";import{r as Y}from"./index.1c09f422.js";import{_ as Z}from"./attention.c511405b.js";import"./date.f86face7.js";const ee=o({components:{Input:A,Button:F},props:{data:{type:Object,default:()=>({box_id:null,shipping_tracking:null})}},setup(e,{emit:a}){const{loading:t,actionShippingTrackingUpdate:l,actionShippingTrackingDelete:i}=T("invoice"),o=s(e.data),d=s(null==o.value.shipping_tracking?"canAdd":"canEdit"),c=s({shipping_tracking:null}),u=X({shipping_tracking:{required:Y}},c,{$lazy:!0}),p=()=>(u.value.$validate(),!u.value.$invalid);return n((()=>e.data),(()=>{e.data?o.value=e.data:o.value={box_id:null,shipping_tracking:null}}),{immediate:!0}),{loading:t,data:o,add:()=>{d.value="canUpdate"},save:async e=>{if(!p())return;await l({box_id:e.box_id,data:{shipping_tracking:c.value.shipping_tracking}})&&(r({type:"success",message:"Tracking number saved."}),d.value="canEdit",e.shipping_tracking=c.value.shipping_tracking)},cancel:()=>{c.value.shipping_tracking?d.value="canEdit":d.value="canAdd"},edit:e=>{d.value="canUpdate",c.value.shipping_tracking=e},remove:async e=>{await i({box_id:e.box_id})&&(r({type:"success",message:"Tracking number removed."}),c.value.shipping_tracking=null,d.value="canAdd")},newData:c,validation:u,validate:p,shippingTrackingForm:d}}}),ae={key:1},te={class:"grid grid-cols-2 gap-4"},le={key:2},ie={class:"grid grid-cols-2 gap-4"},oe=["href"],se={key:1},ne={class:"w-full h-full flex justify-center items-center"},re={key:0,class:"whitespace-pre-line"};const de=o({components:{Tab:G,Badge:J,GroupContainer:q,Button:F,Input:A,Checkbox:V,Select:H,Modal:B,Card:K,Pagination:U,Currency:Q,TextLimit:W,ShippingTracking:O(ee,[["render",function(e,a,t,l,i,o){const s=d("Button"),n=d("Input"),r=d("Popover");return"canAdd"==e.shippingTrackingForm?(c(),u("div",{key:0,class:"lg:opacity-0 group-hover:opacity-100 transition-opacity",onClick:a[1]||(a[1]=v((()=>{}),["stop"]))},[p(s,{color:"teal",onClick:a[0]||(a[0]=a=>e.add()),dense:""},{default:m((()=>a[7]||(a[7]=[g("span",{class:"material-icons text-xl"},"add",-1),f(" Add")]))),_:1})])):"canUpdate"==e.shippingTrackingForm?(c(),u("div",ae,[g("div",te,[g("div",null,[p(n,{class:"w-full",modelValue:e.newData.shipping_tracking,"onUpdate:modelValue":a[2]||(a[2]=a=>e.newData.shipping_tracking=a),placeholder:"input"},null,8,["modelValue"]),(c(!0),u(_,null,b(e.validation.shipping_tracking.$errors,(e=>(c(),u("span",{class:"text-red-base mt-2 block",key:e},h(e.$message)+". ",1)))),128))]),g("div",null,[p(s,{color:"teal",class:"mt-2 mr-2",loading:e.loading.update_shipping_tracking,onClick:a[3]||(a[3]=a=>e.save(e.data)),dense:""},{default:m((()=>a[8]||(a[8]=[g("i",{class:"material-icons text-lg"},"check",-1)]))),_:1},8,["loading"]),p(s,{color:"red",class:"mt-2",loading:e.loading.update_shipping_tracking,onClick:a[4]||(a[4]=a=>e.cancel()),dense:""},{default:m((()=>a[9]||(a[9]=[g("i",{class:"material-icons text-lg"},"close",-1)]))),_:1},8,["loading"])])])])):(c(),u("div",le,[g("div",ie,[g("div",null,[e.data.shipping_tracking_link?(c(),u("a",{key:0,href:e.data.shipping_tracking_link?e.data.shipping_tracking_link:"#",class:"float-left mt-2",color:"teal"},h(e.data.shipping_tracking),9,oe)):(c(),u("span",se,h(e.data.shipping_tracking),1))]),g("div",null,[p(s,{color:"teal",class:"mr-2",loading:e.loading.delete_shipping_tracking,onClick:a[5]||(a[5]=a=>e.edit(e.data.shipping_tracking)),dense:""},{default:m((()=>a[10]||(a[10]=[g("i",{class:"material-icons text-lg"},"edit",-1)]))),_:1},8,["loading"]),p(r,{width:"400",trigger:"hover"},{reference:m((()=>[p(s,{color:"red",loading:e.loading.delete_shipping_tracking,onClick:a[6]||(a[6]=a=>e.remove(e.data)),dense:""},{default:m((()=>a[11]||(a[11]=[g("i",{class:"material-icons text-lg"},"delete",-1)]))),_:1},8,["loading"])])),default:m((()=>[g("div",ne,[(c(),u("span",re,"Delete Tracking Number"))])])),_:1})])])]))}]]),Alert:L},async setup(){const{tab:e}=j("invoice"),{me:o}=$(),{datamatchStatus:r,statusLogin:d}=z(),{data:c,selected:u,state:p,actionAll:m,actionDelete:g,filterDateRef:f,filterDateOptions:v,filterDateFocus:_,filterList:b,clearFilter:h,clearAllFilter:k,isFiltered:I,unsetData:D,openModal:C,loading:S,modal:A}=T("invoice"),{state:F,loading:O,action:V}=P("invoice"),B=w(),U=y(),L=s(0),G=s(0);c.search=window.localStorage.getItem("invoice-tab-search")?window.localStorage.getItem("invoice-tab-search"):"",c.date="null"==window.localStorage.getItem("invoice-tab-date")?"":window.localStorage.getItem("invoice-tab-date"),c.sales_person=JSON.parse(window.localStorage.getItem("invoice-tab-sales-person")?window.localStorage.getItem("invoice-tab-sales-person"):"[]"),V(),n((()=>({route:B.params.statusId,limit:c.limit,search:c.search,date:c.date})),(()=>{c.page=1}),{deep:!0}),n((()=>((e,o)=>{for(var s in o||(o={}))t.call(o,s)&&i(e,s,o[s]);if(a)for(var s of a(o))l.call(o,s)&&i(e,s,o[s]);return e})({route:B.params.statusId},c)),E((async()=>{"invoiceTab"===B.name&&(window.localStorage.setItem("invoice-tab-search",c.search),window.localStorage.setItem("invoice-tab-date",c.date),window.localStorage.setItem("invoice-tab-sales-person",JSON.stringify(c.sales_person)),await m(B.params.statusId),L.value=p.value.total_balance_due?p.value.total_balance_due:0,G.value=p.value.total_profit?p.value.total_profit:0)}),500),{immediate:!0,deep:!0});const J=x((()=>"all"===B.params.statusId));return{me:o,datamatchStatus:r,route:B,data:c,salesPerson:F,loading:S,loadingSalesPerson:O,modal:A,table:p,tab:e,filterList:b,isFiltered:I,unsetData:D,filterDateRef:f,filterDateOptions:v,filterDateFocus:_,clearFilter:h,clearAllFilter:k,deleteInvoice:async()=>{await g(B.params.statusId)},openModalSelected:(e,a)=>C(e,(()=>{u.value=a.box_id})),color:R,tableSummary:({columns:e})=>J?e.map((e=>"due_date"===e.property?"Total":"sub_total"===e.property?`${N(o.value,p.value.grand_total)}`:"balance_due"===e.property?`${N(o.value,p.value.total_balance_due)}`:"profit"===e.property?`${N(o.value,p.value.total_profit)}`:"profit_percentage"===e.property?`${p.value.avg_profit_percentage}%`:"")):"",redirectToOrder:e=>{U.push({name:"invoiceDetail",params:{buybackId:e.box_id}})},checkRouterIsALL:J,totalBalanceDue:L,nameCapitalize:M,totalProfit:G}}}),ce={class:"flex xl:flex-row flex-col justify-between mb-8 items-center"},ue={class:"lg:space-x-4 lg:space-y-0 space-y-4"},pe={key:0,class:"grid grid-cols-2 gap-4"},me={class:"flex items-center"},ge={class:"text-4xl",style:{color:"#424242"}},fe={class:"font-semibold"},ve={class:"flex items-center"},_e={class:"text-4xl",style:{color:"#48bb78"}},be={class:"font-semibold"},he={class:"ml-2 p-2 rounded-lg text-base",color:"white",style:{color:"white","background-color":"#48bb78"}},ke={class:"flex flex-col md:flex-row mb-6"},we={class:"flex-grow md:mr-3 md:mb-0 mb-3"},ye={class:"flew-grow-0"},xe={class:"flex items-center flex-row mb-6"},Ie=["onClick"],De={class:"inline-block ml-3"},Ce={key:0,class:"mb-2"},Se={key:1,class:"block text-teal-04 mb-2"},Te={class:"inline-block"},je={class:"text-center py-10"};var Pe=O(de,[["render",function(e,a,t,l,i,o){const s=d("Button"),n=d("Tab",!0),r=d("Currency"),w=d("Alert"),y=d("Input"),x=d("DatePicker"),T=d("Checkbox"),j=d("DropdownItem"),P=d("DropdownMenu"),A=d("Dropdown"),F=d("GroupContainer"),O=d("router-link"),V=d("TableColumn"),B=d("Badge"),U=d("TextLimit"),L=d("ShippingTracking"),$=d("Popover"),z=d("Table"),M=d("Pagination"),E=d("Card"),N=d("Modal"),R=I("loading");return c(),u("div",null,[g("div",ce,[a[9]||(a[9]=g("div",{class:"lg:flex lg:divide-x lg:divide-grey-01 xl:mb-0 mb-4"},[g("div",{class:"flex lg:pr-4 lg:mb-0 mb-4"},[g("h5",null,"Invoices")])],-1)),g("div",ue,[p(s,{color:"teal",class:"lg:inline-block block",to:{name:"invoiceCreate"},link:""},{default:m((()=>a[8]||(a[8]=[g("span",{class:"material-icons"},"add",-1),f(" Add New Invoice")]))),_:1})])]),p(E,null,{default:m((()=>[p(n,{view:"smooth",items:e.tab},null,8,["items"]),"1"===e.route.params.statusId?D((c(),u("div",pe,["1"===e.route.params.statusId?(c(),C(w,{key:0,color:"teal",view:"smooth",dense:"",class:"mb-5"},{left:m((()=>a[10]||(a[10]=[g("div",{class:"flex items-center h-full"},[g("img",{src:"/assets/balance-due.0af778db.svg",alt:"Icon - balance - due",class:"h-20 mr-5"})],-1)]))),default:m((()=>[a[11]||(a[11]=g("p",{class:"text-lg",style:{color:"#424242"}}," Total Outstanding Balance Due ",-1)),g("div",me,[g("div",ge,[g("span",fe,[p(r,{value:e.totalBalanceDue},null,8,["value"])])])])])),_:1})):k("",!0),"1"===e.route.params.statusId?(c(),C(w,{key:1,color:"green",view:"smooth",dense:"",class:"mb-5"},{left:m((()=>a[12]||(a[12]=[g("div",{class:"flex items-center h-full"},[g("img",{src:"/assets/profit.f3fe8e06.svg",alt:"Icon - profit",class:"h-20 mr-5"})],-1)]))),default:m((()=>[a[13]||(a[13]=g("p",{class:"text-lg",style:{color:"#48bb78"}}," Total Outstanding Profit ",-1)),g("div",ve,[g("div",_e,[g("span",be,[p(r,{value:e.totalProfit},null,8,["value"])])]),g("div",null,[g("span",he,h(e.table.avg_profit_percentage)+" %",1)])])])),_:1})):k("",!0)])),[[R,e.loading.all]]):k("",!0),g("div",ke,[g("div",we,[p(y,{modelValue:e.data.search,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.search=a),placeholder:"Search Everything",class:"w-full",icon:""},{icon:m((()=>a[14]||(a[14]=[g("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue"])]),g("div",ye,[p(F,null,{default:m((()=>[p(s,{color:"white",view:"outlined",class:"flex-auto",onClick:e.filterDateFocus,onBlur:e.filterDateFocus},{default:m((()=>[p(x,S({modelValue:e.data.date,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.date=a)},e.filterDateOptions,{type:"daterange",ref:"filterDateRef",class:"hide-picker"}),null,16,["modelValue"]),a[15]||(a[15]=f(" Select Date "))])),_:1},8,["onClick","onBlur"]),p(A,{trigger:"click",size:"medium",fallbackPlacements:["bottom"]},{dropdown:m((()=>[p(P,null,{default:m((()=>[(c(!0),u(_,null,b(e.salesPerson,((t,l)=>(c(),C(j,{key:l},{default:m((()=>[p(T,{color:"teal",modelValue:e.data.sales_person,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.sales_person=a),value:t},{default:m((()=>[f(h(t.sales_person),1)])),_:2},1032,["modelValue","value"])])),_:2},1024)))),128))])),_:1})])),default:m((()=>[p(s,{color:"white",view:"outlined",class:"flex-auto dropdown dropdown-arrow",loading:e.loadingSalesPerson},{default:m((()=>a[16]||(a[16]=[f("Sales Person")]))),_:1},8,["loading"])])),_:1})])),_:1})])]),g("div",xe,[(c(!0),u(_,null,b(e.filterList,((a,t)=>(c(),u("div",{class:"inline-block",key:t},[a.value?(c(),C(s,{key:0,color:"grey",view:"smooth",dense:"",class:"mx-1"},{default:m((()=>[g("b",null,h(a.name)+":",1),f(" "+h(a.value),1),g("i",{class:"material-icons text-sm",onClick:t=>e.clearFilter(a)},"close",8,Ie)])),_:2},1024)):k("",!0)])))),128)),g("div",De,[e.isFiltered?(c(),C(s,{key:0,color:"teal",view:"smooth",onClick:e.clearAllFilter,dense:""},{default:m((()=>a[17]||(a[17]=[g("i",{class:"material-icons text-sm mr-1"},"close",-1),f("Clear all ")]))),_:1},8,["onClick"])):k("",!0)])]),D((c(),C(z,{class:"mb-6",data:e.table.data,"highlight-current-row":"","show-summary":!e.checkRouterIsALL&&!e.loading.all,"summary-method":e.tableSummary},{default:m((()=>[p(V,{prop:"box_id",label:"Invoice#"},{default:m((e=>[p(O,{tag:"a",class:"font-bold",to:{name:"invoiceDetail",params:{buybackId:e.row.box_id}}},{default:m((()=>[f(h(e.row.box_id),1)])),_:2},1032,["to"])])),_:1}),"all"===e.route.params.statusId?(c(),C(V,{key:0,prop:"status_invoice",label:"Status",width:"150"},{default:m((e=>[p(B,{class:"whitespace-nowrap",color:"Paid"===e.row.status_invoice?"teal":"red"},{default:m((()=>[f(h(e.row.status_invoice),1)])),_:2},1032,["color"])])),_:1})):k("",!0),p(V,{label:"Bill To",width:"150"},{default:m((a=>[p(U,{text:a.row.customer_fullname||""},{default:m((({text:a})=>[e.nameCapitalize(a).length?(c(),u("div",Ce,[(c(!0),u(_,null,b(e.nameCapitalize(a),((e,a)=>(c(),u("span",{key:a,class:"text-teal-04 capitalize"},h(`${e} `),1)))),128))])):(c(),u("span",Se,h(a),1))])),_:2},1032,["text"])])),_:1}),p(V,{prop:"sales_person",label:"Sales Person",width:"150"},{default:m((e=>[p(U,{text:e.row.sales_person||""},null,8,["text"])])),_:1}),p(V,{prop:"invoice_date",label:"Invoice Date",width:"100"}),p(V,{width:"100",label:"3"===e.route.params.statusId?"Date Paid":"Due Date"},{default:m((a=>[f(h(3==e.route.params.statusId?a.row.closed_date:a.row.due_date),1)])),_:1},8,["label"]),p(V,{prop:"sub_total",label:"Total",width:"200",align:"right"},{default:m((e=>[p(r,{value:e.row.sub_total},null,8,["value"])])),_:1}),"1"===e.route.params.statusId?(c(),C(V,{key:1,prop:"balance_due",label:"Balance Due",width:"200",align:"right"},{default:m((e=>[p(r,{value:e.row.balance_due},null,8,["value"])])),_:1})):k("",!0),"3"===e.route.params.statusId||"1"===e.route.params.statusId?(c(),C(V,{key:2,prop:"profit",label:"Profit",align:"right"},{default:m((e=>[p(r,{value:e.row.profit},null,8,["value"])])),_:1})):k("",!0),"3"===e.route.params.statusId?(c(),C(V,{key:3,prop:"profit_percentage",label:"Profit Margin",width:"100",align:"right"},{default:m((e=>[f(h(e.row.profit_percentage)+"% ",1)])),_:1})):k("",!0),"3"!==e.route.params.statusId?(c(),C(V,{key:4,prop:"shipping_tracking",label:"Tracking Number",width:"300"},{default:m((e=>[p(L,{data:e.row},null,8,["data"])])),_:1})):k("",!0),"3"!==e.route.params.statusId?(c(),C(V,{key:5,prop:"action",label:""},{default:m((t=>["Paid"!==t.row.status_invoice?(c(),u("div",{key:0,class:"lg:opacity-0 group-hover:opacity-100 transition-opacity",onClick:a[3]||(a[3]=v((()=>{}),["stop"]))},[1!==t.row.is_can_deleted?(c(),C($,{key:0,placement:"top-end",trigger:"hover",width:200},{reference:m((()=>[g("div",Te,[p(s,{disabled:"",color:"red",dense:""},{default:m((()=>a[18]||(a[18]=[g("span",{class:"material-icons text-xl"},"delete",-1)]))),_:1})])])),default:m((()=>[a[19]||(a[19]=g("div",{class:"text-sm text-black whitespace-nowrap"}," Delete all products off invoice first ",-1))])),_:1})):(c(),C(s,{key:1,color:"red",onClick:a=>e.openModalSelected("delete",t.row),dense:""},{default:m((()=>a[20]||(a[20]=[g("span",{class:"material-icons text-xl"},"delete",-1)]))),_:2},1032,["onClick"]))])):k("",!0)])),_:1})):k("",!0)])),_:1},8,["data","show-summary","summary-method"])),[[R,e.loading.all]]),p(M,{page:e.data.page,"onUpdate:page":a[4]||(a[4]=a=>e.data.page=a),limit:e.data.limit,"onUpdate:limit":a[5]||(a[5]=a=>e.data.limit=a),data:e.table},null,8,["page","limit","data"])])),_:1}),p(N,{size:"xs",modelValue:e.modal.delete,"onUpdate:modelValue":a[7]||(a[7]=a=>e.modal.delete=a),title:"Delete Invoice",onClose:e.unsetData,"hide-header":"","hide-footer":""},{default:m((()=>[g("div",je,[a[23]||(a[23]=g("img",{class:"mb-10 mx-auto",src:Z,alt:"Icon"},null,-1)),a[24]||(a[24]=g("div",{class:"mt-8 mb-10"},[g("h6",{class:"mb-2"},"Attention!"),g("p",null,"Do you want to delete this invoice data?")],-1)),p(s,{color:"red",class:"mr-5",loading:e.loading.delete,onClick:e.deleteInvoice},{default:m((()=>a[21]||(a[21]=[f("Delete Invoice")]))),_:1},8,["loading","onClick"]),p(s,{view:"outlined",color:"teal",disabled:e.loading.delete,onClick:a[6]||(a[6]=a=>e.modal.delete=!1)},{default:m((()=>a[22]||(a[22]=[f("Cancel")]))),_:1},8,["disabled"])])])),_:1},8,["modelValue","onClose"])])}]]);export{Pe as default};
