import{j as a,_ as e,a5 as t,W as s,a0 as i,o as r,n as o,w as l,A as n,B as c,D as d,t as u,a2 as m,a3 as p,ap as g,F as f,ar as h}from"./vendor.f1efedad.js";import{z as y}from"./index.9aa6481b.js";import{C as b}from"./card.dfb8e6f7.js";import{L as w}from"./LoadingCard.be59eb97.js";import{M as v}from"./MultipleInputFile.a941d51f.js";const I=a("buybackImages",{state:()=>({routeParams:null,isLoading:!1,images:[]}),getters:{},actions:{setRoute(a={}){this.routeParams=a},async $getImages(a){var e,t;this.isLoading=!0,this.images=[];try{const s=await y({url:`/v1/pos/order/picture/${null==(t=null==(e=this.routeParams)?void 0:e.params)?void 0:t.buybackId}`,method:"get",params:a});Object.keys(s).forEach((a=>{this.images=[...this.images,...s[a]]}))}catch(s){console.error("Failed to fetch pictures",s)}finally{this.isLoading=!1}},async $uploadImage(a){this.isLoading=!0;try{await y({url:`/v1/pos/order/picture/${this.routeParams.params.buybackId}`,method:"post",data:a,headers:{"Content-Type":"multipart/form-data"}}),e({message:"Picture uploaded!",type:"success"})}catch(t){console.error("Failed to upload pictures",t)}finally{this.isLoading=!1}},async $deleteImage(a){this.isLoading=!0;try{await y({url:`/v1/pos/order/picture/${a}`,method:"post",data:{_method:"DELETE"}}),e({message:"Picture deleted!",type:"success"})}catch(t){console.error("Failed to upload pictures",t)}finally{this.isLoading=!1}}}}),$={class:"w-full flex flex-wrap justify-center"},k=["onClick"],L=["alt","src","onClick"],j={__name:"BuybackImages",setup(a){const e=t(),y=I();y.setRoute(e);const j=async a=>{if(!(null==a?void 0:a.length))return;const e=new FormData;for(let[t,s]of Object.entries(a))e.append(`picture_files[${t}]`,s);await y.$uploadImage(e),await y.$getImages()};return s((async()=>{await y.$getImages()})),(a,e)=>{const t=i("loading");return r(),o(h,null,{default:l((()=>[n((r(),o(b,null,{header:l((()=>e[0]||(e[0]=[c("h6",{class:"font-medium"},"Image",-1)]))),default:l((()=>[d(v,{preview:"",onInput:j},{preview:l((()=>[c("div",$,[(r(!0),u(m,null,p(g(y).images,((a,t)=>(r(),u("div",{class:f(["m-4 relative transition duration-200","transform hover:scale-105 cursor-pointer"]),key:t},[c("div",{class:f(["absolute top-0 right-0","bg-teal-04 w-1 h-1 p-4","box-content flex items-center","justify-center transform -translate-x-2","-translate-y-1/2 rounded-full font-semibold","text-white hover:bg-white hover:text-teal-04","transition duration-200 cursor-pointer"]),onClick:e=>(async a=>{await y.$deleteImage(a),await y.$getImages()})(a.id)},e[1]||(e[1]=[c("i",{class:"material-icons text-lg"},"close",-1)]),8,k),c("img",{alt:`picture-${t}`,src:a.picture,class:"rounded-md",onClick:e=>{var t;(t=a.picture)&&window.open(t,"_blank")}},null,8,L)])))),128))])])),_:1})])),_:1})),[[t,g(y).isLoading]])])),fallback:l((()=>[d(w)])),_:1})}}};export{j as default};
