{"version":3,"file":"index.7f6b30d5.js","sources":["../../src/components/Widget/Unavailable/index.vue","../../src/assets/widget-unavailable.svg","../../src/components/Widget/Preview/index.vue"],"sourcesContent":["<template>\n  <div class=\"flex flex-col items-center justify-center gap-8 mx-auto my-10\">\n    <div>\n      <img src=\"@/assets/widget-unavailable.svg\" />\n    </div>\n    <p class=\"text-2xl text-center font-semibold max-w-lg\">\n      Complete your item setup first \n    </p>\n    <p class=\"text-center\">\n      Here are the steps you need to do:\n    </p>\n    <ul class=\"m-0 space-y-4\">\n      <li v-for=\"(instruction, n) in instructions\" :key=\"n\">\n        <div class=\"flex gap-4 items-center\">\n          <div class=\"w-8 h-8 font-bold bg-teal-03 text-white rounded-full flex justify-center items-center\">\n            {{ n + 1 }}\n          </div>\n          <p>\n            {{ instruction.text }}\n            <router-link :to=\"{ name: instruction.link }\">\n              <span class=\"underline\">\n                {{ instruction.text_link }}\n              </span>\n            </router-link>\n          </p>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { defineComponent, ref } from 'vue'\n\nexport default defineComponent({\n  name: 'WidgetUnvailable',\n  setup() {\n    const instructions = ref([\n      {\n        link: 'settingCondition',\n        text_link: 'Condition Settings',\n        text: 'Set item conditions as needed within the',\n      },\n      {\n        link: 'settingBulkPriceEditor',\n        text_link: 'Price Editor Settings',\n        text: 'Set item prices as needed within the',\n      }\n    ])\n\n    return {\n      instructions\n    }\n  }\n})\n</script>\n","export default \"__VITE_ASSET__ba52d097__\"","<template>\n  <div v-if=\"available\">\n    <Card v-loading=\"loading || loadingUpdate\">\n      <template #default>\n        <div id=\"widgetIframe\" :class=\"{ 'use-iframe': useIframe }\" />\n      </template>\n    </Card>\n  </div>\n  <div v-else>\n    <Card>\n      <WidgetUnvailable />\n    </Card>\n  </div>\n</template>\n<script>\nimport { defineComponent, onMounted, ref, watch } from 'vue'\n\nimport Card from 'bbUi/components/card/card.vue'\nimport WidgetUnvailable from 'components/Widget/Unavailable/index.vue'\n\nexport default defineComponent({\n  name: 'WidgetPreview',\n  components: {\n    Card,\n    WidgetUnvailable\n  },\n  props: {\n    modelValue: {\n      type: Object,\n      default: undefined\n    },\n    available: {\n      type: Boolean,\n      default: false\n    },\n    loading: {\n      type: Boolean,\n      default: true\n    },\n    loadingUpdate: {\n      type: Boolean,\n      default: false\n    },\n    whiteLabel: {\n      type: Boolean,\n      default: false\n    },\n    tenantId: {\n      type: String,\n      default: undefined\n    },\n    apiKey: {\n      type: String,\n      default: undefined\n    },\n    device: {\n      type: String,\n      default: undefined\n    },\n    brand: {\n      type: String,\n      default: undefined\n    },\n    category: {\n      type: String,\n      default: undefined\n    },\n    language: {\n      type: String,\n      default: undefined\n    },\n    tokenModel: {\n      type: String,\n      default: undefined\n    },\n    tokenLocation: {\n      type: String,\n      default: undefined\n    },\n    useIframe: {\n      type: Boolean,\n      default: true\n    }\n  },\n  setup(props) {\n    const init = ref(false)\n    const destroyingIframe = () => {\n      const containerWidget = document.querySelector('#widgetIframe')\n      const iframe = containerWidget.querySelector('iframe')\n      if (iframe) iframe.remove()\n    }\n    const generateSource = () => {\n      const sourceURL = JSON.parse(window.localStorage.getItem('white-label')) && props.whiteLabel\n        ? import.meta.env.VITE_WIDGET_URL_WHITE_LABEL\n        : import.meta.env.VITE_WIDGET_URL\n\n      const scriptUrl = `${sourceURL}/v3.js`\n\n      return scriptUrl\n    }\n    const generateParams = () => {\n      return {\n        tenantId: props.tenantId,\n        apiKey: props.apiKey,\n        ...(JSON.parse(window.localStorage.getItem('white-label')) && { whiteLabel: props.whiteLabel }),\n        ...(props.device && { deviceSlug: props.device }),\n        ...(props.brand && { brandSlug: props.brand }),\n        ...(props.category && { categorySlug: props.category }),\n        ...(props.language && { language: props.language }),\n        ...(props.tokenModel && { tokenModel: props.tokenModel }),\n        ...(props.tokenLocation && { tokenLocation: props.tokenLocation }),\n        disableFloatButton: false\n      }\n    }\n    const generateIframe = () => {\n      if (init.value) return\n      if (!props.useIframe) return generateUsual()\n\n      if (!props.tenantId && !props.apiKey) {\n        return console.error('Tenant ID and Api Key is required for Widget')\n      } else if (!props.available) {\n        return console.warn('Widget Unavailable!')\n      }\n\n      destroyingIframe()\n\n      const containerWidget = document.querySelector('#widgetIframe')\n      const iframe = document.createElement('iframe')\n      containerWidget.appendChild(iframe)\n      iframe.onload = () => {\n        const iframeDocument = iframe.contentWindow.document\n        iframeDocument.open()\n\n        iframeDocument.write(`\n          <html>\n            <head>\n              <title>Widget Preview</title>\n              <style>\n                * {\n                  padding: 0;\n                  margin: 0;\n                }\n              </style>\n            </head>\n            <body>\n            </body>\n          </html>\n        `)\n        iframeDocument.close()\n\n        const scriptSource = document.createElement('script')\n        scriptSource.src = generateSource()\n        scriptSource.onload = () => {\n          const buybackWidget = document.createElement('div')\n          buybackWidget.classList.add('buyback-widget')\n          const scriptConfig = document.createElement('script')\n          scriptConfig.defer = true\n          scriptConfig.innerText = `new Buyback(${JSON.stringify(generateParams())})`\n          iframe.contentWindow.document.body.appendChild(buybackWidget)\n          iframe.contentWindow.document.body.appendChild(scriptConfig)\n        }\n        iframe.contentWindow.document.body.appendChild(scriptSource)\n      }\n      iframe.src = 'about:blank'\n      iframe.classList.add('w-full')\n      iframe.style.minHeight = `calc(100vh + 20rem)`\n    }\n    const generateUsual = () => {\n      const containerWidget = document.querySelector('#widgetIframe')\n      const buybackWidget = document.createElement('div')\n      buybackWidget.classList.add('buyback-widget')\n\n      const script = document.createElement('script')\n      script.src = generateSource()\n      script.onload = () => {\n        const configScript = document.createElement('script')\n        configScript.innerText = `new Buyback(${JSON.stringify(generateParams())})`\n        configScript.defer = true\n        containerWidget.appendChild(buybackWidget)\n        containerWidget.appendChild(configScript)\n      }\n      containerWidget.appendChild(script)\n    }\n\n    onMounted(() => {\n      generateIframe()\n\n      watch(() => ({\n        loading: props.loading,\n        device: props.device,\n        brand: props.brand,\n        category: props.category,\n        tokenModel: props.tokenModel,\n        language: props.language,\n        tokenLocation: props.tokenLocation\n      }), (newVal, oldValue) => {\n        const hasChanges = Object.keys(newVal).some(key => newVal[key] !== oldValue[key])\n        if (hasChanges) generateIframe()\n      }, { deep: true })\n    })\n  }\n})\n</script>\n"],"names":["_sfc_main","defineComponent","name","setup","instructions","ref","link","text_link","text","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_cache","_createElementVNode","_Fragment","_renderList","_ctx","instruction","n","_openBlock","_createElementBlock","key","_toDisplayString","_createTextVNode","_component_router_link","default","_withCtx","components","Card","WidgetUnvailable","props","modelValue","type","Object","available","Boolean","loading","loadingUpdate","whiteLabel","tenantId","String","apiKey","device","brand","category","language","tokenModel","tokenLocation","useIframe","[object Object]","init","generateSource","JSON","parse","window","localStorage","getItem","generateParams","__spreadValues","deviceSlug","brandSlug","categorySlug","disableFloatButton","generateIframe","value","generateUsual","console","error","warn","iframe","document","querySelector","remove","destroyingIframe","containerWidget","createElement","appendChild","onload","iframeDocument","contentWindow","open","write","close","scriptSource","src","buybackWidget","classList","add","scriptConfig","defer","innerText","stringify","body","style","minHeight","script","configScript","onMounted","watch","newVal","oldValue","keys","some","deep","_withDirectives","_createBlock","_component_Card","id"],"mappings":"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"}