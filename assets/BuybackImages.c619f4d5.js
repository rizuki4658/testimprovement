import{j as a,_ as e,a5 as t,W as s,m as i,$ as o,o as r,n as l,w as n,A as c,B as d,D as u,t as m,a1 as p,a2 as h,ap as g,F as f,ar as y}from"./vendor.9695fe57.js";import{z as w}from"./index.c2f66179.js";import{C as v}from"./card.f57f7ca5.js";import{L as b}from"./LoadingCard.c138fa92.js";import{M as I}from"./MultipleInputFile.7a60a749.js";const $=a("buybackImages",{state:()=>({routeParams:null,isLoading:!1,images:[]}),getters:{},actions:{setRoute(a={}){this.routeParams=a},async $getImages(a){var e,t;this.isLoading=!0,this.images=[];try{const s=await w({url:`/v1/pos/order/picture/${null==(t=null==(e=this.routeParams)?void 0:e.params)?void 0:t.buybackId}`,method:"get",params:a});Object.keys(s).forEach((a=>{this.images=[...this.images,...s[a]]}))}catch(s){console.error("Failed to fetch pictures",s)}finally{this.isLoading=!1}},async $uploadImage(a){this.isLoading=!0;try{await w({url:`/v1/pos/order/picture/${this.routeParams.params.buybackId}`,method:"post",data:a,headers:{"Content-Type":"multipart/form-data"}}),e({message:"Picture uploaded!",type:"success"})}catch(t){console.error("Failed to upload pictures",t)}finally{this.isLoading=!1}},async $deleteImage(a){this.isLoading=!0;try{await w({url:`/v1/pos/order/picture/${a}`,method:"post",data:{_method:"DELETE"}}),e({message:"Picture deleted!",type:"success"})}catch(t){console.error("Failed to upload pictures",t)}finally{this.isLoading=!1}}}}),k={class:"flex items-center gap-2"},L={class:"w-full flex flex-wrap justify-center"},x=["onClick"],j=["alt","src","onClick"],_={__name:"BuybackImages",setup(a){const e=t(),w=$();w.setRoute(e);const _=async a=>{if(!(null==a?void 0:a.length))return;const e=new FormData;for(let[t,s]of Object.entries(a))e.append(`picture_files[${t}]`,s);await w.$uploadImage(e),await w.$getImages()};return s((async()=>{await w.$getImages()})),(a,e)=>{const t=i("Tooltip"),s=o("loading");return r(),l(y,null,{default:n((()=>[c((r(),l(v,null,{header:n((()=>[d("div",k,[e[2]||(e[2]=d("h6",null,"Share Files with Customer",-1)),u(t,{placement:"right"},{content:n((()=>e[0]||(e[0]=[d("div",null,[d("p",{class:"mb-2"},"Upload or drag a file here to share with the customer for the following statuses:"),d("ul",{class:"list-disc pl-4 space-y-1"},[d("li",null,"ON HOLD (General or Activation Lock) or Not As Described."),d("li",{class:"list-none"},"File must be uploaded before changing the status."),d("li",{class:"list-none"},"Once the status is updated and a note is added, the customer will be notified and can view the details in their Customer Portal.")])],-1)]))),default:n((()=>[e[1]||(e[1]=d("span",{class:"material-icons cursor-default"},"info",-1))])),_:1})])])),default:n((()=>[u(I,{preview:"",onInput:_},{preview:n((()=>[d("div",L,[(r(!0),m(p,null,h(g(w).images,((a,t)=>(r(),m("div",{class:f(["m-4 relative transition duration-200","transform hover:scale-105 cursor-pointer"]),key:t},[d("div",{class:f(["absolute top-0 right-0","bg-teal-04 w-1 h-1 p-4","box-content flex items-center","justify-center transform -translate-x-2","-translate-y-1/2 rounded-full font-semibold","text-white hover:bg-white hover:text-teal-04","transition duration-200 cursor-pointer"]),onClick:e=>(async a=>{await w.$deleteImage(a),await w.$getImages()})(a.id)},e[3]||(e[3]=[d("i",{class:"material-icons text-lg"},"close",-1)]),8,x),d("img",{alt:`picture-${t}`,src:a.picture,class:"rounded-md",onClick:e=>{var t;(t=a.picture)&&window.open(t,"_blank")}},null,8,j)])))),128))])])),_:1})])),_:1})),[[s,g(w).isLoading]])])),fallback:n((()=>[u(b)])),_:1})}}};export{_ as default};
