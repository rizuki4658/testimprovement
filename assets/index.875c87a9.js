import{u as e}from"./components.3d07dc59.js";import{k as a,a5 as o,O as t,f as l,g as i,m as s,o as r,t as d,B as m,D as n,w as p,I as w,a1 as c,_ as f}from"./vendor.9695fe57.js";import{D as u,C as g,j as k}from"./setting.ec7e7a35.js";import{D as v}from"./workflow.82480012.js";import{_ as h,b,d as T,R as W}from"./index.9c4dcead.js";import{C as E}from"./card.afeb5d7a.js";import{W as j}from"./Form.fce0e3f7.js";import{B as y}from"./Breadcrumb.faa47922.js";import{P as _}from"./PreviewEmailTemplate.11883a5c.js";import"./LoadingCard.ab052f4a.js";import"./index.f40e4a9e.js";import"./index.6b6f6369.js";import"./index.54844a74.js";import"./fieldset.b90636af.js";import"./InputFile.39706113.js";import"./Colorpicker.3ce6208b.js";import"./MultipleEmailInput.f15ed602.js";import"./TextEditor.1cc179d3.js";import"./index.2ee2bcb0.js";import"./select.399034f1.js";import"./breadcrumb.bd47f77c.js";import"./IframeRender.46e71567.js";const I=a({components:{Button:b,Card:E,WorkflowForm:j,Modal:T,Breadcrumb:y,PreviewEmail:_},async setup(){const e=o(),a=t(),s=e.query.type||"in-store",r=l(null),{data:d,loading:m,loadingEmailTheme:n,actionShow:p,actionUpdate:w,actionUpdateEmailTheme:c}=u({type:s}),{modal:h,loading:b,openModal:T,closeModal:W,actionResetEmailTemplate:E,specialWorkflowIds:j}=g({type:s}),{emailBody:y,isPreview:_,previewedTemplate:I,loading:P,actionWorkflowEmail:x}=k({type:s}),C=i((()=>!d.parent_id&&1==d.havechild)),B=i((()=>m.value));if(!v.includes(parseInt(e.params.workflowId)))return await p(e.params.workflowId),{data:d,specialWorkflowIds:j,loading:m,loadingEmailTheme:n,breadcrumb:[{text:"Settings",to:{name:"setting"}},{text:"Workflow",to:{name:"settingWorkflow"}},{text:"Edit Workflow"}],refForm:r,route:e,isParent:C,isPreview:_,isLoadingEditor:B,previewedTemplate:I,loadingPreviewEmailTemplate:P,modalWorkflow:h,loadingWorkflow:b,openModalWorkflow:T,closeModalWorkflow:W,updateWorkflow:async()=>{var o,t;await(null==(t=null==(o=r.value)?void 0:o.validate)?void 0:t.call(o))&&await w(e.params.workflowId,(async e=>{e&&200===e.status&&await a.push({name:"settingWorkflow"})}))},handleUpdateEmailTheme:async()=>await c(e.params.workflowId,(()=>{f({type:"success",message:"Workflow email theme updated"})})),handlePreviewEmailTemplate:async()=>{y.value=d.email_template,d.id&&await x(d.id)},handleResetTemplate:()=>T("reset_template"),resetTemplate:async()=>await E({id:e.params.workflowId},(async()=>{W("reset_template"),await p(e.params.workflowId)}))};await a.push({name:"settingWorkflow"})}}),P={class:"py-10"},x={class:"text-center"};var C=h(I,[["render",function(e,a,o,t,l,i){const f=s("Button"),u=s("Breadcrumb"),g=s("WorkflowForm"),k=s("Card"),v=s("Modal"),h=s("PreviewEmail");return r(),d(c,null,[m("div",null,[n(u,{class:"mt-2 mb-8",pageTitle:"Edit Workflow",backTo:{name:"settingWorkflow"},items:e.breadcrumb},{right:p((()=>[n(f,{color:"teal",loading:e.loading,onClick:e.updateWorkflow},{default:p((()=>a[3]||(a[3]=[w(" Save Changes ")]))),_:1},8,["loading","onClick"])])),_:1},8,["items"]),n(k,{class:"mb-24"},{default:p((()=>[n(g,{data:e.data,ref:"refForm","disable-status":e.specialWorkflowIds.includes(parseInt(e.route.params.workflowId)),"disbale-send-mail":!1,"is-parent":e.isParent,"loading-theme":e.loadingEmailTheme,"loading-preview-email":e.loadingPreviewEmailTemplate,"loading-editor":e.isLoadingEditor,onUpdateEmailTheme:e.handleUpdateEmailTheme,onPreviewEmail:e.handlePreviewEmailTemplate,onResetTemplate:e.handleResetTemplate,"reset-template":""},null,8,["data","disable-status","is-parent","loading-theme","loading-preview-email","loading-editor","onUpdateEmailTheme","onPreviewEmail","onResetTemplate"])])),_:1})]),n(v,{modelValue:e.modalWorkflow.reset_template,"onUpdate:modelValue":a[1]||(a[1]=a=>e.modalWorkflow.reset_template=a),"hide-footer":"","hide-header":"",size:"xs"},{default:p((()=>[m("div",P,[a[6]||(a[6]=m("img",{class:"mb-10 mx-auto",src:W,alt:"Warning icon"},null,-1)),a[7]||(a[7]=m("div",{class:"mt-8 mb-10"},[m("h5",{class:"mb-4 text-center"},"Reset Email Template"),m("p",{class:"text-center mb-6"}," Are you sure you want to reset to the default email template? ")],-1)),m("div",x,[n(f,{onClick:a[0]||(a[0]=a=>e.closeModalWorkflow("reset_template")),view:"outlined",color:"teal",class:"bg-white",disabled:e.loadingWorkflow.reset_template},{default:p((()=>a[4]||(a[4]=[w("Cancel")]))),_:1},8,["disabled"]),n(f,{onClick:e.resetTemplate,view:"smooth",color:"orange",class:"ml-3",loading:e.loadingWorkflow.reset_template},{default:p((()=>a[5]||(a[5]=[w("Yes, reset")]))),_:1},8,["onClick","loading"])])])])),_:1},8,["modelValue"]),n(h,{show:e.isPreview,"onUpdate:show":a[2]||(a[2]=a=>e.isPreview=a),body:e.previewedTemplate},null,8,["show","body"])],64)}]]),B=a({setup(){const{genSuspense:a}=e();return()=>a(C)}});export{B as default};
