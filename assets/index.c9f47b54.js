var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,s=(e,a)=>{for(var t in a||(a={}))i.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))o.call(a,t)&&n(e,t,a[t]);return e},d=(e,l)=>a(e,t(l));import{u as r}from"./components.aaee2f92.js";import{k as c,r as u,g as m,y as p,m as g,$ as f,o as _,t as v,B as y,A as b,n as h,w,K as x,a1 as k,a2 as C,U as V,W as S,D,I,f as j,s as E,F as $,S as O,a4 as M,ap as A,a5 as U,O as L,aW as P,X as F,_ as T,b1 as B}from"./vendor.9695fe57.js";import{u as q}from"./index.f40e4a9e.js";import{r as N,f as z,g as R,d as J}from"./index.6b6f6369.js";import{f as Y,_ as H,e as W,d as G,b as K,u as X,R as Q,g as Z}from"./index.35a87af4.js";import{C as ee}from"./card.85454cb1.js";import{_ as ae}from"./fieldset.3185be27.js";import{T as te,c as le}from"./TextEditor.17462d6a.js";import{c as ie}from"./copy.6c996115.js";import{r as oe,a as ne,u as se,f as de}from"./index.54844a74.js";import{y as re,v as ce}from"./setting.598aa5c3.js";import{I as ue}from"./InputFile.b42f11bd.js";import{B as me}from"./Breadcrumb.a04d3c7a.js";import{c as pe}from"./dashboard.90190b9a.js";import"./LoadingCard.fae900cb.js";import"./breadcrumb.f242deab.js";import"./date.f86face7.js";const ge=c({components:{Input:Y},props:{data:{type:Object,default:()=>({})},staticData:{type:Object,default:()=>({})},loading:{type:Object,default:()=>({})}},emits:["update"],setup(e,{emit:a}){var t;const l=u({prefix:(null==(t=e.data)?void 0:t.prefix_order_number_sequence)||""}),i=m((()=>l.prefix&&`${l.prefix}0X8R1`||"0X8R1")),o=q({prefix:{required:N}},l,{$lazy:!0});p((()=>{var a;return null==(a=e.data)?void 0:a.prefix_order_number_sequence}),(e=>{void 0!==e&&(l.prefix=e)}),{immediate:!0});const n=async()=>(await o.value.$validate(),!o.value.$invalid&&(a("update:data",{prefix_order_number_sequence:l.prefix}),!0));return s({form:l,preview:i,validation:o,handleSave:n},{handleSave:n})}}),fe={class:"flex gap-4"},_e={class:"text-base"},ve={key:0,class:"mt-2"};var ye=H(ge,[["render",function(e,a,t,l,i,o){var n,s;const d=g("Input"),r=f("maska"),c=f("loading");return _(),v(k,null,[y("div",fe,[b((_(),h(d,{modelValue:e.form.prefix,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.prefix=a),disabled:null==(n=e.loading)?void 0:n.update,view:e.validation.prefix.$invalid?"danger":"default",autocomplete:"off",label:"Buyback Prefix",class:"w-full",icon:"","icon-block":"",right:""},{icon:w((()=>[y("span",_e,x(e.preview),1)])),_:1},8,["modelValue","disabled","view"])),[[r,"S*"],[c,null==(s=e.loading)?void 0:s.all]])]),e.validation.prefix.$invalid?(_(),v("div",ve,[(_(!0),v(k,null,C(e.validation.prefix.$errors,((e,a)=>(_(),v("small",{class:"text-red-base block",key:a},x(e.$message)+". ",1)))),128))])):V("",!0)],64)}]]);const be=c({name:"PriceLock",components:{Input:Y},props:{data:{type:Object,default:()=>({})},staticData:{type:Object,default:()=>({})},loading:{type:Object,default:()=>({})}},setup(e){const a=u({expDays:""}),t={expDays:{required:N,minValue:z(1),maxValue:R(90),isValidNumber:e=>{if(!e||""===e)return!1;const a=parseInt(e);return!isNaN(a)&&a>0}}},l=q(t,a,{$lazy:!0});return p((()=>{var a;return null==(a=e.data)?void 0:a.exp_days_pricelock}),(e=>{void 0!==e&&e!==a.expDays&&(a.expDays=e)}),{immediate:!0}),p((()=>a.expDays),(a=>{null!=a&&e.data&&a!==e.data.exp_days_pricelock&&(e.data.exp_days_pricelock=a)})),S((()=>{var t;void 0!==(null==(t=e.data)?void 0:t.exp_days_pricelock)&&(a.expDays=e.data.exp_days_pricelock)})),{form:a,validation:l,handleSave:async()=>{try{return await l.value.$validate(),l.value.$invalid?(console.error("PriceLock validation failed:",l.value.$errors),!1):(e.data&&(e.data.exp_days_pricelock=a.expDays),!0)}catch(t){return console.error("Error saving PriceLock:",t),!1}}}}}),he={class:"flex-col"},we={class:"flex gap-4"};var xe=H(be,[["render",function(e,a,t,l,i,o){const n=g("Tooltip"),s=g("Input");return _(),v("div",he,[y("div",we,[a[3]||(a[3]=y("label",null,"Price Lock",-1)),D(n,{placement:"top"},{content:w((()=>a[1]||(a[1]=[y("div",{class:"w-80"}," Control the offer lifespan. Set the duration your buyback offer remains valid. After [number] days, any unused offers will automatically expire. ",-1)]))),default:w((()=>[a[2]||(a[2]=y("i",{class:"material-icons mr-2"},"info",-1))])),_:1})]),D(s,{modelValue:e.form.expDays,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.expDays=a),disabled:e.loading.update||e.loading.all,view:e.validation.expDays.$invalid?"danger":"default",class:"w-full input-left-aligned",type:"number",max:90,icon:"","icon-block":"",right:"",autocomplete:"off"},{icon:w((()=>a[4]||(a[4]=[y("span",{class:"text-base"},"/days",-1)]))),_:1},8,["modelValue","disabled","view"]),(_(!0),v(k,null,C(e.validation.expDays.$errors,((e,a)=>(_(),v("small",{class:"text-red-base block",key:a},x(e.$message)+". ",1)))),128)),a[5]||(a[5]=y("small",{class:"block mt-2"},[y("span",{class:"font-semibold"},"Max Day"),I(" : 90 days ")],-1))])}],["__scopeId","data-v-91df9a7e"]]);const ke=c({name:"AutoAccept",components:{Input:Y,Card:ee,Checkbox:W},props:{data:{type:Object,default:()=>({})},staticData:{type:Object,default:()=>({})},loading:{type:Object,default:()=>({})}},setup(e){const a=u({isAutoAcceptEnabled:!1,expiryDays:""}),t={expiryDays:{requiredIf:J((()=>a.isAutoAcceptEnabled)),isValidNumber:e=>{if(!e&&0!==e)return!0;const a=parseInt(e,10);return!isNaN(a)&&a>0},minValue:(l=15,e=>{if(!e&&0!==e)return!0;const a=parseInt(e,10);return!isNaN(a)&&a>=l})}};var l;const i=q(t,a,{$lazy:!0}),o=e=>!0===e||"1"===e?"1":"0",n=e=>"1"===e||!0===e;return p((()=>{var a,t;return[null==(a=e.data)?void 0:a.widget_is_enable_auto_accept,null==(t=e.data)?void 0:t.widget_auto_accept_expiry_days]}),(([e,t])=>{void 0!==e&&(a.isAutoAcceptEnabled=n(e)),void 0!==t&&(a.expiryDays=t?String(t):"")}),{immediate:!0}),p((()=>a.isAutoAcceptEnabled),(t=>{e.data&&(e.data.widget_is_enable_auto_accept=o(t),t?""!==a.expiryDays&&a.expiryDays||(a.expiryDays="15",e.data.widget_auto_accept_expiry_days="15"):(a.expiryDays="",e.data.widget_auto_accept_expiry_days=null))})),S((()=>{var t,l;void 0!==(null==(t=e.data)?void 0:t.widget_is_enable_auto_accept)&&(a.isAutoAcceptEnabled=n(e.data.widget_is_enable_auto_accept)),void 0!==(null==(l=e.data)?void 0:l.widget_auto_accept_expiry_days)&&(a.expiryDays=e.data.widget_auto_accept_expiry_days?String(e.data.widget_auto_accept_expiry_days):"")})),{form:a,validation:i,handleSave:async()=>(await i.value.$validate(),!i.value.$invalid&&(e.data&&(e.data.widget_is_enable_auto_accept=o(a.isAutoAcceptEnabled),e.data.widget_auto_accept_expiry_days=a.isAutoAcceptEnabled&&a.expiryDays?String(a.expiryDays):null),!0)),handleInput:async()=>{e.data&&a.isAutoAcceptEnabled&&(e.data.widget_auto_accept_expiry_days=a.expiryDays&&""!==a.expiryDays.trim()?a.expiryDays.trim():null)},handleBlur:async()=>{Number(a.expiryDays)<15&&(a.expiryDays=15,e.data.widget_auto_accept_expiry_days=a.expiryDays)}}}}),Ce={class:"rounded-xl border-grey-01 border p-6"},Ve={class:"flex flex-col gap-4"},Se={class:"flex items-center gap-2"},De={key:0};var Ie=H(ke,[["render",function(e,a,t,l,i,o){const n=g("Checkbox"),s=g("Tooltip"),d=g("Input");return _(),v("div",Ce,[y("div",Ve,[y("div",Se,[D(n,{modelValue:e.form.isAutoAcceptEnabled,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.isAutoAcceptEnabled=a),type:"toggle",disabled:e.loading.update||e.loading.all},null,8,["modelValue","disabled"]),a[4]||(a[4]=y("label",null,"Auto-Accept Revised Offers",-1)),D(s,{placement:"top"},{content:w((()=>a[2]||(a[2]=[y("div",{class:"w-80"}," Specify the number of days after which the system will automatically accept revised offers if the customer doesn't take any action during that period. The offer status will then be updated to 'Seller Acceptedâ€‘Automatically Accepted'. ",-1)]))),default:w((()=>[a[3]||(a[3]=y("i",{class:"material-icons mr-2"},"info",-1))])),_:1})]),e.form.isAutoAcceptEnabled?(_(),v("div",De,[D(d,{modelValue:e.form.expiryDays,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.expiryDays=a),disabled:e.loading.update||e.loading.all||!e.form.isAutoAcceptEnabled,view:e.validation.expiryDays.$invalid?"danger":"default",class:"w-full input-left-aligned",icon:"","icon-block":"",right:"",type:"number",autocomplete:"off",onInput:e.handleInput,onChange:e.handleBlur},{icon:w((()=>a[5]||(a[5]=[y("span",{class:"text-base"},"/days",-1)]))),_:1},8,["modelValue","disabled","view","onInput","onChange"]),(_(!0),v(k,null,C(e.validation.expiryDays.$errors,((e,a)=>(_(),v("small",{class:"text-red-base block mt-1",key:a},x(e.$message)+". ",1)))),128)),a[6]||(a[6]=y("small",{class:"mt-2"},[y("span",{class:"font-semibold"},"Min Day"),I(": 15 days ")],-1))])):V("",!0)])])}],["__scopeId","data-v-5c81a63c"]]);const je=c({components:{Fieldset:ae,Checkbox:W,TextEditor:te},props:{data:{type:Object,required:!0},staticData:{type:Object,default:()=>({})},loading:{type:Object,default:()=>({})}},setup(e,{expose:a}){const t=j(null),l=u({editor:le.exports.Editor,config:{htmlSupport:{allow:[{styles:!0,classes:!0}]}}}),i=m((()=>e.data.widget_auto_disabled_imei)),o=u({widget_is_enable_imei_input:e.data.widget_is_enable_imei_input||"0",widget_is_enable_imei_ins_msg:e.data.widget_is_enable_imei_ins_msg||"0",widget_imei_ins_msg:e.data.widget_imei_ins_msg||"",widget_imei_icon_selected:e.data.widget_imei_icon_selected||""}),n=()=>{E((()=>{Object.keys(o).forEach((a=>{e.data[a]=o[a]}))}))},s=async()=>{try{return Object.keys(o).forEach((a=>{e.data[a]=o[a]})),!0}catch(a){return console.error("Error saving IMEI settings:",a),!1}};return p((()=>e.data),(e=>{e&&(o.widget_is_enable_imei_input=e.widget_is_enable_imei_input||"0",o.widget_is_enable_imei_ins_msg=e.widget_is_enable_imei_ins_msg||"0",o.widget_imei_ins_msg=e.widget_imei_ins_msg||"",o.widget_imei_icon_selected=e.widget_imei_icon_selected||"")}),{immediate:!0,deep:!0}),a({handleSave:s}),{iconOptions:[{icon:"https://d18hvo5uozp8li.cloudfront.net/public/images/electric_bolt.svg",value:"https://d18hvo5uozp8li.cloudfront.net/public/images/electric_bolt.svg"},{icon:"https://d18hvo5uozp8li.cloudfront.net/public/images/speed.svg",value:"https://d18hvo5uozp8li.cloudfront.net/public/images/speed.svg"},{icon:"https://d18hvo5uozp8li.cloudfront.net/public/images/quickreply.svg",value:"https://d18hvo5uozp8li.cloudfront.net/public/images/quickreply.svg"},{icon:"https://d18hvo5uozp8li.cloudfront.net/public/images/warning-icon.svg",value:"https://d18hvo5uozp8li.cloudfront.net/public/images/warning-icon.svg"},{icon:"https://d18hvo5uozp8li.cloudfront.net/public/images/chat_bubble_outline.svg",value:"https://d18hvo5uozp8li.cloudfront.net/public/images/chat_bubble_outline.svg"},{icon:"https://d18hvo5uozp8li.cloudfront.net/public/images/motion_photos_off.svg",value:""}],localForm:o,selectIcon:e=>{o.widget_imei_icon_selected=e,n()},handleSave:s,ckeditor:l,refTextEditor:t,disabledImei:i,toolbarItems:["undo","redo","link","horizontalLine","specialCharacters","heading","|","bold","italic","underline","strikethrough",{label:"Basic styles",icon:"text",items:["fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","superscript","subscript","code","|","textPartLanguage","|"]},"removeFormat","|","alignment","|","bulletedList","numberedList","|","outdent","indent"],updateParent:n}}}),Ee={class:"grid grid-cols-1 gap-4"},$e={class:"flex items-center"},Oe={class:"w-80"},Me={key:0,class:"ml-8"},Ae={class:"mt-4"},Ue={class:"mt-4"},Le={class:"w-full grid grid-cols-6 gap-6 mt-4"},Pe=["onClick","disabled"],Fe=["src","alt"];var Te=H(je,[["render",function(e,a,t,l,i,o){const n=g("Checkbox"),s=g("Tooltip"),d=g("TextEditor"),r=g("Fieldset");return _(),h(r,{class:"rounded-xl"},{label:w((()=>a[3]||(a[3]=[I("IMEI/SN Input Section")]))),default:w((()=>[y("div",Ee,[y("div",$e,[D(n,{id:"widget_is_enable_imei_input",modelValue:e.localForm.widget_is_enable_imei_input,"onUpdate:modelValue":[a[0]||(a[0]=a=>e.localForm.widget_is_enable_imei_input=a),e.updateParent],loading:e.loading.all,disabled:e.loading.update||e.disabledImei,type:"toggle",value:"1","value-off":"0"},{default:w((()=>a[4]||(a[4]=[I(" IMEI/SN Input Section ")]))),_:1},8,["modelValue","loading","disabled","onUpdate:modelValue"]),D(s,{placement:"top"},{content:w((()=>[y("div",Oe,x(e.disabledImei?"IMEI/SN settings are only available for electronics. Please enable electronics in your catalog to modify this setting.":"This setting applies only to electronics and products with IMEI/SN. If no electronics are enabled in the catalog, this setting will be disabled."),1)])),default:w((()=>a[5]||(a[5]=[y("i",{class:"material-icons"},"info",-1)]))),_:1})]),"1"==e.localForm.widget_is_enable_imei_input?(_(),v("div",Me,[D(n,{modelValue:e.localForm.widget_is_enable_imei_ins_msg,"onUpdate:modelValue":[a[1]||(a[1]=a=>e.localForm.widget_is_enable_imei_ins_msg=a),e.updateParent],loading:e.loading.all,disabled:e.loading.update,type:"toggle",value:"1","value-off":"0"},{default:w((()=>a[6]||(a[6]=[I(" Instructional Message ")]))),_:1},8,["modelValue","loading","disabled","onUpdate:modelValue"]),"1"==e.localForm.widget_is_enable_imei_ins_msg?(_(),v(k,{key:0},[y("div",Ae,[a[7]||(a[7]=y("label",{class:"text-sm font-semibold block"},"Text for Checkout Page Section",-1)),D(d,{ref:"refTextEditor",modelValue:e.localForm.widget_imei_ins_msg,"onUpdate:modelValue":[a[2]||(a[2]=a=>e.localForm.widget_imei_ins_msg=a),e.updateParent],options:e.ckeditor,toolbarItems:e.toolbarItems},null,8,["modelValue","options","toolbarItems","onUpdate:modelValue"])]),y("div",Ue,[a[8]||(a[8]=y("label",{class:"text-sm font-semibold block"},"Icon",-1)),y("div",Le,[(_(!0),v(k,null,C(e.iconOptions,(a=>(_(),v("button",{type:"button",key:a.value,class:$(["p-2 rounded-xl",e.localForm.widget_imei_icon_selected===a.value?"border-4 border-teal-04":"border border-grey-01"]),onClick:O((t=>e.selectIcon(a.value)),["prevent"]),disabled:e.loading.update},[y("img",{class:"mx-auto",src:a.icon,alt:a.icon},null,8,Fe)],10,Pe)))),128))])])],64)):V("",!0)])):V("",!0)])])),_:1})}],["__scopeId","data-v-23a44f25"]]);const Be=c({components:{Modal:G,Input:Y,Button:K,Fieldset:ae,InputFile:ue},props:{modelValue:{type:Boolean,default:!1},initialData:{type:Object,default:()=>({title:"",description:"",hyperlink:"",icon:null})}},emits:["update:modelValue","saved"],setup(e,{emit:a}){const{data:t,show:l,update:i,loading:o}=re(),n={title:{required:oe,maxLength:ne(32)},description:{required:oe,maxLength:ne(80)},hyperlink:{required:oe,url:se},icon:{required:oe,fileSize:de}},d=()=>{e.initialData&&Object.keys(e.initialData).length>0&&(t.value={title:e.initialData.title||"",description:e.initialData.description||"",hyperlink:e.initialData.hyperlink||"",icon:e.initialData.icon||null})},r=q(n,t,{$lazy:!0}),c=m({get:()=>e.modelValue,set:e=>a("update:modelValue",e)});p((()=>e.modelValue),(async(e,a)=>{e&&!a?(r.value.$reset(),await u()):!e&&a&&g()})),p((()=>e.initialData),(()=>{e.modelValue&&d()}),{deep:!0});const u=async()=>{try{console.log("Opening modal with data:",e.initialData),e.initialData&&Object.keys(e.initialData).some((a=>e.initialData[a]))?t.value=s({},e.initialData):await l()}catch(a){console.error("Error opening modal:",a)}},g=()=>{r.value.$reset(),a("update:modelValue",!1)};return d(),{customModal:c,dataCustom:t,validation:r,loadingCustom:o,handleOpenModal:u,handleCloseModal:g,handleFile:e=>{t.value.icon=e},handleSubmit:async()=>{try{await r.value.$validate(),r.value.$invalid||(await i((()=>{a("saved",t.value),a("update:modelValue",!1)})),r.value.$reset())}catch(e){console.error("Error saving custom purchasing method:",e)}}}}}),qe={key:0,class:"text-grey-02"},Ne={key:0,class:"text-grey-02"},ze={class:"max-w-md"},Re={key:0},Je={class:"flex items-center justify-end"};const Ye=c({components:{Fieldset:ae,Button:K,Modal:G,Checkbox:W,TextEditor:te,CustomModal:H(Be,[["render",function(e,a,t,l,i,o){const n=g("Input"),s=g("InputFile"),d=g("Fieldset"),r=g("Button"),c=g("Modal"),u=f("loading");return _(),h(M,{to:"body"},[D(c,{modelValue:e.customModal,"onUpdate:modelValue":a[4]||(a[4]=a=>e.customModal=a),title:"Custom Purchasing Method",size:"sm",onClose:e.handleCloseModal},{footer:w((()=>[y("div",Je,[D(r,{color:"teal",loading:e.loadingCustom,onClick:e.handleSubmit},{default:w((()=>a[7]||(a[7]=[I("Save Changes")]))),_:1},8,["loading","onClick"])])])),default:w((()=>[b((_(),v("form",{class:"mt-6 space-y-4",onSubmit:a[3]||(a[3]=O(((...a)=>e.handleSubmit&&e.handleSubmit(...a)),["prevent"]))},[y("div",null,[D(n,{modelValue:e.dataCustom.title,"onUpdate:modelValue":a[0]||(a[0]=a=>e.dataCustom.title=a),name:"widget-purchase-custom-title",id:"widgetPurchaseCustomTitle",label:"Title",block:""},null,8,["modelValue"]),(_(!0),v(k,null,C(e.validation.title.$errors,((e,a)=>(_(),v("small",{key:a,class:"mt-2 text-red-base block"},x(e.$message)+". ",1)))),128)),e.validation.title.$errors.length?V("",!0):(_(),v("small",qe," Maximal 32 characters "))]),y("div",null,[D(n,{modelValue:e.dataCustom.description,"onUpdate:modelValue":a[1]||(a[1]=a=>e.dataCustom.description=a),name:"widget-purchase-custom-description",id:"widgetPurchaseCustomDescription",label:"Description",block:""},null,8,["modelValue"]),(_(!0),v(k,null,C(e.validation.description.$errors,((e,a)=>(_(),v("small",{key:a,class:"mt-2 text-red-base block"},x(e.$message)+". ",1)))),128)),e.validation.description.$errors.length?V("",!0):(_(),v("small",Ne," Maximal 80 characters "))]),y("div",null,[D(n,{modelValue:e.dataCustom.hyperlink,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dataCustom.hyperlink=a),name:"widget-purchase-custom-hyperlink",id:"widgetPurchaseCustomHyperlink",label:"Hyperlink",block:""},null,8,["modelValue"]),(_(!0),v(k,null,C(e.validation.hyperlink.$errors,((e,a)=>(_(),v("small",{key:a,class:"mt-2 text-red-base block"},x(e.$message)+". ",1)))),128))]),D(d,{class:"rounded-md"},{label:w((()=>a[5]||(a[5]=[I("Upload Icon")]))),default:w((()=>[y("div",ze,[D(s,{preview:"",file:e.dataCustom.icon,action:!1,onInput:e.handleFile},{description:w((()=>[(_(!0),v(k,null,C(e.validation.icon.$errors,((e,a)=>(_(),v("small",{key:a,class:"mt-2 text-red-base block"},x(e.$message)+". ",1)))),128)),e.validation.icon.$errors?V("",!0):(_(),v("small",Re,a[6]||(a[6]=[y("b",null,"Suggested",-1),I(" : 96x96px ; "),y("b",null,"File",-1),I(" : PNG, JPG, JPEG, WEBP ; "),y("b",null,"Max",-1),I(" 250KB ")])))])),_:1},8,["file","onInput"])])])),_:1})],32)),[[u,e.loadingCustom]])])),_:1},8,["modelValue","onClose"])])}]]),Input:Y},props:{data:{type:Object,required:!0,default:()=>({})},staticData:{type:Object,default:()=>({})},loading:{type:Object,default:()=>({update:!1,message:!1})}},emits:["update:data"],setup(e,{expose:a,emit:t}){const l=u({mailin:!1,instore:!1,preview:!1}),i=j(!1),o=j(""),n=j(""),r=u({editor:le.exports.Editor,config:{mediaEmbed:{previewsInData:!0},toolbar:["heading","|","bold","italic","link","|","bulletedList","numberedList","|","outdent","indent","|","blockQuote","insertTable","|","undo","redo"],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"}]}}}),c=[{key:"mailin",label:"Mail-In"},{key:"instore",label:"In-Store"},{key:"custom",label:"Custom"}],g=u({mailin_enabled:!1,instore_enabled:!1,custom_enabled:!1}),f=j(""),_=j(""),v=e=>{switch(e){case"mailin":return g.mailin_enabled;case"instore":return g.instore_enabled;case"custom":return g.custom_enabled;default:return!1}},y=a=>{if(e.loading.update)return!0;const t=e.data.purchasing_method_rules;if("mailin"===a&&(!1===t.mailin_has_payout||!1===t.mailin_has_locations))return!0;if("instore"===a&&(!1===t.instore_has_payout||!1===t.instore_has_locations))return!0;if(!g.instore_enabled&&!g.mailin_enabled)return!1;switch(a){case"mailin":return!g.instore_enabled;case"instore":return!g.mailin_enabled;default:return!1}},b=u({title:"",message:""});p((()=>e.data.manual_shipping_warning),(e=>{null!=e&&(b.title=e.title||"",b.message=e.message||"")}),{immediate:!0,deep:!0});const h=m((()=>({title:{required:J((()=>1==e.data.is_manual_shipping_warning))},message:{required:J((()=>1==e.data.is_manual_shipping_warning))}}))),w=q(h,b,{$lazy:!0,$scope:"manualShippingOnly",$autoDirty:!1}),x=async()=>{try{w.value.$reset();return!!(await w.value.$validate())||(console.error("Manual shipping validation failed:",{errors:w.value.$errors,data:b,rules:h.value,isRequired:1==e.data.is_manual_shipping_warning}),!1)}catch(a){return console.error("Error validating manual shipping:",a),!1}},k=m((()=>c.map((e=>d(s({},e),{enabled:v(e.key),disabled:y(e.key)}))))),C=a=>{const t=e.data.purchasing_method||{},l=parseInt(t.value)||0;switch(a){case"mailin":return 1===l||2===l;case"instore":return 1===l||3===l;case"custom":return!0===t.custom;default:return!1}},V=()=>{var a;const t=e.data.widget_confirm_msg||{};let l="",i="";if("string"==typeof t&&t.includes("instore:")&&t.includes("mailin:"))try{t.replace(/{|}/g,"").split(", ").forEach((e=>{e.includes("instore:")?i=e.split("instore: ")[1].replace(/"/g,""):e.includes("mailin:")&&(l=e.split("mailin: ")[1].replace(/"/g,""))}))}catch(n){console.warn("Failed to parse confirmation message string format")}else"object"==typeof t&&null!==t&&("string"==typeof t.mailin?l=t.mailin:t.mailin&&"object"==typeof t.mailin&&(l=t.mailin.message||""),"string"==typeof t.instore?i=t.instore:t.instore&&"object"==typeof t.instore&&(i=t.instore.message||""));g.mailin_enabled=C("mailin"),g.instore_enabled=C("instore"),g.custom_enabled=C("custom");const o=e.data.purchasing_method_rules||{};"0"===(null==(a=e.data.purchasing_method)?void 0:a.value)&&(!1===o.mailin_has_payout&&!1===o.mailin_has_locations&&!0===o.instore_has_payout&&!0===o.instore_has_locations&&(g.mailin_enabled=!1,g.instore_enabled=!0),!1===o.instore_has_payout&&!1===o.instore_has_locations&&!0===o.mailin_has_payout&&!0===o.mailin_has_locations&&(g.instore_enabled=!1,g.mailin_enabled=!0)),f.value=l,_.value=i,(()=>{const a=e.data.manual_shipping_warning||{};b.title=a.title||"",b.message=a.message||""})()},S=m((()=>c.length>0)),D=()=>{E((()=>{let a=0;g.mailin_enabled&&g.instore_enabled?a=1:g.mailin_enabled&&!g.instore_enabled?a=2:!g.mailin_enabled&&g.instore_enabled&&(a=3);const l=e.data.widget_confirm_msg||{},i=e=>"string"==typeof e?e:e&&"object"==typeof e&&e.message?e.message:"",o=s({mailin:i(l.mailin)||f.value||"",instore:i(l.instore)||_.value||""},void 0!==l.custom&&{custom:i(l.custom)||""}),n=d(s({},e.data),{widget_confirm_msg:o,purchasing_method:d(s({},e.data.purchasing_method),{value:a.toString(),custom:g.custom_enabled})});t("update:data",n)}))};return p((()=>e.data),(e=>{e&&V()}),{immediate:!0,deep:!0}),p((()=>e.loading.update),(e=>{e||Object.keys(l).forEach((e=>{"preview"!==e&&(l[e]=!1)}))})),V(),a({handleSave:async()=>{try{return D(),!0}catch(e){return console.error("Error saving confirmation message settings:",e),!1}}}),{tableData:k,modal:l,showCustomModal:i,preview:o,currentPreviewType:n,ckeditor:r,messageMailin:f,messageInstore:_,localForm:g,copyText:ie,handlePreview:a=>{var t,i,s;n.value=a,l.preview=!0;const d=e.data.widget_confirm_msg||{};switch(a){case"mailin":o.value=("string"==typeof d.mailin?d.mailin:null==(t=d.mailin)?void 0:t.message)||f.value||"No message set";break;case"instore":o.value=("string"==typeof d.instore?d.instore:null==(i=d.instore)?void 0:i.message)||_.value||"No message set";break;case"custom":o.value=("string"==typeof d.custom?d.custom:null==(s=d.custom)?void 0:s.message)||"No message set";break;default:o.value="No message available"}},handleEdit:e=>{switch(e){case"mailin":l.mailin=!0;break;case"instore":l.instore=!0}},handleCustomSettings:()=>{i.value=!0},handleCustomSaved:()=>{D()},handleSave:async()=>{try{if(1==e.data.is_manual_shipping_warning){if(!(await x()))return!1}const a=e.data.widget_confirm_msg||{},i=s({},a),o=e=>"string"==typeof e?e:e&&"object"==typeof e&&e.message?e.message:"";i.mailin=o(i.mailin)||"",i.instore=o(i.instore)||"",void 0!==i.custom&&(i.custom=o(i.custom)||""),l.mailin&&(i.mailin=f.value),l.instore&&(i.instore=_.value);const n=d(s({},e.data),{widget_confirm_msg:i,manual_shipping_warning:{title:b.title,message:b.message}});return t("update:data",n),w.value.$reset(),Object.keys(l).forEach((e=>{"preview"!==e&&(l[e]=!1)})),!0}catch(a){return console.error("Error saving confirmation message:",a),!1}},handleCheckboxChange:(e,a)=>{switch(e){case"mailin":g.mailin_enabled=a;break;case"instore":g.instore_enabled=a;break;case"custom":g.custom_enabled=a}D()},updateParent:D,isPurchaseMethodEnabled:C,hasTableData:S,getCustomData:()=>{var a;const t=(null==(a=e.data.purchasing_method)?void 0:a.custom)||{};return{title:t.title||"",description:t.description||"",hyperlink:t.hyperlink||"",icon:t.icon||null}},manualShippingValidation:w,manualShippingData:b,validateManualShipping:x,handleClose:async()=>{if(1==e.data.is_manual_shipping_warning){if(!(await x()))return!1}}}},computed:{checkboxConfig(){const e=this.data.purchasing_method_rules,a=a=>"mailin"===a?!1!==e.instore_has_locations&&this.localForm.instore_enabled:"instore"!==a||!1!==e.mailin_has_locations&&this.localForm.mailin_enabled;return{mailin:{needsTooltip:!1===e.mailin_has_locations||!1===e.mailin_has_payout||this.localForm.mailin_enabled&&!a("mailin"),message:(()=>this.localForm.mailin_enabled&&!a("mailin")?"You don't have another purchasing method so you can't turn off this purchasing method.":!1===e.mailin_has_payout?"Please enable payouts first to modify the purchasing method.":"Please add a Mail-In location on the Locations Settings page before choosing Mail-In as your widget type.")()},instore:{needsTooltip:!1===e.instore_has_locations||!1===e.instore_has_payout||this.localForm.instore_enabled&&!a("instore"),message:(()=>this.localForm.instore_enabled&&!a("instore")?"You don't have another purchasing method so you can't turn off this purchasing method.":!1===e.instore_has_payout?"Please enable payouts first to modify the purchasing method.":"Please add an In-Store location on the Locations Settings page before choosing In-Store as your widget type.")()}}}}}),He={class:"flex items-center gap-x-3"},We={class:"w-80"},Ge=["for"],Ke=["onClick"],Xe=["onClick"],Qe={key:1,class:"text-center py-8"},Ze={key:2,class:"mt-4 mb-2 space-y-2"},ea={class:"flex"},aa={class:"mr-2"},ta=["onClick"],la={class:"flex justify-end"},ia={class:"flex items-center"},oa={class:"mr-2"},na=["onClick"],sa={class:"flex justify-end"},da={class:"bg-black bg-opacity-30 py-6 px-12"},ra={class:"bg-white rounded-lg shadow-lg p-6"},ca=["innerHTML"],ua={class:"flex justify-start"};var ma=H(Ye,[["render",function(e,a,t,l,i,o){const n=g("Checkbox"),s=g("Tooltip"),d=g("TableColumn"),r=g("Button"),c=g("DropdownItem"),u=g("DropdownMenu"),m=g("Dropdown"),p=g("Table"),S=g("Fieldset"),j=g("Input"),E=g("TextEditor"),$=g("Modal"),O=g("CustomModal"),A=f("loading");return _(),v(k,null,[D(S,{class:"mb-6 rounded-xl block"},{label:w((()=>a[11]||(a[11]=[I("Confirmation Message")]))),default:w((()=>[e.hasTableData?(_(),h(p,{key:0,data:e.tableData},{default:w((()=>[D(d,{label:"Purchasing Method",align:"center"},{default:w((a=>{var t;return[y("div",He,[(null==(t=e.checkboxConfig[a.row.key])?void 0:t.needsTooltip)?(_(),h(s,{key:0,placement:"top"},{content:w((()=>[y("div",We,x(e.checkboxConfig[a.row.key].message),1)])),default:w((()=>[D(n,{id:`purchasing_${a.row.key}`,type:"toggle",modelValue:a.row.enabled,"onUpdate:modelValue":[e=>a.row.enabled=e,t=>e.handleCheckboxChange(a.row.key,t)],disabled:a.row.disabled||e.loading.update,value:!0,"value-off":!1},null,8,["id","modelValue","onUpdate:modelValue","disabled"])])),_:2},1024)):(_(),h(n,{key:1,id:`purchasing_${a.row.key}`,type:"toggle",modelValue:a.row.enabled,"onUpdate:modelValue":[e=>a.row.enabled=e,t=>e.handleCheckboxChange(a.row.key,t)],disabled:a.row.disabled||e.loading.update,value:!0,"value-off":!1},null,8,["id","modelValue","onUpdate:modelValue","disabled"])),y("label",{for:`purchasing_${a.row.key}`,class:"cursor-pointer py-1"},x(a.row.label),9,Ge)])]})),_:1}),D(d,{label:"Confirmation Message",align:"center"},{default:w((t=>[D(m,{trigger:"click",class:"flex justify-center",placement:"bottom"},{dropdown:w((()=>[D(u,null,{default:w((()=>["custom"!==t.row.key?(_(),h(c,{key:0},{default:w((()=>[y("button",{class:"w-full text-left hover:bg-gray-50 flex items-center gap-x-2 transition-colors",onClick:a=>e.handleEdit(t.row.key)},a[13]||(a[13]=[y("i",{class:"material-icons text-sm"},"edit",-1),I(" Edit ")]),8,Ke)])),_:2},1024)):V("",!0),"custom"!==t.row.key?(_(),h(c,{key:1,class:"py-1"},{default:w((()=>[y("button",{class:"w-full text-left hover:bg-gray-50 flex items-center gap-x-2 transition-colors",onClick:a=>e.handlePreview(t.row.key)},a[14]||(a[14]=[y("i",{class:"material-icons text-sm"},"visibility",-1),I(" Preview ")]),8,Xe)])),_:2},1024)):V("",!0),"custom"===t.row.key?(_(),h(c,{key:2},{default:w((()=>[y("button",{class:"w-full text-left hover:bg-gray-50 flex items-center gap-x-2 transition-colors",onClick:a[0]||(a[0]=(...a)=>e.handleCustomSettings&&e.handleCustomSettings(...a))},a[15]||(a[15]=[y("i",{class:"material-icons text-sm"},"settings",-1),I(" Settings ")]))])),_:1})):V("",!0)])),_:2},1024)])),default:w((()=>[D(r,{color:"teal",view:"outlined",icon:"",class:"btn-action",dense:"",disabled:e.loading.update},{default:w((()=>a[12]||(a[12]=[y("i",{class:"material-icons text-sm"},"more_horiz",-1)]))),_:1},8,["disabled"])])),_:2},1024)])),_:1})])),_:1},8,["data"])):(_(),v("div",Qe,a[16]||(a[16]=[y("div",{class:"text-gray-400 mb-2"},[y("i",{class:"material-icons text-4xl"},"inbox")],-1),y("h3",{class:"text-lg font-medium text-gray-500 mb-2"},"No Data to Show",-1),y("p",{class:"text-gray-400 text-sm"}," No purchasing methods are currently configured or available. ",-1)])))])),_:1}),(_(),h(M,{to:"body"},[D($,{modelValue:e.modal.mailin,"onUpdate:modelValue":a[5]||(a[5]=a=>e.modal.mailin=a),title:"Confirmation Message (Mail-In)",size:"md",onClose:e.handleClose},{footer:w((()=>[y("div",la,[D(r,{color:"teal",loading:e.loading.update,onClick:e.handleSave},{default:w((()=>a[24]||(a[24]=[I("Save Changes")]))),_:1},8,["loading","onClick"])])])),default:w((()=>[D(S,{class:"mb-6 rounded-xl"},{label:w((()=>a[17]||(a[17]=[y("span",{class:"text-grey-03"},"Manual shipping label",-1)]))),default:w((()=>[e.data.is_courier_active?(_(),h(s,{key:0,placement:"top"},{content:w((()=>a[19]||(a[19]=[y("div",{class:"text-center leading-6 w-80"}," This feature is disabled because you're already using a shipping integration. ",-1)]))),default:w((()=>[D(n,{type:"toggle",color:"teal",disabled:"",value:"1","value-off":"0"},{default:w((()=>a[18]||(a[18]=[I(" Manual shipping label text ")]))),_:1})])),_:1})):(_(),h(n,{key:1,type:"toggle",color:"teal",value:"1","value-off":"0",modelValue:e.data.is_manual_shipping_warning,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.is_manual_shipping_warning=a)},{default:w((()=>a[20]||(a[20]=[I(" Manual shipping label text ")]))),_:1},8,["modelValue"])),D(s,{placement:"top"},{content:w((()=>a[21]||(a[21]=[y("div",{class:"text-center leading-6",style:{width:"400px"}}," This message will appear when no shipping integrations is enabled for Mail-in. In this case, customer will not received automatically generated labels, and you'll need to manually process the shipping labels and email them to the customer. You can also add any message or instructions for your customers. ",-1)]))),default:w((()=>[a[22]||(a[22]=y("i",{class:"material-icons mr-2"},"info",-1))])),_:1}),1==e.data.is_manual_shipping_warning?(_(),v("div",Ze,[D(j,{modelValue:e.manualShippingData.title,"onUpdate:modelValue":a[2]||(a[2]=a=>e.manualShippingData.title=a),type:"text",label:"Title",placeholder:"title...",class:"w-full",view:e.manualShippingValidation.title.$invalid?"danger":"default"},null,8,["modelValue","view"]),(_(!0),v(k,null,C(e.manualShippingValidation.title.$errors,((e,a)=>(_(),v("small",{key:a,class:"text-danger"},x(e.$message),1)))),128)),D(j,{modelValue:e.manualShippingData.message,"onUpdate:modelValue":a[3]||(a[3]=a=>e.manualShippingData.message=a),type:"text",label:"Text Message",placeholder:"message...",class:"w-full",view:e.manualShippingValidation.message.$invalid?"danger":"default"},null,8,["modelValue","view"]),(_(!0),v(k,null,C(e.manualShippingValidation.message.$errors,((e,a)=>(_(),v("small",{key:a,class:"text-danger"},x(e.$message),1)))),128))])):V("",!0)])),_:1}),y("div",null,[a[23]||(a[23]=y("div",{class:"my-4 text-gray-600"}," You can customize the message that appears on offer details page ",-1)),D(E,{modelValue:e.messageMailin,"onUpdate:modelValue":a[4]||(a[4]=a=>e.messageMailin=a),options:e.ckeditor},null,8,["modelValue","options"])]),y("div",null,[e.staticData.widget_confirm_msg_shortcode&&Array.isArray(e.staticData.widget_confirm_msg_shortcode)?(_(),h(p,{key:0,class:"mt-6",data:e.staticData.widget_confirm_msg_shortcode},{default:w((()=>[D(d,{prop:"code",label:"Code"},{default:w((a=>[y("div",ea,[y("code",aa,x(a.row.code),1),y("i",{class:"material-symbols-outlined text-lg text-teal-04",onClick:t=>e.copyText(a.row.code),title:"Copy to clipboard"}," content_copy ",8,ta)])])),_:1}),D(d,{prop:"description",label:"Description"})])),_:1},8,["data"])):V("",!0)])])),_:1},8,["modelValue","onClose"]),D($,{modelValue:e.modal.instore,"onUpdate:modelValue":a[7]||(a[7]=a=>e.modal.instore=a),title:"Confirmation Message (In-Store)",size:"md"},{footer:w((()=>[y("div",sa,[D(r,{color:"teal",loading:e.loading.update,onClick:e.handleSave},{default:w((()=>a[26]||(a[26]=[I("Save")]))),_:1},8,["loading","onClick"])])])),default:w((()=>[y("div",null,[a[25]||(a[25]=y("div",{class:"my-4 text-gray-600"}," You can customize the message that appears on offer details page ",-1)),D(E,{modelValue:e.messageInstore,"onUpdate:modelValue":a[6]||(a[6]=a=>e.messageInstore=a),options:e.ckeditor},null,8,["modelValue","options"])]),y("div",null,[e.staticData.widget_confirm_msg_shortcode&&Array.isArray(e.staticData.widget_confirm_msg_shortcode)?(_(),h(p,{key:0,class:"mt-6",data:e.staticData.widget_confirm_msg_shortcode},{default:w((()=>[D(d,{prop:"code",label:"Code"},{default:w((a=>[y("div",ia,[y("code",oa,x(a.row.code),1),y("i",{class:"material-symbols-outlined text-lg text-teal-04",onClick:t=>e.copyText(a.row.code)}," content_copy ",8,na)])])),_:1}),D(d,{prop:"description",label:"Description"})])),_:1},8,["data"])):V("",!0)])])),_:1},8,["modelValue"]),D($,{modelValue:e.modal.preview,"onUpdate:modelValue":a[9]||(a[9]=a=>e.modal.preview=a),title:"Preview",size:"lg","no-padding":""},{footer:w((()=>[y("div",ua,[y("a",{href:"#",class:"text-red-04 no-underline hover:text-red-03",onClick:a[8]||(a[8]=a=>e.modal.preview=!1)}," Close ")])])),default:w((()=>[y("div",da,[y("div",ra,[b(y("div",{class:"prose max-w-none",innerHTML:e.preview},null,8,ca),[[A,e.loading.message]])])])])),_:1},8,["modelValue"])])),D(O,{modelValue:e.showCustomModal,"onUpdate:modelValue":a[10]||(a[10]=a=>e.showCustomModal=a),"initial-data":e.getCustomData(),onSaved:e.handleCustomSaved},null,8,["modelValue","initial-data","onSaved"])],64)}]]);const pa=c({name:"LeadBooster",components:{Input:Y,Card:ee,Checkbox:W,Fieldset:ae},props:{data:{type:Object,default:()=>({})},staticData:{type:Object,default:()=>({})},loading:{type:Object,default:()=>({})}},setup(e){const a=u({isEnableCollectLeads:"0"}),t=q({},a,{$lazy:!0});return p((()=>{var a;return null==(a=e.data)?void 0:a.is_enable_collectleads}),(e=>{void 0!==e&&e!==a.isEnableCollectLeads&&(a.isEnableCollectLeads=e)}),{immediate:!0}),p((()=>a.isEnableCollectLeads),(a=>{e.data&&a!==e.data.is_enable_collectleads&&(e.data.is_enable_collectleads=a)})),S((()=>{var t;void 0!==(null==(t=e.data)?void 0:t.is_enable_collectleads)&&(a.isEnableCollectLeads=e.data.is_enable_collectleads)})),{form:a,validation:t,handleSave:async()=>{try{return await t.value.$validate(),t.value.$invalid?(console.error("LeadBooster validation failed:",t.value.$errors),!1):(e.data&&(e.data.is_enable_collectleads=a.isEnableCollectLeads),!0)}catch(l){return console.error("Error saving LeadBooster:",l),!1}}}}}),ga={class:"flex items-center gap-2"};const fa={class:"flex items-center gap-4"},_a={class:"block mt-2"},va=c({components:{Breadcrumb:me,Button:K,Card:ee,Modal:G,Prefix:ye,PriceLock:xe,AutoAccept:Ie,LeadBooster:H(pa,[["render",function(e,a,t,l,i,o){const n=g("Checkbox"),s=g("Tooltip"),d=g("Fieldset");return _(),h(d,{class:"rounded-xl"},{label:w((()=>a[1]||(a[1]=[I("Collect Leads")]))),default:w((()=>[y("div",ga,[D(n,{modelValue:e.form.isEnableCollectLeads,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.isEnableCollectLeads=a),type:"toggle",disabled:e.loading.update||e.loading.all,value:"1","value-off":"0"},null,8,["modelValue","disabled"]),a[4]||(a[4]=y("label",null,"Lead Booster",-1)),D(s,{placement:"top"},{content:w((()=>a[2]||(a[2]=[y("div",{class:"w-80"}," Generate more leads by collecting customer information before they can view their offer. ",-1)]))),default:w((()=>[a[3]||(a[3]=y("i",{class:"material-icons mr-2"},"info",-1))])),_:1})])])),_:1})}]]),ConfirmationMessage:ma,Imei:Te,LimitItems:{__name:"index",props:{data:{type:Object,default:()=>({})},staticData:{type:Object,default:()=>({})},loading:{type:Object,default:()=>({})}},emits:["update:data"],setup(e,{expose:a,emit:t}){const l=e,i=t,o=u({widget_limit_qty_items:null}),n=m((()=>{var e,a;return{widget_limit_qty_items:{required:N,minValue:z(1),maxValue:R(null!=(a=null==(e=l.data)?void 0:e.widget_limit_qty_items_max)?a:99)}}})),s=q(n,o,{$lazy:!0}),d=async()=>{await s.value.$validate(),i("update:data",{widget_limit_qty_items:o.widget_limit_qty_items})};return p((()=>l.data.widget_limit_qty_items),(e=>{null!=e&&(o.widget_limit_qty_items=e)}),{immediate:!0}),a({handleSave:async()=>!!(await s.value.$validate())&&(i("update:data",{widget_limit_qty_items:o.widget_limit_qty_items}),!0)}),(a,t)=>{var i,n;const r=g("Tooltip"),c=f("loading");return _(),v("div",null,[y("div",fa,[t[4]||(t[4]=y("label",null,"Mail-In Item Limit",-1)),D(r,{placement:"top"},{content:w((()=>t[2]||(t[2]=[y("div",{class:"w-80"}," Restrict the number of items You can set limit on items per offer exclusively for the Mail-in purchasing method. ",-1)]))),default:w((()=>[t[3]||(t[3]=y("i",{class:"material-icons mr-2"},"info",-1))])),_:1})]),y("div",null,[y("form",{autocomplete:"off",onSubmit:t[1]||(t[1]=O((()=>{}),["prevent"]))},[b((_(),h(Y,{modelValue:o.widget_limit_qty_items,"onUpdate:modelValue":t[0]||(t[0]=e=>o.widget_limit_qty_items=e),disabled:e.loading.update,class:"w-full",autocomplete:"off",view:A(s).widget_limit_qty_items.$invalid?"danger":"default","icon-block":"",right:"",icon:"",onInput:d},{icon:w((()=>t[5]||(t[5]=[y("span",{class:"text-base"},"/Items",-1)]))),_:1},8,["modelValue","disabled","view"])),[[c,e.loading.all]]),(_(!0),v(k,null,C(A(s).widget_limit_qty_items.$errors,((e,a)=>(_(),v("small",{class:"text-red-base block",key:a},x(e.$message)+". ",1)))),128)),y("small",_a,[t[6]||(t[6]=y("span",{class:"font-semibold"},"Max Items",-1)),I(" : Up to "+x(null!=(n=null==(i=null==l?void 0:l.data)?void 0:i.widget_limit_qty_items_max)?n:99)+" items ",1)])],32)])])}}}},async setup(){const e=U(),a=L(),{data:t,modal:l,staticData:i,loading:o,actionShow:n,actionUpdate:d,state:r,actionCustomStartingPoint:c,actionShowLanguage:p}=ce(),{widgetOptions:g,isProPlan:f}=X(),{state:_,actionConditionDeviceWidgetAvailability:v}=pe(),y=j(null),b=j(null),h=j(null),w=j(null),x=j(null),k=j(null),C=j(null),V=j(!1),D=j({}),I=j(!1),E=j(!1),$=j(!1),O=j(null),M=j(!1),A=m((()=>JSON.stringify(t)!==JSON.stringify(D.value))),q=u({prefix:null,priceLock:null,autoAcceAutoAccept:null,leadBooster:null,confirmationMessage:null,imei:null}),N=Z((async e=>{try{o.update=!0;const a=s(s({},t),e);await d(a),await n({includedKeys:["source","widget_is_remove_brand_available"]}),T({type:"success",message:"Settings updated successfully!",duration:3e3})}catch(a){T({type:"error",message:"Failed to update settings. Please try again.",duration:5e3})}finally{o.update=!1}}),500);P(((e,a,t)=>{A.value&&!M.value?(O.value={type:"route",to:e},I.value=!0,M.value=!0,t(!1)):t()}));const z=e=>{if(A.value)return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?",I.value||(O.value={type:"browser"},I.value=!0),e.returnValue};S((async()=>{await(async()=>{try{o.all=!0,await Promise.all([n(),c(),p(),v()]),D.value=JSON.parse(JSON.stringify(t))}catch(e){T({type:"error",message:"Failed to load widget data. Please refresh the page.",duration:5e3})}finally{o.all=!1}})(),window.addEventListener("beforeunload",z)})),F((()=>{window.removeEventListener("beforeunload",z)}));const R=m((()=>{const e={totalComponents:6,activeComponents:0,hasErrors:Object.values(q).some((e=>null!==e))};return t.prefix_enabled&&e.activeComponents++,t.price_lock_enabled&&e.activeComponents++,t.auto_offers_enabled&&e.activeComponents++,t.lead_booster_enabled&&e.activeComponents++,t.widget_confirm_msg&&e.activeComponents++,t.imei_enabled&&e.activeComponents++,e}));return{loadingAllForm:V,breadcrumb:[{text:"Settings",to:{name:"setting"}},{text:"Offer Settings"}],state:r,staticData:i,payload:t,originalPayload:D,modalWidget:l,loading:o,errors:q,router:a,route:e,isDataModified:A,configurationSummary:R,prefixRef:y,priceLockRef:b,autoAcceAutoAcceptRef:h,leadBoosterRef:w,limitItemsRef:C,confirmationMessageRef:x,imeiRef:k,showUnsavedModal:I,loadingDiscard:E,loadingSaveBeforeLeave:$,actionShow:n,actionUpdate:d,handleSaveAll:async()=>{try{V.value=!0;const a=[],l=[{ref:y,name:"Prefix"},{ref:b,name:"Price Lock"},{ref:h,name:"Auto Offers"},{ref:w,name:"Lead Booster"},{ref:x,name:"Confirmation Message"},{ref:k,name:"IMEI"},{ref:C,name:"Limit Items"}];for(const{ref:t,name:i}of l)if(t.value&&"function"==typeof t.value.handleSave)try{const e=await t.value.handleSave();a.push({name:i,success:e}),q[i.toLowerCase().replace(" ","")]=e?null:`Validation failed for ${i}`}catch(e){a.push({name:i,success:!1,error:e}),q[i.toLowerCase().replace(" ","")]=e.message||`Error saving ${i}`}if(a.some((e=>!e.success))){const e=a.filter((e=>!e.success)).map((e=>e.name)).join(", ");return void T({type:"error",message:`Please fix validation errors in: ${e}`,duration:5e3})}await d(t),await n(),D.value=JSON.parse(JSON.stringify(t)),Object.keys(q).forEach((e=>{q[e]=null})),T({type:"success",message:"All changes saved successfully!",duration:3e3})}catch(e){T({type:"error",message:"Failed to save changes. Please try again.",duration:5e3})}finally{V.value=!1}},handleReset:async()=>{try{"confirm"===await B.confirm("Are you sure you want to discard all unsaved changes? This action cannot be undone.","Confirm Reset",{confirmButtonText:"Yes, Reset",cancelButtonText:"Cancel",type:"warning",confirmButtonClass:"el-button--danger"})&&(Object.assign(t,JSON.parse(JSON.stringify(D.value))),Object.keys(q).forEach((e=>{q[e]=null})),T({type:"info",message:"Changes have been reset",duration:3e3}))}catch(e){}},handleComponentUpdate:e=>{Object.assign(t,e)},handleUpdateWidget:N,handleBeforeRouteLeave:(e,a,t)=>{A.value&&!M.value?(O.value={type:"route",to:e},I.value=!0,M.value=!0,t(!1)):t()},handleDiscardChanges:async()=>{try{E.value=!0,Object.assign(t,JSON.parse(JSON.stringify(D.value))),Object.keys(q).forEach((e=>{q[e]=null})),I.value=!1,M.value=!1,O.value&&("route"===O.value.type?await a.push(O.value.to):"browser"===O.value.type&&(window.removeEventListener("beforeunload",z),window.location.href=O.value.href||"/"),O.value=null)}catch(e){T({type:"error",message:"Failed to discard changes",duration:3e3})}finally{E.value=!1}},handleSaveAndExit:async()=>{try{$.value=!0;const l=[],i=[{ref:y,name:"Prefix"},{ref:b,name:"Price Lock"},{ref:h,name:"Auto Offers"},{ref:w,name:"Lead Booster"},{ref:x,name:"Confirmation Message"},{ref:k,name:"IMEI"},{ref:C,name:"Limit Items"}];for(const{ref:a,name:t}of i)if(a.value&&"function"==typeof a.value.handleSave)try{const e=await a.value.handleSave();l.push({name:t,success:e}),q[t.toLowerCase().replace(" ","")]=e?null:`Validation failed for ${t}`}catch(e){l.push({name:t,success:!1,error:e}),q[t.toLowerCase().replace(" ","")]=e.message||`Error saving ${t}`}if(l.some((e=>!e.success))){const e=l.filter((e=>!e.success)).map((e=>e.name)).join(", ");return void T({type:"error",message:`Please fix validation errors in: ${e}`,duration:5e3})}await d(t),await n(),D.value=JSON.parse(JSON.stringify(t)),Object.keys(q).forEach((e=>{q[e]=null})),I.value=!1,M.value=!1,O.value&&("route"===O.value.type?await a.push(O.value.to):"browser"===O.value.type&&(window.removeEventListener("beforeunload",z),window.location.href=O.value.href||"/"),O.value=null),T({type:"success",message:"Changes saved successfully!",duration:3e3})}catch(e){T({type:"error",message:"Failed to save changes. Please try again.",duration:5e3})}finally{$.value=!1}},handleCancelLeave:()=>{I.value=!1,O.value=null,M.value=!1},stateDevice:_,widgetOptions:g,isProPlan:f}}}),ya={class:"min-h-screen bg-gray-50"},ba={class:"space-y-8"},ha={class:"grid grid-cols-1 lg:grid-cols-2"},wa={class:"space-y-6"},xa={class:"rounded-lg"},ka={class:"flex flex-col justify-center gap-4 items-center my-6"},Ca={class:"flex flex-wrap items-center justify-center gap-14 mt-4"};var Va=H(va,[["render",function(e,a,t,l,i,o){const n=g("Button"),s=g("Breadcrumb"),d=g("Prefix"),r=g("PriceLock"),c=g("LimitItems"),u=g("AutoAccept"),m=g("ConfirmationMessage"),p=g("LeadBooster"),x=g("Imei"),k=g("Card"),C=g("Modal"),V=f("loading");return _(),v("div",ya,[D(s,{class:"mt-2 mb-8","page-title":"Offer Settings","back-to":{name:"setting"},items:e.breadcrumb},{right:w((()=>[D(n,{color:"teal",loading:e.loadingAllForm,onClick:e.handleSaveAll},{default:w((()=>a[1]||(a[1]=[I(" Save Changes ")]))),_:1},8,["loading","onClick"])])),_:1},8,["items"]),b((_(),h(k,{class:"mb-6 shadow-sm"},{header:w((()=>a[2]||(a[2]=[y("h6",{class:""},"Configuration",-1)]))),default:w((()=>[y("div",ba,[y("div",ha,[y("div",wa,[y("div",null,[D(d,{ref:"prefixRef",data:e.payload,"static-data":e.staticData,loading:e.loading,"onUpdate:data":e.handleComponentUpdate},null,8,["data","static-data","loading","onUpdate:data"])]),y("div",null,[D(r,{ref:"priceLockRef",data:e.payload,"static-data":e.staticData,loading:e.loading,"onUpdate:data":e.handleComponentUpdate},null,8,["data","static-data","loading","onUpdate:data"])]),y("div",null,[D(c,{ref:"limitItemsRef",data:e.payload,"static-data":e.staticData,loading:e.loading,"onUpdate:data":e.handleComponentUpdate},null,8,["data","static-data","loading","onUpdate:data"])]),y("div",null,[D(u,{ref:"autoAcceAutoAcceptRef",data:e.payload,"static-data":e.staticData,loading:e.loading,"onUpdate:data":e.handleComponentUpdate},null,8,["data","static-data","loading","onUpdate:data"])])])]),D(m,{ref:"confirmationMessageRef",data:e.payload,"static-data":e.staticData,loading:e.loading,"onUpdate:data":e.handleComponentUpdate},null,8,["data","static-data","loading","onUpdate:data"]),y("div",xa,[D(p,{ref:"leadBoosterRef",data:e.payload,"static-data":e.staticData,loading:e.loading,"onUpdate:data":e.handleComponentUpdate},null,8,["data","static-data","loading","onUpdate:data"])]),D(x,{ref:"imeiRef",data:e.payload,"static-data":e.staticData,loading:e.loading,"onUpdate:data":e.handleComponentUpdate},null,8,["data","static-data","loading","onUpdate:data"])])])),_:1})),[[V,e.loadingAllForm||e.loading.all]]),D(C,{modelValue:e.showUnsavedModal,"onUpdate:modelValue":a[0]||(a[0]=a=>e.showUnsavedModal=a),closeTo:e.handleCancelLeave,size:"xs","hide-header":"","hide-footer":""},{default:w((()=>[y("div",ka,[a[5]||(a[5]=y("img",{src:Q},null,-1)),a[6]||(a[6]=y("h6",{class:"text-3xl font-semibold"}," You have unsaved changes ",-1)),a[7]||(a[7]=y("p",{class:"text-center"},"Are you sure you want to leave this page without saving your changes?",-1)),y("div",Ca,[D(n,{onClick:O(e.handleDiscardChanges,["prevent"]),color:"grey"},{default:w((()=>a[3]||(a[3]=[I(" Discard Changes ")]))),_:1},8,["onClick"]),D(n,{color:"teal",loading:e.loadingSaveBeforeLeave,onClick:e.handleSaveAndExit},{default:w((()=>a[4]||(a[4]=[I(" Save Changes and Exit ")]))),_:1},8,["loading","onClick"])])])])),_:1},8,["modelValue","closeTo"])])}]]),Sa=c({setup(){const{genSuspense:e}=r();return()=>e(Va)}});export{Sa as default};
