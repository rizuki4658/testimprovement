var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(e,n,a)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,i=(t,e)=>{for(var n in e||(e={}))o.call(e,n)&&l(t,n,e[n]);if(a)for(var n of a(e))s.call(e,n)&&l(t,n,e[n]);return t},c=(t,a)=>e(t,n(a));import{j as r,g as u}from"./vendor.9695fe57.js";import{z as p,s as m,x as d}from"./index.dcc9fc55.js";const y=r("user",{state:()=>({}),getters:{},actions:{async $loginToken(t){await p({url:"/v1/pos/login/token",method:"post",data:i({},"object"!=typeof t?{token:t}:{token:t.token,company_token:t.company})})}}}),v=r("multipleCompany",{state:()=>({company:{isLoading:!1,result:null,active:null,isGhost:null},companyDetail:{isLoading:!1,modal:!1,result:!1,token:null},unlink:{isLoading:!1,modal:!1}}),getters:{companies:t=>u((()=>{var e,n;return null!=(n=null==(e=null==t?void 0:t.company)?void 0:e.result)?n:[]})),activeCompany:t=>u((()=>{var e,n,a;return null!=(a=null==(n=null==(e=t.company)?void 0:e.active)?void 0:n.name)?a:"Default Company"})),isMultipleAccount:()=>u((()=>!window.location.origin.includes("usedproducts"))),isGhost:t=>u((()=>t.company.isGhost))},actions:{generateStatus(t){if(1==t.subscription_status&&t.trial_end){const e=new Date(Date.now()),n=new Date(t.trial_end),a=Math.abs(n-e),o=Math.ceil(a/864e5);return c(i({},t),{class_alert:"bg-orange-01",class_text:"text-orange-04",class_dot:"bg-orange-04",text:"Trial Ends in",days:o})}return 2==t.subscription_status?c(i({},t),{class_alert:"bg-red-01",class_text:"text-red-04",class_dot:"bg-red-04",text:"Unpaid Billing"}):3==t.subscription_status?c(i({},t),{class_alert:"bg-orange-01",class_text:"text-orange-04",class_dot:"bg-orange-04",text:"Subscribe Cancelled"}):c(i({},t),{class_alert:null,class_text:null,text:null})},generateList(t){return t.filter((t=>t.name&&t)).map((t=>i({},this.generateStatus(t))))},async $getCompanies(t=!1){var e,n,a,o,s,l,i,c,r,u,p,y,v,g,h,b,_,f;const w=null!=(s=null==(o=null==(a=null==(n=null==(e=m)?void 0:e.state)?void 0:n.user)?void 0:a.me)?void 0:o.companies)?s:[];if(w&&!t)this.company.result=this.generateList(w);else{const t=d();await m.dispatch("user/me"),(null==(r=null==(c=null==(i=null==(l=m)?void 0:l.state)?void 0:i.user)?void 0:c.me)?void 0:r.menu_v2)&&t.setMenu(null==(v=null==(y=null==(p=null==(u=m)?void 0:u.state)?void 0:p.user)?void 0:y.me)?void 0:v.menu_v2),this.company.result=this.generateList(null!=(f=null==(_=null==(b=null==(h=null==(g=m)?void 0:g.state)?void 0:h.user)?void 0:b.me)?void 0:_.companies)?f:[])}},async $getActiveCompany(){var t;const e=d(),n=null!=(t=e.company.form)?t:void 0;n?this.company.active=n:(await e.$getSettingCompanyProfile(),this.company.active=e.company.form)},async $getIsGhost(){var t,e,n,a,o;const s=null!=(o=null==(a=null==(n=null==(e=null==(t=m)?void 0:t.state)?void 0:e.user)?void 0:n.me)?void 0:a.is_ghost)?o:0;this.company.isGhost=!!s},async $getBulkMultipleCompany(){await this.$getCompanies(),await this.$getActiveCompany(),await this.$getIsGhost()},async $getCompany(t){const e=await p({url:"/v1/config/company/show",method:"get",params:c(i({},t),{company_code:this.companyDetail.token})});this.companyDetail.result=e},async $updateMultipleCompany(t){var e,n,a,o;this.company.isLoading=!0,this.company.active.name=t.name;const s=null!=(a=null==(n=null==(e=this.company)?void 0:e.result)?void 0:n.findIndex((t=>t.is_selected)))?a:-1;(null==(o=this.company)?void 0:o.result[s])&&(this.company.result[s].name=t.name),this.company.isLoading=!1},async $unlinkAccount(){this.companyDetail.token&&await p({url:"/v1/config/company/unlink",method:"post",data:{company_code:this.companyDetail.token}})},async $switchCompany(t){const e=y();await e.$loginToken(t)}}});export{v as u};
