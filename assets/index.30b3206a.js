var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;import{u as l}from"./components.00bf6492.js";import{k as d,g as c,f as r,y as p,_ as u,m,o as g,n as h,w as f,B as y,D as w,I as _,K as b,N as k,a5 as v,O as F,r as S,W as j,$ as C,t as x,A as R,U as W,a1 as L}from"./vendor.9695fe57.js";import{d as U,e as O,u as P,c as V}from"./location.7390c176.js";import{d as T,b as A,e as q,_ as M,f as B,P as D,u as N,a9 as I,g as E}from"./index.c2f66179.js";import{C as K}from"./card.f57f7ca5.js";import{S as $}from"./select.9d161386.js";import{_ as z}from"./badge.ea6fe761.js";import{_ as G}from"./tab.c78d43fc.js";import{_ as H}from"./fieldset.400d29ed.js";import{_ as J}from"./radio.09932d3b.js";import{c as Q}from"./copy.6c996115.js";import"./LoadingCard.c138fa92.js";const X=d({components:{Modal:T,Button:A,Fieldset:H,Checkbox:q,Radio:J},props:{id:{type:[Number,String],default:""},code:{type:String,default:""},type:{type:String,default:"on_page"},show:{type:Boolean,default:!1}},emits:["update:show","update-data"],setup(e,{emit:a}){const{loading:t,data:o,resetData:s,actionUpdate:i}=U(),n=c({set:e=>{!1===e&&s(),a("update:show",e)},get:()=>e.show}),l=r("");p((()=>({id:e.id,type:e.type,show:e.show})),(({id:e,type:a})=>{o.id=e,o.widget_app_type=a}),{deep:!0}),p((()=>e.code),(()=>{l.value=e.code}));return{loading:t,data:o,show:n,code:l,copyText:Q,handleUpdate:async()=>{await i((e=>{const{widget_app_type:t,widget_source:s}=e;l.value=s,o.widget_app_type=t,u({type:"success",message:"Changes saved"}),a("update-data")}))}}}}),Y={class:"mb-6"},Z={class:"border border-grey-02 bg-grey-lighten rounded rounded-lg p-4 my-6"},ee={class:"flex flex-wrap justify-end mt-4"},ae={class:"flex flex-col"},te={class:"flex flex-wrap items-center"},oe={class:"flex flex-wrap items-center"};const se=d({components:{Card:K,Button:A,Checkbox:q,Modal:T,Input:B,Select:$,Pagination:D,Badge:z,Tab:G,WidgetCode:M(X,[["render",function(e,a,t,o,s,i){const n=m("Fieldset"),l=m("Button"),d=m("Radio"),c=m("Tooltip"),r=m("Modal");return g(),h(r,{modelValue:e.show,"onUpdate:modelValue":a[3]||(a[3]=a=>e.show=a),title:"Widget"},{default:f((()=>[y("div",Y,[w(n,null,{label:f((()=>a[4]||(a[4]=[_("Widget Code")]))),default:f((()=>[a[5]||(a[5]=y("p",{class:"my-2"}," Copy the following code and paste it as close to the opening <head> tag as possible on every page you wish to display the buyback widget. ",-1)),y("div",Z,[y("code",null,b(e.code),1)])])),_:1}),y("div",ee,[w(l,{onClick:a[0]||(a[0]=a=>e.copyText(e.code)),color:"teal",view:"smooth",dense:""},{default:f((()=>a[6]||(a[6]=[y("i",{class:"material-symbols-outlined mr-2"},"content_copy",-1),_(" Copy ")]))),_:1})])]),w(n,null,{label:f((()=>a[7]||(a[7]=[_(" Widget Type")]))),default:f((()=>[a[12]||(a[12]=y("label",{class:"mb-4"},"Widget Type",-1)),y("div",ae,[y("div",te,[w(d,{modelValue:e.data.widget_app_type,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.widget_app_type=a),class:"font-normal mb-2",value:"floating"},{default:f((()=>a[8]||(a[8]=[_(" Floating ")]))),_:1},8,["modelValue"]),w(c,{placement:"right",content:"This widget will open when clicking on a floating button on the side of the page."},{default:f((()=>a[9]||(a[9]=[y("i",{class:"text-grey-03 material-icons ml-2 cursor-pointer"},"info",-1)]))),_:1})]),y("div",oe,[w(d,{modelValue:e.data.widget_app_type,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.widget_app_type=a),class:"font-normal",value:"on_page"},{default:f((()=>a[10]||(a[10]=[y("div",{class:"flex flex-wrap items-center"},"On Page",-1)]))),_:1},8,["modelValue"]),w(c,{placement:"right",content:"This widget will be hosted directly on a webpage."},{default:f((()=>a[11]||(a[11]=[y("i",{class:"text-grey-03 material-icons ml-2 cursor-pointer"},"info",-1)]))),_:1})])])])),_:1})])),footer:f((()=>[w(l,{onClick:e.handleUpdate,loading:e.loading.update,color:"teal",view:"smooth"},{default:f((()=>a[13]||(a[13]=[_("Save")]))),_:1},8,["onClick","loading"])])),_:1},8,["modelValue"])}]])},async setup(e,{emit:l}){const d=k(),{data:c,state:m,loading:g,actionAll:h}=O(),{actionAll:f}=P(),{loading:y,actionRequestFranchisee:w,actionApproveFranchisee:_,actionRejectFranchisee:b,actionRevokeFranchisee:C}=V(),{me:x,action:R}=N(),W=v(),L=F(),U=r(!1),T=S({id:null,code:null,type:"on_page"});p((()=>({limit:c.limit,search:c.search})),(()=>{c.page=1}),{deep:!0}),p((()=>{return e=((e,a)=>{for(var t in a||(a={}))s.call(a,t)&&n(e,t,a[t]);if(o)for(var t of o(a))i.call(a,t)&&n(e,t,a[t]);return e})({},c),l={linkedStatus:W.params.linkedStatus},a(e,t(l));var e,l}),E((async({linkedStatus:e})=>{e&&await h(W.params.linkedStatus)}),500),{deep:!0});return j((async()=>{if(!W.params.linkedStatus)return L.push({name:W.name,params:{linkedStatus:2}});d.state.setting.manageLocation.all||await f(d.state.user.me.id),await Promise.all([h(W.params.linkedStatus)])})),{data:c,me:x,store:d,state:m,loading:g,loadingFranchisee:y,route:W,phoneNumber:I,selectedFranchiseeWidget:T,showFranchiseeWidgetModal:U,handleRequestFranchisee:async e=>{const a={location_id:e.id,franchisor_code:e.franchisor_code?e.franchisor_code:""};await w(a,(async()=>{await Promise.all([h(),actionLocations()])}))},handleApproveFranchiseeRequest:async e=>await _(e,(async()=>{u({type:"success",message:"Request approved"}),await h(W.params.linkedStatus)})),handleRejectFranchiseeRequest:async e=>await b(e,(async()=>{u({type:"success",message:"Request rejected"}),await h(W.params.linkedStatus)})),handleRevokeFranchisee:async e=>await C(e,(async()=>{u({type:"success",message:"Linked location revoked"}),await h(W.params.linkedStatus)})),handleWidgetCode:e=>{U.value=!0,Object.assign(T,{id:e.id,code:e.widget_source,type:e.widget_app_type})},handleUpdateLinkedLocation:async()=>{await h(W.params.linkedStatus)}}}}),ie={class:"font-semibold text-teal-04"},ne={class:"flex items-center flex-wrap"},le={class:"lg:opacity-0 group-hover:opacity-100 transition-opacity"};var de=M(se,[["render",function(e,a,t,o,s,i){const n=m("Input"),l=m("Tab"),d=m("TableColumn"),c=m("Button"),r=m("Table"),p=m("Pagination"),u=m("WidgetCode"),k=C("loading");return g(),x("div",null,[w(n,{modelValue:e.data.search,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.search=a),placeholder:"Search Everything",class:"w-full mb-5 mr-4",icon:""},{icon:f((()=>a[4]||(a[4]=[y("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue"]),w(l,{items:[{name:"Requested",to:{name:"settingManageLocationLinkedLocations",params:{linkedStatus:2}}},{name:"Approved",to:{name:"settingManageLocationLinkedLocations",params:{linkedStatus:1}}}]}),R((g(),x("div",null,[w(r,{data:e.state.data},{default:f((()=>[w(d,{label:"Store Name","min-width":"250"},{default:f((({row:e})=>[y("p",ie,b(e.location_name),1)])),_:1}),w(d,{label:"Email"},{default:f((({row:e})=>[_(b(e.email||"-"),1)])),_:1}),w(d,{label:"Location",prop:"address_text"}),w(d,{label:"Phone"},{default:f((({row:a})=>[y("span",null,b(e.phoneNumber(a.phone_number)),1)])),_:1}),w(d,{label:"Account Source",prop:"company_name","min-width":"200"}),w(d,{label:"Date Linked",prop:"date_linked","min-width":"200",width:"150"}),w(d,{label:"",width:"400"},{default:f((({row:t})=>[y("div",ne,[1==e.route.params.linkedStatus?(g(),h(c,{key:0,onClick:a=>e.handleWidgetCode(t),class:"mr-4",color:"teal",view:"smooth",dense:""},{default:f((()=>a[5]||(a[5]=[y("i",{class:"material-icons"},"visibility",-1),_(" Widget ")]))),_:2},1032,["onClick"])):W("",!0),y("div",le,[2==e.route.params.linkedStatus?(g(),x(L,{key:0},[w(c,{onClick:a=>e.handleApproveFranchiseeRequest(t.id),loading:e.loadingFranchisee.approveFranchisee.get(t.id),class:"mr-4",color:"green",view:"smooth",dense:""},{default:f((()=>a[6]||(a[6]=[y("i",{class:"material-icons"},"check",-1),_(" Approve")]))),_:2},1032,["onClick","loading"]),w(c,{loading:e.loadingFranchisee.rejectFranchisee.get(t.id),onClick:a=>e.handleRejectFranchiseeRequest(t.id),color:"red",view:"smooth",dense:""},{default:f((()=>a[7]||(a[7]=[y("i",{class:"material-icons"},"close",-1),_(" Reject")]))),_:2},1032,["loading","onClick"])],64)):W("",!0),1==e.route.params.linkedStatus?(g(),h(c,{key:1,loading:e.loadingFranchisee.revokeFranchisee.get(t.id),onClick:a=>e.handleRevokeFranchisee(t.id),color:"red",view:"smooth",dense:""},{default:f((()=>a[8]||(a[8]=[y("i",{class:"material-icons"},"close",-1),_(" Revoke Access")]))),_:2},1032,["loading","onClick"])):W("",!0)])])])),_:1})])),_:1},8,["data"]),w(p,{page:e.data.page,"onUpdate:page":a[1]||(a[1]=a=>e.data.page=a),limit:e.data.limit,"onUpdate:limit":a[2]||(a[2]=a=>e.data.limit=a),data:e.state},null,8,["page","limit","data"])])),[[k,e.loading.all]]),w(u,{show:e.showFranchiseeWidgetModal,"onUpdate:show":a[3]||(a[3]=a=>e.showFranchiseeWidgetModal=a),id:e.selectedFranchiseeWidget.id,code:e.selectedFranchiseeWidget.code,type:e.selectedFranchiseeWidget.type,onUpdateData:e.handleUpdateLinkedLocation},null,8,["show","id","code","type","onUpdateData"])])}]]),ce=d({setup(){const{genSuspense:e}=l();return()=>e(de)}});export{ce as default};
