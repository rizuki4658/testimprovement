{"version":3,"file":"index.d209a42a.js","sources":["../../src/views/onboarding/index.vue","../../src/assets/buyback-logo.svg"],"sourcesContent":["<template>\n  <div class=\"onboarding-layout\">\n    <div class=\"onboarding-layout__sidebar\">\n      <div class=\"onboarding-logo\">\n        <img\n          class=\"lg:w-44\"\n          src=\"@/assets/buyback-logo.svg\"\n          alt=\"Brand logo\"\n          whitelabel=\"image-replace\"\n          data-image-type=\"logo\"\n        />\n        <Transition name=\"slide-fade\">\n          <div v-if=\"hasCompanyReferrer && !loadingCompanyReferrer.all && !isAddCompany\" class=\"company-referrer\">\n            <i class=\"material-icons my-4\">close</i>\n            <div class=\"company-referrer__logo\">\n              <img\n                class=\"lg:w-44\"\n                :src=\"companyReferrerDetail.logo\"\n                alt=\"Company referrer logo\"\n              />\n            </div>\n            <div class=\"company-referrer__description\">\n              <p class=\"text-black\">\n                {{ companyReferrerDetail.name }} uses Reusely to fast-track\n                trade-in with preconfigured settings tailored just for you.\n              </p>\n            </div>\n          </div>\n        </Transition>\n      </div>\n      <div class=\"onboarding-menu\">\n        <div class=\"onboarding-steps\">\n          <div\n            v-for=\"(route, routeIndex) of onboardingRoutes\"\n            :key=\"routeIndex\"\n            :class=\"[\n              'onboarding-step',\n              currentStepIndex === routeIndex\n                ? 'onboarding-step--active'\n                : routeIndex < currentStepIndex\n                ? 'onboarding-step--success'\n                : ''\n            ]\"\n          >\n            <div class=\"onboarding-step__number\">\n              <template v-if=\"routeIndex < currentStepIndex\">\n                <i class=\"material-icons icon-md\">done</i>\n              </template>\n              <template v-else>\n                {{ routeIndex + 1 }}\n              </template>\n            </div>\n            <div class=\"onboarding-step__title\">\n              {{ route.meta.title_step }}\n            </div>\n          </div>\n        </div>\n      </div>\n      <div v-if=\"isFirstStep\" class=\"h-56 text-center\">\n        <p>\n          Already have an account?\n          <router-link :to=\"{ name: 'login' }\">Login Here</router-link>\n        </p>\n      </div>\n    </div>\n    <div class=\"onboarding-layout__content\">\n      <div>\n        <div class=\"onboarding-progress\">\n          <div\n            class=\"onboarding-progress__bar\"\n            :style=\"{ width: `${progressPercentage}%` }\"\n          ></div>\n        </div>\n      </div>\n      <div class=\"flex-auto overflow-y-auto overflow-x-hidden\">\n        <div class=\"onboarding-menu-mobile\">\n          <div class=\"onboarding-logo\">\n            <img\n              class=\"w-1/4 mt-8\"\n              src=\"@/assets/buyback-logo.svg\"\n              alt=\"Brand logo\"\n              whitelabel=\"image-replace\"\n              data-image-type=\"logo\"\n            />\n          </div>\n          <Transition name=\"slide-fade\">\n            <div v-if=\"hasCompanyReferrer && !loadingCompanyReferrer.all && !isAddCompany\" class=\"company-referrer px-12\">\n              <i class=\"material-icons my-4\">close</i>\n              <div class=\"company-referrer__logo\">\n                <img\n                  class=\"w-1/4\"\n                  :src=\"companyReferrerDetail.logo\"\n                  alt=\"Company referrer logo\"\n                />\n              </div>\n              <div class=\"company-referrer__description\">\n                <p class=\"text-black\">\n                  {{ companyReferrerDetail.name }} uses Reusely to fast-track\n                  trade-in with preconfigured settings tailored just for you.\n                </p>\n              </div>\n            </div>\n          </Transition>\n          <div class=\"mx-12 my-32\">\n            <Stepper\n              color=\"teal\"\n              :steps=\"onboardingStepsTitle\"\n              :active-step=\"currentStepIndex + 1\"\n            />\n          </div>\n        </div>\n        <RouterView v-slot=\"{ Component, route }\">\n          <template v-if=\"Component && isShowContent\">\n            <Transition name=\"slide-fade\" :key=\"route.path\">\n              <KeepAlive>\n                <Suspense>\n                  <component :is=\"Component\" :key=\"route.path\"></component>\n                  <template #fallback>\n                    <div class=\"h-full w-full flex items-center justify-center\">\n                      <BaseLoading />\n                    </div>\n                  </template>\n                </Suspense>\n              </KeepAlive>\n            </Transition>\n          </template>\n          <template v-else>\n            <div class=\"h-full w-full flex items-center justify-center\">\n              <BaseLoading />\n            </div>\n          </template>\n        </RouterView>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport {\n  defineComponent,\n  computed,\n  ref,\n  watch,\n  onUnmounted,\n  onMounted\n} from 'vue'\nimport { useRouter, useRoute, onBeforeRouteUpdate } from 'vue-router'\n\n// Composables\nimport { useCurrentStep, useCompanyReferrer } from 'composable/onboarding'\n\n// Components\nimport Stepper from 'bbUi/components/stepper/stepper.vue'\nimport BaseLoading from 'components/BaseLoading.vue'\n\n// Utils\nimport { queue } from 'utils/request'\n\nexport default defineComponent({\n  components: {\n    Stepper,\n    BaseLoading\n  },\n  setup() {\n    const isShowContent = ref(false)\n    const router = useRouter()\n    const route = useRoute()\n\n    const {\n      state: stateCurrentStep,\n      stepRoutes,\n      currentStepRoute,\n      actionCurrentStep\n    } = useCurrentStep()\n    const {\n      loading: loadingCompanyReferrer,\n      getCompanyReferrerDetail,\n      companyReferrer,\n      companyReferrerDetail,\n      hasCompanyReferrer\n    } = useCompanyReferrer()\n    const onboardingRoutes = computed(() => {\n      if (route.name.includes('onboarding')) {\n        return router.getRoutes().find((item) => item.name === 'onboarding')\n          ?.children\n      } else if (route.name.includes('newCompany')) {\n        return router.getRoutes().find((item) => item.name === 'newCompany')\n          ?.children\n      }\n\n      return []\n    })\n    const onboardingStepsTitle = computed(() =>\n      onboardingRoutes.value.map((route) => route.meta.title_step)\n    )\n    const currentStepIndex = computed(() => {\n      const currentRouteIndex = onboardingRoutes.value.findIndex(\n        (onboardingRoute) => onboardingRoute.name === route.name\n      )\n      if (currentRouteIndex === -1) return 0\n      return currentRouteIndex\n    })\n    const totalSteps = computed(() => onboardingRoutes.value.length)\n    const progressPercentage = computed(() => {\n      return Math.floor(((currentStepIndex.value + 1) / totalSteps.value) * 100)\n    })\n    const isFirstStep = computed(\n      () => route.name === stepRoutes.value[0].route.name && !route.query.token\n    )\n    const isAddCompany = computed(() => route.path.includes('new-company'))\n    const checkCurrentRoute = async () => {\n      isShowContent.value = false\n      await actionCurrentStep()\n\n      // check is onboarding done, if true redirect to dashboard\n      const isOnboardingDone = stateCurrentStep.value.is_onboarding === false\n      const isNotLastRoute = route.name === stepRoutes.value[0].route.name\n      if (isOnboardingDone && isNotLastRoute) {\n        window.location.href = '/dashboard'\n        return\n      }\n\n      const isIncorrectRouteName = currentStepRoute.value.name !== route.name\n      const isIncorrectVerifyEmail =\n        currentStepRoute.value.name === 'onboardingPersonalInformation' &&\n        !!currentStepRoute.value.query.token &&\n        !route.query.token\n\n      if (isIncorrectRouteName || isIncorrectVerifyEmail) {\n        await router.push(currentStepRoute.value)\n        return\n      }\n      isShowContent.value = true\n    }\n    const destroyWatcher = watch(\n      () => route.fullPath,\n      async () => {\n        if (route.matched.length > 0) {\n          if (route.matched[0].name === 'onboarding') await checkCurrentRoute()\n          if (route.matched[0].name === 'newCompany') isShowContent.value = true\n        }\n      },\n      {\n        deep: true,\n        immediate: true\n      }\n    )\n    onBeforeRouteUpdate((to, from, next) => {\n      // #86792nrh4 - Prevent user from navigating while email verification process is unfinished\n      if (from.name === 'onboardingPersonalInformation') {\n        if (\n          to.name === 'onboardingPurchasingMethod' &&\n          to.params.verified === 'true'\n        )\n          return next()\n\n        if (!from.query.token) return next()\n        return next(false)\n      }\n      next()\n    })\n    onMounted(async () => {\n      window.onbeforeunload = (event) => {\n        if (queue.size > 0) {\n          event.preventDefault()\n          return (event.returnValue =\n            'Changes you made may not be saved, continue anyway?')\n        }\n      }\n      await getCompanyReferrerDetail()\n    })\n    onUnmounted(() => {\n      destroyWatcher()\n    })\n\n    return {\n      loadingCompanyReferrer,\n      isShowContent,\n      isAddCompany,\n      route,\n      totalSteps,\n      onboardingRoutes,\n      onboardingStepsTitle,\n      currentStepIndex,\n      progressPercentage,\n      isFirstStep,\n      companyReferrer,\n      companyReferrerDetail,\n      hasCompanyReferrer\n    }\n  }\n})\n</script>\n<style lang=\"scss\">\n.onboarding-layout {\n  @apply flex h-screen overflow-y-hidden bg-white shadow-2xl overflow-x-hidden;\n  &__sidebar {\n    @apply lg:flex flex-col hidden justify-center items-center overflow-y-auto;\n    min-width: 32rem;\n    max-width: 32rem;\n  }\n  &__content {\n    @apply flex-auto flex flex-col bg-grey-lighten max-w-full;\n  }\n}\n.onboarding-logo {\n  @apply w-full flex flex-col items-center justify-center h-40;\n}\n.onboarding-menu {\n  @apply flex-1 flex items-center justify-center flex-col;\n}\n.onboarding-steps {\n  // @apply m-auto my-20;\n  // height: max-content;\n}\n.onboarding-step {\n  @apply flex items-center text-lg;\n  $self: &;\n\n  &__number {\n    @apply flex items-center justify-center w-10 h-10 rounded-full border border-grey-04 text-grey-04 m-6 opacity-20;\n  }\n  &__title {\n    @apply flex-auto text-grey-04 max-w-sm opacity-20;\n  }\n  &--active {\n    #{ $self }__number {\n      @apply border-teal-04 text-teal-04 opacity-100;\n    }\n    #{ $self }__title {\n      @apply text-teal-04 opacity-100;\n    }\n  }\n  &--success {\n    #{$self}__number {\n      @apply bg-green-04 border border-green-04 text-white opacity-100;\n    }\n    #{$self}__title {\n      @apply text-grey-02 opacity-100;\n    }\n  }\n}\n.onboarding-progress {\n  @apply flex-auto rounded-full bg-grey-01 mx-6 my-4;\n  $self: &;\n  &__bar {\n    @apply transition-all duration-300 h-3 bg-teal-04 rounded-full;\n  }\n}\n.onboarding-menu-mobile {\n  @apply lg:hidden;\n  .onboarding-logo {\n    @apply flex justify-center mt-10;\n  }\n}\n.loading-logo {\n  animation: rotate 0.8s infinite linear;\n}\n@keyframes rotate {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(-360deg);\n  }\n}\n.company-referrer {\n  @apply text-center;\n  &__logo {\n    @apply flex justify-center;\n  }\n  &__description {\n    @apply mt-10;\n  }\n}\n</style>\n","export default \"__VITE_ASSET__c5f0a2ca__\""],"names":["_sfc_main","defineComponent","components","Stepper","BaseLoading","[object Object]","isShowContent","ref","router","useRouter","route","useRoute","state","stateCurrentStep","stepRoutes","currentStepRoute","actionCurrentStep","useCurrentStep","loading","loadingCompanyReferrer","getCompanyReferrerDetail","companyReferrer","companyReferrerDetail","hasCompanyReferrer","useCompanyReferrer","onboardingRoutes","computed","name","includes","_a","getRoutes","find","item","children","_b","onboardingStepsTitle","value","map","route2","meta","title_step","currentStepIndex","currentRouteIndex","findIndex","onboardingRoute","totalSteps","length","progressPercentage","Math","floor","isFirstStep","query","token","isAddCompany","path","destroyWatcher","watch","fullPath","async","matched","isOnboardingDone","is_onboarding","isNotLastRoute","window","location","href","isIncorrectRouteName","isIncorrectVerifyEmail","push","checkCurrentRoute","deep","immediate","onBeforeRouteUpdate","to","from","next","params","verified","onMounted","onbeforeunload","event","queue","size","preventDefault","returnValue","onUnmounted","_hoisted_1","class","_hoisted_2","key","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_openBlock","_createElementBlock","_createElementVNode","_cache","src","alt","whitelabel","default","_withCtx","_ctx","all","_hoisted_4","_hoisted_5","logo","_Fragment","_renderList","routeIndex","_hoisted_11","_hoisted_12","_hoisted_14","_createTextVNode","_hoisted_19","_hoisted_20","_createVNode","_component_Stepper","color","steps","Component","_createBlock","_Transition","_KeepAlive","_Suspense","fallback","_hoisted_25","_resolveDynamicComponent","_hoisted_26"],"mappings":"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"}