import{u as e}from"./components.41c6afd8.js";import{C as a}from"./card.de1f0319.js";import{f as l,_ as t,b as o,d as i,u as d,R as n}from"./index.e231b017.js";import{B as s}from"./Breadcrumb.e5dd1515.js";import{k as r,g as m,m as c,o as u,t as p,B as f,D as v,U as b,a2 as g,a3 as y,K as h,N as w,a5 as V,r as T,f as k,w as E,I as x,_ as C,a0 as j,A as _,n as B}from"./vendor.f1efedad.js";import{u as N}from"./index.32689823.js";import{r as U}from"./index.1c09f422.js";import{e as F}from"./emailTemplate.540f6153.js";import{M as G}from"./MultipleEmailInput.e6474fb8.js";import{T as I,c as S}from"./TextEditor.8118238d.js";import{P}from"./PreviewEmailTemplate.2eb4d3fa.js";import"./LoadingCard.9892fd7a.js";import"./breadcrumb.e60df23d.js";import"./setting.86482221.js";import"./IframeRender.ac49ebc3.js";const R=r({name:"GeneralNotificationsFormInfo",components:{Input:l,MultipleEmailInput:G},props:{modelValue:{type:Object,default:()=>({})},validation:{type:Object,default:()=>({})},hideBcc:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,a){const l=m({get:()=>e.modelValue,set:e=>a.emit("update:modelValue",e)});return{data:l,handleUpdateBccEmail:e=>{l.value.bcc=[...e]}}}}),$={class:"space-y-4"},M={class:"space-y-1 lg:w-1/2"},A={class:"space-y-1 lg:w-1/2"},D={key:0,class:"space-y-1 lg:w-1/2"},O={class:"space-y-1 lg:w-1/2"};var q=t(R,[["render",function(e,a,l,t,o,i){var d,n;const s=c("Input"),r=c("MultipleEmailInput");return u(),p("div",$,[f("div",M,[a[3]||(a[3]=f("label",null,"Title",-1)),v(s,{modelValue:e.data.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.name=a),placeholder:"Title",block:"",disabled:""},null,8,["modelValue"])]),f("div",A,[a[4]||(a[4]=f("label",null,"Email",-1)),v(s,{modelValue:e.data.email_sender,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.email_sender=a),placeholder:"Email Sender",block:"",disabled:""},null,8,["modelValue"])]),e.hideBcc?b("",!0):(u(),p("div",D,[a[5]||(a[5]=f("label",null,"BCC",-1)),v(r,{onEmailChange:e.handleUpdateBccEmail,suggestion:!1,emails:e.data.bcc},null,8,["onEmailChange","emails"])])),f("div",O,[a[6]||(a[6]=f("label",null,"Subject",-1)),v(s,{modelValue:e.data.subject,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.subject=a),placeholder:"Subject",block:""},null,8,["modelValue"]),(u(!0),p(g,null,y(null==(n=null==(d=e.validation)?void 0:d.subject)?void 0:n.$errors,((e,a)=>(u(),p("small",{key:a,class:"mt-2 text-red-base block"},h(e.$message)+". ",1)))),128))])])}]]);const z=r({name:"GeneralNotificationsFormEditor",components:{PreviewEmailTemplate:P,TextEditor:I,Button:o,Modal:i},props:{modelValue:{type:String,default:void 0},validation:{type:Object,default:()=>({})}},emits:["update:modelValue","reset"],setup(e,a){const l=w(),t=V(),{me:o}=d(),i=T({editor:S.exports.Editor,config:{htmlSupport:{allow:[{styles:!0,classes:!0}]},link:{decorators:{test:{mode:"automatic",callback:e=>"{:verify-link}"===e,classes:"btn btn-blue btn-filled my-4"}}},simpleUpload:{uploadUrl:`https://api-eu.buybackcloud.com/api/v1/pos/settings/email-template/upload-image/${t.params.id}?buyback_company_token=${o.value.buyback_company_token}`}}}),n=m({get:()=>e.modelValue,set:e=>a.emit("update:modelValue",e)}),s=k(),r=k(!1),c=k(!1),u=k(!1);return{ckeditor:i,data:n,preview:s,showPreview:r,loading:c,modal:u,openModalReset:()=>{u.value=!0},handleResetTemplate:async()=>{try{await l.dispatch("setting/emailTemplate/resetEmailTemplate",t.params.id),u.value=!1,a.emit("reset")}catch(e){}finally{c.value=!1}},handlePreviewEmailTemplate:async()=>{c.value=!0;try{const e=await l.dispatch("setting/emailTemplate/previewEmailTemplate",{id:t.params.id,body:n.value||""});s.value=e,r.value=!0}catch(e){s.value=null,r.value=!1}finally{c.value=!1}}}}}),H={class:"py-10"},K={class:"text-center"};var L=t(z,[["render",function(e,a,l,t,o,i){var d,s;const r=c("Button"),m=c("TextEditor"),b=c("Modal"),w=c("PreviewEmailTemplate");return u(),p("div",null,[v(m,{modelValue:e.data,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data=a),options:e.ckeditor,"with-image-upload":""},{toolbar:E((()=>[v(r,{class:"ml-2",color:"teal",dense:"",loading:e.loading,onClick:e.handlePreviewEmailTemplate},{default:E((()=>a[4]||(a[4]=[f("i",{class:"material-icons mr-1"},"visibility",-1),x(" Preview Email ")]))),_:1},8,["loading","onClick"]),v(r,{class:"ml-auto",color:"orange",view:"smooth",dense:"",onClick:e.openModalReset},{default:E((()=>a[5]||(a[5]=[f("i",{class:"material-icons"},"restart_alt",-1),x(" Reset to Default ")]))),_:1},8,["onClick"])])),_:1},8,["modelValue","options"]),(u(!0),p(g,null,y(null==(s=null==(d=e.validation)?void 0:d.body)?void 0:s.$errors,((e,a)=>(u(),p("small",{key:a,class:"mt-2 text-red-base block"},h(e.$message)+". ",1)))),128)),v(b,{modelValue:e.modal,"onUpdate:modelValue":a[2]||(a[2]=a=>e.modal=a),"hide-footer":"","hide-header":"",size:"xs"},{default:E((()=>[f("div",H,[a[8]||(a[8]=f("img",{class:"mb-10 mx-auto",src:n,alt:"Warning icon"},null,-1)),a[9]||(a[9]=f("div",{class:"mt-8 mb-10"},[f("h5",{class:"mb-4 text-center"},"Reset Email Template"),f("p",{class:"text-center mb-6"}," Are you sure you want to reset to the default email template? ")],-1)),f("div",K,[v(r,{view:"outlined",color:"teal",class:"bg-white",onClick:a[1]||(a[1]=a=>e.modal=!1),disabled:e.loading},{default:E((()=>a[6]||(a[6]=[x(" Cancel ")]))),_:1},8,["disabled"]),v(r,{view:"smooth",color:"orange",class:"ml-3",loading:e.loading,onClick:e.handleResetTemplate},{default:E((()=>a[7]||(a[7]=[x(" Yes, reset ")]))),_:1},8,["loading","onClick"])])])])),_:1},8,["modelValue"]),v(w,{show:e.showPreview,"onUpdate:show":a[3]||(a[3]=a=>e.showPreview=a),body:e.preview,"render-type":"direct"},null,8,["show","body"])])}]]);const W=r({name:"GeneralNotificationsFormCodes",components:{},props:{modelValue:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup:e=>({data:m((()=>e.modelValue)),loading:m((()=>e.loading)),copyText:e=>{navigator.clipboard.writeText(e).then((()=>{C({type:"success",message:"Text copied to clipboard"})}))}})}),Y={class:"flex items-center gap-x-4"},J=["onClick"];const Q=r({name:"GeneralNotificationsForm",components:{Button:o,GeneralNotificationsFormInfo:q,GeneralNotificationsFormCodes:t(W,[["render",function(e,a,l,t,o,i){const d=c("TableColumn"),n=c("Table"),s=j("loading");return _((u(),B(n,{data:e.modelValue},{default:E((()=>[v(d,{prop:"code",label:"Code"},{default:E((l=>[f("div",Y,[f("span",null,h(l.row.code),1),f("i",{class:"material-symbols-outlined text-lg text-teal-04",onClick:a=>e.copyText(l.row.code)}," content_copy ",8,J),a[0]||(a[0]=f("i",{class:"material-icons"},"copy",-1))])])),_:1}),v(d,{prop:"description",label:"Description"})])),_:1},8,["data"])),[[s,e.loading]])}]]),GeneralNotificationsFormEditor:L},async setup(){const e=V(),a=k(),l=k(),{data:t,loading:o,handleShow:i,handleUpdate:d}=F(),n=m((()=>["31"].includes(`${t.value.id}`))),s=N({subject:{required:U},body:{required:U}},t,{$lazy:!0});return await i(e.params.id),{data:t,loading:o,isHideBcc:n,formInfo:a,formEditor:l,validation:s,handleShow:i,handleUpdate:d,saveTemplate:async()=>{if(!(await s.value.$validate()))return;const a={id:e.params.id,data:t.value};await d(a)},resetTemplate:async()=>{i(e.params.id)}}}}),X={class:"space-y-10"};var Z=t(r({components:{Card:a,Button:o,Breadcrumb:s,GeneralNotificationsForm:t(Q,[["render",function(e,a,l,t,o,i){const d=c("GeneralNotificationsFormInfo"),n=c("GeneralNotificationsFormEditor"),s=c("GeneralNotificationsFormCodes"),r=j("loading");return _((u(),p("div",X,[v(d,{modelValue:e.data,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data=a),validation:e.validation,"hide-bcc":e.isHideBcc,ref:"formInfo"},null,8,["modelValue","validation","hide-bcc"]),v(n,{modelValue:e.data.body,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.body=a),validation:e.validation,ref:"formEditor",onReset:e.resetTemplate},null,8,["modelValue","validation","onReset"]),v(s,{modelValue:e.data.sort_code,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.sort_code=a),loading:e.loading},null,8,["modelValue","loading"])])),[[r,e.loading]])}]])},async setup(){const e=k(null),a=k(!1);return{generalForm:e,breadcrumb:[{text:"Settings",to:{name:"setting"}},{text:"Notifications",to:{name:"settingEmailTemplate"}},{text:"Edit Notification"}],handleSave:async()=>{var a;await(null==(a=null==e?void 0:e.value)?void 0:a.saveTemplate())},loading:a}}}),[["render",function(e,a,l,t,o,i){const d=c("Button"),n=c("Breadcrumb"),s=c("GeneralNotificationsForm"),r=c("Card");return u(),p(g,null,[v(n,{class:"mt-2 mb-8",pageTitle:"Edit Notification",backTo:{name:"settingEmailTemplate"},items:e.breadcrumb},{right:E((()=>[v(d,{loading:e.loading,color:"teal",onClick:e.handleSave},{default:E((()=>a[0]||(a[0]=[x(" Save Changes ")]))),_:1},8,["loading","onClick"])])),_:1},8,["items"]),v(r,null,{default:E((()=>[v(s,{ref:"generalForm"},null,512)])),_:1})],64)}]]),ee=r({setup(){const{genSuspense:a}=e();return()=>a(Z)}});export{ee as default};
