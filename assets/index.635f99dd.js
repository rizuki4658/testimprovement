var a=Object.defineProperty,e=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(e,l,t)=>l in e?a(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,i=(a,i)=>{for(var o in i||(i={}))l.call(i,o)&&s(a,o,i[o]);if(e)for(var o of e(i))t.call(i,o)&&s(a,o,i[o]);return a};import{N as o,f as n,g as r,r as d,W as c,y as m,m as u,a0 as p,o as v,t as f,B as k,D as y,w as _,ap as g,A as w,a2 as h,I as b,K as x,U as A,n as C,a4 as D,a3 as j,S as U,F as M,_ as V,s as T}from"./vendor.f1efedad.js";import{C as R}from"./card.6a96327d.js";import{_ as S}from"./tab.1390e648.js";import{_ as O,h as F,u as I,f as N,b as z,P as B,g as P}from"./index.161fb295.js";import{F as E}from"./FilterDropdown.f4c58ac7.js";import{B as H}from"./BTable.d9581a46.js";import{a as K}from"./date.f86face7.js";import{_ as L}from"./NotificationModalDetail.737a09cf.js";import"./BDropdown.3c24c256.js";const W={class:"w-full"},Y={style:{"min-height":"200px"}},$={key:0,class:"flex flex-col justify-center items-center w-full h-64"},q={class:"w-full mt-8 flex justify-between items-center"},G={class:"flex-1 flex gap-4 items-center"},J={class:"text-grey-03"},Q={key:0},X={class:"flex flex-col p-3"},Z=["onClick"],aa={class:"capitalize"},ea={class:"flex gap-4"},la={class:"flex gap-6 items-center mt-4"},ta={key:0},sa={key:1},ia={key:2},oa={class:"flex items-center text-black"},na={class:"ml-2 capitalize"},ra={key:3},da={class:"text-black"},ca={key:4},ma={class:"text-sm"},ua={class:"material-icons mr-2"},pa={key:5},va={key:0};var fa=O({__name:"index",setup(a){const{tab:e,filter:l,resetFilter:t,loading:s,actionShow:O,notificationState:fa,notificationDetail:ka,actionShowDetail:ya,actionMarkAsRead:_a,actionMarkAsUnread:ga,actionMarkAllAsRead:wa,actionMarkAllAsUnread:ha,actionListType:ba,listType:xa}=F(),Aa=o(),{dateByTimezone:Ca}=I(),Da=n(!1),ja=r((()=>[{name:"Select Date",key:"date",count_selected:0},{name:"Type",key:"type",count_selected:0}])),Ua=n(""),Ma=n([]),Va=r((()=>{const a=new Set;return Ma.value.filter((e=>{const l=0===e.mark_as_read,t=!a.has(e.id);return!(!l||!t)&&(a.add(e.id),!0)})).map((a=>a.id))})),Ta=r((()=>{const a=new Set;return Ma.value.filter((e=>{const l=1===e.mark_as_read,t=!a.has(e.id);return!(!l||!t)&&(a.add(e.id),!0)})).map((a=>a.id))})),Ra=a=>{a&&"date"===a.key&&Ea()},Sa=a=>"date"===a.key,Oa=()=>{Ya(),l.type=Ua.value},Fa=()=>{Ua.value="",Ka.value=null,t()},Ia=r((()=>1!==l.page||10!==l.limit||""!==l.from||""!==l.to||""!==l.type||""!==l.search)),Na=async()=>{var a;(null==(a=null==Ma?void 0:Ma.value)?void 0:a.length)&&(await _a({ids:Va.value}),Ma.value=[],await Qa())},za=async()=>{var a;(null==(a=null==Ma?void 0:Ma.value)?void 0:a.length)&&(await ga({ids:Ta.value}),Ma.value=[],await Qa())},Ba=d({disabledDate:a=>a.getTime()>Ca.value.getTime()}),Pa=n(null),Ea=async()=>{await T(),Pa.value&&Pa.value.focus()},Ha=n("unread"),Ka=n(null),La=n(!1),Wa=[{column_name:"Notification",key:"title",width:"250px"},{column_name:"Description",key:"description",width:"900px"},{column_name:"Type",key:"type_notification",width:"100px"},{column_name:"Date",key:"created_at",width:"100px"},{column_name:"",key:"actions"}],Ya=()=>{Ka.value&&(l.from=Ka.value[0],l.to=Ka.value[1])},$a=async a=>{La.value=!0,await ya({id:a.id})},qa=r((()=>!Ka.value&&!Ua.value)),Ga=()=>{Ka.value=null,l.from="",l.to=""},Ja=()=>{Ua.value="",l.type=""},Qa=async()=>{const a=i({},l);"unread"===Ha.value?a.mark_as_read=0:a.mark_as_read=1,await O(a)},Xa=async()=>{try{await wa({mark_as_read:0}),await Qa(),V({type:"success",message:"All notifications have been marked as read!"}),Ha.value="all"}catch(a){console.log(a),V({type:"error",message:a.message})}},Za=async()=>{try{await ha(),await Qa(),V({type:"success",message:"All notifications have been marked as unread!"})}catch(a){console.log(a),V({type:"error",message:a.message})}};return c((async()=>{await Qa(),await ba()})),m((()=>i({},l)),P((()=>{Qa()}),500)),m(Ha,(async()=>{await t(),await Qa()})),m((()=>Aa.state.notification.isHasUnreadNotification),(async()=>{await Qa()}),{immediate:!0}),(a,t)=>{const i=u("DatePicker"),o=u("DropdownItem"),n=u("DropdownMenu"),r=u("Dropdown"),d=p("loading");return v(),f(h,null,[k("div",W,[t[20]||(t[20]=k("h5",{class:"mb-10"},"Notifications",-1)),y(R,null,{default:_((()=>{var a,c,m,u,p,T,R,O;return[y(S,{items:g(e),by:"value",name:"label",component:"",color:"teal",view:"smooth",dense:"",modelValue:Ha.value,"onUpdate:modelValue":t[0]||(t[0]=a=>Ha.value=a)},null,8,["items","modelValue"]),w((v(),f("div",Y,[Ia.value||0!==(null==(c=null==(a=g(fa))?void 0:a.data)?void 0:c.length)?(v(),f(h,{key:1},[k("div",q,[k("div",G,[y(N,{modelValue:g(l).search,"onUpdate:modelValue":t[1]||(t[1]=a=>g(l).search=a),placeholder:"Search",icon:"",class:"w-full md:max-w-xl"},{icon:_((()=>t[11]||(t[11]=[k("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue"]),y(E,{onItemClick:Ra,filters:ja.value,onApplyFilter:Oa,onResetFilter:Fa,onCollapse:t[3]||(t[3]=a=>Da.value=!1),"reset-disabled":qa.value,"apply-disabled":qa.value,loading:g(s).listType,"item-disable-hover":Sa},{label:_((({item:a})=>[k("div",null,[k("p",J,[b(x(a.name)+" ",1),a.meta.count_selected>0?(v(),f("span",Q," ("+x(a.meta.count_selected)+") ",1)):A("",!0)]),"date"===a.key?(v(),C(i,D({key:0,modelValue:Ka.value,"onUpdate:modelValue":t[2]||(t[2]=a=>Ka.value=a)},Ba,{placement:"right",type:"daterange",ref_key:"filterDateRef",ref:Pa,class:"hide-picker"}),null,16,["modelValue"])):A("",!0)])])),dropdown:_((({filter:a,collapse:e})=>[k("div",X,["type"===a.key?(v(!0),f(h,{key:0},j(g(xa),(a=>(v(),f("a",{onClick:U((()=>{Ua.value=a,e()}),["prevent"]),key:a,href:"",class:M(["text-grey-03","p-3","block","hover:bg-grey-lighten"])},[k("p",aa,x(a),1)],8,Z)))),128)):A("",!0)])])),_:1},8,["filters","reset-disabled","apply-disabled","loading"])]),k("div",ea,[(null==(m=g(fa))?void 0:m.has_unread_notifications)?(v(),f(h,{key:0},[(null==(u=Va.value)?void 0:u.length)?(v(),C(z,{key:0,onClick:Na,color:"teal",view:"outlined",loading:g(s).markAllAsRead,disabled:g(s).markAllAsUnread},{default:_((()=>{var a;return[t[12]||(t[12]=k("span",{class:"material-icons mr-2"},"drafts",-1)),b(" Mark "+x(null==(a=Va.value)?void 0:a.length)+" as read",1)]})),_:1},8,["loading","disabled"])):(v(),C(z,{key:1,onClick:Xa,color:"teal",view:"outlined",loading:g(s).markAllAsRead,disabled:g(s).markAllAsUnread},{default:_((()=>t[13]||(t[13]=[k("span",{class:"material-icons mr-2"},"drafts",-1),b(" Mark all as read")]))),_:1},8,["loading","disabled"]))],64)):A("",!0),"all"==Ha.value&&(null==(p=g(fa))?void 0:p.has_read_notifications)?(v(),f(h,{key:1},["all"===Ha.value&&(null==(T=Ta.value)?void 0:T.length)?(v(),C(z,{key:0,onClick:za,color:"teal",view:"outlined",loading:g(s).markAllAsUnread,disabled:g(s).markAllAsRead},{default:_((()=>{var a;return[t[14]||(t[14]=k("span",{class:"material-icons mr-2"},"mark_email_unread",-1)),b(" Mark "+x(null==(a=Ta.value)?void 0:a.length)+" as unread",1)]})),_:1},8,["loading","disabled"])):(v(),C(z,{key:1,onClick:Za,color:"teal",view:"outlined",loading:g(s).markAllAsUnread,disabled:g(s).markAllAsRead},{default:_((()=>t[15]||(t[15]=[k("span",{class:"material-icons mr-2"},"mark_email_unread",-1),b(" Mark all as unread")]))),_:1},8,["loading","disabled"]))],64)):A("",!0)])]),k("div",la,[g(l).from||g(l).to?(v(),C(z,{key:0,color:"grey",view:"smooth",dense:""},{default:_((()=>[t[16]||(t[16]=k("b",null,"Date:",-1)),b(" "+x(g(K)(g(l).from))+" to "+x(g(K)(g(l).to)),1),k("i",{class:"material-icons text-sm ml-2",onClick:Ga},"close")])),_:1})):A("",!0),g(l).type?(v(),C(z,{key:1,color:"grey",view:"smooth",dense:"",class:"capitalize"},{default:_((()=>[t[17]||(t[17]=k("b",null,"Type:",-1)),b(" "+x(g(l).type)+" ",1),k("i",{class:"material-icons text-sm ml-2",onClick:Ja},"close")])),_:1})):A("",!0),g(l).from||g(l).to||g(l).type?(v(),C(z,{key:2,color:"grey",view:"smooth",dense:""},{default:_((()=>[t[18]||(t[18]=b(" Clear All ")),k("i",{class:"material-icons text-sm ml-2",onClick:Fa},"close")])),_:1})):A("",!0)]),y(H,{onRowClick:$a,items:(null==(R=g(fa))?void 0:R.data)||[],headers:Wa||[],selectable:"",selected:Ma.value,"onUpdate:selected":t[5]||(t[5]=a=>Ma.value=a),"clickable-row":!0,"item-value":"id",class:"mt-4 mb-8",loading:g(s).show},{column:_((({row:a,column:e,key:l})=>["title"===l?(v(),f("td",ta,[k("p",{class:M(0==a.mark_as_read?"font-semibold text-black":"")},x(e),3)])):"description"===l?(v(),f("td",sa,[k("p",{class:M(["leading-7",0==a.mark_as_read?"font-semibold text-black":""])},x(e),3)])):"type_notification"===l?(v(),f("td",ia,[k("div",oa,[k("span",{class:M(["material-icons","info"===e?"text-blue-04":"text-orange-04"])},x("info"===e?"info":"warning"),3),k("p",na,x(e),1)])])):"created_at"===l?(v(),f("td",ra,[k("p",da,x(e),1)])):"actions"===l?(v(),f("td",ca,[y(r,{trigger:"click","hide-on-click":"",placement:"bottom-end"},{dropdown:_((()=>[y(n,{onClick:e=>(async a=>{0==a.mark_as_read?await _a({ids:[a.id]}):await ga({ids:[a.id]}),V({type:"success",message:`Notification have been marked as ${0==a.mark_as_read?"read":"unread"}!`}),await Qa()})(a),class:"py-1"},{default:_((()=>[y(o,null,{default:_((()=>[k("p",ma,[k("span",ua,x(1==a.mark_as_read?"drafts":"mark_email_unread"),1),b(" "+x(0==a.mark_as_read?"Mark as read":"Mark as unread"),1)])])),_:2},1024)])),_:2},1032,["onClick"])])),default:_((()=>[k("button",{onClick:t[4]||(t[4]=U((()=>{}),["stop"])),class:"btn-action"},t[19]||(t[19]=[k("span",{class:"material-icons"},"more_horiz",-1)]))])),_:2},1024)])):(v(),f("td",pa,x(e||"-"),1))])),_:1},8,["items","headers","selected","loading"]),(null==(O=g(fa))?void 0:O.total)>g(l).limit?(v(),f("div",va,[y(B,{page:g(l).page,"onUpdate:page":t[6]||(t[6]=a=>g(l).page=a),limit:g(l).limit,"onUpdate:limit":t[7]||(t[7]=a=>g(l).limit=a),data:g(fa)},null,8,["page","limit","data"])])):A("",!0)],64)):(v(),f("div",$,t[10]||(t[10]=[k("span",{class:"material-icons icon-updated"},"drafts",-1),k("h5",{class:"mt-4 text-lg"},"Youâ€™re all caught up!",-1),k("p",{class:"text-grey-03 mt-3"},"There are no new notifications at this time.",-1)])))])),[[d,g(s).show]])]})),_:1})]),y(L,{modelValue:La.value,"onUpdate:modelValue":t[8]||(t[8]=a=>La.value=a),title:"Message Info",data:g(ka),onOnClose:t[9]||(t[9]=a=>(async a=>{0==a.mark_as_read&&(await _a({ids:[a.id]}),await Qa())})(g(ka))),loading:g(s).showDetail},null,8,["modelValue","data","loading"])],64)}}},[["__scopeId","data-v-0f11a5f7"]]);export{fa as default};
