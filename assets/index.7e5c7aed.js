var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,d=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,l=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&d(e,n,t[n]);if(a)for(var n of a(t))i.call(t,n)&&d(e,n,t[n]);return e};import{C as r}from"./card.198a6be1.js";import{_ as s}from"./index.ec266ec1.js";import{k as c,f as u,m as p,o as g,t as m,B as f,a2 as y,a3 as b,K as v,I as w,D as h,w as k,W as S,y as x,a0 as I,A as O,n as j,F as C}from"./vendor.f1efedad.js";const L=c({name:"WidgetUnvailable",setup:()=>({instructions:u([{link:"settingCondition",text_link:"Condition Settings",text:"Set item conditions as needed within the"},{link:"settingBulkPriceEditor",text_link:"Price Editor Settings",text:"Set item prices as needed within the"}])})}),W={class:"flex flex-col items-center justify-center gap-8 mx-auto my-10"},B={class:"m-0 space-y-4"},E={class:"flex gap-4 items-center"},P={class:"w-8 h-8 font-bold bg-teal-03 text-white rounded-full flex justify-center items-center"},_={class:"underline"};var K=s(L,[["render",function(e,t,n,a,o,i){const d=p("router-link");return g(),m("div",W,[t[0]||(t[0]=f("div",null,[f("img",{src:"/assets/widget-unavailable.ba52d097.svg"})],-1)),t[1]||(t[1]=f("p",{class:"text-2xl text-center font-semibold max-w-lg"}," Complete your item setup first ",-1)),t[2]||(t[2]=f("p",{class:"text-center"}," Here are the steps you need to do: ",-1)),f("ul",B,[(g(!0),m(y,null,b(e.instructions,((e,t)=>(g(),m("li",{key:t},[f("div",E,[f("div",P,v(t+1),1),f("p",null,[w(v(e.text)+" ",1),h(d,{to:{name:e.link}},{default:k((()=>[f("span",_,v(e.text_link),1)])),_:2},1032,["to"])])])])))),128))])])}]]);const M=c({name:"WidgetPreview",components:{Card:r,WidgetUnvailable:K},props:{modelValue:{type:Object,default:void 0},available:{type:Boolean,default:!1},loading:{type:Boolean,default:!0},loadingUpdate:{type:Boolean,default:!1},whiteLabel:{type:Boolean,default:!1},tenantId:{type:String,default:void 0},apiKey:{type:String,default:void 0},device:{type:String,default:void 0},brand:{type:String,default:void 0},category:{type:String,default:void 0},language:{type:String,default:void 0},tokenModel:{type:String,default:void 0},tokenLocation:{type:String,default:void 0},useIframe:{type:Boolean,default:!0}},setup(e){const a=u(!1),o=()=>`${JSON.parse(window.localStorage.getItem("white-label"))&&e.whiteLabel?"https://widget-refreshedtech.com":"https://widget-eu.buybackcloud.com"}/v3.js`,i=()=>{return a=l(l(l(l(l(l(l({tenantId:e.tenantId,apiKey:e.apiKey},JSON.parse(window.localStorage.getItem("white-label"))&&{whiteLabel:e.whiteLabel}),e.device&&{deviceSlug:e.device}),e.brand&&{brandSlug:e.brand}),e.category&&{categorySlug:e.category}),e.language&&{language:e.language}),e.tokenModel&&{tokenModel:e.tokenModel}),e.tokenLocation&&{tokenLocation:e.tokenLocation}),t(a,n({disableFloatButton:!1}));var a},d=()=>{if(a.value)return;if(!e.useIframe)return r();if(!e.tenantId&&!e.apiKey)return console.error("Tenant ID and Api Key is required for Widget");if(!e.available)return console.warn("Widget Unavailable!");(()=>{const e=document.querySelector("#widgetIframe").querySelector("iframe");e&&e.remove()})();const t=document.querySelector("#widgetIframe"),n=document.createElement("iframe");t.appendChild(n),n.onload=()=>{const e=n.contentWindow.document;e.open(),e.write("\n          <html>\n            <head>\n              <title>Widget Preview</title>\n              <style>\n                * {\n                  padding: 0;\n                  margin: 0;\n                }\n              </style>\n            </head>\n            <body>\n            </body>\n          </html>\n        "),e.close();const t=document.createElement("script");t.src=o(),t.onload=()=>{const e=document.createElement("div");e.classList.add("buyback-widget");const t=document.createElement("script");t.defer=!0,t.innerText=`new Buyback(${JSON.stringify(i())})`,n.contentWindow.document.body.appendChild(e),n.contentWindow.document.body.appendChild(t)},n.contentWindow.document.body.appendChild(t)},n.src="about:blank",n.classList.add("w-full"),n.style.minHeight="calc(100vh + 20rem)"},r=()=>{const e=document.querySelector("#widgetIframe"),t=document.createElement("div");t.classList.add("buyback-widget");const n=document.createElement("script");n.src=o(),n.onload=()=>{const n=document.createElement("script");n.innerText=`new Buyback(${JSON.stringify(i())})`,n.defer=!0,e.appendChild(t),e.appendChild(n)},e.appendChild(n)};S((()=>{d(),x((()=>({loading:e.loading,device:e.device,brand:e.brand,category:e.category,tokenModel:e.tokenModel,language:e.language,tokenLocation:e.tokenLocation})),((e,t)=>{Object.keys(e).some((n=>e[n]!==t[n]))&&d()}),{deep:!0})}))}}),U={key:0},q={key:1};var J=s(M,[["render",function(e,t,n,a,o,i){const d=p("Card"),l=p("WidgetUnvailable"),r=I("loading");return e.available?(g(),m("div",U,[O((g(),j(d,null,{default:k((()=>[f("div",{id:"widgetIframe",class:C({"use-iframe":e.useIframe})},null,2)])),_:1})),[[r,e.loading||e.loadingUpdate]])])):(g(),m("div",q,[h(d,null,{default:k((()=>[h(l)])),_:1})]))}]]);export{K as W,J as a};
