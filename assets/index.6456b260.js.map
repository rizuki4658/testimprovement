{"version":3,"file":"index.6456b260.js","sources":["../../src/views/setting/payment-method/promo-code/index.vue","../../src/views/setting/payment-method/promo-code/index.js"],"sourcesContent":["<template>\n  <div v-loading=\"loading.all\" class=\"flex flex-col mt-2\">\n    <Table :data=\"stateAll.data\">\n      <TableColumn width=\"100\">\n        <template #default=\"{ row }\">\n          <Checkbox\n            v-model=\"row.is_enable\"\n            class=\"py-3\"\n            type=\"toggle\"\n            :value=\"1\"\n            :value-off=\"0\"\n            @change=\"statusPromo(row)\"\n          />\n        </template>\n      </TableColumn>      \n      <TableColumn prop=\"code\" label=\"Promo Code\" width=\"144\" />\n      <TableColumn label=\"Type\" width=\"240\">\n        <template #default=\"{ row }\">\n          {{ row.type }}\n          ({{ row.type === 'Percentage' ?  `${row.amount}%` : currency(me, row.amount) }})\n        </template>\n      </TableColumn>\n      <TableColumn label=\"\">\n        <template #default=\"scope\">\n          <div class=\"flex items-center lg:opacity-0 group-hover:opacity-100 transition-opacity\">\n            <Button color=\"teal\" class=\"mr-4\" dense @click=\"editCoupon(scope.row.id)\">\n              <span class=\"material-icons text-xl\">edit</span>\n            </Button>\n              <Button color=\"red\" dense @click=\"openDeleteModal(scope.row)\">\n              <span class=\"material-icons text-xl\">delete</span>\n            </Button>\n          </div>\n        </template>\n      </TableColumn>\n    </Table>\n    <br />\n    <Pagination v-model:page=\"filters.page\" v-model:limit=\"filters.limit\" :data=\"stateAll\" />\n  </div>\n  <Modal v-model=\"modal.delete\" size=\"xs\" hide-footer hide-header>\n    <div class=\"flex flex-col items-center justify-center my-10\">\n      <div class=\"flex flex-col items-center justify-center mb-6\">\n        <img class=\"mb-6\" src=\"@/assets/icon/attention.svg\" alt=\"Success Icon\">\n        <h2 class=\"text-2xl mb-2\">Delete this Promo Code</h2>\n        <p>Are you sure want to delete this promo code?</p>\n      </div>\n      <div class=\"flex flex-wrap\">\n        <Button color=\"teal\" class=\"mr-4\" @click=\"modal.delete = false\">Cancel</Button>\n        <Button color=\"red\" @click=\"deleteCoupon\" :loading=\"loading.delete\">Yes</Button>\n      </div>\n    </div>\n  </Modal>\n\n  <router-view />\n</template>\n\n<script>\nimport { defineComponent, watch, ref } from 'vue'\nimport { useUser } from 'composable/user'\nimport { useCouponCodes } from 'composable/setting'\nimport { useRouter, useRoute } from 'vue-router'\nimport Card from 'bbUi/components/card/card.vue'\nimport Input from 'bbUi/components/input/input.vue'\nimport Button from 'bbUi/components/button/button.vue'\nimport Pagination from 'components/Pagination.vue'\nimport Checkbox from 'bbUi/components/checkbox/checkbox.vue'\nimport Breadcrumb from 'bbUi/components/breadcrumb/breadcrumb.vue'\nimport Modal from 'bbUi/components/modal/modal.vue'\nimport debounce from 'utils/debounce'\nimport { currency } from 'utils/number'\nimport { ElMessage } from 'element-plus'\n\nexport default defineComponent({\n  components: {\n    Card,\n    Input,\n    Button,\n    Breadcrumb,\n    Pagination,\n    Modal,\n    Checkbox\n  },\n  async setup(props, { emit }) {\n    const { me } = useUser()\n    const { stateAll, loading, filters, actionAll, actionDelete, modal, actionStatus } = useCouponCodes()\n    const router = useRouter()\n    const route = useRoute()\n    const selectedItem = ref(null)\n    const breadcrumb = [{\n      text: 'Settings',\n      to: {\n        name: 'setting'\n      }\n    }, {\n      text: 'Promo Codes'\n    }]\n    const dataTable = ref([])\n    const openDeleteModal = (item) => {\n      selectedItem.value = item\n      modal.delete = true\n    }\n    const deleteCoupon = async () => {\n      await actionDelete(selectedItem.value.id, async() => {\n        ElMessage({\n          type: 'success',\n          message: 'Promo Code deleted'\n        })\n        await actionAll()\n      })\n      selectedItem.value = null\n      modal.delete = false\n    }\n    const editCoupon = (id) => router.push({\n      name: 'settingPayoutsPromoCodeEdit',\n      params: {\n        id\n      }\n    })\n    const statusPromo = async (row) => {\n      await actionStatus(row, () => {\n        ElMessage({\n          type: 'success',\n          message: `Promo Code \"${row.code}\" ${ row.is_enable ? 'activated' : 'deactivated'}`\n        })\n      })\n    }\n    watch(() => ({...filters}), debounce(async () => {\n      await actionAll()\n    }, 400), {\n      deep: true\n    })\n    \n    watch(() => ({limit: filters.limit}), () => filters.page = 1, {\n      deep: true\n    })\n\n    watch(\n      () => ({ ...route }),\n      async (_, oldVal) => {\n        if (oldVal.name.includes('Edit') || oldVal.name.includes('Create')) {\n          await actionAll()\n        }\n      }\n    )\n\n    await actionAll()\n    return {\n      me,\n      stateAll,\n      loading,\n      filters,\n      modal,\n      breadcrumb,\n      openDeleteModal,\n      deleteCoupon,\n      editCoupon,\n      currency,\n      statusPromo\n    }\n  }\n})\n</script>","import { defineComponent } from 'vue'\nimport { useSuspense } from 'composable/components'\nimport index from './index.vue'\n\nexport default defineComponent({\n  setup() {\n    const { genSuspense } = useSuspense()\n\n    return () => genSuspense(index)\n  }\n})"],"names":["_sfc_main","defineComponent","components","Card","Input","Button","Breadcrumb","Pagination","Modal","Checkbox","[object Object]","props","emit","me","useUser","stateAll","loading","filters","actionAll","actionDelete","modal","actionStatus","useCouponCodes","router","useRouter","route","useRoute","selectedItem","ref","watch","__spreadValues","debounce","async","deep","limit","page","_","oldVal","name","includes","breadcrumb","text","to","openDeleteModal","item","value","delete","deleteCoupon","id","_u","type","message","editCoupon","push","params","currency","statusPromo","row","code","is_enable","_hoisted_1","class","_hoisted_2","_hoisted_3","_openBlock","_createElementBlock","_Fragment","_component_Table","_withCtx","_component_TableColumn","width","_createVNode","_component_Checkbox","modelValue","onUpdate:modelValue","$event","value-off","prop","label","default","scope","_component_Button","color","dense","_cache","_createElementVNode","_component_Pagination","_ctx","onUpdate:page","onUpdate:limit","_component_Modal","size","hide-footer","src","_imports_0","_hoisted_4","onClick","index","genSuspense","useSuspense"],"mappings":"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"}