{"version":3,"file":"BTable.d9581a46.js","sources":["../../src/components/BTable/BTable.vue"],"sourcesContent":["<template>\n  <div class=\"b-table-container\">\n    <table class=\"b-table\">\n      <thead class=\"b-table__header\">\n        <tr class=\"b-table__row b-table__row--header\">\n          <th\n            v-if=\"selectable\"\n            class=\"b-table__column-selection\"\n            @mouseenter=\"isHoveredSelectionColumn = true\"\n            @mouseleave=\"isHoveredSelectionColumn = false\"\n          >\n            <Checkbox\n              v-show=\"items.length > 0\"\n              :model-value=\"selectAll || isIndeterminate\"\n              @click.prevent=\"selectAll = isIndeterminate ? true : !selectAll\"\n              :indeterminate=\"isIndeterminate\"\n              :disabled=\"isAnyRowLoading\"\n            />\n          </th>\n          <slot v-for=\"header in headers\" v-bind=\"{ header }\" name=\"header\">\n            <th :key=\"header.key\">\n              {{ header.column_name }}\n            </th>\n          </slot>\n          <th v-if=\"$slots.action || moreActionSlots?.length\"></th>\n        </tr>\n      </thead>\n      <tbody class=\"b-table__body\">\n        <tr\n          v-for=\"(item, itemIndex) of items\"\n          v-intersect=\"() => handleIntersectionObserver(item)\"\n          @click=\"handleClickRow(item)\"\n          :class=\"[\n            'b-table__row b-table__row--body relative',\n            clickableRow && 'b-table__row--clickable',\n            'group',\n            item.loading && 'is-loading'\n          ]\"\n          :key=\"`${item[itemValue]}-${itemIndex}-${dataTimestamp}`\"\n        >\n          <td\n            v-if=\"selectable\"\n            @mouseenter=\"isHoveredSelectionColumn = true\"\n            @mouseleave=\"isHoveredSelectionColumn = false\"\n          >\n            <Checkbox\n              :model-value=\"selectedValues.includes(item[itemValue || ''])\"\n              :disabled=\"isAnyRowLoading\"\n              @click.prevent=\"handleSelectionChange(item)\"\n            />\n          </td>\n          <slot\n            v-for=\"header in headers\"\n            :key=\"header.key\"\n            v-bind=\"{\n              row: item,\n              column: item[header.key],\n              key: header.key,\n              rowIndex: itemIndex,\n              preventRowClick,\n              resetRowClick\n            }\"\n            name=\"column\"\n          >\n            <td>\n              {{ item[header.key] }}\n            </td>\n          </slot>\n          <td\n            v-if=\"$slots.action && !moreActionSlots?.length\"\n            class=\"group-hover:opacity-100 transition duration-300 opacity-0\"\n            @mouseenter=\"isHoveredActionColumn = true\"\n            @mouseleave=\"isHoveredActionColumn = false\"\n          >\n            <slot\n              v-bind=\"{ row: item, rowIndex: itemIndex }\"\n              name=\"action\"\n            />\n          </td>\n          <td\n            v-else-if=\"moreActionSlots.length\"\n            class=\"transition duration-300 opacity-0 group-hover:opacity-100\"\n            :class=\"{ 'opacity-100': isMoreActionDropdownOpen && isMoreActionDropdownOpenKey === itemIndex }\"\n            @mouseenter=\"isHoveredActionColumn = true\"\n            @mouseleave=\"isHoveredActionColumn = false\">\n            <div>\n              <Dropdown\n                trigger=\"hover\"\n                placement=\"bottom-end\"\n                @visible-change=\"(visible) => {\n                  isMoreActionDropdownOpen = visible\n                  isMoreActionDropdownOpenKey = itemIndex\n                }\">\n                <Button\n                  color=\"grey\"\n                  view=\"outlined\"\n                  class=\"text-base\"\n                  dense>\n                  <span class=\"material-icons\">\n                    more_vert\n                  </span>\n                </Button>\n                <template #dropdown>\n                  <DropdownMenu\n                    class=\"p-2 rounded-lg\">\n                    <DropdownItem\n                      v-for=\"(moreAction, n) in moreActionSlots\"\n                      :key=\"n\"\n                      class=\"p-0 leading-none rounded-lg\">\n                      <div class=\"text-teal-04 hover:text-teal-03\">\n                        <slot v-bind=\"{ row: item, rowIndex: itemIndex }\" :name=\"moreAction\" />\n                      </div>\n                    </DropdownItem>\n                  </DropdownMenu>\n                </template>\n              </Dropdown>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n      <tfoot class=\"b-table__footer\">\n        <tr class=\"b-table__row b-table__row--footer\">\n          <slot name=\"footer\" v-bind=\"{ headers }\"></slot>\n        </tr>\n      </tfoot>\n    </table>\n  </div>\n</template>\n\n<script>\nimport { computed, defineComponent, ref, watch } from 'vue'\nimport Checkbox from 'bbUi/components/checkbox/checkbox.vue'\nimport Button from 'bbUi/components/button/button.vue'\n\nexport default defineComponent({\n  name: 'BTable',\n  components: {\n    Checkbox,\n    Button\n  },\n  props: {\n    headers: {\n      type: Array,\n      default: () => []\n    },\n    items: {\n      type: Array,\n      default: () => []\n    },\n    itemValue: {\n      type: String,\n      default: 'id'\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    selected: {\n      type: Array,\n      default: () => []\n    },\n    clickableRow: {\n      type: Boolean,\n      default: false\n    },\n    selectable: {\n      type: Boolean,\n      default: false\n    },\n    minWidth: {\n      type: String,\n      default: '200px'\n    },\n    intersect: {\n      type: Boolean,\n      default: false\n    },\n    observerTable: {\n      type: Function,\n      default: undefined\n      // Lazy Load for each row if row need fetch another data\n    },\n    moreActions: {\n      type: Array,\n      default: undefined\n      // example you just send ['delete',  'edit', 'preview']\n      // this props will generate new slots with camelCase named, using prefix ex: 'actionDelete'\n      // new ui standard all button action inside dropdown\n    },\n    prefixMoreAction: {\n      type: String,\n      default: 'action'\n    },\n    timeStamp: {\n      type: Boolean,\n      default: true\n    }\n  },\n  emits: ['update:selected', 'rowClick', 'update:singleSelected'],\n  setup(props, { emit }) {\n    const isHoveredSelectionColumn = ref(false)\n    const isHoveredActionColumn = ref(false)\n    const isPreventRowClick = ref(false)\n    const isMoreActionDropdownOpen = ref(false)\n    const isMoreActionDropdownOpenKey = ref(null)\n    const dataTimestamp = ref(new Date(Date.now()).getTime())\n    const selected = computed({\n      set: (selected) => emit('update:selected', selected),\n      get: () => props.selected\n    })\n    const selectedValues = computed(() =>\n      selected.value.map((item) => item[props.itemValue])\n    )\n    const selectedItemFilteredByItemsProp = computed(() => {\n      return props.items\n        .map((item) => item[props.itemValue])\n        .filter((item) => selectedValues.value.includes(item))\n    })\n\n    const moreActionSlots = computed(() => {\n      return props.moreActions ? props.moreActions.map((str) => {\n        return prefixForActionSlots(str, props.prefixMoreAction)\n      }) : []\n    })\n    const isAnyRowLoading = computed(() =>\n      props.items.some((item) => item.loading === true)\n    )\n    const isIndeterminate = computed(() => {\n      const filteredSelectedItems = selectedItemFilteredByItemsProp.value\n      const hasSelectedItems = filteredSelectedItems.length > 0\n      const notAllItemsSelected =\n        filteredSelectedItems.length < props.items.length\n      return hasSelectedItems && notAllItemsSelected\n    })\n\n    const selectAll = computed({\n      set: (value) => {\n        if (value) {\n          const newItems = props.items.filter((item) => {\n            const currentItem = item[props.itemValue]\n            return !selectedValues.value.includes(currentItem)\n          })\n          selected.value = [...selected.value, ...newItems]\n        } else {\n          const itemIds = props.items.map((item) => item[props.itemValue])\n          selected.value = selected.value.filter(\n            (item) => !itemIds.includes(item[props.itemValue])\n          )\n        }\n      },\n      get: () => selected.value.length >= props.items.length\n    })\n    const minWidth = computed(() => props.minWidth)\n    const handleClickRow = (row) => {\n      if (\n        !props.clickableRow ||\n        isHoveredSelectionColumn.value ||\n        isHoveredActionColumn.value ||\n        isPreventRowClick.value\n      )\n        return\n      emit('rowClick', row)\n    }\n    const handleSelectionChange = (item) => {\n      const isCurrentItemSelected = selectedValues.value.includes(\n        item[props.itemValue]\n      )\n      if (isCurrentItemSelected) {\n        selected.value = selected.value.filter(\n          (selectedItem) =>\n            selectedItem[props.itemValue] !== item[props.itemValue]\n        )\n        return\n      }\n      selected.value = [...selected.value, item]\n      emit('update:singleSelected', item)\n    }\n    const preventRowClick = () => {\n      isPreventRowClick.value = true\n    }\n    const resetRowClick = () => {\n      isPreventRowClick.value = false\n    }\n    const handleIntersectionObserver = (e) => {\n      if (props.observerTable && typeof props.observerTable === 'function' && props.intersect) {\n        props.observerTable(e)\n      }\n    }\n    const prefixForActionSlots = (str, prefix = 'action') => {\n      return (\n        prefix +\n        str\n          .split(/[\\s-]+/)\n          .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n          .join('')\n      )\n    }\n\n    watch(() => props.items, () => {\n      if (props.timeStamp) dataTimestamp.value = new Date(Date.now()).getTime()\n    })\n\n    return {\n      selected,\n      selectedValues,\n      isHoveredSelectionColumn,\n      isHoveredActionColumn,\n      isIndeterminate,\n      isPreventRowClick,\n      isMoreActionDropdownOpenKey,\n      isMoreActionDropdownOpen,\n      isAnyRowLoading,\n      selectAll,\n      moreActionSlots,\n      dataTimestamp,\n      handleClickRow,\n      handleSelectionChange,\n      preventRowClick,\n      resetRowClick,\n      handleIntersectionObserver\n    }\n  }\n})\n</script>\n\n<style lang=\"scss\">\n.b-table {\n  @apply w-full;\n}\n\n.b-table-container {\n  @apply relative w-full overflow-auto border-b border-grey-01;\n}\n\n.b-table__row {\n  @apply border-b border-grey-01;\n  &:hover {\n    background-color: rgba(0, 0, 0, 0.03);\n  }\n\n  th,\n  td {\n    @apply p-5 text-left;\n  }\n\n  th {\n    min-width: v-bind(minWidth);\n\n    &.b-table__column-selection {\n      min-width: 60px !important;\n      width: 60px !important;\n    }\n  }\n\n  &--clickable {\n    @apply cursor-pointer;\n  }\n  &.is-loading {\n    position: relative;\n    &:hover {\n      background-color: transparent !important;\n    }\n    td {\n      position: relative;\n      cursor: wait;\n      &::after {\n        content: '';\n        position: absolute;\n        inset: 0;\n        background: rgba(255, 255, 255, 0.5);\n        animation: flicker-bg 1s ease-in-out infinite alternate;\n        z-index: 10;\n        pointer-events: all;\n      }\n    }\n  }\n  // &.is-loading::after {\n  //   @apply border-teal-04;\n  //   content: '';\n  //   position: absolute;\n  //   top: 50%;\n  //   left: 50%;\n  //   width: 20px;\n  //   height: 20px;\n  //   margin: -10px 0 0 -10px;\n  //   border: 2px solid;\n  //   border-top-color: transparent;\n  //   border-radius: 50%;\n  //   animation: spin 0.8s linear infinite;\n  //   z-index: 10;\n  //   pointer-events: all;\n  // }\n}\n\n.b-table__header,\n.b-table__footer {\n  @apply sticky bg-grey-01;\n}\n\n.b-table__header {\n  inset-block-start: 0;\n}\n\n.b-table__footer {\n  inset-block-end: 0;\n}\n@keyframes flicker-bg {\n  0% {\n    background-color: rgba(255, 255, 255, 0.6);\n  }\n  100% {\n    background-color: rgba(255, 255, 255, 0.3);\n  }\n}\n</style>\n"],"names":["__default__","defineComponent","name","components","Checkbox","Button","props","headers","type","Array","default","items","itemValue","String","loading","Boolean","selected","clickableRow","selectable","minWidth","intersect","observerTable","Function","moreActions","prefixMoreAction","timeStamp","emits","[object Object]","emit","isHoveredSelectionColumn","ref","isHoveredActionColumn","isPreventRowClick","isMoreActionDropdownOpen","isMoreActionDropdownOpenKey","dataTimestamp","Date","now","getTime","computed","set","selected2","get","selectedValues","value","map","item","selectedItemFilteredByItemsProp","filter","includes","moreActionSlots","str","prefixForActionSlots","isAnyRowLoading","some","isIndeterminate","filteredSelectedItems","hasSelectedItems","length","notAllItemsSelected","selectAll","newItems","currentItem","itemIds","prefix","split","word","charAt","toUpperCase","slice","join","watch","handleClickRow","row","handleSelectionChange","selectedItem","preventRowClick","resetRowClick","handleIntersectionObserver","e","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_5","key","_hoisted_7","_hoisted_8","_hoisted_9","_openBlock","_createElementBlock","_createElementVNode","_hoisted_4","onMouseenter","_ctx","_createVNode","_component_Checkbox","model-value","onClick","_cache","_withModifiers","$event","indeterminate","_Fragment","_renderList","header","$slots","_mergeProps","ref_for","_a","_hoisted_6","itemIndex","_withDirectives","disabled","_renderSlot","column","_a2","_normalizeClass","opacity-100","_component_Dropdown","trigger","placement","onVisibleChange","visible","_withCtx","moreAction","n","_createBlock","_component_DropdownItem","_component_Button","color","view"],"mappings":"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"}