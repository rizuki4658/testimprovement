var a=Object.defineProperty,e=Object.defineProperties,i=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(e,i,t)=>i in e?a(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t,s=(a,e)=>{for(var i in e||(e={}))l.call(e,i)&&o(a,i,e[i]);if(t)for(var i of t(e))n.call(e,i)&&o(a,i,e[i]);return a},d=(a,t)=>e(a,i(t));import{r,az as c,O as m,f as u,g as p,_ as y}from"./vendor.9695fe57.js";import{u as v}from"./index.f40e4a9e.js";import{c as g,r as f,m as h,a as b}from"./index.6b6f6369.js";import{aM as w,E as _,s as S,v as T}from"./index.35a87af4.js";import{c as j}from"./setting.598aa5c3.js";const O=Symbol(),k=Symbol(),E=Symbol(),L=Symbol(),M=()=>{const a=r({verification:!1}),e=r({verification:!1,verification_check:!1}),i=r({email:"",code:null,code_encrypted:null}),t=async(a=(()=>{}))=>{try{e.verification=!0;const t=await S.dispatch("setting/sendEmailVerification",{email:i.email});i.code_encrypted=t.code,T(a)&&a(null,null)}catch(t){T(a)&&a(t,null)}finally{e.verification=!1}};return c(O,a),c(k,e),c(E,i),c(L,t),{data:i,modal:a,loading:e,openModal:e=>{Object.keys(a).includes(e)&&(a[e]=!0)},closeModal:e=>{Object.keys(a).includes(e)&&(a[e]=!1),"verification"===a[e]&&Object.assign(i,{email:"",code:null,code_encrypted:null})},actionVerify:t,actionVerifyCheck:async(a=(()=>{}))=>{try{e.verification_check=!0,await S.dispatch("setting/checkEmailVerification",i),T(a)&&a()}finally{e.verification_check=!1}}}},q=()=>{const{loading:a,filters:e,locations:i,mailinLocation:t,fetchLocations:l}=(()=>{const a=r({fetch:!1}),e=r({page:1,limit:10,search:"",sort_by:"",order_by:"",is_addtional_info:1,location_type:null}),i=p((()=>S.state.setting.emailTemplate.staff_notification.locations||[])),t=p((()=>i.value.mailin_location_id?{id:i.value.mailin_location_id||null,name:i.value.mailin_location_name||""}:{id:null,name:"Mail-in"}));return{loading:a,filters:e,locations:i,mailinLocation:t,fetchLocations:async(i=(()=>{}),t)=>{try{a.fetch=!0,await S.dispatch("setting/emailTemplate/staffNotificationLocation",s(s({},e),t&&{admin_id:t})),T(i)&&i()}finally{a.fetch=!1}}}})();return{loading:a,filters:e,locations:i,mailinLocation:t,fetchLocations:l}},P=()=>{const a=m(),e=u(!1),i=u([]),t=u({page:1,limit:10,type:"mail-in"}),l=u({show:!1,body:void 0});return{loading:e,preview:l,data:i,query:t,handlePreview:async a=>{try{a.loading=!0,l.value.show=!1;const e=await S.dispatch("setting/emailTemplate/previewEmailTemplateById",a.id);l.value.show=!0,l.value.body=e}catch{l.value.show=!1,l.value.body=void 0}finally{return a.loading=!1,a}},handleStatus:async a=>{try{a.loading=!0,await S.dispatch("setting/emailTemplate/update",{id:a.id,data:{is_enable:a.is_enable}})}finally{return a.loading=!1,a}},handleEdit:e=>{a.push({name:"settingEmailTemplateStaffForm",params:{id:e.id},query:{type:t.value.type}})},handleShow:async()=>{var a,l;try{e.value=!0;const n=await S.dispatch("setting/emailTemplate/staffList",{page:t.value.page,limit:t.value.limit,type:t.value.type});i.value=(null==(a=null==n?void 0:n.data)?void 0:a.length)?n.data.map((a=>d(s({},a),{loading:!1}))):[],(null==(l=Object.keys(n))?void 0:l.length)&&Object.keys(n).map((a=>{"data"!==a&&(t.value[a]=n[a])}))}catch{i.value=[],t.value={page:1,limit:10,type:"mail-in"}}finally{e.value=!1}}}},x=()=>{const a=r({table:[],domain:void 0,sub_domain:void 0,continent:void 0,email:void 0,emailSenderType:void 0,selected:void 0,loading:{all:!1,table:!1},options:w(_.value).mailServer.options,instructions:w(_.value).mailServer.instructions,form:{email:"",domain:"",region:""},verifying:!1,modal:{formCustom:!1,sender:!1}}),e=v({email:{required:g.withMessage("Email is required",f)},region:{minValue:h(2),maxLength:b(2),required:g.withMessage("Region is required",f)}},a.form),i={show:async()=>{a.loading.all=!0;try{const{sending_dns_records:e,domain:i,email:t,continent:l,email_sender_type:n,sub_domain:o}=await S.dispatch("setting/emailTemplate/mailServer");a.table=e||[],a.domain=i,a.email=t,a.continent=l,a.emailSenderType=n,a.sub_domain=o}finally{a.loading.all=!1}},add:async(e,i=(()=>{}))=>{a.loading.all=!0;try{const t=await S.dispatch("setting/emailTemplate/addMailServer",e);y({message:"Email and Domain saved!",type:"success"}),T(i)&&i(t)}finally{a.loading.all=!1}},reset:async(e=(()=>{}))=>{a.loading.all=!0;try{const i=await S.dispatch("setting/emailTemplate/resetMailServer");y({message:"Email and Domain updated!",type:"success"}),T(e)&&e(i)}finally{a.loading.all=!1}},verify:async(e=(()=>{}))=>{a.loading.all=!0;try{const i=await S.dispatch("setting/emailTemplate/verifyMailServer");T(e)&&e(d(s({},i),{code:"unverified"===i.status?400:200})),y({message:"Reverified successfully",type:"success"})}catch{T(e)&&e({code:400})}finally{a.loading.all=!1}}};return{data:a,validate:e,methods:i}},V=()=>{const a=u(!1),e=u(void 0),i=u([{id:24,name:"Cart Recovery",subject:"[abandoned mailin] You're missing out on {:offer-total}!",desc:"A reminder for customers to complete their trade-in.",is_enable:1,type:0,link_to:null,loading:!1}]),t=u({page:1,limit:10}),l=u(!1);return{data:i,query:t,preview:a,loading:l,previewTemplate:e,handleShow:async()=>{var a,e;try{l.value=!0;const n=await S.dispatch("setting/emailTemplate/generalList",{page:t.value.page,limit:t.value.limit,type:"general"});i.value=(null==(a=null==n?void 0:n.data)?void 0:a.length)?n.data.map((a=>d(s({},a),{loading:!1}))):[],(null==(e=Object.keys(n))?void 0:e.length)&&Object.keys(n).map((a=>{"data"!==a&&(t.value[a]=n[a])}))}catch{i.value=[],t.value={page:1,limit:10}}finally{l.value=!1}},handleStatus:async a=>{try{a.loading=!0,await S.dispatch("setting/emailTemplate/update",{id:a.id,data:{is_enable:a.is_enable}})}finally{return a.loading=!1,a}},handlePreview:async i=>{try{i.loading=!0,e.value=await S.dispatch("setting/emailTemplate/previewEmailTemplateById",i.id),a.value=!0}catch{e.value=void 0,a.value=!1}finally{i.loading=!1}return i}}},C=()=>{const a=u({}),e=u(!1),{data:i,actionShow:t}=j(),l=async l=>{e.value=!0;try{(null==i?void 0:i.email_sender)||await t();const n=await S.dispatch("setting/emailTemplate/generalForm",l);a.value=d(s({},n),{email_sender:(null==i?void 0:i.email_sender)||null})}catch{a.value={}}finally{e.value=!1}};return{data:a,loading:e,handleShow:l,handleUpdate:async a=>{e.value=!0;try{await S.dispatch("setting/emailTemplate/update",a),await l(a.id),y({message:"Email template change",type:"success"})}catch{y({message:"Update email template is failed!.",type:"error"})}finally{e.value=!1}}}};export{V as a,x as b,M as c,q as d,C as e,P as u};
