var a=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,c=(e,t,l)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,s=(a,e)=>{for(var t in e||(e={}))i.call(e,t)&&c(a,t,e[t]);if(l)for(var t of l(e))n.call(e,t)&&c(a,t,e[t]);return a},o=(a,l)=>e(a,t(l));import{s as d,y as r,v as u,u as y,W as p,X as b,r as h}from"./index.161fb295.js";import{f as v,n as m,d as k}from"./date.f86face7.js";import{r as w,f,g,h as _}from"./vendor.f1efedad.js";const D=a=>{const e=g((()=>d.state.buyback[a].statuses)),t=g((()=>[r({id:0,short_name:"All"},"invoiceTab",{statusId:"all"},"id","short_name")].concat(e.value.map((a=>o(s({},r(a,"invoiceTab",{statusId:a.id},"id","short_name")),{data:a}))))));return{state:e,tab:t}},C=a=>{const e=f(!1),t=w({customer:!1,paymentMethod:!1});return{state:g((()=>d.state.buyback[a].show.data)),loading:e,modal:t,openModal:(a,e=(()=>{}))=>{t[a]=!0,u(e)&&e()},closeModal:(a,e=(()=>{}))=>{t[a]=!1,u(e)&&e()},action:async(t,l=(()=>{}))=>{e.value=!0,await d.dispatch(`buyback/${a}/show`,t),u(l)&&l(),e.value=!1}}},$=a=>{const e=g((()=>d.state.buyback[a].show.salesPerson)),t=f(!1);return{state:e,loading:t,action:async(e=(()=>{}))=>{try{t.value=!0,await d.dispatch(`buyback/${a}/showSalesPerson`),u(e)&&e()}finally{t.value=!1}}}},I=a=>{const e=g((()=>d.state.buyback[a].show.items)),t=w({notes:null,imei_sn:null,device:{}}),l=w({sort_by:"",order_by:""}),i=w({all:!1,create:!1,update:{},delete:!1,bulkDelete:!1}),n=w({delete:!1,bulkDelete:!1}),c=f(null),s=()=>{c.value=null,t.device={}},o=async(e,t=(()=>{}))=>{i.all=!0,await d.dispatch(`buyback/${a}/showItems`,{buybackId:e,sort:l}),u(t)&&t(),i.all=!1};return{data:t,loading:i,modal:n,selected:c,state:e,sort:l,unsetData:s,openModal:(a,e=(()=>{}))=>{n[a]=!0,u(e)&&e()},actionAll:o,actionCreate:async(e,t,l=(()=>{}))=>{try{i.create=!0,await d.dispatch(`buyback/${a}/showItemCreate`,{id:e,data:t}),u(l),n.create=!1,s(),await o(e)}finally{i.create=!1}},actionUpdate:async(e,t,l,n=(()=>{}))=>{try{i.update[t]=!0;const c=await d.dispatch(`buyback/${a}/showItemUpdate`,{id:t,box_id:e,data:l});u(n)&&n(c),s()}finally{i.update[t]=!1}},actionDelete:async(e,t=(()=>{}))=>{try{i.delete=!0,await d.dispatch(`buyback/${a}/showItemDelete`,{box_id:e,id:c.value}),u(t)&&t(),n.delete=!1,s(),await o(e)}finally{i.delete=!1}},actionBulkDelete:async(e,t=(()=>{}))=>{try{i.bulkDelete=!0,await d.dispatch(`buyback/${a}/showItemBulkDelete`,e),u(t)&&t(),n.bulkDelete=!1,s(),await o(e.buybackId)}finally{i.bulkDelete=!1}}}},A=a=>{const e=w({selected:"InvoiceDeviceSearch",items:[{name:"Search Item",component:"InvoiceDeviceSearch"},{name:"Bulk Item",component:"InvoiceDeviceBulk"},{name:"Custom Item",component:"InvoiceDeviceCustom"}]}),t=w({page:1,limit:10,search:"",sort_by:"",order_by:""}),l=f(!1),i=g((()=>d.state.buyback[a].devices));return{tab:e,data:t,loading:l,state:i,actionAll:async(e,i=(()=>{}))=>{l.value=!0,await d.dispatch(`buyback/${a}/devices`,t),u(i)&&i(),l.value=!1}}},T=a=>{const e=w({all:!1,update:!1});return{state:g((()=>d.state.buyback[a].show.paymentMethods)),loading:e,actionAll:async(t,l={},i=(()=>{}))=>{try{e.all=!0;const n={id:t,params:l};await d.dispatch(`buyback/${a}/showPaymentMethods`,n),u(i)&&i()}finally{e.all=!1}},actionUpdate:async(t,l,i=(()=>{}))=>{try{e.update=!0,await d.dispatch(`buyback/${a}/showPaymentMethodUpdate`,{id:t,data:l}),u(i)&&i()}finally{e.update=!1}}}},P=()=>{const a=w({paperCheck:!1,paperCheckInvoice:!1,pdf:!1,csv:!1});return{loading:a,actionPaperCheck:async(e,t=(()=>{}))=>{try{a.paperCheck=!0;const l=await d.dispatch("buyback/printPaperCheck",e);p(l),u(t)&&t()}finally{a.paperCheck=!1}},actionPaperCheckInvoice:async(e,t,l=(()=>{}))=>{try{a.paperCheckInvoice=!0;const e=await d.dispatch("buyback/invoice/showRecordPrintCheck",t);p(e),u(l)&&l()}finally{a.paperCheckInvoice=!1}},actionPdf:async(e,t=(()=>{}))=>{try{a.pdf=!0;const l=await d.dispatch("buyback/invoice/showPrintPdf",e);p(l),u(t)&&t()}finally{a.pdf=!1}},actionCsv:async(e,t=(()=>{}))=>{try{a.csv=!0;const l=await d.dispatch("buyback/invoice/showPrintCsv",e);b(l,`invoice-csv-${e}`,"text/csv"),u(t)&&t()}finally{a.csv=!1}}}},O=a=>{const e=w({customer_id:null,customer_email:null,customer_firstname:null,customer_lastname:null}),t=w({due_date:new Date,invoice_date:new Date,reference:null,payment_term_id:null}),l=f([]),i=f(!1);return{dataCustomer:e,dataInvoice:t,dataDevice:l,loading:i,action:async(n=(()=>{}))=>{try{i.value=!0;const c=await d.dispatch(`buyback/${a}/create`,o(s(s({},e),t),{ids:JSON.stringify(l.value.map((a=>a.id))),due_date:v(t.due_date),invoice_date:v(t.invoice_date)}));u(n)&&n(c)}finally{i.value=!1}}}},M=a=>{const{dateByTimezone:e}=y();return{data:w({due_date:new Date,invoice_date:new Date,reference:null,payment_term_id:null}),filterDateOptions:w({disabledDate:a=>a.getTime()>e.value.getTime(),shortcuts:[{text:"Yesterday",value:new Date(e.value.getTime()-m(e.value).yesterday)},{text:"A Week Ago",value:new Date(e.value.getTime()-m(e.value).weekAgo)},{text:"A Month Ago",value:new Date(e.value.getTime()-m(e.value).monthAgo)}]})}},x=a=>{const{me:e,dateByTimezone:t}=y(),l=w({page:1,limit:10,search:"",from:null,to:null,sort_by:"",order_by:"",sales_person:[],date:null}),i=g((()=>{var a,t;return[{id:"date",name:"Date",value:l.date?`${_(l.date[0]).format((null==(a=e.value)?void 0:a.date_format)||"")} - ${_(l.date[1]).format((null==(t=e.value)?void 0:t.date_format)||"")}`:null,default:null},{id:"sales_person",name:"Sales Person",value:l.sales_person.length>0?l.sales_person.map((a=>a.sales_person)).join(", "):null,default:[]}]})),n=g((()=>i.value.filter((a=>a.value)).length>0)),c=f(null),o=w({disabledDate:a=>a.getTime()>t.value.getTime(),shortcuts:[{text:"Today",value:[t.value,t.value]},{text:"Yesterday",value:[new Date(t.value.getTime()-m(t.value).yesterday),t.value]},{text:"Last 7 Days",value:[new Date(t.value.getTime()-m(t.value).weekAgo),t.value]},{text:"Last 30 Days",value:[new Date(t.value.getTime()-m(t.value).monthAgo),t.value]},{text:"This Month",value:[...k()]},{text:"Last Month",value:[...k(-1)]}]});let r=!1;const p=w({all:!1,delete:!1}),b=w({delete:!1}),h=f(null),D=g((()=>d.state.buyback[a].all)),C=()=>{h.value=null},$=async(e,t=(()=>{}))=>{p.all=!0;const i=Object.assign({},l);i.from=i.date&&v(i.date[0])||null,i.to=i.date&&v(i.date[1])||null,i.sales_person=i.sales_person.map((a=>a.id)),delete i.date,await d.dispatch(`buyback/${a}/all`,s({status_id:e},i)),u(t)&&t(),p.all=!1};return{data:l,state:D,loading:p,modal:b,selected:h,filterDateRef:c,filterDateOptions:o,filterList:i,isFiltered:n,clearFilter:a=>{if(!l.hasOwnProperty(a.id))return!1;l[a.id]=a.default},clearAllFilter:()=>{for(let a of i.value)l[a.id]=a.default},filterDateFocus:()=>{r?r=!1:(r=!0,c.value.focus())},unsetData:C,openModal:(a,e=(()=>{}))=>{b[a]=!0,u(e)&&e()},actionAll:$,actionDelete:async(e,t=(()=>{}))=>{try{p.delete=!0,await d.dispatch(`buyback/${a}/delete`,h.value),u(t)&&t(),b.delete=!1,C(),await $(e)}finally{p.delete=!1}},actionShippingTrackingUpdate:async(e,t=(()=>{}))=>{try{p.update_shipping_tracking=!0;await d.dispatch(`buyback/${a}/updateShippingTracking`,e);return u(t)&&t(),p.update_shipping_tracking=!1,!0}catch(l){return p.update_shipping_tracking=!1,!1}},actionShippingTrackingDelete:async(e,t=(()=>{}))=>{try{p.delete_shipping_tracking=!0;await d.dispatch(`buyback/${a}/deleteShippingTracking`,e);return u(t)&&t(),p.delete_shipping_tracking=!1,!0}catch(l){return p.delete_shipping_tracking=!1,!1}}}},j=a=>{const e=w({amount:0,note:null,payment_method:null}),t=w({create:!1}),l=w({all:!1,create:!1}),i=()=>{e.amount=0,e.note=null,e.payment_method=null},n=async(e,t=(()=>{}))=>{l.all=!0,await d.dispatch(`buyback/${a}/showRecords`,e),u(t)&&t(),l.all=!1},c=g((()=>d.state.buyback[a].show.records));return{data:e,state:c,loading:l,modal:t,openModal:(a,e=(()=>{}))=>{t[a]=!0,u(e)&&e()},unsetData:i,actionAll:n,actionCreate:async(c,s=(()=>{}))=>{try{l.create=!0,await d.dispatch(`buyback/${a}/showRecordCreate`,{id:c,data:e}),u(s)&&s(),t.create=!1,i(),await n(c)}finally{l.create=!1}}}},S=a=>{const e=w({search:null}),t=w({create:!1,record:!1}),l=w({all:!1,create:!1,record:!1}),i=f(null),n=async(e,t=(()=>{}))=>{l.all=!0,await d.dispatch(`buyback/${a}/showReturns`,e),u(t)&&t(),l.all=!1},c=g((()=>d.state.buyback[a].show.returns)),s=g((()=>d.state.buyback[a].show.available.items));return{data:e,state:c,selected:i,getAvailable:s,loading:l,modal:t,openModal:(a,e=(()=>{}))=>{t[a]=!0,u(e)&&e()},actionAll:n,actionAvailable:async(t,i=(()=>{}))=>{l.available=!0,await d.dispatch(`buyback/${a}/showReturnAvailable`,{id:t,data:e}),u(i)&&i(),l.available=!1},actionCreate:async(e,i,n=(()=>{}))=>{try{l.create=!0,await d.dispatch(`buyback/${a}/showReturnCreate`,{id:e,data:i}),u(n)&&n(),t.create=!1}finally{l.create=!1}},actionRecord:async(e,c,s=(()=>{}))=>{try{l.record=!0,await d.dispatch(`buyback/${a}/showReturnRecord`,{id:i.value,data:c}),u(s)&&s(),t.record=!1,i.value=null,await n(e)}finally{l.record=!1}}}},U=a=>{const e=w({update:!1,customer:!1}),t=w({update:!1,customer:!1});return{loading:e,modal:t,openModal:(a,e=(()=>{}))=>{t[a]=!0,u(e)&&e()},closeModal:(a,e=(()=>{}))=>{t[a]=!1,u(e)&&e()},actionUpdate:async(l,i,n=(()=>{}))=>{try{e.update=!0,await d.dispatch(`buyback/${a}/showDetailUpdate`,{id:l,data:i}),u(n)&&n(),t.update=!1}finally{e.update=!1}},actionUpdateV2:async(a,t=(()=>{}))=>{try{e.customer=!0,await d.dispatch("buyback/invoice/showDetailUpdateV2",{data:a}),u(t)&&t()}finally{e.customer=!1}}}},R=()=>{const a=g((()=>h(d.state.buyback.invoice.show.conditions))),e=g((()=>d.state.buyback.invoice.show.itemConditionOptions||{})),t=w({all:!1,create:!1,update:{},bulk:!1}),l=w({update:!1});return{state:a,stateItemConditionOptions:e,loading:t,modal:l,openModal:(a,e=(()=>{}))=>{if(Object.keys(l).includes(a))return console.warn(`Invalid modal key ${a}`);l[a]=!0,u(e)&&e()},getConditions:async a=>{try{return t.get=!0,await d.dispatch("buyback/invoice/getConditions",a)}catch(e){u(callback)&&callback(e)}finally{t.get=!1}},actionAll:async(a=(()=>{}))=>{try{t.all=!0,await d.dispatch("buyback/invoice/showConditions"),u(a)&&a()}finally{t.all=!1}},actionUpdate:async(a,e,l=(()=>{}))=>{const i={id:a,data:e};try{t.update[e.id]=!0,await d.dispatch("buyback/invoice/updateCondition",i),u(l)&&l()}finally{t.update[e.id]=!1}},actionBulkUpdate:async(a,e,l=(()=>{}))=>{const i={id:a,data:e};try{t.bulk=!0,await d.dispatch("buyback/invoice/updateBulkCondition",i),u(l)&&l()}finally{t.bulk=!1}},actionCreate:async(a,e=(()=>{}))=>{try{t.create=!0,await d.dispatch("buyback/invoice/createCondition",a),u(e)&&e()}finally{t.create=!1}},actionDelete:async(a,e=(()=>{}))=>{try{t.delete=!0,await d.dispatch("buyback/invoice/deleteCondition",a),u(e)&&e()}finally{t.delete=!1}}}},B=()=>{const a=f(!1);return{state:g((()=>d.state.buyback.invoice.show.changelog)),loading:a,action:async(e,t=(()=>{}))=>{try{a.value=!0,await d.dispatch("buyback/invoice/showChangelog",e),u(t)&&t()}finally{a.value=!1}}}},F=()=>{const a=f(!1),e=f(!1),t=f(void 0);return{loading:a,modal:e,timer:t,send:async(e,t=(()=>{}))=>{a.value=!0;try{await d.dispatch("buyback/invoice/sendEmailVoice",e),u(t)&&t()}finally{a.value=!1}}}};export{M as a,A as b,F as c,P as d,S as e,I as f,j as g,T as h,B as i,x as j,D as k,$ as l,C as m,R as n,U as o,O as u};
