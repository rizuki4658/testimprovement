var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,s=(e,s)=>{for(var r in s||(s={}))t.call(s,r)&&i(e,r,s[r]);if(a)for(var r of a(s))l.call(s,r)&&i(e,r,s[r]);return e};import{s as r,g as n,v as o,d,b as f,_ as c,O as p}from"./index.6438e939.js";import{r as m,g as u,f as v,y,k as h,m as g,o as w,n as b,w as O,B as _,D as M,t as T,a1 as S,U as R,K as j,S as C}from"./vendor.9695fe57.js";import{C as x}from"./CollapsibleCard.d8bab457.js";import{_ as I}from"./IframeRender.46e71567.js";const k=()=>{const e=m({loading:{all:!1,show:!1,show_theme:!1,updateStatus:[],update:!1,update_theme:!1,location:!1,subscription:!1,storeSubscription:!1,preview_email:!1,reset_template:!1}}),a=u((()=>{if(r.state.dashboard.locationFiltered){const e=1==r.state.dashboard.locationFiltered.is_mailin_available,a=r.state.dashboard.locationFiltered.total_instore;return e&&0===a?"mail-in":!e&&a>0?"in-store":"both"}})),t=u((()=>{var e;return 1==(null==(e=r.state.user.me)?void 0:e.is_location_mail_in)})),l=u((()=>({all:r.state.setting.revisedOffer.all,show:r.state.setting.revisedOffer.show}))),i=u((()=>"local"==a.value?[{name:"mail-in"===a.value?"Mail-In":"In-Store",value:"local"===a.value?"mail-in":"in-store"}]:"mail-in"==a.value?[{name:"Mail-In",value:"mail-in"},{name:"Easy Offer",value:"easy-offer"}]:"both"==a.value?[{name:"Mail-In",value:"mail-in"},{name:"In-Store",value:"in-store"},{name:"Easy Offer",value:"easy-offer"}]:[])),d=m({email_template:{id:null,body:null},all:{page:1,limit:10,type:t.value||"both"===a.value?"mail-in":"in-store"},type:null}),f=m({reset_template:!1}),c=v(!1),p=v(""),h=async(a=(()=>{}))=>{try{e.loading.all=!0;const t=await r.dispatch("setting/revisedOffer/all",d.all);o(a)&&a(t)}finally{e.loading.all=!1}},g=async(a,t=(()=>{}))=>{try{e.loading.show=!0;const l={id:a.id},i=await r.dispatch("setting/revisedOffer/show",l);Object.assign(d.email_template,s({},i)),o(t)&&t(i)}finally{e.loading.show=!1}};return y((()=>s({},d.all)),n((async()=>{await h()}),400)),{state:l,data:d,loading:e.loading,modal:f,location:a,isPreviewRevisedOffer:c,previewedRevisedOffer:p,openModal:e=>{Object.keys(f).includes(e)&&(f[e]=!0)},closeModal:e=>{Object.keys(f).includes(e)&&(f[e]=!1)},actionAll:h,actionUpdate:async(a,t=(()=>{}))=>{try{e.loading.update=!0;const l=Object.assign({},{id:a.id,data:d.email_template}),i=await r.dispatch("setting/revisedOffer/update",l);o(t)&&t(i)}finally{e.loading.update=!1}},actionShow:g,actionPreviewRevisedOffer:async(a,t=(()=>{}))=>{let l="";try{e.loading.preview_email=!0,c.value=!1,l=a?await r.dispatch("setting/revisedOffer/previewRevisedOfferById",a):await r.dispatch("setting/revisedOffer/previewRevisedOffer",{body:d.email_template.body||""}),c.value=!0,p.value=l,o(t)&&t(l)}finally{e.loading.preview_email=!1}},actionResetTemplate:async(a=(()=>{}))=>{var t;const l=null==(t=d.email_template)?void 0:t.id;if(l)try{e.loading.reset_template=!0,await r.dispatch("setting/revisedOffer/resetRevisedOffer",l),o(a)&&a(),await g({id:l})}finally{e.loading.reset_template=!1}},isMailIn:t,revisedOfferTypes:i}};const P=h({name:"PreviewEmailTemplate",components:{Modal:d,Button:f,CollapsibleCard:x,IframeRender:I},props:{show:{type:Boolean,default:!1},type:{type:String,default:""},body:{type:String,default:""},renderType:{type:String,default:"iframe"},title:{type:String,default:"Preview Text"}},emits:["update:show"],setup(e,{emit:a}){const t=v(".html-template {  font-family: Arial, Helvetica, sans-serif; all: revert; }"),l=u({get:()=>e.show,set(e){a("update:show",e)}}),i=u((()=>p(e.body))),s=u((()=>p(e.renderType)));return{styles:t,isShow:l,renderType:s,sanitizedBody:i,handleClose:()=>{l.value=!1}}}}),B={class:"border border-grey-01 rounded-lg mb-6"},E={class:"mb-4"},H={class:"border border-grey-01 rounded-lg p-6"},D=["innerHTML"],L=["innerHTML"],z={class:"text-left"};var A=c(P,[["render",function(e,a,t,l,i,s){const r=g("CollapsibleCard"),n=g("IframeRender"),o=g("Modal");return w(),b(o,{modelValue:e.isShow,"onUpdate:modelValue":a[1]||(a[1]=a=>e.isShow=a),title:e.title},{default:O((()=>[_("div",B,[M(r,null,{title:O((()=>a[2]||(a[2]=[_("p",{class:"font-semibold"},"Where can i found this texts?",-1)]))),default:O((()=>{var t,l,i,s;return[(null==(t=e.type)?void 0:t.includes("Accepted"))?(w(),T(S,{key:0},[a[3]||(a[3]=_("p",{class:"mb-4"}," This text is showed on customer portal when customer accept the new offer. ",-1)),a[4]||(a[4]=_("img",{src:"/images/revised-offer/message-accept.webp",alt:"Declined Offer Message "},null,-1))],64)):R("",!0),(null==(l=e.type)?void 0:l.includes("Declined"))?(w(),T(S,{key:1},[_("p",E," This text is showed on the customer portal when the customer declines the "+j(e.type.includes("Easy Offer")?"pending":"revised")+" offer. ",1),a[5]||(a[5]=_("img",{src:"/images/revised-offer/message-decline.webp",alt:"Declined Offer Message "},null,-1))],64)):R("",!0),(null==(i=e.type)?void 0:i.includes("Revised"))||(null==(s=e.type)?void 0:s.includes("Pending"))?(w(),T(S,{key:2},[a[6]||(a[6]=_("p",{class:"mb-4"}," This text is showed on the customer portal when the item doesn't match the original offer. ",-1)),a[7]||(a[7]=_("img",{src:"/images/revised-offer/message-revised.webp",alt:"Revised Offer Message"},null,-1))],64)):R("",!0)]})),_:1})]),_("div",H,["iframe"===e.renderType?(w(),b(n,{key:0,css:e.styles,style:{width:"100%",height:"600px"}},{default:O((()=>[_("div",{class:"html-template",innerHTML:e.sanitizedBody},null,8,D)])),_:1},8,["css"])):(w(),T("div",{key:1,innerHTML:e.sanitizedBody,class:"ck-content"},null,8,L))])])),footer:O((()=>[_("div",z,[_("a",{href:"#!",onClick:a[0]||(a[0]=C(((...a)=>e.handleClose&&e.handleClose(...a)),["prevent"])),class:"text-red-04 hover:text-red-02"},"Cancel")])])),_:1},8,["modelValue","title"])}]]);export{A as R,k as u};
