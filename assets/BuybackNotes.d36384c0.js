import{m as e,o as t,t as o,D as l,w as a,ap as s,U as d,B as i,K as n,n as r,a1 as u,a2 as m,f as c,I as v,y as f,a4 as N,a5 as p,aq as y,$ as g,A as b}from"./vendor.9695fe57.js";import{u as _}from"./notes.a0b54fb4.js";import{C as k}from"./card.f57f7ca5.js";import{f as x,b as w,d as C,O as h}from"./index.c2f66179.js";import{u as L}from"./index.f40e4a9e.js";import{r as V}from"./index.6b6f6369.js";import{_ as $}from"./tab.c78d43fc.js";const j={key:0},T={key:1},B={class:"space-y-4"},U={__name:"BuybackNotesForm",setup(c,{expose:v}){const f=_(),N=L({note:{required:V}},f.formNotes,{$lazy:!0});return v({validation:N,onSubmit:async()=>(await N.value.$validate(),!N.value.$invalid),onReset:()=>{N.value.$reset()}}),(c,v)=>{const p=e("Tooltip");return t(),o("div",null,[l($,{modelValue:s(f).formNotes.type,"onUpdate:modelValue":v[0]||(v[0]=e=>s(f).formNotes.type=e),items:s(f).formNotes.tabs,color:"teal",view:"smooth",component:"",disabledItems:""},{title:a((({item:e})=>[l(p,{placement:"top",disabled:!e.disabled},{content:a((()=>["preview"===s(f).formNotes.mode?(t(),o("p",j,"This Tab is disabled because you are in preview mode.")):d("",!0),"edit"===s(f).formNotes.mode?(t(),o("p",T,"This Tab is disabled because you are in edit mode.")):d("",!0)])),default:a((()=>[i("p",null,n(e.name),1)])),_:2},1032,["disabled"])])),_:1},8,["modelValue","items"]),i("div",B,[i("div",null,["preview"===s(f).formNotes.mode?(t(),r(x,{key:0,modelValue:s(f).formNotes.note,"onUpdate:modelValue":v[1]||(v[1]=e=>s(f).formNotes.note=e),type:"textarea",label:"Notes",rows:"6",class:"w-full",readonly:"",view:s(N).note.$invalid?"danger":"default"},null,8,["modelValue","view"])):(t(),r(x,{key:1,modelValue:s(f).formNotes.note,"onUpdate:modelValue":v[2]||(v[2]=e=>s(f).formNotes.note=e),type:"textarea",label:"Notes",rows:"6",class:"w-full",view:s(N).note.$invalid?"danger":"default"},null,8,["modelValue","view"])),(t(!0),o(u,null,m(s(N).note.$errors,((e,l)=>(t(),o("span",{key:l,class:"text-red-base"},n(e.$message)+". ",1)))),128))])])])}}},A={__name:"BuybackNotesAdd",setup(e){const d=_(),n=c(),r=()=>{d.addNotes.modal=!0,d.addNotes.isLoading=!1,d.resetForm(),d.formNotes.type="internal",d.formNotes.mode="add"},m=()=>{d.addNotes.modal=!1,d.addNotes.isLoading=!1,d.resetForm()},f=async()=>{await n.value.onSubmit()&&(await d.$addNotes(),n.value.onReset(),m())};return(e,c)=>(t(),o(u,null,[l(w,{color:"teal",dense:"",onClick:r},{default:a((()=>c[1]||(c[1]=[i("span",{class:"material-icons text-lg"},"add",-1),v(" Add Notes ")]))),_:1}),l(C,{modelValue:s(d).addNotes.modal,"onUpdate:modelValue":c[0]||(c[0]=e=>s(d).addNotes.modal=e),"no-close":s(d).addNotes.isLoading,onClose:m},{header:a((()=>c[2]||(c[2]=[i("h6",{class:"font-medium"},"Create Note",-1)]))),default:a((()=>[l(U,{ref_key:"formAdd",ref:n},null,512)])),footer:a((()=>[l(w,{color:"teal",loading:s(d).addNotes.isLoading,onClick:f},{default:a((()=>c[3]||(c[3]=[v(" Save Note ")]))),_:1},8,["loading"])])),_:1},8,["modelValue","no-close"])],64))}},D={__name:"BuybackNotesDelete",setup(e){const o=_(),d=c({}),n=()=>{d.value={},o.deleteNotes.item=void 0,o.deleteNotes.modal=!1,o.deleteNotes.isLoading=!1,o.resetForm()},u=async()=>{await o.$deleteNotes(),o.deleteNotes.modal=!1};return f((()=>o.deleteNotes.modal),(e=>{var t;e?(d.value=(null==(t=o.deleteNotes)?void 0:t.item)||{},(()=>{var e,t,l;o.formNotes.mode="delete",o.formNotes.type=null==(e=d.value)?void 0:e.type,o.formNotes.note=null==(t=d.value)?void 0:t.note,o.formNotes.id=null==(l=d.value)?void 0:l.id})()):n()})),(e,d)=>(t(),r(N,{to:"body"},[l(C,{modelValue:s(o).deleteNotes.modal,"onUpdate:modelValue":d[0]||(d[0]=e=>s(o).deleteNotes.modal=e),title:"Delete Note",size:"xs",onClose:n},{footer:a((()=>[l(w,{color:"teal",loading:s(o).deleteNotes.isLoading,onClick:u},{default:a((()=>d[1]||(d[1]=[v(" Delete Note ")]))),_:1},8,["loading"])])),default:a((()=>[d[2]||(d[2]=i("p",null,"Are you sure want to delete this note?",-1))])),_:1},8,["modelValue"])]))}},F={class:"font-medium"},I={class:"mb-10"},R={class:"-mb-6 -mx-12 px-12 py-6 border-t border-grey-01 flex justify-end"},H={__name:"BuybackNotesEdit",setup(o){const d=_(),u=c(),m=c(""),p=c({}),y=()=>{const e=d.formNotes.tabs.findIndex((e=>{var t;return e.component!==(null==(t=p.value)?void 0:t.type)}));d.formNotes.tabs[e].disabled=!0},g=()=>{m.value="",p.value={},d.editNotes.item=void 0,d.editNotes.modal=!1,d.editNotes.isLoading=!1,d.resetForm()},b=async()=>{var e;await u.value.onSubmit()&&(await d.$editNotes(),null==(e=u.value)||e.onReset(),d.editNotes.modal=!1)};return f((()=>d.editNotes.modal),(e=>{var t,o,l;e?(p.value=(null==(t=d.editNotes)?void 0:t.item)||{},(null==(l=null==(o=d.editNotes)?void 0:o.item)?void 0:l.is_granted)?(()=>{var e,t,o;m.value="Edit Note",d.formNotes.mode="edit",d.formNotes.id=null==(e=p.value)?void 0:e.id,d.formNotes.type=null==(t=p.value)?void 0:t.type,d.formNotes.note=null==(o=p.value)?void 0:o.note,y()})():(()=>{var e,t;m.value="Preview Note",d.formNotes.mode="preview",d.formNotes.type=null==(e=p.value)?void 0:e.type,d.formNotes.note=null==(t=p.value)?void 0:t.note,y()})()):g()})),(o,c)=>{const f=e("Tooltip");return t(),r(N,{to:"body"},[l(C,{modelValue:s(d).editNotes.modal,"onUpdate:modelValue":c[0]||(c[0]=e=>s(d).editNotes.modal=e),"no-close":s(d).editNotes.isLoading,"hide-footer":"",onClose:g},{header:a((()=>[i("h6",F,n(m.value),1)])),default:a((()=>{var e,t;return[i("div",I,[l(U,{ref_key:"formEdit",ref:u},null,512)]),i("div",R,[l(f,{placement:"top-end",disabled:null==(t=null==(e=s(d).editNotes)?void 0:e.item)?void 0:t.is_granted},{content:a((()=>c[1]||(c[1]=[i("p",null,"You cannot edit or delete offer notes created by other users.",-1)]))),default:a((()=>{var e,t;return[i("div",null,[l(w,{color:"teal",loading:s(d).editNotes.isLoading,disabled:!(null==(t=null==(e=s(d).editNotes)?void 0:e.item)?void 0:t.is_granted),onClick:b},{default:a((()=>c[2]||(c[2]=[v(" Update Note ")]))),_:1},8,["loading","disabled"])])]})),_:1},8,["disabled"])])]})),_:1},8,["modelValue","no-close"])])}}},M={class:"space-y-3"},S={class:"notes space-y-4"},E={class:"flex items-center flex-wrap flex-row justify-between gap-2"},Y={class:"small font-medium"},q={class:"flex items-center gap-x-2"},z=["innerHTML"],K={key:1,class:"flex items-center justify-center p-12 bg-grey-lighten rounded-md"},O={__name:"BuybackNotesInternal",setup(d){const c=_(),v=e=>{c.editNotes.item=e,c.editNotes.modal=!0,c.editNotes.isLoading=!1};return(d,f)=>{var N,p;const y=e("Tooltip");return t(),o("div",M,[f[5]||(f[5]=i("p",null,"Internal Notes",-1)),(null==(p=null==(N=s(c).getNotes)?void 0:N.internal)?void 0:p.length)?(t(),o(u,{key:0},[(t(!0),o(u,null,m(s(c).getNotes.internal,((e,d)=>(t(),o("div",{key:d},[i("div",S,[i("div",E,[i("p",Y,"By "+n(e.admin.name)+" - "+n(e.created_at),1),i("div",q,[(null==e?void 0:e.is_granted)?(t(),r(w,{key:0,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>f[0]||(f[0]=[i("span",{class:"material-icons text-lg"},"edit",-1)]))),_:2},1032,["onClick"])):(t(),r(w,{key:1,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>f[1]||(f[1]=[i("span",{class:"material-icons text-lg"},"visibility",-1)]))),_:2},1032,["onClick"])),l(y,{placement:"top",disabled:null==e?void 0:e.is_granted},{content:a((()=>f[2]||(f[2]=[i("p",{class:"max-w-xs"},"You cannot edit or delete offer notes created by other users.",-1)]))),default:a((()=>[i("div",null,[l(w,{color:"red",disabled:!(null==e?void 0:e.is_granted),dense:"",onClick:t=>(e=>{c.deleteNotes.item=e,c.deleteNotes.modal=!0,c.deleteNotes.isLoading=!1})(e)},{default:a((()=>f[3]||(f[3]=[i("span",{class:"material-icons text-lg"},"delete",-1)]))),_:2},1032,["disabled","onClick"])])])),_:2},1032,["disabled"])])]),i("div",{class:"block",innerHTML:s(h)(e.note)},null,8,z)])])))),128)),l(H),l(D)],64)):(t(),o("div",K,f[4]||(f[4]=[i("span",null,"Nothing to see here",-1)])))])}}},P={class:"space-y-3"},G={class:"notes space-y-4"},J={class:"flex items-center flex-wrap flex-row justify-between gap-2"},Q={class:"small font-medium"},W={class:"flex items-center gap-x-2"},X=["innerHTML"],Z={key:1,class:"flex items-center justify-center p-12 bg-grey-lighten rounded-md"},ee={__name:"BuybackNotesCustomer",setup(d){const c=_(),v=e=>{c.editNotes.item=e,c.editNotes.modal=!0,c.editNotes.isLoading=!1};return(d,f)=>{var N,p;const y=e("Tooltip");return t(),o("div",P,[f[5]||(f[5]=i("p",null,"Customer Notes",-1)),(null==(p=null==(N=s(c).getNotes)?void 0:N.customer)?void 0:p.length)?(t(),o(u,{key:0},[(t(!0),o(u,null,m(s(c).getNotes.customer,((e,d)=>(t(),o("div",{key:d},[i("div",G,[i("div",J,[i("p",Q,"By "+n(e.admin.name)+" - "+n(e.created_at),1),i("div",W,[(null==e?void 0:e.is_granted)?(t(),r(w,{key:0,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>f[0]||(f[0]=[i("span",{class:"material-icons text-lg"},"edit",-1)]))),_:2},1032,["onClick"])):(t(),r(w,{key:1,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>f[1]||(f[1]=[i("span",{class:"material-icons text-lg"},"visibility",-1)]))),_:2},1032,["onClick"])),l(y,{placement:"top",disabled:null==e?void 0:e.is_granted},{content:a((()=>f[2]||(f[2]=[i("p",{class:"max-w-xs"},"You cannot edit or delete offer notes created by other users.",-1)]))),default:a((()=>[i("div",null,[l(w,{color:"red",disabled:!(null==e?void 0:e.is_granted),dense:"",onClick:t=>(e=>{c.deleteNotes.item=e,c.deleteNotes.modal=!0,c.deleteNotes.isLoading=!1})(e)},{default:a((()=>f[3]||(f[3]=[i("span",{class:"material-icons text-lg"},"delete",-1)]))),_:2},1032,["disabled","onClick"])])])),_:2},1032,["disabled"])])]),i("div",{class:"block",innerHTML:s(h)(e.note)},null,8,X)])])))),128)),l(H),l(D)],64)):(t(),o("div",Z,f[4]||(f[4]=[i("span",null,"Nothing to see here",-1)])))])}}},te={class:"flex items-center justify-between gap-4"},oe={class:"grid md:grid-cols-2 gap-4"},le={__name:"BuybackNotes",props:{isReadonly:!1,isDeleted:!1},async setup(e){let d,n;const u=p(),m=_();return m.$setRoute(u.params),[d,n]=y((()=>m.$getNotes())),await d,n(),(e,d)=>{const n=g("loading");return t(),r(k,null,{header:a((()=>[i("div",te,[d[0]||(d[0]=i("h6",{class:"font-medium"},"Notes",-1)),l(A)])])),default:a((()=>[b((t(),o("div",oe,[l(O),l(ee)])),[[n,s(m).getNotes.isLoading]])])),_:1})}}};export{le as default};
