var e=Object.defineProperty,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,t=(a,n,r)=>n in a?e(a,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[n]=r;import{a5 as i,f as o,r as c,g as s}from"./vendor.f1efedad.js";import{G as l,H as u,s as d,v as y}from"./index.e231b017.js";import{r as p,e as _}from"./index.2fb3814c.js";import{c as m}from"./index.1c09f422.js";const g=l(),v=(e,a={})=>{const{excludedKeys:n}=a;return Object.entries(e).filter((([e,a])=>{var r;return!(null==(r=null==n?void 0:n.includes)?void 0:r.call(n,e))&&(""===a||null==a||!1===a)})).length>0},b=()=>{const e=i(),a=o(!1),n=o(!1),r=o(!1),t=c({name:"",email:"",password:"",package_id:17}),l=c({name:{required:p},email:{required:p,email:_},password:{required:p,passwordValidation:m.withMessage("At least 6 characters and include capital letters",m.regex(/^(?=.*?[A-Z]).{6,}$/))}}),u=s((()=>v(t))),g=s((()=>!!e.query.token));return{loading:a,isShowPassword:r,isRegisteredReady:n,data:t,validationRules:l,isIncompleteForm:u,isVerifyEmail:g,action:async(e=(()=>{}))=>{try{a.value=!0;const n=await d.dispatch("onboarding/register",t);y(e)&&e(n)}finally{a.value=!1}}}},w=()=>{const e=i(),t=c({code:"",code_encrypted:"",company_token:"",is_validate_email_sender:!1}),l=o(!1),u=s((()=>{var e;return(null==(e=t.code)?void 0:e.length)<6})),p=s((()=>{const a=e.query.token;if(!a)return{code_encrypted:null,email:null,company_token:null};try{return JSON.parse(window.atob(a))}catch(n){return console.warn(`Error while decoding token: ${n.message}`),{code_encrypted:null,email:null}}}));return{data:t,loading:l,isIncomplete:u,decodedTokenPayload:p,action:async(e=(()=>{}))=>{try{l.value=!0;const i=t,{company_token:o}=i,c=((e,t)=>{var i={};for(var o in e)n.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&a)for(var o of a(e))t.indexOf(o)<0&&r.call(e,o)&&(i[o]=e[o]);return i})(i,["company_token"]),s=await d.dispatch("onboarding/verifyEmail",{data:c,params:{company_token:o}});g.remove("company-referrer",{path:"/onboarding"}),y(e)&&e(null,s)}catch(i){y(e)&&e(i,null)}finally{l.value=!1}}}},f=()=>{const{actionCurrencies:e,actionCountries:a,countries:n,currencies:r}=u(),t=c({name:null,legal_business_name:null,country_code:null,country_name:null,currency:null,currency_symbol:null,address:null,city:null,zip:null,state:null,suite:null,address_text:null,lat:null,lon:null,valid:!1,location_type:null}),i=o(!1),l=c({legal_business_name:{required:m.withMessage("Legal business name is required",p)},name:{required:m.withMessage("Doing business as (DBA) is required",p)},country_code:{required:m.withMessage("Business country is required",p)},currency:{required:m.withMessage("Business currency is required",p)},address_text:{required:m.withMessage("Business address is required",p)},city:{required:m.withMessage("City is required",p)},zip:{required:m.withMessage("is required",p)}}),_=s((()=>v(t,{excludedKeys:["lat","lon","suite","address","city","zip","state"]}))),g=s((()=>null!==t.location_type));return{data:t,loading:i,validationRules:l,actionCurrencies:e,actionCountries:a,countries:n,currencies:r,isIncompleteForm:_,isShowForm:g,action:async(e=(()=>{}),a=!1)=>{try{i.value=!0,a?await d.dispatch("onboarding/registerUpdateByToken",t):await d.dispatch("onboarding/registerUpdate",t),y(e)&&e()}finally{i.value=!1}},actionSetCurrency:async e=>{await d.dispatch("onboarding/setCurrency",e)}}},h=()=>{const e=s((()=>d.state.onboarding.syncable_devices)),a=o(!1),n=c({page:1});return{state:e,loading:a,filters:n,actionGetDevices:async(e=(()=>{}))=>{try{a.value=!0,await d.dispatch("onboarding/getSyncableDevices",n),y(e)&&e()}finally{a.value=!1}}}},S=()=>{const e=c({category_id:null,is_mac:0}),a=s((()=>d.state.onboarding.pricing_source_companies)),n=o(!1);return{data:e,state:a,loading:n,actionGetCompanies:async(a=(()=>{}))=>{try{n.value=!0,await d.dispatch("onboarding/getPricingSourceCompanies",e),y(a)&&a()}finally{n.value=!1}},unsetPricingSourceCompanies:()=>{Object.assign(e,{category_id:null,is_mac:0}),d.commit("onboarding/UNSET_PRICING_SOURCE_COMPANIES")}}},P=()=>{const e=s((()=>d.state.onboarding.price_sync.arr_devices)),i=s((()=>d.state.onboarding.company_pricing_source)),l=s((()=>{var e;return d.state.onboarding.currency_symbol||(null==(e=d.state.user.me)?void 0:e.currency_symbol)||""})),u=s((()=>{var e;return d.state.onboarding.currency||(null==(e=d.state.user.me)?void 0:e.currency)||""})),p=s((()=>{const e=u.value&&u.value.split("")||"USD".split("");return e.pop(),e.join("").toLowerCase()})),_=s((()=>d.state.onboarding.price_sync_preview.available_devices)),m=s((()=>d.state.onboarding.price_sync_preview.selected_device)),g=s((()=>d.state.onboarding.price_sync_preview.price_preview)),b=c({category_id:null,type:3,source:null,amount_type:1,amount_price:0,is_computer:null,name:null,image:null}),w=c({price_sync:!1,active_device:!1,eject_price_sync:!1,available_devices_sync_preview:!1,device_sync_preview:!1}),f=o(!1),h=s((()=>{const e=["image"],a=3==b.type,n="available"===i.value.status,r=1==w.active_device;return a&&n&&(e.push("amount_type"),e.push("amount_price")),v(b,{excludedKeys:e})||r})),S=s((()=>e.value.length<1));return{state:e,stateCompanySource:i,stateCurrentCurrency:u,stateCurrentCountryCode:p,stateCurrentCurrencySymbol:l,stateAvailableDevicesPriceSyncPreview:_,stateSelectedDevicePriceSyncPreview:m,stateDevicePriceSyncPreview:g,data:b,loading:w,modal:f,isIncompletePriceSyncDevice:h,isIncompletePriceSyncs:S,priceSyncDevice:async()=>{try{await d.commit("onboarding/SET_PRICE_SYNC_DEVICE",((e,i)=>{for(var o in i||(i={}))n.call(i,o)&&t(e,o,i[o]);if(a)for(var o of a(i))r.call(i,o)&&t(e,o,i[o]);return e})({},b))}finally{}},removePriceSyncDevice:e=>{d.commit("onboarding/REMOVE_PRICE_SYNC_DEVICE",e)},unsetPriceSyncDevice:()=>{Object.assign(b,{category_id:null,type:3,source:null,amount_type:0,amount_price:0,is_computer:null,name:null,image:null}),d.commit("onboarding/UNSET_PRICE_SYNC_DEVICE"),d.commit("onboarding/UNSET_DEVICE_PRICE_SYNC_PREVIEW")},selectDevicePriceSyncPreview:(e=null)=>{e&&d.commit("onboarding/SET_SELECTED_DEVICE_PRICE_SYNC_PREVIEW",e)},actionPriceSyncs:async(e=(()=>{}))=>{try{w.price_sync=!0,await d.dispatch("onboarding/priceSyncs"),y(e)&&e()}finally{w.price_sync=!1}},actionCheckActiveDevice:async(e=(()=>{}))=>{try{w.active_device=!0;if(!(null!==b.category_id&&null!==b.is_computer&&null!==b.source))return;await d.dispatch("onboarding/activeDevice",{category_id:b.category_id,is_mac:b.is_computer,sub_domain:b.source}),y(e)&&e()}finally{w.active_device=!1}},actionEjectPriceSync:async e=>{try{w.eject_price_sync=!0,await d.dispatch("onboarding/ejectPriceSync"),y(e)&&e()}finally{w.eject_price_sync=!1}},actionAvailableDevicesPreview:async(e=(()=>{}))=>{try{w.available_devices=!0,await d.dispatch("onboarding/getAvailableDevicesPriceSyncPreview",{categories:"mac",category_id:b.category_id,is_onboarding:!0}),y(e)&&e()}finally{w.available_devices=!1}},actionDevicePriceSyncPreview:async(e=(()=>{}))=>{try{w.device_sync_preview=!0,await d.dispatch("onboarding/devicePriceSyncPreview",{product_id:m.value.id,type:b.type,source:b.source,type:b.type,amount_price:b.amount_price,amount_type:b.amount_type}),y(e)&&e()}finally{w.device_sync_preview=!1}}}},C=()=>{const e=s((()=>d.state.onboarding.payout_methods)),a=s((()=>d.state.onboarding.popular_payout_methods)),n=o(!1);return{state:e,statePopular:a,loading:n,actionShow:async(e=(()=>{}))=>{try{n.value=!0,await d.dispatch("onboarding/showPayoutMethods"),y(e)&&e()}finally{n.value=!1}}}},E=()=>{const e=s((()=>d.state.onboarding.selected_payout_methods.arr_payment_methods)),a=o(!1),n=s((()=>e.value.length<1));return{state:e,loading:a,isIncompleteForm:n,setSelectedPayoutMethods:e=>d.commit("onboarding/SET_SELECTED_PAYOUT_METHODS",e),actionUpdatePayout:async(e=(()=>{}))=>{try{a.value=!0,await d.dispatch("onboarding/updatePayoutMethods"),y(e)&&e()}finally{a.value=!1}}}},D=()=>{const e=s((()=>d.state.onboarding.current_step)),a=s((()=>{var a;return[{step:1,route:{name:"onboardingPersonalInformation",query:{}}},{step:2,route:{name:"onboardingPersonalInformation",query:{token:window.btoa(JSON.stringify({email:(null==(a=d.state.user.me)?void 0:a.email)||"",code_encrypted:e.value.code_encrypted||null}))}}},{step:3,route:{name:"onboardingPurchasingMethod",query:{},params:{verified:!0}}},{step:4,route:{name:"onboardingSyncProducts",query:{}}},{step:5,route:{name:"onboardingPayoutMethods",query:{}}},{step:6,route:{name:"onboardingDeployWidget",query:{}}}]})),n=s((()=>{var n;return(null==(n=a.value.find((a=>a.step===e.value.last_register_step)))?void 0:n.route)||a.value[0]})),r=o(!1);return{state:e,loading:r,stepRoutes:a,currentStepRoute:n,actionCurrentStep:async(e=(()=>{}))=>{try{r.value=!0,await d.dispatch("onboarding/currentStep"),y(e)&&e()}catch(a){}finally{r.value=!1}}}},R=()=>{const e=g.get("company-referrer",{path:"/onboarding"})||null;d.commit("onboarding/SET_COMPANY_REFERRER",e);const a=c({all:!1}),n=s((()=>d.state.onboarding.company_referrer)),r=s((()=>d.state.onboarding.company_referrer_detail)),t=s((()=>d.getters["onboarding/hasCompanyReferrer"]));return{loading:a,companyReferrer:n,companyReferrerDetail:r,getCompanyReferrerDetail:async()=>{try{a.all=!0,await d.dispatch("onboarding/getCompanyReferrerDetail")}finally{a.all=!1}},hasCompanyReferrer:t}};export{R as a,w as b,b as c,f as d,h as e,S as f,P as g,C as h,E as i,D as u};
