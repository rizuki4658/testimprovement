{"version":3,"file":"SelectCountry.3e7bff58.js","sources":["../../src/components/SelectCountry.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"refSelectCountryContainer\"\n    v-outside=\"handleOutsideClick\"\n    v-loading=\"loading.all\"\n    :class=\"[\n      'select-country wrapper',\n      !!noBorder && 'select-country--noborder'\n    ]\"\n  >\n    <label v-if=\"!!label\" for=\"select-country\" class=\"mb-1\">{{\n      label || 'Country'\n    }}</label>\n    <label v-if=\"$slots.label\">\n      <slot name=\"label\"></slot>\n    </label>\n    <div\n      ref=\"refSelectCountryContainer\"\n      v-outside=\"handleOutsideClick\"\n      v-loading=\"loading.all\"\n      :class=\"[\n        rounded && !phone && 'rounded-lg',\n        rounded && phone && 'rounded-l-lg'\n      ]\"\n      class=\"select-country wrapper\"\n    >\n      <div\n        @focus=\"toggleCollapse\"\n        tabindex=\"0\"\n        id=\"select-country\"\n        :class=\"[\n          rounded && !phone && 'rounded-lg',\n          rounded && phone && 'rounded-l-lg'\n        ]\"\n        class=\"select-country__value flex w-full justify-between items-center bg-white rounded-lg cursor-pointer select-none focus:border-teal-04\"\n      >\n        <div class=\"flex items-center\">\n          <template v-if=\"loading.all\"> Loading ... </template>\n          <template v-else-if=\"selectedCountry === null\">\n            <p>{{ placeholder }}</p>\n          </template>\n          <template v-else>\n            <slot name=\"selected\" :data=\"selectedCountry\">\n              <div class=\"mr-4\">\n                <img\n                  :src=\"`/flag/${selectedCountry[\n                    countryCodeKey || 'country_code'\n                  ]?.toLowerCase()}.svg`\"\n                  width=\"16\"\n                />\n              </div>\n              <div>{{ selectedCountry[countryNameKey || 'nicename'] }}</div>\n            </slot>\n          </template>\n        </div>\n        <div class=\"arrow\">\n          <i class=\"material-icons\">arrow_drop_down</i>\n        </div>\n      </div>\n      <div\n        v-if=\"!staticPosition\"\n        ref=\"refSelectCountrySheet\"\n        v-show=\"isCollapse\"\n        class=\"select-country__sheet fixed p-4 bg-white border border-grey-01 fixed w-full mt-2 rounded z-50\"\n      >\n        <Input\n          v-model=\"searchQuery\"\n          class=\"mb-4\"\n          block\n          placeholder=\"Search country\"\n          :disabled=\"disabled\"\n        />\n        <div class=\"max-h-96 overflow-y-auto\">\n          <div\n            v-for=\"(country, countryIndex) of countries\"\n            :key=\"countryIndex\"\n            @click=\"handleSelectCountry(country)\"\n            class=\"flex items-center p-3 hover:bg-darken cursor-pointer\"\n          >\n            <slot\n              name=\"option\"\n              :data=\"{\n                country,\n                selected:\n                  !!country && !!selectedCountry\n                    ? country[countryCodeKey || 'country_code'] ===\n                      selectedCountry[countryCodeKey || 'country_code']\n                    : false\n              }\"\n            >\n              <div class=\"mr-4 flex items-center\">\n                <i\n                  v-if=\"\n                    !!country && !!selectedCountry\n                      ? country[countryCodeKey || 'country_code'] ===\n                        selectedCountry[countryCodeKey || 'country_code']\n                      : false\n                  \"\n                  class=\"material-icons mr-4 text-teal-04\"\n                  >check_circle</i\n                >\n                <img\n                  :src=\"`/flag/${country[\n                    countryCodeKey || 'country_code'\n                  ].toLowerCase()}.svg`\"\n                  width=\"18\"\n                />\n              </div>\n              <div>{{ country[countryNameKey || 'nicename'] }}</div>\n            </slot>\n          </div>\n        </div>\n      </div>\n      <div\n        v-if=\"staticPosition\"\n        ref=\"refSelectCountrySheet\"\n        v-show=\"isCollapse\"\n        :class=\"[\n          placement === 'top' && 'bottom-full -translate-y-2',\n          placement === 'bottom' && 'top-full translate-y-2',\n        ]\"\n        class=\"absolute transform  p-4 bg-white border border-grey-01 rounded z-50\"\n        style=\"left: 0; right: 0;\"\n      >\n      <Input\n          v-model=\"searchQuery\"\n          class=\"mb-4\"\n          block\n          placeholder=\"Search country\"\n          :disabled=\"disabled\"\n        />\n        <div class=\"max-h-60 overflow-y-auto\">\n          <div\n            v-for=\"(country, countryIndex) of countries\"\n            :key=\"countryIndex\"\n            @click=\"handleSelectCountry(country)\"\n            class=\"flex items-center p-3 hover:bg-darken cursor-pointer\"\n          >\n            <slot\n              name=\"option\"\n              :data=\"{\n                country,\n                selected:\n                  !!country && !!selectedCountry\n                    ? country[countryCodeKey || 'country_code'] ===\n                      selectedCountry[countryCodeKey || 'country_code']\n                    : false\n              }\"\n            >\n              <div class=\"mr-4 flex items-center\">\n                <i\n                  v-if=\"\n                    !!country && !!selectedCountry\n                      ? country[countryCodeKey || 'country_code'] ===\n                        selectedCountry[countryCodeKey || 'country_code']\n                      : false\n                  \"\n                  class=\"material-icons mr-4 text-teal-04\"\n                  >check_circle</i\n                >\n                <img\n                  :src=\"`/flag/${country[\n                    countryCodeKey || 'country_code'\n                  ].toLowerCase()}.svg`\"\n                  width=\"18\"\n                />\n              </div>\n              <div>{{ country[countryNameKey || 'nicename'] }}</div>\n            </slot>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {\n  computed,\n  defineComponent,\n  nextTick,\n  onMounted,\n  ref,\n  watch,\n  watchEffect\n} from 'vue'\nimport { useCountries } from 'composable/setting'\nimport Input from 'bbUi/components/input/input.vue'\nimport { deepClone } from 'utils/deep-clone'\n\nexport default defineComponent({\n  name: 'SelectCountry',\n  components: {\n    Input\n  },\n  props: {\n    selected: {\n      type: String,\n      default: null\n    },\n    label: {\n      type: String,\n      default: ''\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    filterCountry: {\n      type: Function,\n      default: () => true\n    },\n    countries: {\n      type: Array,\n      default: () => null\n    },\n    countryCodeKey: {\n      type: String,\n      default: 'country_code'\n    },\n    countryNameKey: {\n      type: String,\n      default: 'nicename'\n    },\n    isoKey: {\n      type: String,\n      default: 'iso3'\n    },\n    phoneCodeKey: {\n      type: String,\n      default: 'phone_code'\n    },\n    placeholder: {\n      type: String,\n      default: 'Please select a country'\n    },\n    staticPosition: {\n      type: Boolean,\n      default: false\n    },\n    placement: {\n      type: String,\n      default: 'bottom'\n    },\n    initLoad: {\n      type: Boolean,\n      default: true\n    },\n    rounded: {\n      type: Boolean,\n      default: false\n    },\n    phone: {\n      type: Boolean,\n      default: false\n    },\n    noBorder: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['change', 'select'],\n  setup(props, { emit }) {\n    const { state, loading, action } = useCountries()\n    const selected = ref(null)\n    const searchQuery = ref('')\n    const isCollapse = ref(false)\n    const refSelectCountryContainer = ref(null)\n    const refSelectCountrySheet = ref(null)\n\n    const isCustomCountries = computed(() => !!props.countries)\n    const isExistCountries = computed(() =>\n      isCustomCountries.value ? !!props.countries : !!state.value.length\n    )\n    const countries = computed(() => {\n      let countryList = []\n      if (isCustomCountries.value) {\n        countryList = !!props.countries?.length ? [...props.countries] : []\n      } else {\n        countryList = !!state.value?.length ? [...state.value] : []\n      }\n      return countryList\n        .filter((country) => {\n          if (!!searchQuery.value)\n            return (\n              country[props.countryNameKey || 'nicename']\n                .toLowerCase()\n                .indexOf(searchQuery.value) > -1 ||\n              country[props.countryCodeKey || 'country_code']\n                .toLowerCase()\n                .indexOf(searchQuery.value) > -1\n            )\n          else return true\n        })\n        .filter(props.filterCountry)\n    })\n    const selectedCountry = computed(() => {\n      if (isCustomCountries.value) {\n        return selected.value && isExistCountries.value\n          ? props.countries.find(\n              (country) =>\n                country[\n                  props.countryCodeKey || 'country_code'\n                ].toLowerCase() === selected.value.toLowerCase() ||\n                country[props.isoKey || 'iso3'].toLowerCase() ===\n                  selected.value.toLowerCase()\n            )\n          : null\n      }\n      return selected.value && isExistCountries.value\n        ? state.value.find(\n            (country) =>\n              country[props.countryCodeKey || 'country_code'].toLowerCase() ===\n                selected.value.toLowerCase() ||\n              country[props.isoKey || 'iso3'].toLowerCase() ===\n                selected.value.toLowerCase()\n          )\n        : null\n    })\n\n    watchEffect(() => {\n      if (!!selectedCountry.value)\n        emit('change', deepClone(selectedCountry.value))\n    })\n    watch(\n      () => props.selected,\n      (selectedCountry) => {\n        selected.value = selectedCountry\n      },\n      {\n        immediate: true\n      }\n    )\n    onMounted(async () => {\n      if (!isCustomCountries.value && props.initLoad) await action()\n    })\n\n    const calculateSheetPosition = () => {\n      if (props.staticPosition) return\n\n      const selectContainer = refSelectCountryContainer.value\n      const selectSheet = refSelectCountrySheet.value\n      if (!selectContainer || !selectSheet) return\n      if (!selectContainer.getBoundingClientRect) return\n\n      const selectContainerParent = selectContainer.parentElement.parentElement\n      if (!selectContainerParent) return\n\n      nextTick(() => {\n        const { y: containerY } = selectContainer.getBoundingClientRect()\n        const containerOffsetTop = containerY - selectSheet.clientHeight / 4\n        const containerParentWidth = selectContainerParent.clientWidth\n\n        selectSheet.style.top = `${containerOffsetTop}px`\n        selectSheet.style.width = `${containerParentWidth}px`\n      })\n    }\n\n    const toggleCollapse = () => {\n      isCollapse.value = !props.disabled ? !isCollapse.value : false\n      if (isCollapse.value) {\n        calculateSheetPosition()\n      }\n    }\n    const handleOutsideClick = () => (isCollapse.value = false)\n    const handleSelectCountry = (country) => {\n      selected.value = country[props.countryCodeKey || 'country_code']\n      isCollapse.value = false\n\n      const countrySelected = deepClone(selectedCountry.value)\n      emit('change', countrySelected)\n      emit('select', countrySelected)\n    }\n    return {\n      refSelectCountryContainer,\n      refSelectCountrySheet,\n      countries,\n      selectedCountry,\n      searchQuery,\n      loading,\n      toggleCollapse,\n      handleOutsideClick,\n      handleSelectCountry,\n      isCollapse\n    }\n  }\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.select-country {\n  border: 1px solid #DDDDDD;\n  &--noborder {\n    border: 0px !important;\n  }\n  &:not(.input-phone) {\n    @apply relative;\n    .select-country__value {\n      @apply transition duration-300;\n      padding: 0.5rem 1rem;\n    }\n  }\n  &.input-phone {\n    .select-country__value {\n      @apply border-r-0 rounded-tr-none rounded-br-none w-36;\n      padding: 0.5rem 1rem;\n      box-sizing: border-box;\n    }\n    .select-country__sheet {\n      @apply top-14;\n    }\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","name","components","Input","props","selected","type","String","default","label","disabled","Boolean","filterCountry","Function","countries","Array","countryCodeKey","countryNameKey","isoKey","phoneCodeKey","placeholder","staticPosition","placement","initLoad","rounded","phone","noBorder","emits","[object Object]","emit","state","loading","action","useCountries","ref","searchQuery","isCollapse","refSelectCountryContainer","refSelectCountrySheet","isCustomCountries","computed","isExistCountries","value","length","countryList","_a","_b","filter","country","toLowerCase","indexOf","selectedCountry","find","watchEffect","deepClone","watch","selectedCountry2","immediate","onMounted","async","toggleCollapse","selectContainer","selectSheet","getBoundingClientRect","selectContainerParent","parentElement","nextTick","y","containerY","containerOffsetTop","clientHeight","containerParentWidth","clientWidth","style","top","width","calculateSheetPosition","handleOutsideClick","handleSelectCountry","countrySelected","key","for","_hoisted_2","_hoisted_4","_hoisted_9","_hoisted_12","_hoisted_14","_withDirectives","_createElementBlock","_createCommentVNode","class","_normalizeClass","_ctx","_createElementVNode","onFocus","_cache","args","tabindex","id","_hoisted_3","_Fragment","_toDisplayString","_hoisted_5","src","_hoisted_7","onUpdate:modelValue","$event","block","_hoisted_8","_renderList","countryIndex","_openBlock","onClick","$slots","data","_hoisted_13","_directive_outside"],"mappings":"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"}