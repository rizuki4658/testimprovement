var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,t)=>{for(var a in t||(t={}))l.call(t,a)&&r(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&r(e,a,t[a]);return e},n=(e,s)=>t(e,a(s));import{C as d}from"./card.dfb8e6f7.js";import{j as u,g as c,f as m,a5 as p,h as f,r as y,m as b,o as v,t as g,B as _,D as h,ap as x,U as k,w as S,I as $,K as w,n as C,a4 as I,a2 as V,a3 as O,S as T,F as j,_ as L,O as U,y as B,W as A,z as D,a0 as P,A as R}from"./vendor.f1efedad.js";import{z as E,X as q,u as M,f as F,e as N,b as z,ad as J,_ as Y,y as G,r as W,d as K,a4 as X,P as H,g as Q}from"./index.9aa6481b.js";import{F as Z}from"./FilterDropdown.948b9e48.js";import{C as ee,a as te}from"./CustomTableExport.5c5d656f.js";import{f as ae}from"./date.f86face7.js";import{a as se}from"./dymo.fbcd861f.js";import{S as le,B as oe}from"./BulkStatusesForm.36b4c39c.js";import{B as re}from"./BTable.59e23b62.js";import{_ as ie}from"./tab.065d46d3.js";import{S as ne}from"./SelectableChip.171e35cc.js";import{_ as de}from"./badge.b59865a3.js";import{_ as ue}from"./BuybackNotesWarning.b689e74e.js";import{c as ce}from"./status.6f59bf91.js";import{_ as me}from"./ExpeditedIcon.db9b60c4.js";import{u as pe}from"./notes.2b722abc.js";import"./BDropdown.7a2c3a7d.js";import"./index.32689823.js";import"./index.05b14cb2.js";import"./vue-draggable-next.esm-bundler.0ebea46e.js";import"./fieldset.49a14fc7.js";import"./attention.c511405b.js";import"./Table.89f43e16.js";const fe=u("easyOffer",{state:()=>({order:{data:null,isLoading:!1},orderStatus:{isLoading:!1,result:null},statusOptions:{isLoading:!1,result:null},export:{isLoading:!1,extension:"csv"},filters:{buyback:"easy-offer",page:1,limit:10,search:"",sort_by:"",order_by:"",date:null,from:"",to:"",is_require_file:0,is_expired:0,barcode:"",referral_source:null,item_condition:[],selling_type:[],payout_method:[],buyback_source:[],shipping_courier:[]},loading:{print:{address_label:!1},bulkStatus:!1,delete:!1,restore:!1,updateStatus:!1,exportCsv:!1,exportPaypallMass:!1,exportCsvTremendous:!1,exportCsvDots:!1},customTable:{data:null,isLoading:!1},referralSource:{data:null,isLoading:!1},conditions:{data:null,isLoading:!1},payoutMethods:{data:null,isLoading:!1},couriers:{data:null,isLoading:!1},fileRequired:{data:null,isLoading:!1}}),actions:{$clearFilters(){this.filters={buyback:"easy-offer",page:1,limit:10,search:"",date:null,from:"",to:"",sort_by:"",order_by:"",is_expired:0,barcode:"",referral_source:null,item_condition:[],selling_type:[],payout_method:[],buyback_source:[],shipping_courier:[]}},async $getOrderStatus(e){this.$state.orderStatus.isLoading=!0;try{const t=await E({url:"v1/pos/order/order-status",method:"get",params:i({status_id:e},this.filters)});return this.$state.orderStatus.result=t,t}catch(t){return console.log(t),null}finally{this.$state.orderStatus.isLoading=!1}},async $getStatusOptions(){try{this.$state.statusOptions.isLoading=!0;const e=await E({url:"/v1/pos/order/order-status",method:"get",params:{type:"option",buyback:"easy-offer"}});return this.$state.statusOptions.result=e,e}catch(e){return console.log(e),null}finally{this.$state.statusOptions.isLoading=!1}},async $getCustomTable(e){try{this.$state.customTable.isLoading=!0;const t=await E({url:"/v1/pos/custom-table",method:"get",params:{type_table:"easy-offer",status:e}});return this.$state.customTable.data=t,t}catch(t){return console.log(t),null}finally{this.$state.customTable.isLoading=!1}},async $getReferralSource(e){try{this.$state.referralSource.isLoading=!0;const t=await E({url:"/v1/pos/easy-offer/filter/referral-source",method:"get",params:e});return this.$state.referralSource.data=t.map((e=>e.name)),t}catch(t){return console.log(t),null}finally{this.$state.referralSource.isLoading=!1}},async $getItemCondition(e){try{this.$state.conditions.isLoading=!0;const t=await E({url:"/v1/pos/easy-offer/filter/item-condition",method:"get",params:e});return this.$state.conditions.data=t.map((e=>e.name)),t}catch(t){return console.log(t),null}finally{this.$state.conditions.isLoading=!1}},async $getPayoutMethod(){try{this.$state.payoutMethods.isLoading=!0;const e=await E({url:"/v1/pos/easy-offer/payment-method",method:"get"});return this.$state.payoutMethods.data=e,e}catch(e){return console.log(e),null}finally{this.$state.payoutMethods.isLoading=!1}},async $getShippingCourier(e){try{this.$state.couriers.isLoading=!0;const t=await E({url:"/v1/pos/easy-offer/filter/courier",method:"get",params:e});return this.$state.couriers.data=t.map((e=>e.name)),t}catch(t){return console.log(t),null}finally{this.$state.couriers.isLoading=!1}},async $getOrder(e){const t=Object.assign({},this.$state.filters);t.from=t.date&&ae(t.date[0])||null,t.to=t.date&&ae(t.date[1])||null,delete t.date;try{this.$state.order.isLoading=!0;const a=await E({url:"v2/pos/easy-offer",method:"get",params:i({status_id:e},t)});return this.$state.order.data=a,a}catch(a){return console.log(a),null}finally{this.$state.order.isLoading=!1}},async $actionBatchPrintAddressLabel(e){try{this.$state.loading.print.address_label=!0;const t=JSON.stringify(e.map((e=>e.offer_id))),a=Object.assign({},{ids:t}),s=await E({url:"/v1/pos/print/batch-address-label",method:"post",data:a});let l=[];s.forEach(((e,t)=>{l[t]={fullname:"",addressComponent:""},l[t].fullname=`${e.billing_firstname||""} ${e.billing_lastname||""}`,l[t].address_component=`${e.billing_address1?e.billing_address1.toUpperCase():""}\n${e.billing_city?e.billing_city.toUpperCase():""} ${e.billing_state?e.billing_state.toUpperCase():""} ${e.billing_zip?e.billing_zip.toUpperCase():""}`,l[t].imb=e.imb||""})),se(l)}finally{this.$state.loading.print.address_label=!1}},async $actionDelete(e){try{this.$state.loading.delete=!0;return await E({url:"/v1/pos/order/delete/bulk",method:"delete",data:{selected_order_id:JSON.stringify(e)}})}finally{this.$state.loading.delete=!1}},async $actionRestore(e){try{this.$state.loading.restore=!0;return await E({url:"/v1/pos/order/restore/bulk",method:"post",data:{selected_order_id:JSON.stringify(e)}})}finally{this.$state.loading.restore=!1}},async $actionUpdate(e){this.$state.loading.bulkStatus=!0;try{const t=e.transaction_id.reduce(((e,t)=>(e[t.box_id]=t.transaction_id,e)),{}),a=Object.assign({},n(i({},e),{transaction_id:JSON.stringify(t)}));return await E({url:"/v1/pos/order/bulk-status",method:"post",data:n(i({},a),{_method:"PUT"})})}finally{this.$state.loading.bulkStatus=!1}},async $actionExportCsv(e){try{this.$state.loading.exportCsv=!0;return await E({url:"/v1/pos/order/generate-csv",method:"get",params:n(i({},e),{buyback_type:4,extension:this.$state.export.extension}),responseType:"blob"})}finally{this.$state.loading.exportCsv=!1}},async $actionExportCSVTremendous(){try{this.$state.loading.exportCsvTremendous=!0;const e=await E({url:"/v1/pos/order/tremendous-failures/download",method:"get",params:{buyback_type:4}});return q(e,"CSV Tremendous","text/csv"),e}finally{this.$state.loading.exportCsvTremendous=!1}},async $actionExportCSVDOTS(e={},t="CSV DOTS"){try{this.$state.loading.exportCsvDots=!0;const a=await E({url:"/v1/pos/order/masspay",method:"get",params:n(i({},e),{buyback_type:4}),responseType:"blob"});return q(a,`${t} ${e.delivery_method||""}`,`text/${e.extension}`),a}catch(a){return console.log(a),null}finally{this.$state.loading.exportCsvDots=!1}},async $actionExportPaypalMass(e,t,a){var s;try{loading.exportPaypalMass=!0;const l={status_id:e,payment_method:(null==(s=a.payouts)?void 0:s.map((e=>e.name)))||data.payment_method,is_affiliate:0,is_expired:t,limit:data.limit,buyback_type:"local"===buyback?2:null,extension:a.extension},o=await E({url:"/v1/pos/order/paypal-mass",method:"get",params:l,responseType:"blob"});q(o,"Payouts Info",l.payment_method.length>1?"application/zip":`text/${a.extension}`)}finally{loading.exportPaypalMass=!1}},async $actionGetFileRequired(){try{this.$state.fileRequired.isLoading=!0;const e=await E({url:"/v1/pos/easy-offer/required-file-upload",method:"get"});return this.$state.fileRequired.data=e.is_required_file_easy_offer,e}finally{this.$state.fileRequired.isLoading=!1}},async $actionUpdateFileRequired(e){try{this.$state.fileRequired.isLoading=!0;return await E({url:"/v1/pos/easy-offer/required-file-upload",method:"put",data:e})}finally{this.$state.fileRequired.isLoading=!1}}}}),ye={class:"flex flex-col xl:flex-row"},be={class:"flex flex-wrap flex-grow xl:mr-3 xl:mb-0 mb-3 my-2"},ve={key:0,class:"flex-auto mr-2 my-2"},ge={class:"flex-auto mr-2 my-2"},_e={class:"xl:flex-auto mr-2 my-2"},he={class:"text-grey-03"},xe={key:0},ke={class:"flex flex-col p-3"},Se=["onClick"],$e={class:"inline-flex flex-wrap xl:flex-grow-0 flex-grow items-center my-2"},we={key:0},Ce=["onClick"],Ie={key:1,class:"opacity-50"},Ve=["onClick"],Oe={key:1},Te={class:"flex flex-start flex-row mb-4"},je=["onClick"],Le={key:0,class:"inline-block mx-2"},Ue={__name:"EasyOfferTableFilters",props:{table:{type:Object,default:()=>({})},tabStatuses:{type:Array,default:()=>[]}},emits:["update:customTable"],setup(e,{emit:t}){var a,s;const l=e,o=t,{me:r,dateByTimezone:i}=M(),n=fe(),d=c((()=>{var e;return(null==(e=n.$state.referralSource)?void 0:e.data)||[]})),u=c((()=>{var e;return(null==(e=n.$state.conditions)?void 0:e.data)||[]})),U=c((()=>{var e;return(null==(e=n.$state.payoutMethods)?void 0:e.data)||[]})),B=c((()=>{var e;return(null==(e=n.$state.couriers)?void 0:e.data)||[]})),{buyback:A}=le,D=m(!1),P=m(!1),R=m(!1),E=c((()=>["all","1","2"].includes(G.params.statusId))),q=m("1"==(null==(a=l.table)?void 0:a.is_csv_download)),Y=m("1"==(null==(s=l.table)?void 0:s.is_csv_download)),G=p(),W=c((()=>{var e,t;return[{id:"payment_method",name:"Payout Method",value:n.filters.payment_method?n.filters.payment_method.join(", "):null,default:[]},{id:"date",name:"Date",value:n.filters.date?`${f(n.filters.date[0]).format((null==(e=r.value)?void 0:e.date_format)||"")} - ${f(n.filters.date[1]).format((null==(t=r.value)?void 0:t.date_format)||"")}`:null,default:null},{id:"shipping_courier",name:"Courier",value:n.filters.shipping_courier?n.filters.shipping_courier.join(", "):null,default:[]},{id:"buyback_source",name:"Buyback Source",value:n.filters.buyback_source?n.filters.buyback_source.join(", "):null},{id:"referral_source",name:"Referral Source",value:n.filters.referral_source,default:null},{id:"item_condition",name:"Item Condition",value:n.filters.item_condition?n.filters.item_condition.join(", "):null,default:[]}]})),K=c((()=>W.value.filter((e=>e.value)).length>0)),X=e=>{e&&"date"===e.key&&ue()},H=async()=>{P.value=!0,R.value=!0,o("update:customTable"),P.value=!1},Q=async()=>{P.value=!0,R.value=!1,(()=>{for(let e of W.value)n.filters[e.id]=e.default})(),o("update:customTable"),P.value=!1},se=[{name:"Select Date",key:"date",count_selected:0},{name:"Item Condition",key:"condition",count_selected:(n.filters.item_condition||[]).length||0},{name:"Referral Source",key:"referral_source",count_selected:0},{name:"Payout Method",key:"payout_method",count_selected:(n.filters.payment_method||[]).length||0},{name:"Source",key:"source",count_selected:(n.filters.buyback_source||[]).length||0},{name:"Courier",key:"courier",count_selected:n.filters.shipping_courier.length||[]}],oe=()=>n.order.isLoading||n.orderStatus.isLoading,re=e=>"date"===e.key,ie=m(null),ne=y({disabledDate:e=>e.getTime()>i.value.getTime()}),de=c((()=>{const e={from:null,to:null},[t,a]=n.filters.date||[];return!t||!a||(e.from=ae(t)||null,e.to=ae(a)||null),e})),ue=()=>{D.value?D.value=!1:(D.value=!0,ie.value.focus())},ce=async()=>{o("update:customTable")},me=c((()=>{var e,t,a,s,o,r;const i="active"!==(null==(t=null==(e=G.params.category)?void 0:e.toLowerCase)?void 0:t.call(e)),n="expired"===G.params.subStatusId;if(i)return"Archive";if(n)return"Expired";if("all"===G.params.statusId)return"All";if(G.params.statusId&&G.params.subStatusId){const e=null==(a=l.tabStatuses)?void 0:a.find((e=>e.id==G.params.statusId));if(!e)return"";const t=e.sub;return t&&(null==(s=t.find((e=>e.id==G.params.subStatusId)))?void 0:s.short_name)||""}return(null==(r=null==(o=l.tabStatuses)?void 0:o.find((e=>e.id==G.params.statusId)))?void 0:r.short_name)||""})),pe=c((()=>{const e=me.value,[t,a]=n.filters.date||[];if(!(t&&a))return e;return`${e} ${t?ae(t):""} to ${a?ae(a):""}`})),Ue=c((()=>n.loading.exportCsv||n.loading.exportPaypallMass||n.loading.exportCsvTremendous||n.loading.exportCsvDots)),Be=async e=>{n.export.extension=(null==e?void 0:e.extension)||(null==e?void 0:e.ext)||e,e.isTremendous?await n.$actionExportCSVTremendous():(await n.$actionExportCsv({status_id:G.params.subStatusId?G.params.subStatusId:G.params.statusId||G.params.category,from:de.value.from,to:de.value.to,is_grouped:null==e?void 0:e.grp}),L({type:"success",message:"Your export data request is processing, it will be delivered to your email when the process is completed."}),q.value=!0,n.export.extension="csv")},Ae=async e=>{const t={payment_method:e.payouts.map((e=>e.name)),delivery_method:e.dots,extension:e.extension};await n.$actionExportCSVDOTS(t,`${e.extension.toUpperCase()} DOTS`),L({type:"success",message:"Your export data has been sent"}),Y.value=!0},De=async e=>{await n.$actionExportPaypalMass(G.params.statusId,"expired"===G.params.category?"1":"0",e)};return(e,t)=>{const a=b("DatePicker"),s=b("Popover"),l=b("DropdownItem"),o=b("DropdownMenu"),r=b("Dropdown");return v(),g(V,null,[_("div",ye,[_("div",be,[E.value?(v(),g("div",ve,[h(F,{modelValue:x(n).filters.barcode,"onUpdate:modelValue":t[0]||(t[0]=e=>x(n).filters.barcode=e),placeholder:"Scan barcode/tracking #",block:"",icon:""},null,8,["modelValue"])])):k("",!0),_("div",ge,[h(F,{modelValue:x(n).filters.search,"onUpdate:modelValue":t[1]||(t[1]=e=>x(n).filters.search=e),placeholder:"Search Everything",block:"",icon:""},{icon:S((()=>t[9]||(t[9]=[_("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue"])]),_("div",_e,[h(Z,{onItemClick:X,onApplyFilter:H,onResetFilter:Q,onCollapse:t[7]||(t[7]=e=>D.value=!1),filters:se,"item-loading":oe,"item-disable-hover":re,loading:P.value,"reset-disabled":!R.value},{label:S((({item:e})=>[_("div",null,[_("p",he,[$(w(e.name)+" ",1),e.meta.count_selected>0?(v(),g("span",xe," ("+w(e.meta.count_selected)+") ",1)):k("",!0)]),"date"===e.key?(v(),C(a,I({key:0,modelValue:x(n).filters.date,"onUpdate:modelValue":t[2]||(t[2]=e=>x(n).filters.date=e)},ne,{placement:"right",type:"daterange",ref_key:"filterDateRef",ref:ie,class:"hide-picker"}),null,16,["modelValue"])):k("",!0)])])),dropdown:S((({filter:e,collapse:a})=>[_("div",ke,["condition"===e.key?(v(!0),g(V,{key:0},O(u.value,(e=>(v(),C(N,{modelValue:x(n).filters.item_condition,"onUpdate:modelValue":t[3]||(t[3]=e=>x(n).filters.item_condition=e),key:e,value:e,color:"teal",class:"my-2 font-normal"},{default:S((()=>[$(w(e),1)])),_:2},1032,["modelValue","value"])))),128)):k("",!0),"referral_source"===e.key?(v(!0),g(V,{key:1},O(d.value,((e,t)=>(v(),g("a",{onClick:T((()=>{x(n).filters.referral_source=e,a()}),["prevent"]),key:t,href:"",class:j(["text-grey-03","p-3","block","hover:bg-grey-lighten",x(n).filters.referral_source===e&&"font-semibold"])},[_("p",null,w(e),1)],10,Se)))),128)):k("",!0),"payout_method"===e.key?(v(!0),g(V,{key:2},O(U.value,(e=>(v(),C(N,{modelValue:x(n).filters.payment_method,"onUpdate:modelValue":t[4]||(t[4]=e=>x(n).filters.payment_method=e),key:e.id,value:e.name,color:"teal",class:"my-2 font-normal"},{default:S((()=>[$(w(e.name),1)])),_:2},1032,["modelValue","value"])))),128)):k("",!0),"source"===e.key?(v(!0),g(V,{key:3},O(x(A),(e=>(v(),C(N,{modelValue:x(n).filters.buyback_source,"onUpdate:modelValue":t[5]||(t[5]=e=>x(n).filters.buyback_source=e),key:e.value,value:e.value,color:"teal",class:"my-2 font-normal"},{default:S((()=>[$(w(e.name),1)])),_:2},1032,["modelValue","value"])))),128)):k("",!0),"courier"===e.key?(v(!0),g(V,{key:4},O(B.value,(e=>(v(),C(N,{modelValue:x(n).filters.shipping_courier,"onUpdate:modelValue":t[6]||(t[6]=e=>x(n).filters.shipping_courier=e),key:e,value:e,color:"teal",class:"my-2 font-normal"},{default:S((()=>[$(w(e),1)])),_:2},1032,["modelValue","value"])))),128)):k("",!0)])])),_:1},8,["loading","reset-disabled"])])]),_("div",$e,[h(ee,{onUpdateTable:ce,type:"easy-offer",status:x(G).params.subStatusId||x(G).params.statusId||x(G).params.category,class:"mr-2"},null,8,["status"]),h(te,{modelValue:x(n).export.extension,"onUpdate:modelValue":t[8]||(t[8]=e=>x(n).export.extension=e),onExport:Be,onExportPayout:De,onExportDots:Ae,loading:Ue.value,"export-filename":pe.value,"with-payout":7==x(G).params.statusId,payouts:U.value,class:"w-max",grouped:""},{default:S((({openModal:e,openModalPayout:a})=>[7==x(G).params.statusId?(v(),g("div",we,[h(r,{trigger:"click",size:"medium",placement:"bottom-end","hide-on-click":!0,disabled:Ue.value||x(n).loading.exportCsv},{dropdown:S((()=>[h(o,null,{default:S((()=>[h(l,null,{default:S((()=>[h(s,{width:"400",trigger:"hover",disabled:!q.value},{reference:S((()=>[q.value?(v(),g("span",Ie,"Current Table View")):(v(),g("span",{key:0,onClick:t=>e()},"Current Table View",8,Ce))])),default:S((()=>[t[11]||(t[11]=_("div",{class:"w-full h-full flex justify-center items-center"},[_("span",{class:"whitespace-pre-line"}," Export data is being processed ")],-1))])),_:2},1032,["disabled"])])),_:2},1024),h(l,null,{default:S((()=>[_("span",{onClick:a},"Only Payout Info",8,Ve)])),_:2},1024),h(l,{onClick:t=>e(!0)},{default:S((()=>t[12]||(t[12]=[$("Tremendous")]))),_:2},1032,["onClick"])])),_:2},1024)])),default:S((()=>[h(z,{loading:Ue.value||x(n).loading.exportCsv,color:"white"},{default:S((()=>t[10]||(t[10]=[_("div",{class:"flex items-center justify-between gap-x-2"},[_("span",{class:"text-grey-03 text-base"},[_("i",{class:"material-icons"},"download"),$(" Export ")]),_("i",{class:"material-icons text-grey-03"},"arrow_drop_down")],-1)]))),_:1},8,["loading"])])),_:2},1032,["disabled"])])):(v(),g("div",Oe,[h(s,{width:"400",trigger:"hover",disabled:!q.value},{reference:S((()=>[_("div",null,[h(z,{onClick:t=>e(),color:"white",block:"",loading:Ue.value||x(n).loading.exportCsv,disabled:q.value},{default:S((()=>t[13]||(t[13]=[_("span",{class:"text-grey-03"},[_("i",{class:"material-icons text-lg"}," file_download "),$(" Export ")],-1)]))),_:2},1032,["onClick","loading","disabled"])])])),default:S((()=>[t[14]||(t[14]=_("div",{class:"w-full h-full flex justify-center items-center"},[_("span",{class:"whitespace-pre-line"}," Export data is being processed ")],-1))])),_:2},1032,["disabled"])]))])),_:1},8,["modelValue","loading","export-filename","with-payout","payouts"])])]),_("div",Te,[R.value?(v(),g(V,{key:0},[(v(!0),g(V,null,O(W.value,((t,a)=>(v(),g("div",{class:"inline-block",key:a},[t.value?(v(),C(z,{key:0,color:"grey",view:"smooth",dense:"",class:"mx-1"},{default:S((()=>[_("b",null,w(t.name)+":",1),$(" "+w("Referral Source"===t.name?t.value:x(J)(t.value)),1),_("i",{class:"material-icons text-sm ml-2",onClick:a=>e.handleClearFilter(t)},"close",8,je)])),_:2},1024)):k("",!0)])))),128)),K.value?(v(),g("div",Le,[h(z,{onClick:Q,color:"teal",view:"smooth",dense:""},{default:S((()=>t[15]||(t[15]=[_("i",{class:"material-icons text-sm mr-1"},"close",-1),$("Clear all ")]))),_:1})])):k("",!0)],64)):k("",!0)])],64)}}};const Be={class:"flex flex-row items-center justify-center"},Ae={class:"block"},De={key:0,class:"p-3 ml-4 bg-teal-04 text-white rounded-full flex items-center justify-center box-border",style:{"min-width":"3rem"}},Pe={key:1,class:"flex flex-col md:flex-row mb-6"},Re={class:"flex flex-wrap items-center"},Ee={class:"ml-2"};var qe=Y({__name:"EasyOfferTab",props:{currentTabId:{type:[String,Number],required:!0},statusId:{type:[String,Number],default:"all"},tabStatuses:{type:Array,default:()=>[]}},setup(e){const t=e,a=p(),s=U(),l=c((()=>[G({id:0,short_name:"Active"},"easyOfferTab",{category:"active",statusId:t.statusId||"all"},"id","short_name"),G({id:2,short_name:"Archive"},"easyOfferTab",{category:"archive"},"id","short_name")])),o=c((()=>{var e;return[G({id:0,short_name:"All"},"easyOfferTab",{statusId:"all"},"id","short_name")].concat(null==(e=t.tabStatuses)?void 0:e.map((e=>n(i({},G(e,"easyOfferTab",{statusId:e.id},"id","short_name")),{data:e}))))})),r=c((()=>{const e=W(t.tabStatuses).find((e=>1001==e.id)),a=e?e.sub:null;return a?a.map((e=>"Abandoned Buyback"===e.status_name?n(i({},e),{color:"orange",subStatusId:e.id}):"Active Leads"===e.status_name?n(i({},e),{color:"green",subStatusId:e.id}):"Expired"===e.status_name?n(i({},e),{color:"red",subStatusId:"expired"}):n(i({},e),{color:"teal",subStatusId:e.id}))):[]})),d=e=>{s.push({name:"easyOfferTab",params:{statusId:a.params.statusId,category:a.params.category,subStatusId:e}})};return(t,s)=>(v(),g(V,null,[h(ie,{view:"smooth",color:"teal",class:"mt-14 md:m-0",items:l.value,"active-id":e.currentTabId},null,8,["items","active-id"]),"active"===x(a).params.category?(v(),C(ie,{key:0,class:"mt-4",view:"smooth",items:o.value},{title:S((e=>{var t,s;return[_("div",Be,[_("span",Ae,w(e.item.name),1),"customerDetail"===x(a).name||[6,3].includes(null==(t=e.item.data)?void 0:t.id)||["all","test order"].includes(e.item.name.toLowerCase())?k("",!0):(v(),g("div",De,w(null==(s=e.item.data)?void 0:s.total),1))])]})),_:1},8,["items"])):k("",!0),1001==x(a).params.statusId?(v(),g("div",Pe,[h(ne,{modelValue:x(a).params.subStatusId,onChange:d,"color-key":"color",by:"subStatusId",name:"status_name",items:r.value,class:"substatus-chip"},{label:S((({item:e})=>[_("div",Re,[_("span",Ee,w(e.status_name),1),null!==e.total?(v(),g("span",{key:0,class:j(["substatus-counter","flex","items-center","justify-center","p-3","bg-grey-03","rounded-full","text-white","ml-4",e.color&&`--color-${e.color}`]),style:{"min-width":"3rem"}},w(e.total),3)):k("",!0)])])),_:1},8,["modelValue","items"])])):k("",!0)],64))}},[["__scopeId","data-v-5261c153"]]);const Me={__name:"BulkStatusModal",props:{modelValue:{type:Boolean,default:!1},bulkStatusData:{type:Object,required:!0},stateOptionStatuses:{type:Array,default:()=>[]},isBulkStatusLargeModal:{type:Boolean,default:!1},bulkStatusLoading:{type:Boolean,default:!1}},emits:["update:modelValue","update:bulkStatusData","close","updateStatus"],setup(e,{emit:t}){const a=t,s=m(null),l=()=>{a("close")},o=()=>{s.value.validate&&s.value.validate()&&a("updateStatus")},r=e=>{a("update:bulkStatusData",e)};return(t,a)=>(v(),C(K,{"model-value":e.modelValue,"onUpdate:modelValue":a[0]||(a[0]=e=>t.$emit("update:modelValue",e)),title:"Change Status",onClose:l,size:e.isBulkStatusLargeModal?"lg":"sm"},{default:S((()=>[h(oe,{ref_key:"refBulkStatusForm",ref:s,statuses:e.stateOptionStatuses,data:e.bulkStatusData,"onUpdate:data":r},null,8,["statuses","data"])])),footer:S((()=>[h(z,{color:"teal",onClick:o,loading:e.bulkStatusLoading},{default:S((()=>a[1]||(a[1]=[$("Save")]))),_:1},8,["loading"])])),_:1},8,["model-value","size"]))}},Fe={class:"py-10"},Ne={class:"mt-8 mb-10"},ze={class:"mb-4 text-center"},Je={key:0},Ye={class:"text-center mb-4"},Ge={key:0},We={class:"text-center"},Ke={__name:"BulkArchiveModal",props:{modelValue:{type:Boolean,default:!1},selectedBuybacks:{type:Array,default:()=>[]}},emits:["update:modelValue","archive"],setup(e,{emit:t}){const a=t,s=()=>{a("update:modelValue",!1)},l=()=>{a("archive"),a("update:modelValue",!1)};return(t,a)=>(v(),C(K,{size:"xs","model-value":e.modelValue,"onUpdate:modelValue":a[0]||(a[0]=e=>t.$emit("update:modelValue",e)),title:"Archive Order","hide-header":"","hide-footer":"",onClose:s},{default:S((()=>[_("div",Fe,[a[6]||(a[6]=_("img",{class:"mb-10 mx-auto",src:X,alt:"Success Icon"},null,-1)),_("div",Ne,[_("h5",ze,[$("Archiving "+w(e.selectedBuybacks.length)+" Order",1),e.selectedBuybacks.length>1?(v(),g("span",Je,"s")):k("",!0)]),_("p",Ye,[$(" Are you sure you want to archive "+w(e.selectedBuybacks.length)+" order",1),e.selectedBuybacks.length>1?(v(),g("span",Ge,"s")):k("",!0),a[1]||(a[1]=$(" ? ")),a[2]||(a[2]=_("br",null,null,-1)),a[3]||(a[3]=$(' Once archived orders can be removed from the "Archived" menu '))])]),_("div",We,[h(z,{view:"outlined",color:"teal",class:"bg-white",onClick:s},{default:S((()=>a[4]||(a[4]=[$("Cancel")]))),_:1}),h(z,{color:"orange",class:"ml-3",onClick:l},{default:S((()=>a[5]||(a[5]=[$("Yes, Archive")]))),_:1})])])])),_:1},8,["model-value"]))}},Xe={class:"py-10"},He={class:"mt-8 mb-10"},Qe={class:"mb-4 text-center"},Ze={key:0},et={class:"text-center mb-4"},tt={key:0},at={class:"text-center"},st={__name:"BulkUnarchiveModal",props:{modelValue:{type:Boolean,default:!1},selectedBuybacks:{type:Array,default:()=>[]}},emits:["update:modelValue","restore"],setup(e,{emit:t}){const a=t,s=()=>{a("update:modelValue",!1)},l=()=>{a("restore"),a("update:modelValue",!1)};return(t,a)=>(v(),C(K,{size:"xs","model-value":e.modelValue,"onUpdate:modelValue":a[0]||(a[0]=e=>t.$emit("update:modelValue",e)),title:"Restore Order","hide-header":"","hide-footer":"",onClose:s},{default:S((()=>[_("div",Xe,[a[5]||(a[5]=_("img",{class:"mb-10 mx-auto",src:X,alt:"Success Icon"},null,-1)),_("div",He,[_("h5",Qe,[$("Restoring "+w(e.selectedBuybacks.length)+" Order",1),e.selectedBuybacks.length>1?(v(),g("span",Ze,"s")):k("",!0)]),_("p",et,[$(" Are you sure you want to restore "+w(e.selectedBuybacks.length)+" order",1),e.selectedBuybacks.length>1?(v(),g("span",tt,"s")):k("",!0),a[1]||(a[1]=$(" ? ")),a[2]||(a[2]=_("br",null,null,-1))])]),_("div",at,[h(z,{view:"outlined",color:"teal",class:"bg-white",onClick:s},{default:S((()=>a[3]||(a[3]=[$("Cancel")]))),_:1}),h(z,{color:"orange",class:"ml-3",onClick:l},{default:S((()=>a[4]||(a[4]=[$("Yes, Restore")]))),_:1})])])])),_:1},8,["model-value"]))}},lt={class:"flex items-center"},ot={class:"flex items-center flex-row my-4 float-left"},rt={key:0,class:"inline-block mx-2"},it={key:1,class:"inline-block"},nt={key:2,class:"inline-block mx-2"},dt={key:3,class:"inline-block mx-2"},ut={key:0,class:"font-semibold"},ct={class:"flex items-center"},mt={key:1},pt={key:2},ft={class:"list"},yt={key:0},bt={class:"text-grey-03"},vt={key:0,style:{"list-style-type":"none"},class:"my-2 text-grey-03"},gt={key:3},_t={key:4},ht={key:0,class:"w-max flex items-center gap-2 bg-green-lighten text-green-04 py-2 px-4 rounded-full text-sm"},xt={key:1},kt={key:5},St={__name:"index",setup(e){const t=pe(),a=y({selected_ids:[],selected_box_id:null,transaction_id:null,notes:null,status_id:1,is_send_email:!1}),s=p(),l=U(),o=fe(),r=m([]),i=m([]),n=c((()=>s.params.category)),u=m(!1),f=m(!1),I=m(!1),T=m(!1),j=m(!1),E=()=>{f.value=!0},q=()=>{I.value=!0},M=async()=>{await o.$actionBatchPrintAddressLabel(i.value)},F=async()=>{if(!j.value){j.value=!0;try{const e="expired"===s.params.subStatusId?1:s.params.subStatusId||s.params.statusId||s.params.category;"expired"===s.params.subStatusId&&(o.filters.is_expired=1);const t=o.filters.is_expired,a="1001"==s.params.statusId,l=!!s.params.subStatusId;a&&!l&&(s.params.subStatusId="1");const i=await Promise.all([o.$getOrderStatus(e),o.$getStatusOptions(),o.$getOrder(e),o.$getReferralSource({status_id:e,is_expired:t}),o.$getItemCondition({status_id:e,is_expired:t}),o.$getCustomTable(e),o.$getPayoutMethod(),o.$getShippingCourier({status_id:e,is_expired:t}),o.$actionGetFileRequired()]);r.value=i[0]}finally{j.value=!1}}},J=()=>{Object.assign(a,{selected_box_id:null,transaction_id:null,notes:null,status_id:1,is_send_email:!1})},Y=async()=>{var e,s;if([3,7].includes(a.status_id)&&(o.$state.loading.bulkStatus=!0,t.warningNotes.ids=i.value.map((e=>e.order_id)),!t.warningNotes.isReviewed&&await t.$getNotesUnread(a.transaction_id.map((e=>e.box_id))),null==(s=null==(e=t.warningNotes)?void 0:e.notes)?void 0:s.length))return t.warningNotes.modal=!0,void(o.$state.loading.bulkStatus=!1);await o.$actionUpdate(a).then((async()=>{i.value=[],u.value=!1,L({type:"success",message:"Success update status"}),await F()}))},G=c((()=>{const e=i.value;return!!e.length&&e.every((t=>[9,15].includes(e[0].status_id)?[9,15].includes(t.status_id):[12,13].includes(e[0].status_id)?[12,13].includes(t.status_id):t.status_id===e[0].status_id))})),W=c((()=>0===[...i.value].filter((e=>e.is_readonly)).length)),K=c((()=>[7].includes(a.status_id))),X=()=>{var e,t;a.selected_box_id=i.value.map((e=>e.offer_id)).join(","),a.transaction_id=i.value.map((e=>({box_id:e.offer_id,transaction_id:""}))),u.value=!0;const l=(null==(e=i.value)?void 0:e.length)>0?null==(t=i.value[0])?void 0:t.status_id:1;"all"===s.params.statusId?a.status_id=l:a.status_id=s.params.subStatusId?parseInt(s.params.subStatusId):parseInt(s.params.statusId)},Z=c((()=>null==o?void 0:o.order.data)),ee=async()=>{const e=i.value.map((e=>e.order_id)).join(",");"deleted"===await o.$actionDelete([e])&&(L({type:"success",message:"Success archiving order"}),i.value=[],await F())},te=async()=>{const e=i.value.map((e=>e.order_id)).join(",");await o.$actionRestore([e]),L({type:"success",message:"Success restoring order"}),i.value=[],await F()},ae=e=>{l.push({name:"easyOfferDetail",params:{buybackId:e.offer_id}})},se=async e=>{try{await o.$actionUpdateFileRequired({is_required:e})}catch(t){console.log(t)}finally{L({type:"success",message:"Success update required file upload"}),await o.$actionGetFileRequired()}};let le=null;B((()=>({category:s.params.category,statusId:s.params.statusId,subStatusId:s.params.subStatusId})),((e,t)=>{le&&clearTimeout(le),"expired"===t.subStatusId&&"expired"!==e.subStatusId&&(o.filters.is_expired=0),le=setTimeout((()=>{F()}),10)}),{deep:!0});let oe=null;return B((()=>({page:o.filters.page,limit:o.filters.limit,search:o.filters.search,barcode:o.filters.barcode,is_require_file:o.filters.is_require_file,is_expired:o.filters.is_expired})),Q(((e,t)=>{oe&&clearTimeout(oe);["search","barcode","limit","status_id","is_expired","buyback"].some((a=>e[a]!==t[a]))&&(o.filters.page=1),"expired"===s.params.subStatusId&&1!==o.filters.is_expired&&(o.filters.is_expired=1),oe=setTimeout((()=>{JSON.stringify(e)!==JSON.stringify(t)&&F()}),10)}),500),{deep:!0}),A((()=>{F()})),D((()=>{le&&clearTimeout(le),oe&&clearTimeout(oe)})),(e,t)=>{const l=b("Tooltip"),c=b("Popover"),m=P("loading");return v(),g(V,null,[t[20]||(t[20]=_("div",{class:"flex items-center gap-4 mb-6"},[_("h5",null,"Easy Offer"),_("div",{class:"px-3 py-1 bg-teal-04 text-white rounded-full flex items-center justify-center box-border text-xs"}," API ")],-1)),h(d,null,{default:S((()=>{var e,a,d,u;return[h(qe,{currentTabId:n.value,statusId:x(s).params.statusId||"all",tabStatuses:r.value},null,8,["currentTabId","statusId","tabStatuses"]),h(Ue,{"onUpdate:customTable":F,table:Z.value,tabStatuses:r.value},null,8,["table","tabStatuses"]),_("div",lt,[h(N,{modelValue:x(o).fileRequired.data,"onUpdate:modelValue":[t[0]||(t[0]=e=>x(o).fileRequired.data=e),se],value:"1","value-off":"0",loading:x(o).fileRequired.isLoading,type:"toggle"},{default:S((()=>t[8]||(t[8]=[$(" Require File Upload ")]))),_:1},8,["modelValue","loading"]),h(l,{placement:"top"},{content:S((()=>t[9]||(t[9]=[_("div",{class:"text-sm w-64"},"When it’s turned on, your customers must include a file when creating an EasyOffer on your front end.",-1)]))),default:S((()=>t[10]||(t[10]=[_("i",{class:"material-icons text-teal-04"},"info",-1)]))),_:1})]),_("div",ot,["active"===x(s).params.category&&i.value.length>0&&G.value&&W.value?(v(),g("div",rt,[h(z,{color:"teal",dense:"",onClick:X},{default:S((()=>t[11]||(t[11]=[$("Change Status")]))),_:1})])):k("",!0),"active"===x(s).params.category&&i.value.length>0?(v(),g("div",it,[h(z,{color:"teal",dense:"",onClick:M,loading:x(o).$state.loading.print.address_label},{default:S((()=>t[12]||(t[12]=[_("i",{class:"material-icons text-lg mr-2"},"print",-1),$(" Print Batch Address Label ")]))),_:1},8,["loading"])])):k("",!0),"active"==x(s).params.category&&i.value.length>0?(v(),g("div",nt,[h(z,{color:"red",dense:"",onClick:E},{default:S((()=>t[13]||(t[13]=[_("i",{class:"material-icons text-lg mr-2"},"archive",-1),$(" Archive All Selected")]))),_:1})])):k("",!0),"archive"==x(s).params.category&&i.value.length>0?(v(),g("div",dt,[h(z,{color:"teal",dense:"",onClick:q},{default:S((()=>t[14]||(t[14]=[_("i",{class:"material-icons text-lg mr-2"},"restore",-1),$(" Restore All Selected")]))),_:1})])):k("",!0)]),R((v(),C(re,{selected:i.value,"onUpdate:selected":t[1]||(t[1]=e=>i.value=e),items:(null==(e=Z.value)?void 0:e.data)||[],headers:(null==(a=Z.value)?void 0:a.header_table)||[],"clickable-row":!0,onRowClick:ae,"item-value":"offer_id",selectable:"",class:"my-4"},{column:S((({row:e,column:a,key:o})=>["offer_id"===o?(v(),g("td",ut,[_("div",ct,[$(w(a)+" ",1),0==e.shipping_label&&1==x(s).params.statusId?(v(),C(c,{key:0,trigger:"hover"},{reference:S((()=>t[15]||(t[15]=[_("div",{class:"text-center ml-2"},[_("i",{class:"material-icons text-orange-04 text-center"},"warning")],-1)]))),default:S((()=>[t[16]||(t[16]=_("span",null,"Shipping label failed to generate",-1))])),_:1})):k("",!0),2==e.shipping_label_status?(v(),C(l,{key:1,placement:"top"},{content:S((()=>t[17]||(t[17]=[_("div",{style:{"max-width":"200px"}}," Unable to generate shipping label due to an error. ",-1)]))),default:S((()=>[t[18]||(t[18]=_("div",{class:"text-center ml-2"},[_("i",{class:"material-icons text-red-base text-center"},"warning")],-1))])),_:1})):k("",!0)])])):"status"===o?(v(),g("td",mt,[h(de,{color:x(ce)(a)},{default:S((()=>[$(w(a),1)])),_:2},1032,["color"])])):Array.isArray(a)?(v(),g("td",pt,[_("ul",ft,[(v(!0),g(V,null,O(a,(e=>(v(),g(V,null,[e?(v(),g("li",yt,[_("span",bt,w(e),1)])):k("",!0)],64)))),256)),e[`${o}_has_more`]?(v(),g("li",vt," ... and more ")):k("",!0)])])):"age_of_order"===o?(v(),g("td",gt,w([a||0,"Day(s)"].join(" ")),1)):"expedited_payout"===o?(v(),g("td",_t,[a?(v(),g("div",ht,[h(me,{class:"text-green-04"}),t[19]||(t[19]=_("span",null,"Expedited Payout",-1))])):(v(),g("span",xt,"-"))])):(v(),g("td",kt,w(a||"-"),1))])),_:1},8,["selected","items","headers"])),[[m,null==(u=null==(d=x(o))?void 0:d.order)?void 0:u.isLoading]]),Z.value&&Z.value.total>x(o).filters.limit?(v(),C(H,{key:0,page:x(o).filters.page,"onUpdate:page":t[2]||(t[2]=e=>x(o).filters.page=e),limit:x(o).filters.limit,"onUpdate:limit":t[3]||(t[3]=e=>x(o).filters.limit=e),data:Z.value},null,8,["page","limit","data"])):k("",!0)]})),_:1}),h(Me,{ref_key:"refBulkStatusForm",ref:T,"model-value":u.value,"onUpdate:modelValue":t[4]||(t[4]=e=>u.value=e),"bulk-status-data":a,"onUpdate:bulkStatusData":t[5]||(t[5]=e=>a=e),"state-option-statuses":x(o).$state.statusOptions.result,"is-bulk-status-large-modal":K.value,"bulk-status-loading":x(o).$state.loading.bulkStatus,onClose:J,onUpdateStatus:Y},null,8,["model-value","bulk-status-data","state-option-statuses","is-bulk-status-large-modal","bulk-status-loading"]),h(Ke,{"model-value":f.value,"onUpdate:modelValue":t[6]||(t[6]=e=>f.value=e),"selected-buybacks":i.value,onArchive:ee},null,8,["model-value","selected-buybacks"]),h(st,{"model-value":I.value,"onUpdate:modelValue":t[7]||(t[7]=e=>I.value=e),"selected-buybacks":i.value,onRestore:te},null,8,["model-value","selected-buybacks"]),h(ue,{onProceed:Y})],64)}}};export{St as default};
