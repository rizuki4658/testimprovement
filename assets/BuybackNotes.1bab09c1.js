import{m as e,o as t,t as o,D as l,w as a,ap as s,U as d,B as i,K as n,n as r,a2 as u,a3 as m,f as c,I as v,y as N,a5 as p,aq as f,a0 as y,A as g}from"./vendor.f1efedad.js";import{u as b}from"./notes.170a2982.js";import{C as _}from"./card.198a6be1.js";import{f as k,b as x,d as w,O as C}from"./index.ec266ec1.js";import{u as h}from"./index.32689823.js";import{r as L}from"./index.05b14cb2.js";import{_ as V}from"./tab.3f85415b.js";const j={key:0},$={key:1},T={class:"space-y-4"},B={__name:"BuybackNotesForm",setup(c,{expose:v}){const N=b(),p=h({note:{required:L}},N.formNotes,{$lazy:!0});return v({validation:p,onSubmit:async()=>(await p.value.$validate(),!p.value.$invalid),onReset:()=>{p.value.$reset()}}),(c,v)=>{const f=e("Tooltip");return t(),o("div",null,[l(V,{modelValue:s(N).formNotes.type,"onUpdate:modelValue":v[0]||(v[0]=e=>s(N).formNotes.type=e),items:s(N).formNotes.tabs,color:"teal",view:"smooth",component:"",disabledItems:""},{title:a((({item:e})=>[l(f,{placement:"top",disabled:!e.disabled},{content:a((()=>["preview"===s(N).formNotes.mode?(t(),o("p",j,"This Tab is disabled because you are in preview mode.")):d("",!0),"edit"===s(N).formNotes.mode?(t(),o("p",$,"This Tab is disabled because you are in edit mode.")):d("",!0)])),default:a((()=>[i("p",null,n(e.name),1)])),_:2},1032,["disabled"])])),_:1},8,["modelValue","items"]),i("div",T,[i("div",null,["preview"===s(N).formNotes.mode?(t(),r(k,{key:0,modelValue:s(N).formNotes.note,"onUpdate:modelValue":v[1]||(v[1]=e=>s(N).formNotes.note=e),type:"textarea",label:"Notes",rows:"6",class:"w-full",readonly:"",view:s(p).note.$invalid?"danger":"default"},null,8,["modelValue","view"])):(t(),r(k,{key:1,modelValue:s(N).formNotes.note,"onUpdate:modelValue":v[2]||(v[2]=e=>s(N).formNotes.note=e),type:"textarea",label:"Notes",rows:"6",class:"w-full",view:s(p).note.$invalid?"danger":"default"},null,8,["modelValue","view"])),(t(!0),o(u,null,m(s(p).note.$errors,((e,l)=>(t(),o("span",{key:l,class:"text-red-base"},n(e.$message)+". ",1)))),128))])])])}}},U={__name:"BuybackNotesAdd",setup(e){const d=b(),n=c(),r=()=>{d.addNotes.modal=!0,d.addNotes.isLoading=!1,d.resetForm(),d.formNotes.type="internal",d.formNotes.mode="add"},m=()=>{d.addNotes.modal=!1,d.addNotes.isLoading=!1,d.resetForm()},N=async()=>{await n.value.onSubmit()&&(await d.$addNotes(),n.value.onReset(),m())};return(e,c)=>(t(),o(u,null,[l(x,{color:"teal",dense:"",onClick:r},{default:a((()=>c[1]||(c[1]=[i("span",{class:"material-icons text-lg"},"add",-1),v(" Add Notes ")]))),_:1}),l(w,{modelValue:s(d).addNotes.modal,"onUpdate:modelValue":c[0]||(c[0]=e=>s(d).addNotes.modal=e),"no-close":s(d).addNotes.isLoading,onClose:m},{header:a((()=>c[2]||(c[2]=[i("h6",{class:"font-medium"},"Create Note",-1)]))),default:a((()=>[l(B,{ref_key:"formAdd",ref:n},null,512)])),footer:a((()=>[l(x,{color:"teal",loading:s(d).addNotes.isLoading,onClick:N},{default:a((()=>c[3]||(c[3]=[v(" Save Note ")]))),_:1},8,["loading"])])),_:1},8,["modelValue","no-close"])],64))}},A={__name:"BuybackNotesDelete",setup(e){const o=b(),d=c({}),n=()=>{d.value={},o.deleteNotes.item=void 0,o.deleteNotes.modal=!1,o.deleteNotes.isLoading=!1,o.resetForm()},u=async()=>{await o.$deleteNotes(),o.deleteNotes.modal=!1};return N((()=>o.deleteNotes.modal),(e=>{var t;e?(d.value=(null==(t=o.deleteNotes)?void 0:t.item)||{},(()=>{var e,t,l;o.formNotes.mode="delete",o.formNotes.type=null==(e=d.value)?void 0:e.type,o.formNotes.note=null==(t=d.value)?void 0:t.note,o.formNotes.id=null==(l=d.value)?void 0:l.id})()):n()})),(e,d)=>(t(),r(w,{modelValue:s(o).deleteNotes.modal,"onUpdate:modelValue":d[0]||(d[0]=e=>s(o).deleteNotes.modal=e),title:"Delete Note",size:"xs",onClose:n},{footer:a((()=>[l(x,{color:"teal",loading:s(o).deleteNotes.isLoading,onClick:u},{default:a((()=>d[1]||(d[1]=[v(" Delete Note ")]))),_:1},8,["loading"])])),default:a((()=>[d[2]||(d[2]=i("p",null,"Are you sure want to delete this note?",-1))])),_:1},8,["modelValue"]))}},D={class:"font-medium"},F={class:"mb-10"},I={class:"-mb-6 -mx-12 px-12 py-6 border-t border-grey-01 flex justify-end"},R={__name:"BuybackNotesEdit",setup(o){const d=b(),u=c(),m=c(""),p=c({}),f=()=>{const e=d.formNotes.tabs.findIndex((e=>{var t;return e.component!==(null==(t=p.value)?void 0:t.type)}));d.formNotes.tabs[e].disabled=!0},y=()=>{m.value="",p.value={},d.editNotes.item=void 0,d.editNotes.modal=!1,d.editNotes.isLoading=!1,d.resetForm()},g=async()=>{var e;await u.value.onSubmit()&&(await d.$editNotes(),null==(e=u.value)||e.onReset(),d.editNotes.modal=!1)};return N((()=>d.editNotes.modal),(e=>{var t,o,l;e?(p.value=(null==(t=d.editNotes)?void 0:t.item)||{},(null==(l=null==(o=d.editNotes)?void 0:o.item)?void 0:l.is_granted)?(()=>{var e,t,o;m.value="Edit Note",d.formNotes.mode="edit",d.formNotes.id=null==(e=p.value)?void 0:e.id,d.formNotes.type=null==(t=p.value)?void 0:t.type,d.formNotes.note=null==(o=p.value)?void 0:o.note,f()})():(()=>{var e,t;m.value="Preview Note",d.formNotes.mode="preview",d.formNotes.type=null==(e=p.value)?void 0:e.type,d.formNotes.note=null==(t=p.value)?void 0:t.note,f()})()):y()})),(o,c)=>{const N=e("Tooltip");return t(),r(w,{modelValue:s(d).editNotes.modal,"onUpdate:modelValue":c[0]||(c[0]=e=>s(d).editNotes.modal=e),"no-close":s(d).editNotes.isLoading,"hide-footer":"",onClose:y},{header:a((()=>[i("h6",D,n(m.value),1)])),default:a((()=>{var e,t;return[i("div",F,[l(B,{ref_key:"formEdit",ref:u},null,512)]),i("div",I,[l(N,{placement:"top-end",disabled:null==(t=null==(e=s(d).editNotes)?void 0:e.item)?void 0:t.is_granted},{content:a((()=>c[1]||(c[1]=[i("p",null,"You cannot edit or delete order notes created by other users.",-1)]))),default:a((()=>{var e,t;return[i("div",null,[l(x,{color:"teal",loading:s(d).editNotes.isLoading,disabled:!(null==(t=null==(e=s(d).editNotes)?void 0:e.item)?void 0:t.is_granted),onClick:g},{default:a((()=>c[2]||(c[2]=[v(" Update Note ")]))),_:1},8,["loading","disabled"])])]})),_:1},8,["disabled"])])]})),_:1},8,["modelValue","no-close"])}}},H={class:"space-y-3"},M={class:"notes space-y-4"},S={class:"flex items-center flex-wrap flex-row justify-between gap-2"},E={class:"small font-medium"},Y={class:"flex items-center gap-x-2"},q=["innerHTML"],z={key:1,class:"flex items-center justify-center p-12 bg-grey-lighten rounded-md"},K={__name:"BuybackNotesInternal",setup(d){const c=b(),v=e=>{c.editNotes.item=e,c.editNotes.modal=!0,c.editNotes.isLoading=!1};return(d,N)=>{var p,f;const y=e("Tooltip");return t(),o("div",H,[N[5]||(N[5]=i("p",null,"Internal Notes",-1)),(null==(f=null==(p=s(c).getNotes)?void 0:p.internal)?void 0:f.length)?(t(),o(u,{key:0},[(t(!0),o(u,null,m(s(c).getNotes.internal,((e,d)=>(t(),o("div",{key:d},[i("div",M,[i("div",S,[i("p",E,"By "+n(e.admin.name)+" - "+n(e.created_at),1),i("div",Y,[(null==e?void 0:e.is_granted)?(t(),r(x,{key:0,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>N[0]||(N[0]=[i("span",{class:"material-icons text-lg"},"edit",-1)]))),_:2},1032,["onClick"])):(t(),r(x,{key:1,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>N[1]||(N[1]=[i("span",{class:"material-icons text-lg"},"visibility",-1)]))),_:2},1032,["onClick"])),l(y,{placement:"top",disabled:null==e?void 0:e.is_granted},{content:a((()=>N[2]||(N[2]=[i("p",{class:"max-w-xs"},"You cannot edit or delete order notes created by other users.",-1)]))),default:a((()=>[i("div",null,[l(x,{color:"red",disabled:!(null==e?void 0:e.is_granted),dense:"",onClick:t=>(e=>{c.deleteNotes.item=e,c.deleteNotes.modal=!0,c.deleteNotes.isLoading=!1})(e)},{default:a((()=>N[3]||(N[3]=[i("span",{class:"material-icons text-lg"},"delete",-1)]))),_:2},1032,["disabled","onClick"])])])),_:2},1032,["disabled"])])]),i("div",{class:"block",innerHTML:s(C)(e.note)},null,8,q)])])))),128)),l(R),l(A)],64)):(t(),o("div",z,N[4]||(N[4]=[i("span",null,"Nothing to see here",-1)])))])}}},O={class:"space-y-3"},P={class:"notes space-y-4"},G={class:"flex items-center flex-wrap flex-row justify-between gap-2"},J={class:"small font-medium"},Q={class:"flex items-center gap-x-2"},W=["innerHTML"],X={key:1,class:"flex items-center justify-center p-12 bg-grey-lighten rounded-md"},Z={__name:"BuybackNotesCustomer",setup(d){const c=b(),v=e=>{c.editNotes.item=e,c.editNotes.modal=!0,c.editNotes.isLoading=!1};return(d,N)=>{var p,f;const y=e("Tooltip");return t(),o("div",O,[N[5]||(N[5]=i("p",null,"Customer Notes",-1)),(null==(f=null==(p=s(c).getNotes)?void 0:p.customer)?void 0:f.length)?(t(),o(u,{key:0},[(t(!0),o(u,null,m(s(c).getNotes.customer,((e,d)=>(t(),o("div",{key:d},[i("div",P,[i("div",G,[i("p",J,"By "+n(e.admin.name)+" - "+n(e.created_at),1),i("div",Q,[(null==e?void 0:e.is_granted)?(t(),r(x,{key:0,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>N[0]||(N[0]=[i("span",{class:"material-icons text-lg"},"edit",-1)]))),_:2},1032,["onClick"])):(t(),r(x,{key:1,color:"teal",dense:"",onClick:t=>v(e)},{default:a((()=>N[1]||(N[1]=[i("span",{class:"material-icons text-lg"},"visibility",-1)]))),_:2},1032,["onClick"])),l(y,{placement:"top",disabled:null==e?void 0:e.is_granted},{content:a((()=>N[2]||(N[2]=[i("p",{class:"max-w-xs"},"You cannot edit or delete order notes created by other users.",-1)]))),default:a((()=>[i("div",null,[l(x,{color:"red",disabled:!(null==e?void 0:e.is_granted),dense:"",onClick:t=>(e=>{c.deleteNotes.item=e,c.deleteNotes.modal=!0,c.deleteNotes.isLoading=!1})(e)},{default:a((()=>N[3]||(N[3]=[i("span",{class:"material-icons text-lg"},"delete",-1)]))),_:2},1032,["disabled","onClick"])])])),_:2},1032,["disabled"])])]),i("div",{class:"block",innerHTML:s(C)(e.note)},null,8,W)])])))),128)),l(R),l(A)],64)):(t(),o("div",X,N[4]||(N[4]=[i("span",null,"Nothing to see here",-1)])))])}}},ee={class:"flex items-center justify-between gap-4"},te={class:"grid md:grid-cols-2 gap-4"},oe={__name:"BuybackNotes",props:{isReadonly:!1,isDeleted:!1},async setup(e){let d,n;const u=p(),m=b();return m.$setRoute(u.params),[d,n]=f((()=>m.$getNotes())),await d,n(),(e,d)=>{const n=y("loading");return t(),r(_,null,{header:a((()=>[i("div",ee,[d[0]||(d[0]=i("h6",{class:"font-medium"},"Notes",-1)),l(U)])])),default:a((()=>[g((t(),o("div",te,[l(K),l(Z)])),[[n,s(m).getNotes.isLoading]])])),_:1})}}};export{oe as default};
