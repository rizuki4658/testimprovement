var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,r=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&o(e,a,t[a]);if(i)for(var a of i(t))l.call(t,a)&&o(e,a,t[a]);return e},s=(e,i)=>t(e,a(i));import{u as c,s as d,v as u,W as p,X as h}from"./index.67cab78b.js";import{n as v,f}from"./date.f86face7.js";import{a as m}from"./dymo.ee3e0c83.js";import{r as g,g as y,h as w,f as b}from"./vendor.9695fe57.js";const C=()=>{const e=g({logo:null,company_email:null,name:null,email_sender:null,address:null,phone:null,city:null,state:null,zip:null,country:null,address_text:null}),t=g({show:!1,update:!1});return{data:e,loading:t,actionShow:async(a=(()=>{}))=>{t.show=!0;((t={})=>{e.logo=t.logo||null,e.company_email=t.company_email||null,e.name=t.name||null,e.email_sender=t.email_sender||null,e.address=t.address||null,e.phone=t.phone||null,e.city=t.city||null,e.state=t.state||null,e.zip=t.zip||null,e.country=t.country||null,e.address_text=t.address_text||null})(await d.dispatch("setting/companyProfile/show")),u(a)&&a(),t.show=!1},actionUpdate:async(a=(()=>{}))=>{t.update=!0,await d.dispatch("setting/companyProfile/showUpdate",e),u(a)&&a(),t.update=!1}}},_=()=>{const{me:e,dateByTimezone:t}=c(),a=g({page:1,limit:10,search:"",payment_method:[],from:null,to:null,date:null}),i=y((()=>d.state.report.userShippingLabel.all)),n=g({all:!1,update:!1,print:{shipping_kit:!1,address_label:!1}}),l=y((()=>{var t,i;return[{id:"payment_method",name:"Payout Method",value:a.payment_method?a.payment_method.join(", "):null,default:[]},{id:"date",name:"Date",value:a.date?`${w(a.date[0]).format(null==(t=e.value)?void 0:t.date_format)} - ${w(a.date[1]).format(null==(i=e.value)?void 0:i.date_format)}`:null,default:null},{id:"shipping_courier",name:"Courier",value:a.shipping_courier?a.shipping_courier.join(", "):null,default:[]}]})),o=y((()=>l.value.filter((e=>e.value)).length>0)),h=b(null),v=g({disabledDate:e=>e.getTime()>t.value.getTime()});let C=!1;return{data:a,state:i,loading:n,filterDateOptions:v,filterDateRef:h,isFiltered:o,filterList:l,filterDateFocus:()=>{C?C=!1:(C=!0,h.value.focus())},clearFilter:e=>{if(!a.hasOwnProperty(e.id))return!1;a[e.id]=e.default},clearAllFilter:()=>{for(let e of l.value)a[e.id]=e.default},actionAll:async(e=(()=>{}))=>{try{n.show=!0;const t=Object.assign({},s(r({},a),{from:a.date&&f(a.date[0])||null,to:a.date&&f(a.date[1])||null,is_affiliate:0}));delete t.date;const i=await d.dispatch("report/userShippingLabel/all",t);u(e)&&e(i)}finally{n.show=!1}},actionBatchStatusPrintUpdate:async(e,t=(()=>{}))=>{try{n.update=!0;const a=JSON.stringify(e.map((e=>e.offer_id))),i=Object.assign({},{ids:a}),l=await d.dispatch("report/userShippingLabel/addressLabelPrintStatusBatchUpdate",i);u(t)&&t(l)}finally{n.update=!1}},actionBatchPrintShippingKit:async(e,t=(()=>{}))=>{try{n.print.shipping_kit=!0;const a=JSON.stringify(e.map((e=>e.offer_id))),i=Object.assign({},{ids:a}),l=await d.dispatch("report/userShippingLabel/shippingKitPrintBatch",i);p(l),u(t)&&t()}finally{n.print.shipping_kit=!1}},actionBatchPrintAddressLabel:async(e,t=(()=>{}))=>{try{n.print.address_label=!0;const a=JSON.stringify(e.map((e=>e.offer_id))),i=Object.assign({},{ids:a}),l=await d.dispatch("report/userShippingLabel/addressLabelPrintBatch",i);let o=[];l.forEach(((e,t)=>{o[t]={fullname:"",addressComponent:""},o[t].fullname=`${e.billing_firstname||""} ${e.billing_lastname||""}`,o[t].address_component=`${e.billing_address1?e.billing_address1.toUpperCase():""}\n${e.billing_city?e.billing_city.toUpperCase():""} ${e.billing_state?e.billing_state.toUpperCase():""} ${e.billing_zip?e.billing_zip.toUpperCase():""}`,o[t].imb=e.imb||""})),m(o),u(t)&&t()}finally{n.print.address_label=!1}}}},D=()=>{const{me:e,dateByTimezone:t}=c(),a=g({show:null}),i=g({show:!1,print:{},csv:!1}),n=(e=null,t=!1)=>{i.print[e]=t},l=g({page:1,limit:10,search:"",from:null,to:null,sort_by:"",order_by:"",date:[],buyback_type:"2"}),o=y((()=>{var t,a,i;return[{id:"date",name:"Date",value:Array.isArray(l.date)&&(null==(t=l.date)?void 0:t.length)?`${w(l.date[0]).format(null==(a=e.value)?void 0:a.date_format)} - ${w(l.date[1]).format(null==(i=e.value)?void 0:i.date_format)}`:null,default:null}]})),v=y((()=>o.value.filter((e=>e.value)).length>0)),m=b(null),C=g({disabledDate:e=>e.getTime()>t.value.getTime()});let _=!1;return{state:a,data:l,loading:i,filterList:o,isFiltered:v,filterDateOptions:C,filterDateRef:m,clearFilter:e=>{if(!l.hasOwnProperty(e.id))return!1;l[e.id]=e.default},clearAllFilter:()=>{for(let e of o.value)l[e.id]=e.default},filterDateFocus:()=>{_?_=!1:(_=!0,m.value.focus())},actionShow:async(e=(()=>{}))=>{i.show=!0;let t=r({},l);t.date&&(t.from=f(t.date[0])||null,t.to=f(t.date[1])||null),delete t.date,await d.dispatch("report/local/showCheckRegister",t),a.show=d.state.report.local.show.checkRegister,u(e)&&e(),i.show=!1},actionPrintCheck:async(e,t=(()=>{}))=>{n(e,!0);try{const a=await d.dispatch("report/printCheck",e);p(a),u(t)&&t()}catch(a){console.warn(a)}n(e,!1)},downloadCSV:async(e,t=(()=>{}))=>{try{i.csv=!0;const e=await d.dispatch("report/local/checkRegisterCSV",s(r({},l),{from:l.date?f(l.date[0])||null:"",to:l.date?f(l.date[1])||null:""}));h(e,"check-register-csv","text/csv"),u(t)&&t()}finally{i.csv=!1}}}},O=()=>{const e=g({show:!1,update:!1,preview:!1,print:!1}),t=g({});return{data:t,loading:e,actionShow:async(a=(()=>{}))=>{e.show=!0;const i=await d.dispatch("setting/checkSetting/showCheckSetting");var n;n=i,Object.assign(t,n),u(a)&&a(),e.show=!1},actionUpdate:async(t,a=(()=>{}))=>{e.update=!0;try{await d.dispatch("setting/checkSetting/updateCheckSetting",t),u(a)&&a()}catch(i){console.warn(i)}e.update=!1},actionPrintTest:async(t="local",a=(()=>{}))=>{e.print=!0;try{let e=null;e="online"==t?await d.dispatch("setting/checkSetting/onlineCheckPreview"):await d.dispatch("setting/checkSetting/localCheckPreview"),p(e),u(a)&&a()}catch(i){console.warn(i)}e.print=!1},actionCheckPreview:async(t="local")=>{try{e.preview=!0;let a=null;a="online"==t?await d.dispatch("setting/checkSetting/onlineCheckPreview"):await d.dispatch("setting/checkSetting/localCheckPreview");const i=new Blob([a],{type:"application/pdf"});let n=window.URL.createObjectURL(i),l=window["pdfjs-dist/build/pdf"];l.GlobalWorkerOptions.workerSrc="//mozilla.github.io/pdf.js/build/pdf.worker.js",l.getDocument(n).promise.then((function(e){e.getPage(1).then((function(e){let t=e.getViewport({scale:1.5}),a=document.getElementById("the-canvas"),i=a.getContext("2d");a.height=400,a.width=t.width,a.style.border="solid 1px rgba(0,0,0,0.1)";let n={canvasContext:i,viewport:t};e.render(n)}))}),(function(e){console.error(e)}))}catch(a){console.warn(a)}finally{e.preview=!1}}}},R=()=>{const{dateByTimezone:e}=c(),t=b(null),a=b(null),i=b(!1),n=b(!1),l=g({all:!1,chart:!1,device:{show:[]},filters:!1,chartFilters:!1}),o=b(2),p=b(0),h=g([{name:"Today",value:{from:e.value,to:e.value}},{name:"Yesterday",value:{from:new Date(e.value.getTime()-v(e.value).yesterday),to:e.value}},{name:"Last 7 Days",value:{from:new Date(e.value.getTime()-v(e.value).weekAgo),to:e.value}},{name:"Last 30 Days",value:{from:new Date(e.value.getTime()-v(e.value).monthAgo),to:e.value}},{name:"Last 90 Days",value:{from:new Date(e.value.getTime()-3*v(e.value).monthAgo),to:e.value}}]),m=g([{name:"Last 7 Days",value:{from:new Date(e.value.getTime()-v(e.value).weekAgo),to:e.value}},{name:"Last 30 Days",value:{from:new Date(e.value.getTime()-v(e.value).monthAgo),to:e.value}},{name:"Last 90 Days",value:{from:new Date(e.value.getTime()-3*v(e.value).monthAgo),to:e.value}}]),w=g({from:m[0].value.from,to:m[0].value.to,source:[],device:[],model:[],is_mailin:0}),C=g({from:h[2].value.from,to:h[2].value.to,source:[],search:null,page:1,limit:10}),_=g({disabledDate:t=>t.getTime()>e.value.getTime()}),D=y((()=>d.state.report.conversionRate.conversionRateChart)),O=y((()=>d.state.report.conversionRate.conversionRateDevices)),R=y((()=>d.state.report.conversionRate.conversionRateChartFilters)),S=y((()=>d.state.report.conversionRate.conversionRateFilters));return{loading:l,conversionRateFilters:C,conversionRateChartFilters:w,stateConversionRateChart:D,stateConversionRateDevices:O,stateConversionRateChartFilters:R,stateConversionRateFilters:S,selectedDateRangeOptionIndex:o,selectedDateRangeOptionChartIndex:p,dateRangeOptions:h,chartDateRangeOptions:m,datePickerOptions:_,refDatePicker:t,refChartDatePicker:a,actionConversionRateChart:async(e=(()=>{}))=>{try{l.chart=!0;const t=Object.assign({},s(r({},w),{from:f(w.from),to:f(w.to),source:w.source.includes("all")?JSON.stringify(["all"]):JSON.stringify(w.source),device:JSON.stringify(w.device),model:JSON.stringify(w.model)}));await d.dispatch("report/conversionRate/showConversionRateChart",t),u(e)&&e()}finally{l.chart=!1}},actionConversionRateDevices:async(e=(()=>{}))=>{try{l.all=!0;const t=Object.assign({},s(r({},C),{from:f(C.from),to:f(C.to),source:C.source.includes("all")?JSON.stringify(["all"]):JSON.stringify(C.source)}));await d.dispatch("report/conversionRate/showConversionRateDevices",t),u(e)&&e()}finally{l.all=!1}},actionConversionRateDeviceShow:async(e,t="[]",a=(()=>{}))=>{try{l.device.show.push(e);const i={from:f(C.from),to:f(C.to),source:JSON.stringify(C.source),array_sources:t},n=await d.dispatch("report/conversionRate/showConversionRateDeviceDetail",{id:e,params:i});u(a)&&a(n)}finally{const t=l.device.show.findIndex((t=>t===e));-1!==t&&l.device.show.splice(t,1)}},actionConversionRateChartFilters:async(e=(()=>{}))=>{l.chartFilters=!0;try{const t={from:f(w.from),to:f(w.to),device:JSON.stringify(w.device),source:JSON.stringify(w.source)};await d.dispatch("report/conversionRate/showConversionRateChartFilters",t),u(e)&&e()}finally{l.chartFilters=!1}},actionConversionRateFilters:async(e=(()=>{}))=>{l.filters=!0;try{const t={from:f(C.from),to:f(C.to),source:JSON.stringify(C.source)};await d.dispatch("report/conversionRate/showConversionRateFilters",t),u(e)&&e()}finally{l.filters=!1}},setSelectedDateRangeOption:e=>{o.value=e;const t=h[e],{from:a,to:i}=t.value;C.from=a,C.to=i},setSelectedDateRangeOptionChart:e=>{p.value=e;const t=m[e],{from:a,to:i}=t.value;w.from=a,w.to=i},datePickerFocus:()=>{i.value?i.value=!1:(i.value=!0,t.value.focus())},datePickerSelected:([e,t])=>{i.value=!1,o.value=null,C.from=e,C.to=t},chartDatePickerFocus:()=>{n.value?n.value=!1:(n.value=!0,a.value.focus())},chartDatePickerSelected:([e,t])=>{i.value=!1,p.value=null,w.from=e,w.to=t}}};export{D as a,R as b,O as c,C as d,_ as u};
