var e=Object.defineProperty,i=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(i,a,l)=>a in i?e(i,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[a]=l,d=(e,i)=>{for(var a in i||(i={}))t.call(i,a)&&o(e,a,i[a]);if(l)for(var a of l(i))n.call(i,a)&&o(e,a,i[a]);return e},s=(e,l)=>i(e,a(l));import{u as r}from"./components.0003aa88.js";import{N as c,g as u,a5 as p,f as m,y as v,m as g,a0 as y,o as f,t as h,A as b,n as _,ap as x,Z as C,w,B as k,D as S,K as P,I as V,U,a2 as A,k as M,r as I,W as B,F as T,T as j,a3 as L,a4 as D,aO as E,Q as O,v as R,S as $,_ as F,O as N,as as H,z as q,au as z,aF as G,q as J,G as W,s as Y}from"./vendor.f1efedad.js";import{_ as Z,av as K,u as Q,a4 as X,b as ee,d as ie,f as ae,aw as le,S as te,ax as ne,r as oe,g as de,s as se,v as re,O as ce,aj as ue,e as pe,ay as me,Q as ve,at as ge,P as ye,j as fe,az as he,aA as be,aB as _e,R as xe,aC as Ce,aD as we,am as ke,aE as Se,aF as Pe,h as Ve,aG as Ue,aq as Ae,aH as Me}from"./index.9aa6481b.js";import{c as Ie}from"./dashboard.b0a370a4.js";import{E as Be}from"./expandable-panel.4fc35914.js";import{S as Te}from"./SelectCountry.3e7bff58.js";import{S as je}from"./SelectCurrency.a37b235f.js";import{u as Le}from"./setting.2daa7691.js";import{_ as De}from"./catalog-not-found.379a4c88.js";import{u as Ee}from"./index.32689823.js";import{c as Oe,m as Re}from"./index.05b14cb2.js";import{r as $e}from"./index.a87b789d.js";import{s as Fe}from"./vue-multiselect.esm.ac3ecea1.js";import{_ as Ne}from"./fieldset.49a14fc7.js";import{V as He}from"./vue-draggable-next.esm-bundler.0ebea46e.js";import"./chart.b16d9eb5.js";import{S as qe}from"./select.15c77568.js";import{C as ze}from"./Currency.ae08941b.js";import{_ as Ge}from"./pricing-source-custom.49e72213.js";import{B as Je}from"./BDropdown.7a2c3a7d.js";import{F as We}from"./FileUpload.4137f086.js";import"./LoadingCard.be59eb97.js";import"./card.dfb8e6f7.js";import"./date.f86face7.js";const Ye={class:"text-sm"},Ze={key:0},Ke={key:1},Qe={key:2},Xe={key:3,class:"w-60 text-xs"},ei={key:0,class:"w-60 text-xs"},ii={key:1,class:"w-60 text-xs"},ai={key:3},li={class:"flex items-center justify-center flex-col gap-y-8 my-6 -mx-8"},ti={class:"space-y-2 text-center max-w-lg"},ni={class:"font-semibold text-xl"},oi={class:"text-sm text-grey-03"},di={key:0,class:"text-sm text-grey-03"},si={class:"flex items-center justify-center gap-x-4"};var ri=Z({__name:"SyncPricing",props:{is_available:Number|String,loading:{type:Boolean,default:!1},isSyncable:Number|String,modelValue:{type:[Number,Boolean,String],default:0},tooltip:{type:Boolean,default:!1},item:{type:Object,default:()=>{}},disabled:{type:Boolean,default:!1},priceSharing:{type:Boolean,default:!1},priceScraper:{type:Boolean,default:!1},disabledAction:{type:Object,default:void 0}},emits:["update:modelValue","loaded-price"],setup(e,{emit:i}){const a=e,l=i,t=p(),{loading:n,actionAll:o,actionSetLevel:d,actionManualPrice:s}=K(t.params.tab),r=m({title:{disable_category:"Disable Price Sync for all Items in this Category?",disable_child:"Disable Price Sync for this Items?",enable_category:"Enable Price Sync for all Items in this Category?",enable_child:"Enable Price Sync for this Items"},description:{disable_category:"Warning! Proceeding will require manual price updates for all items in this category. You will retain the most recently synced prices until then.",disable_child:"Warning! Proceeding will require manual price updates for this items. You will retain the most recently synced prices until then.",enable_category:"Warning! If you proceed, any manually set prices for items in this category will be overridden.",enable_child:"Warning! If you proceed, any manually set prices for this items will be overridden."}}),c=u((()=>{var e,i,l,t;return 1==D.value?{desc:(null==(e=a.item)?void 0:e.is_child)?r.value.description.enable_child:r.value.description.enable_category,title:(null==(i=a.item)?void 0:i.is_child)?r.value.title.enable_child:r.value.title.enable_category}:{desc:(null==(l=a.item)?void 0:l.is_child)?r.value.description.disable_child:r.value.description.disable_category,title:(null==(t=a.item)?void 0:t.is_child)?r.value.title.disable_child:r.value.title.disable_category}})),M=u((()=>{a.tooltip&&(a.item.total_device_manual>0||a.item.total_device_sync)})),I=u((()=>a.modelValue?1:a.isSyncable)),{me:B}=Q(),T=u((()=>3==B.value.is_price_sharing)),j=u((()=>B.value.sub_domain_linked)),L=m(!1),D=m(a.modelValue);m([]);const E=u((()=>{if(!a.item)return!1;return("device"===d(a.item)||a.item.model_as_device)&&a.item.total_device_sync>0&&a.item.total_device_manual>0})),O=u((()=>a.loading||n.all||n.manual_price)),R=u((()=>{var e,i,l;return null!==j.value?0==(null==(e=a.item)?void 0:e.is_syncable):!j.value&&0==(null==(i=a.item)?void 0:i.is_syncable)&&!(null==(l=a.item)?void 0:l.is_price_sync)})),$=async e=>{var i,l,t,n,o,d,r,c;let u=!1;1!=e||!(null==(i=a.item)?void 0:i.sync_with_multiple_source)&&(E.value||(null==(l=a.item)?void 0:l.sync_with_multiple_source))||await s({category_id:a.item.id},((e,i)=>{var a;e||(u=null!=(a=null==i?void 0:i.is_price_exist)&&a)})),D.value=E.value&&!(null==(t=a.item)?void 0:t.sync_with_multiple_source)?0:e;const p=!(null==(n=a.item)?void 0:n.is_price_sync)&&(null==(d=null==(o=a.item)?void 0:o.conditions)?void 0:d.length)?null==(c=[...null==(r=a.item)?void 0:r.conditions])?void 0:c.filter((e=>!isNaN(e.condition_sub_value)&&parseFloat(e.condition_sub_value)>0)):[];(a.item.is_price_sync||(null==p?void 0:p.length)||!a.item.is_child&&a.item.total_device_manual&&a.item.total_device_sync||u)&&!a.priceSharing?L.value=!0:N()},F=()=>{L.value=!1,D.value=Number(!D.value)},N=()=>{L.value=!1,l("update:modelValue",Number(D.value))};return v((()=>a.modelValue),(e=>D.value=e)),(i,a)=>{const l=g("Tooltip"),t=y("loading");return f(),h(A,null,[e.disabledAction.priceUploadByProgress?b((f(),_(x(C),{key:0,modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e),disabled:"",color:"teal","true-label":1,"false-label":0},null,8,["modelValue"])),[[t,O.value]]):I.value?(f(),_(l,{key:1,placement:"top",disabled:!M.value&&!R.value},{content:w((()=>[k("div",Ye,[R.value||!e.item.total_device_manual||e.item.total_device_sync?R.value||e.item.total_device_manual||!e.item.total_device_sync?!R.value&&e.item.total_device_manual&&e.item.total_device_sync?(f(),h("p",Qe," Not all items in this category are price-synced. ")):(f(),h("p",Xe," There are currently no pricing sources available for this item. You can price it manually by using the dropdown menu. ")):(f(),h("p",Ke," All items in this category are price-synced. ")):(f(),h("p",Ze," All Items Manually Priced "))])])),default:w((()=>[k("div",null,[b(S(x(C),{modelValue:D.value,"onUpdate:modelValue":a[1]||(a[1]=e=>D.value=e),disabled:R.value||T.value&&!D.value,color:"teal",indeterminate:!!E.value,"true-label":1,"false-label":0,onChange:$},null,8,["modelValue","disabled","indeterminate"]),[[t,O.value]])])])),_:1},8,["disabled"])):(f(),_(l,{key:2,placement:"top",disabled:e.priceSharing},{content:w((()=>[e.priceScraper?(f(),h("div",ii,"Accounts designated as scrapers cannot sync with the pricing source.")):(f(),h("div",ei,"There are currently no pricing sources available for this item. You can price it manually by using the dropdown menu."))])),default:w((()=>[b(S(x(C),{color:"teal","true-label":"1","false-label":"0",disabled:""},null,512),[[t,O.value]])])),_:1},8,["disabled"])),e.priceSharing||e.disabledAction.priceUploadByProgress?U("",!0):(f(),h("div",ai,[S(ie,{modelValue:L.value,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value=e),"hide-header":"","hide-footer":"",size:"xs"},{default:w((()=>[k("div",li,[a[5]||(a[5]=k("img",{src:X},null,-1)),k("div",ti,[k("p",ni,P(c.value.title),1),k("p",oi,P(c.value.desc),1),!e.item.is_child&&e.item.total_device_manual&&e.item.total_device_sync?(f(),h("p",di,[a[3]||(a[3]=V(" Currently ")),k("b",null,P(e.item.total_device_sync)+" "+P(e.item.total_device_sync>1?"Items":"Item")+" price synced, "+P(e.item.total_device_manual)+" "+P(e.item.total_device_manual>1?"Items":"Item")+" manually priced ",1)])):U("",!0)]),k("div",si,[S(ee,{color:"teal",onClick:N},{default:w((()=>[V(" Yes, "+P(1==D.value?"Enable":"Disable"),1)])),_:1}),S(ee,{color:"teal",view:"smooth",onClick:F},{default:w((()=>a[4]||(a[4]=[V(" Cancel ")]))),_:1})])])])),_:1},8,["modelValue"])]))],64)}}},[["__scopeId","data-v-322dd3c3"]]);const ci=M({name:"BulkPriceEditorInput",components:{Input:ae,Button:ee},props:{data:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},isAutomatedPrice:{type:[Boolean,Number],default:!1},hasPricingSource:{type:Boolean,default:!1}},emits:["input","focusOut","setCustomPrice","unsetCustomPrice","resetCustomPrice","saveCustomPrice","setOriginalPrice"],setup(e,{emit:i}){const a=m(!1),l=m(null),{me:t}=Q(),n=I(e.data),o=u((()=>{var i;return!!(n.index>-1&&Array.isArray(null==(i=null==n?void 0:n.row)?void 0:i.price))&&(e.isAutomatedPrice&&1===n.row.price[n.index].is_custom_price)}));return B((()=>{e.isAutomatedPrice&&i("setOriginalPrice")})),v((()=>e.data),(e=>{n.row.price[n.index].original_price||i("setOriginalPrice"),Object.assign(n,e)})),{isVisible:l,tooltipShow:a,isPriceSyncCustomPrice:o,deviceUpdate:(l,t,n)=>{var o,d;a.value=!1,e.isAutomatedPrice||(null==(o=null==l?void 0:l.price[t])?void 0:o.original_price)!=(null==(d=null==l?void 0:l.price[t])?void 0:d.price)&&i("focusOut",{row:l,index:t,item:n,isSync:e.isAutomatedPrice})},currencies:le,data:n,me:t}}}),ui={key:0,class:"flex items-stretch"},pi={class:"relative flex-grow"},mi={class:"max-w-md text-sm"},vi={key:0,class:"material-icons text-green-04 absolute left-10 top-1/2 text-2xl transform -translate-y-1/2"},gi={class:"max-w-sm"},yi={key:0,class:"flex items-stretch"},fi={key:0,class:"flex item-stretch"},hi={key:0,class:"flex items-stretch"},bi={key:0,class:"flex item-stretch"},_i={key:1,class:"flex items-stretch"},xi={class:"relative flex-grow"},Ci={class:"max-w-xs text-sm"};var wi=Z(ci,[["render",function(e,i,a,l,t,n){var o,d;const s=g("Input",!0),r=g("Tooltip"),c=g("Button");return(null==(d=null==(o=e.data.row)?void 0:o.price)?void 0:d.length)?(f(),h("div",ui,[k("div",pi,[S(r,{modelValue:e.tooltipShow,"onUpdate:modelValue":i[5]||(i[5]=i=>e.tooltipShow=i),placement:"top",manual:""},{content:w((()=>[k("p",mi,"Items priced at "+P(1==e.me.currency_prefix?`${e.me.currency_symbol}0`:`0${e.me.currency_symbol}`)+" are not subject to pricing rules.",1)])),default:w((()=>[S(s,{tabindex:"0",modelValue:e.data.row.price[e.data.index].price,"onUpdate:modelValue":i[0]||(i[0]=i=>{e.data.row.price[e.data.index].price=i,e.$emit("setCustomPrice")}),type:"number",class:T(["w-full",e.isPriceSyncCustomPrice?"input--custom-priced":""]),disabled:e.disabled||e.data.row.price[e.data.index].loading,view:e.data.row.price[e.data.index].success?"success":"default",loading:e.data.row.price[e.data.index].loading,currency:!0,onMouseenter:i[1]||(i[1]=i=>e.isVisible=e.disabled),onMouseleave:i[2]||(i[2]=i=>e.isVisible=!1),onFocusOut:i[3]||(i[3]=i=>e.deviceUpdate(e.data.row,e.data.index,e.data.items)),onFocusIn:i[4]||(i[4]=i=>e.tooltipShow=!0),icon:""},{icon:w((()=>[V(P(e.me.currency_symbol),1)])),_:1},8,["modelValue","class","disabled","view","loading"])])),_:1},8,["modelValue"]),S(j,{name:"slide-fade"},{default:w((()=>[e.data.row.price[e.data.index].success?(f(),h("span",vi,"done")):U("",!0)])),_:1}),e.isPriceSyncCustomPrice&&e.data.row.price[e.data.index].last_update?(f(),_(r,{key:0,placement:"top"},{content:w((()=>[k("div",gi," Manually updated on "+P(e.data.row.price[e.data.index].last_update),1)])),default:w((()=>i[12]||(i[12]=[k("i",{class:"material-icons absolute right-4 top-1/2 transform -translate-y-1/2 text-teal-04"},"info",-1)]))),_:1})):U("",!0)]),e.isAutomatedPrice?(f(),h("div",yi,[0===e.data.row.price[e.data.index].is_custom_price?(f(),_(j,{key:0,name:"slide-fade"},{default:w((()=>[e.data.row.price[e.data.index].is_editable_custom_price?U("",!0):(f(),h("div",fi,[e.data.row.price[e.data.index].price>0?(f(),_(c,{key:0,onClick:i[6]||(i[6]=i=>e.$emit("setCustomPrice")),class:"mx-2",color:"teal",dense:"",view:"outlined",style:{"border-color":"#dddddd !important"}},{default:w((()=>i[13]||(i[13]=[k("div",{class:"p-1"},[k("i",{class:"material-icons"},"edit")],-1)]))),_:1})):(f(),_(r,{key:1,placement:"left"},{content:w((()=>i[15]||(i[15]=[k("div",{class:"max-w-lg"}," Manual pricing required: Conditions priced at $0 must be manually priced to be visible to your customers. ",-1)]))),default:w((()=>[S(c,{onClick:i[7]||(i[7]=i=>e.$emit("setCustomPrice")),class:"mx-2",color:"red",dense:"",view:"outlined"},{default:w((()=>i[14]||(i[14]=[k("div",{class:"p-1"},[k("i",{class:"material-icons"},"edit")],-1)]))),_:1})])),_:1}))]))])),_:1})):(f(),_(j,{key:1,name:"slide-fade"},{default:w((()=>[e.data.row.price[e.data.index].is_editable_custom_price?U("",!0):(f(),h("div",hi,[e.isAutomatedPrice?(f(),_(c,{key:0,onClick:i[8]||(i[8]=i=>e.$emit("resetCustomPrice")),loading:e.data.row.price[e.data.index].loading,color:"red",class:"mx-2",dense:""},{default:w((()=>i[16]||(i[16]=[k("div",{class:"p-1"},[k("i",{class:"material-icons"},"delete")],-1)]))),_:1},8,["loading"])):U("",!0)]))])),_:1})),S(j,{name:"slide-fade"},{default:w((()=>[1===e.data.row.price[e.data.index].is_editable_custom_price?(f(),h("div",bi,[S(c,{onClick:i[9]||(i[9]=i=>e.$emit("saveCustomPrice")),loading:e.data.row.price[e.data.index].loading,class:"mx-2",color:"teal",dense:""},{default:w((()=>i[17]||(i[17]=[k("div",{class:"p-1"},[k("i",{class:"material-icons"},"check")],-1)]))),_:1},8,["loading"]),S(c,{onClick:i[10]||(i[10]=i=>e.$emit("unsetCustomPrice")),disabled:e.data.row.price[e.data.index].loading,color:"red",dense:""},{default:w((()=>i[18]||(i[18]=[k("div",{class:"p-1"},[k("i",{class:"material-icons"},"close")],-1)]))),_:1},8,["disabled"])])):U("",!0)])),_:1})])):U("",!0)])):(f(),h("div",_i,[k("div",xi,[S(r,{modelValue:e.tooltipShow,"onUpdate:modelValue":i[11]||(i[11]=i=>e.tooltipShow=i),trigger:"focus",placement:"top",manual:""},{content:w((()=>[k("p",Ci,"Items priced at "+P(1==e.me.currency_prefix?`${e.me.currency_symbol}0`:`0${e.me.currency_symbol}`)+" are not subject to pricing rules.",1)])),default:w((()=>[S(s,{class:"w-full",disabled:"",currency:!0,icon:""},{icon:w((()=>[V(P(e.me.currency_symbol),1)])),_:1})])),_:1},8,["modelValue"])])]))}]]);const ki=M({name:"BulkPriceEditorMappingMethodMethods",props:{modelValue:{type:[Number,String],default:void 0},sources:{type:Array,default:()=>[]},isChild:{type:Boolean,default:!1},companySource:{type:Boolean,default:!1},editing:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(e,i){const a=u({get:()=>e.modelValue,set:e=>i.emit("update:modelValue",e)}),l=u((()=>{var i;return[{value:1,class:"auto-mapping",title:"Auto Mapping",extras:!1,disabled:e.isChild||(null==(i=e.sources)?void 0:i.length)>1&&!e.isChild,icon:"/icon/settings/auto-mapping.svg",desc:"This method clones Item conditions and terms automatically from the chosen price source, but be cautious: any existing conditions and terms will be overwritten."},{value:2,class:"manual-mapping",title:"Manual Mapping",extras:!0,icon:"/icon/settings/manual-mapping.svg",disabled:!1,desc:"With this method, you can create conditions and terms from scratch or use our presets, then manually map them to any price source for better control, a highly recommended approach if you frequently change sources but want to maintain your conditions and terms."}]}));return{method:a,options:l,select:e=>{e.disabled||(a.value=e.value,i.emit("select",e.value))}}}}),Si={key:0},Pi={key:0,class:"bg-grey-02 bg-opacity-10 rounded-md px-4 py-1 flex items-center gap-x-2 mb-4"},Vi={class:"grid md:grid-cols-2 md:gap-x-4 gap-y-4 md:gap-y-0"},Ui=["onClick"],Ai={class:"flex justify-between gap-x-4"},Mi=["src"],Ii={class:"info-mapping"},Bi={class:"flex justify-between items-center"},Ti={class:"flex items-center gap-x-4"},ji={class:"text-base font-semibold"},Li={key:0,class:"bg-green-04 rounded-full text-white inline-flex px-4 py-0 items-center justify-center gap-1 text-sm"},Di={key:0,class:"bg-grey-01 text-sm rounded-full px-3 py-1"};var Ei=Z(ki,[["render",function(e,i,a,l,t,n){var o,d;return(e.isChild||e.companySource)&&(null==(o=e.sources)?void 0:o.length)?U("",!0):(f(),h("div",Si,[((null==(d=e.sources)?void 0:d.length)||0)>1?(f(),h("div",Pi,i[0]||(i[0]=[k("i",{class:"material-icons"},"info",-1),k("p",{class:"text-sm font-semibold"}," Manual mapping will be used for price sync due to the selection of multiple data sources ",-1)]))):U("",!0),k("div",Vi,[(f(!0),h(A,null,L(e.options,((a,l)=>{var t;return f(),h("div",{key:l,class:T([a.class,a.disabled&&`${a.class}--disabled`,!(null==(t=e.sources)?void 0:t.length)&&`${a.class}--disabled-initiate`,e.method===a.value&&`${a.class}--active`]),onClick:i=>e.select(a)},[k("div",Ai,[k("img",{src:a.icon},null,8,Mi),k("div",Ii,[k("div",Bi,[k("div",Ti,[k("h2",ji,P(a.title),1),a.extras?(f(),h("div",Li,i[1]||(i[1]=[k("span",{class:"material-icons"},"verified",-1),V(" Recomended ")]))):U("",!0)]),e.method===a.value?(f(),h("div",Di," Active ")):U("",!0)]),k("p",{class:T([e.method===a.value?"text-grey-04":"text-grey-03","info-mapping--desc"])},P(a.desc),3)])])],10,Ui)})),128))])]))}]]);const Oi=M({name:"BulkPriceEditorMappingMethodEmpty",components:{Button:ee},props:{conditions:{type:Number,default:0},loading:{type:Boolean,default:!1},available:{type:Boolean,default:!1}},emits:["add"],setup:(e,i)=>({addConditionGroup:()=>i.emit("add")})}),Ri={key:0,class:"text-center bg-grey-01 bg-opacity-20 py-10 w-full"},$i={key:0,class:"max-w-lg mx-auto mt-10 mb-6 space-y-6 text-grey-03"},Fi={key:1,class:"mx-auto mt-10 mb-6 space-y-6"};var Ni=Z(Oi,[["render",function(e,i,a,l,t,n){const o=g("Button");return e.conditions||e.loading?U("",!0):(f(),h("div",Ri,[e.available?(f(),h("div",$i,[i[1]||(i[1]=k("img",{class:"mx-auto",alt:"not-found",src:De},null,-1)),i[2]||(i[2]=k("p",{class:"leading-5 text-2xl"},"No Condition",-1)),i[3]||(i[3]=k("p",{class:"leading-5 text-base"},"You don't have any conditions set yet. Before proceeding to pricing, please add conditions according to your needs.",-1)),S(o,{color:"teal",view:"outlined",onClick:e.addConditionGroup},{default:w((()=>i[0]||(i[0]=[k("div",{class:"flex"},[V(" Add Condition Group "),k("span",{class:"material-icons"},"arrow_right")],-1)]))),_:1},8,["onClick"])])):(f(),h("div",Fi,[i[5]||(i[5]=k("img",{class:"mx-auto",alt:"not-found",src:De},null,-1)),i[6]||(i[6]=k("p",{class:"leading-5 text-2xl"},"No Items Found",-1)),i[7]||(i[7]=k("p",{class:"leading-5 text-base"},[V(" To set items condition, you first need to enable items in the Catalog. Click the "),k("b",null,"Go to Catalog Page"),V(" button below, switch on the toggle for the items you want to display, and then proceed to the Price Editor to set their conditions and prices ")],-1)),S(o,{link:"",color:"teal",view:"outlined",to:{name:"settingBuybackDevice"}},{default:w((()=>i[4]||(i[4]=[k("div",{class:"flex"},[V(" Go to Catalog Page "),k("span",{class:"material-icons"},"arrow_right")],-1)]))),_:1})]))]))}]]);const Hi=M({name:"BulkPriceEditorMappingMethodConditions",components:{Select:te,Input:ae},props:{conditions:{type:Array,default:()=>[]},sources:{type:Array,default:()=>[]},sourceConditions:{type:Array,default:()=>[]},category:{type:Object,default:()=>({})},companySource:{type:Boolean,default:!1},method:{type:Number,default:1},loading:{type:Boolean,default:!1},differentRules:{type:Boolean,default:!1},currencySymbol:{type:String,default:"$"},currencyPrefix:{type:[String,Number],default:1}},emits:["update:conditions","update:different","update:ids"],setup(e,i){const a=m(!1),l=u({get:()=>e.conditions.map((e=>s(d({},e),{showTooltip:void 0!==(null==e?void 0:e.showTooltip)&&e.showTooltip}))),set:e=>i.emit("update:conditions",e)}),t=u((()=>{if(!(null==l?void 0:l.length)||e.sources.length)return!1;const[a,...t]=e.conditions,{amountPrice:n,amountType:o,pricingRuleType:d}=a,s=!t.every((e=>(null==e?void 0:e.amountPrice)===n&&(null==e?void 0:e.amountType)===o&&(null==e?void 0:e.pricingRuleType)===d));return i.emit("update:different",s),s})),n=u((()=>{var i;if(!(null==(i=e.sources)?void 0:i.length)||1===e.method||!l.value.length)return!1;const a=l.value.map((e=>null==e?void 0:e.source_condition_id)).filter((e=>!!e));return a.filter(((e,i)=>a.indexOf(e)!==i)).length>0})),o=u((()=>{var i;return n.value||(null==(i=e.sources)?void 0:i.length)>1||t.value||e.companySource})),r=Oe.withMessage("Please select at least one condition.",(()=>l.value.some((e=>e.source_condition_id)))),c=u((()=>2===e.method?{source_condition_id:{atLeastOneSelected:r}}:{source_condition_id:{}})),p=Ee(c,l,{$lazy:!0});return{list:l,showTooltip:a,isDifferentRules:t,showColumns:o,handleUpdateConditionIDS:(i,a,t)=>{l.value=[...l.value].map((l=>{var t,n,o;return a.id===l.id&&(l.source_condition_id=null==a?void 0:a.source_condition_id,e.sources.length>1&&(1===i.type?a.source=[...a.source,{sub_domain:null==(t=null==i?void 0:i.head)?void 0:t.sub_domain,name:null==(n=null==i?void 0:i.head)?void 0:n.name,id:null==(o=null==i?void 0:i.option)?void 0:o.id}]:a.source=a.source.filter((e=>{var a,l;return!(e.id===(null==(a=null==i?void 0:i.option)?void 0:a.id)&&e.sub_domain===(null==(l=null==i?void 0:i.head)?void 0:l.sub_domain))})))),l}))},handleResetConditionIDS:(i,a)=>{l.value=[...l.value].map((i=>{var l,t;return i.id===a.id&&(i.source_condition_id=null,(null==e?void 0:e.sources)&&1!==(null==(l=null==e?void 0:e.sources)?void 0:l.length)?(null==(t=null==e?void 0:e.sources)?void 0:t.length)>1&&(i.source=[],i.source_condition_id=[],i.options=[...i.options].map((e=>s(d({},e),{condition:[...null==e?void 0:e.condition].map((e=>s(d({},e),{checked:!1,disabled:!1})))})))):i.source={}),i})),"function"==typeof i&&i()},handleChangeRuleType:e=>(i.emit("update:conditions",l.value),e),handleChangeRuleAmountType:e=>(i.emit("update:conditions",l.value),e),handleChangeRuleAmountPrice:e=>(i.emit("update:conditions",l.value),e),isSameRulesForOneSource:n,validation:p,onSubmit:async()=>await p.value.$validate()}}}),qi={key:0,class:"capitalize"},zi={key:1,class:"capitalize"},Gi={class:"capitalize"},Ji={class:"space-y-2"},Wi=["innerHTML"],Yi={class:"pl-4"},Zi={class:"list-disc"},Ki=["innerHTML"],Qi={class:"flex items-center gap-x-2"},Xi={key:0},ea={key:0,class:"flex items-center gap-x-2"},ia={class:"bg-teal-02 bg-opacity-30 capitalize text-sm px-2 py-0.5 rounded-full"},aa={key:1,class:"flex items-center gap-x-2"},la={class:"bg-teal-02 bg-opacity-30 capitalize text-sm px-2 py-0.5 rounded-full"},ta={class:"flex items-center justify-start gap-x-2"},na={style:{width:"320px"},class:"space-y-2"},oa=["innerHTML"],da={key:0,class:"list-disc list-outside mx-4 space-y-1"},sa={class:"flex items-center justify-start gap-x-2"},ra={class:"capitalize"},ca={style:{width:"320px"},class:"space-y-2"},ua=["innerHTML"],pa={key:0,class:"list-disc list-outside mx-4 space-y-1"},ma={class:""},va={class:"text-xs"},ga=["onClick"],ya={key:0,class:"text-red-04"},fa={key:0},ha={key:0,class:"w-full flex items-center justify-end"},ba={class:"flex-1 space-y-2"},_a={class:"max-w-lg"},xa={key:0,class:"grid grid-cols-3 max-w-lg gap-2"},Ca={class:"max-w-xs text-sm"},wa={key:0,class:"text-grey-03"},ka={key:1,class:"text-grey-03"};const Sa=M({name:"BulkPriceEditorMappingMethod",components:{Button:ee,Select:te,Input:ae,Methods:Ei,EmptyCondition:Ni,Conditions:Z(Hi,[["render",function(e,i,a,l,t,n){var o;const r=g("TableColumn"),c=g("Tooltip"),u=g("Select"),p=g("RadioButton"),m=g("RadioGroup"),v=g("Input"),y=g("Table");return(null==(o=e.list)?void 0:o.length)&&!e.loading?(f(),_(y,{key:0,class:"w-full",data:e.list},{default:w((()=>[S(r,{prop:"name","min-width":"160"},{header:w((()=>{var i,a;return[1===e.method?(f(),h("span",qi,P(null==(i=e.sources[0])?void 0:i.name)+" Conditions ",1)):(f(),h("span",zi,P(null==(a=e.category)?void 0:a.name)+" Condition ",1))]})),default:w((({row:e})=>[k("span",Gi,P(e.name),1)])),_:1}),S(r,{prop:"condition_term",label:"Description","min-width":"300"},{default:w((({row:e})=>[k("div",Ji,[k("p",{innerHTML:e.term},null,8,Wi),k("div",Yi,[k("ul",Zi,[(f(!0),h(A,null,L(e.condition_term,((e,i)=>(f(),h("li",{key:i},[k("span",{innerHTML:e},null,8,Ki)])))),128))])])])])),_:1}),2===e.method?(f(),_(r,{key:0,"min-width":"300","class-name":"cell-custom"},{header:w((()=>[k("div",Qi,[i[2]||(i[2]=k("span",null,"Map Data Source Condition to yours",-1)),S(c,{placement:"top"},{content:w((()=>i[0]||(i[0]=[k("div",{class:"w-72"}," When you map your own conditions to a Data Source, your own conditions will be the ones visible to your customers. ",-1)]))),default:w((()=>[i[1]||(i[1]=k("span",{class:"text-teal-04 material-icons leading-4",style:{"font-size":"1.25rem !important"}},"info",-1))])),_:1})])])),default:w((({row:a,$index:l})=>{var t,n,o,r,p,m,v,g,y,b;return[S(u,D({ref:"selectCondtion",modelValue:a.source_condition_id,"onUpdate:modelValue":e=>a.source_condition_id=e},s(d({},(null==(t=e.sources)?void 0:t.length)>1&&{child:"condition",optgroup:!0,optgroupBy:"condition",optgroupCheckbox:!0}),{items:(null==(n=e.sources)?void 0:n.length)>1?a.options:e.sourceConditions}),{error:null==(r=null==(o=e.validation)?void 0:o.source_condition_id)?void 0:r.$error,by:"id",name:"name",placeholder:"Choose Condition",multiple:(null==(p=e.sources)?void 0:p.length)>1,block:"","no-border":"","max-height":"200px",onChange:i=>e.handleUpdateConditionIDS(i,a,l)}),E({item:w((({item:i})=>{var a,t,n,o;return[k("div",ta,[k("span",{class:T(["capitalize",(null==(a=e.sources)?void 0:a.length)>1&&"font-semibold"])},P((null==(t=e.sources)?void 0:t.length)>1?`${i.name}'s Conditions`:i.name),3),1===(null==(n=e.sources)?void 0:n.length)?(f(),_(c,{key:0,disabled:!(null==(o=null==i?void 0:i.condition_term)?void 0:o.length),placement:"top"},{content:w((()=>{var e;return[k("div",na,[k("p",{innerHTML:(null==i?void 0:i.term)||""},null,8,oa),(null==(e=null==i?void 0:i.condition_term)?void 0:e.length)?(f(),h("ul",da,[(f(!0),h(A,null,L(null==i?void 0:i.condition_term,((e,i)=>(f(),h("li",{key:`${i}_${l}`,class:"text-sm"},P(e),1)))),128))])):U("",!0)])]})),default:w((()=>{var e;return[k("i",{class:T([!(null==(e=null==i?void 0:i.condition_term)?void 0:e.length)&&"opacity-0","material-icons"])},"info",2)]})),_:2},1032,["disabled"])):U("",!0)])]})),noChild:w((({item:e})=>[k("div",ma,[i[5]||(i[5]=V(" No Condition ")),k("p",va,P(null==e?void 0:e.name)+" don't have any conditions set yet ",1)])])),_:2},[(null==(m=e.sources)?void 0:m.length)>1?{name:"selected",fn:w((({selectedOption:e})=>{var l,t;return[(null==(l=null==a?void 0:a.source_condition_id)?void 0:l.length)?(f(),h("div",Xi,[e.length>1?(f(),h("div",ea,[i[3]||(i[3]=k("span",null,"Mixed",-1)),k("span",ia,P(e.length)+" Source Selected ",1)])):(f(),h("div",aa,[k("span",null,P(null==e?void 0:e.name),1),k("span",la,P(null==(t=null==a?void 0:a.source[0])?void 0:t.name)+"'s ",1)]))])):U("",!0)]})),key:"0"}:void 0,(null==(v=e.sources)?void 0:v.length)>1||e.isDifferentRules?{name:"child",fn:w((({childItem:e,childIndex:a})=>[S(c,{placement:"top",disabled:!e.disabled&&!e.already_selected_other},{content:w((()=>i[4]||(i[4]=[k("div",{class:"w- text-sm"}," You can only choose one condition per one source ",-1)]))),default:w((()=>{var i;return[k("div",sa,[k("span",ra,P(null==e?void 0:e.name),1),S(c,{placement:"top",disabled:e.disabled||e.already_selected_other||!(null==(i=null==e?void 0:e.condition_term)?void 0:i.length)},{content:w((()=>{var i;return[k("div",ca,[k("p",{innerHTML:(null==e?void 0:e.term)||""},null,8,ua),(null==(i=null==e?void 0:e.condition_term)?void 0:i.length)?(f(),h("ul",pa,[(f(!0),h(A,null,L(null==e?void 0:e.condition_term,((e,i)=>(f(),h("li",{key:`${a}_${i}`,class:"text-sm"},P(e),1)))),128))])):U("",!0)])]})),default:w((()=>{var i;return[k("i",{class:T([!(null==(i=null==e?void 0:e.condition_term)?void 0:i.length)&&"opacity-0","material-icons"])},"info",2)]})),_:2},1032,["disabled"])])]})),_:2},1032,["disabled"])])),key:"1"}:void 0,(Array.isArray(null==a?void 0:a.source_condition_id)?null==(g=null==a?void 0:a.source_condition_id)?void 0:g.length:null==a?void 0:a.source_condition_id)?{name:"append",fn:w((({hide:i})=>[k("button",{class:"bg-grey-01 bg-opacity-20 px-4 py-3 mt-1 text-base text-center text-grey-02 hover:text-grey-03 w-full",onClick:l=>e.handleResetConditionIDS(i,a)}," Clear Selection ",8,ga)])),key:"2"}:void 0]),1040,["modelValue","onUpdate:modelValue","error","multiple","onChange"]),(null==(b=null==(y=e.validation)?void 0:y.source_condition_id)?void 0:b.$error)?(f(),h("small",ya," Please select at least one condition. ")):U("",!0)]})),_:1})):U("",!0),S(r,{label:e.showColumns?"Pricing Rules":"","min-width":e.showColumns?"360":""},{default:w((({row:a})=>{var l,t;return[e.isSameRulesForOneSource&&a.is_duplicate||(null==(l=e.sources)?void 0:l.length)>1||e.isDifferentRules||e.companySource?(f(),h("div",fa,[a.source_condition_id||(null==(t=null==a?void 0:a.source_condition_id)?void 0:t.length)?(f(),h("div",ha,[k("div",ba,[k("div",_a,[S(m,{modelValue:a.pricingRuleType,"onUpdate:modelValue":e=>a.pricingRuleType=e,class:"radio--full",onChange:i=>e.handleChangeRuleType(a)},{default:w((()=>[S(p,{label:"3"},{default:w((()=>i[6]||(i[6]=[V("Match")]))),_:1}),S(p,{label:"2"},{default:w((()=>i[7]||(i[7]=[V("Markup")]))),_:1}),S(p,{label:"1"},{default:w((()=>i[8]||(i[8]=[V("Markdown")]))),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),3!=a.pricingRuleType?(f(),h("div",xa,[S(m,{modelValue:a.amountType,"onUpdate:modelValue":e=>a.amountType=e,dense:"",class:"radio--full mb-4 col-span-2",onChange:i=>e.handleChangeRuleAmountType(a)},{default:w((()=>[S(p,{label:"1"},{default:w((()=>i[9]||(i[9]=[V(" % Percentage ")]))),_:1}),S(p,{label:"0"},{default:w((()=>[V(P(e.currencySymbol)+" Fixed ",1)])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),S(c,{modelValue:a.showTooltip,"onUpdate:modelValue":e=>a.showTooltip=e,placement:"top",manual:""},{content:w((()=>[k("p",Ca,"Items priced at "+P(1==e.currencyPrefix?`${e.currencySymbol}0`:`0${e.currencySymbol}`)+" are not subject to pricing rules.",1)])),default:w((()=>[S(v,{modelValue:a.amountPrice,"onUpdate:modelValue":e=>a.amountPrice=e,right:"0"!=a.amountPrice,max:1==a.amountType?100:"auto",min:0,type:"number",class:"w-full col-span-1","icon-block":"",icon:"",onChange:i=>e.handleChangeRuleAmountPrice(a),onFocusIn:e=>a.showTooltip=!0,onFocusOut:e=>a.showTooltip=!1},{icon:w((()=>["0"==a.amountType?(f(),h("span",wa,P(e.currencySymbol),1)):(f(),h("span",ka," % "))])),_:2},1032,["modelValue","onUpdate:modelValue","right","max","onChange","onFocusIn","onFocusOut"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])):U("",!0)])])):U("",!0)])):U("",!0)]})),_:1},8,["label","min-width"])])),_:1},8,["data"])):U("",!0)}]])},props:{pricingSource:{type:Array,default:void 0},main:{type:Object,default:void 0},editing:{type:Boolean,default:!1},category:{type:Object,default:void 0},type:{type:[String,Number],default:void 0},rules:{type:Object,default:void 0},companySource:{type:Boolean,default:!1},differentRules:{type:Boolean,default:!1}},emits:["manual-mapping","update:type","update:different","selectedCondition"],async setup(e,i){p();const{me:a}=Q(),l=m(),t=m(),n=m(),{isAvailableDevice:o,actionConditionDeviceAvailability:r}=Le(),{data:c,conditions:u,sourceConditions:g,getConditions:y,handleExisting:f,handleWithLoading:h,handleParsingJSON:b}=ne(),_=async i=>{var a,l,t,n;const o=await Promise.all(null==(a=e.pricingSource)?void 0:a.map((async a=>{try{const l=e.editing&&i?i[a.sub_domain]:await y({category_id:e.category.id,sub_domain:a.sub_domain}),t=Array.isArray(l)?l:[];return s(d({},a),{condition:t.map((e=>{const{term:i,terms:l}=b(e.condition_term);return s(d({},e),{term:i||null,condition_term:l||[],sub_domain:a.sub_domain,checked:!1,disabled:!1})}))})}catch(l){return console.error("Error fetching source conditions:",l),null}})));c.sourceConditions=(null!=(t=null==(l=e.pricingSource)?void 0:l.length)?t:0)>1?o.filter(Boolean):(null==(n=o.shift())?void 0:n.condition)||[]},x=async(i,a)=>{var l,t,n;const o=(null==(l=e.rules)?void 0:l.rules)||[],r=(null==(t=null==e?void 0:e.pricingSource)?void 0:t.length)>1,u=!r&&1==(null==(n=e.pricingSource)?void 0:n.length);c.conditions=null==i?void 0:i.map((e=>{var i,l,t;const{term:n,terms:p}=b(e.condition_term),m=r&&u?o.filter((i=>i.member_condition_id==e.id)):o.find((i=>i.member_condition_id==e.id)),v=r?[...c.sourceConditions].map((i=>s(d({},oe(i)),{condition:i.condition.map((l=>{const t=o.find((a=>a.member_condition_id===e.id&&a.source_condition_id===l.id&&i.sub_domain===a.source)),n=!!t;return d(d(s(d({},l),{member_id:(null==t?void 0:t.member_condition_id)||void 0,sub_domain:i.sub_domain,already_selected_other:!1}),a&&{checked:n}),a&&{disabled:!1})}))}))):void 0,g=v?v.map((e=>e.condition)).flat():void 0,y=g?oe(g).filter((i=>i.member_id===e.id&&oe(o).find((e=>e.source===i.sub_domain))&&oe(o).find((e=>e.source_condition_id===i.id)))):void 0,f=y?y.map((e=>({id:e.id,name:e.name,sub_domain:e.sub_domain,member_id:e.member_id}))):null;return d(s(d({},e),{term:n||null,condition_term:p||[],pricingRuleType:!!a&&(Array.isArray(m)?null==(i=m[0])?void 0:i.type:null==m?void 0:m.type)||"3",amountType:!!a&&(Array.isArray(m)?null==(l=m[0])?void 0:l.amount_type:null==m?void 0:m.amount_type)||"1",amountPrice:!!a&&(Array.isArray(m)?null==(t=m[0])?void 0:t.amount_price:null==m?void 0:m.amount_price)||0,source_condition_id:(r&&a?y:null)||(a?Array.isArray(m)?m[0].source_condition_id:null==m?void 0:m.source_condition_id:null)}),d({showOption:!1,source:r?a?f.filter((i=>i.member_id===e.id)):[]:{}},r&&{options:v})||{source:!!a&&{sub_domain:null==m?void 0:m.source,name:null==m?void 0:m.source_name,id:null==m?void 0:m.source_condition_id}||{}})})),a&&u&&k(c.conditions),a&&r&&(e=>{const i=oe(e).map((e=>e.source)).flat();c.conditions=oe(e).map((e=>{const a=i.some((i=>i.member_id===e.id));return e.options=a?e.options.map((e=>(i.some((i=>i.sub_domain===e.sub_domain))&&(e.condition=e.condition.map((e=>s(d({},e),{disabled:!i.some((i=>i.id===e.id)),already_selected_other:!1})))),e))):e.options.map((e=>(i.some((i=>i.sub_domain===e.sub_domain))&&(e.condition=e.condition.map((e=>s(d({},e),{already_selected_other:i.some((i=>i.id===e.id)),disabled:i.some((i=>i.id===e.id))})))),e))),e}))})(c.conditions)},C=async()=>{var i,a,l,t;c.conditionIDS=[],c.sourceConditions=[];const n=1===c.method?"auto":"manual",o=(null==(i=e.rules)?void 0:i.mappingType)===n,d=f(null==e?void 0:e.pricingSource,null==(a=e.rules)?void 0:a.rules);if(e.editing&&(null==(t=null==(l=e.rules)?void 0:l.selectedSources)?void 0:t.length)&&d&&o)return await(async i=>{var a,l;c.loading=!0,await _(null==(a=null==e?void 0:e.rules)?void 0:a.sourcesConditions),await x(null==(l=null==e?void 0:e.category)?void 0:l.conditions,i),c.loading=!1})(d);c.loading=!0,await _();const s=await y({category_id:e.category.id});await x(s,!!o&&d),c.loading=!1},w=async a=>{var l;if(n.value=Date.now(),null==(l=e.pricingSource)?void 0:l.length){if((1!==a||!e.category.is_child)&&(c.method=a,i.emit("update:type",a||null),a))return 1===a?(async()=>{c.loading=!0;const[i]=e.pricingSource;await y({category_id:e.category.id,sub_domain:i.sub_domain}).then((e=>{c.conditions=e,c.loading=!1})).catch((()=>{c.conditions=[],c.loading=!1}))})():C()}else c.loading=!1},k=a=>{var l,t;2==c.method&&1==e.pricingSource.length?u.value=(e=>{var i,a;try{const a=e,l=a.reduce(((e,i)=>(null!==i.source_condition_id&&(e[i.source_condition_id]=(e[i.source_condition_id]||0)+1),e)),{});return null!=(i=a.map((e=>s(d({},e),{is_duplicate:null!==e.source_condition_id&&l[e.source_condition_id]>1}))))?i:[]}catch(l){return null!=(a=null==e?void 0:e.map((e=>s(d({},e),{is_duplicate:!1}))))?a:[]}})(a):u.value=a;const n=oe(u.value).filter((e=>e.source_condition_id&&(Array.isArray(e.source_condition_id)?e.source_condition_id.length>0:![null,void 0,{},""].includes(e.source_condition_id)))).map((e=>d({id:e.id,name:e.name},e.is_duplicate&&{is_duplicate:e.is_duplicate})));i.emit("selectedCondition",d({selected:n},2==c.method&&1==e.pricingSource.length&&{isAllDuplicate:(null==(l=n.filter((e=>e.is_duplicate)))?void 0:l.length)===(null==(t=u.value)?void 0:t.length)}))},S=de((async i=>{var a;i?i>1||(null==(a=null==e?void 0:e.category)?void 0:a.is_child)||(null==e?void 0:e.companySource)?await w(2):c.loading=!1:(c.loading=!1,c.conditions=[],c.sourceConditions=[])}),100);return B((async()=>{var i,a,l;await r();const t=((e,i)=>{if(!Array.isArray(e)||!Array.isArray(i))return!1;if(e.length!==i.length)return!1;const a=e=>[...e].map((e=>{var i;return null!=(i=null==e?void 0:e.sub_domain)?i:e})).sort();return JSON.stringify(a(e))===JSON.stringify(a(i))})(e.pricingSource,null==(i=e.rules)?void 0:i.selectedSources);e.editing&&t?await w("manual"===(null==(a=e.rules)?void 0:a.mappingType)?2:1):await S(null==(l=null==e?void 0:e.pricingSource)?void 0:l.length)})),v((()=>({source:e.pricingSource,editing:e.editing})),(async(i,a)=>{c.loading=!0,c.conditions=[],c.sourceConditions=[],await S(i.source.length),i.editing&&(e.category.condition_source=[],e.category.condition=[])}),{deep:!0}),{me:a,data:c,selectCondtion:l,conditions:u,sourceConditions:g,isAvailableDevice:o,formConditions:t,keyCondition:n,handleSelectMethod:w,handleAddConditionGroup:()=>i.emit("manual-mapping"),handleUpdateConditions:k,handleUpdateDifferent:e=>i.emit("update:different",e),handleReset:()=>{c.method=null,c.loading=!1,c.conditions=[],c.sourceConditions=[],c.conditionIDS=[]},onSubmit:async()=>{var e;return null==(e=t.value)?void 0:e.onSubmit()}}}}),Pa={class:"bulkprice-editor-mapping"},Va={key:0};var Ua=Z(Sa,[["render",function(e,i,a,l,t,n){var o,d;const s=g("Methods"),r=g("EmptyCondition"),c=g("Conditions"),u=y("loading");return f(),h("div",Pa,[S(s,{modelValue:e.data.method,"onUpdate:modelValue":i[0]||(i[0]=i=>e.data.method=i),sources:e.pricingSource,"is-child":e.category.is_child,editing:e.editing,"company-source":e.companySource,onSelect:e.handleSelectMethod},null,8,["modelValue","sources","is-child","editing","company-source","onSelect"]),e.data.method&&(null==(o=e.pricingSource)?void 0:o.length)?(f(),h("div",Va,[b((f(),h("div",{class:"flex items-start justify-center",style:O({minHeight:!(null==(d=e.conditions)?void 0:d.length)||e.data.loading?"280px":""})},[S(r,{conditions:e.conditions.length,loading:e.data.loading,available:e.isAvailableDevice,onAdd:e.handleAddConditionGroup},null,8,["conditions","loading","available","onAdd"]),(f(),_(c,{key:`${e.data.method}-${e.keyCondition}`,ref:"formConditions",conditions:e.conditions,loading:e.data.loading,method:e.data.method,sources:e.pricingSource,"source-conditions":e.sourceConditions,category:e.category,"company-source":e.companySource,"currency-symbol":e.me.currency_symbol,"currency-prefix":e.me.currency_prefix,differentRules:e.differentRules,"onUpdate:different":e.handleUpdateDifferent,"onUpdate:conditions":e.handleUpdateConditions},null,8,["conditions","loading","method","sources","source-conditions","category","company-source","currency-symbol","currency-prefix","differentRules","onUpdate:different","onUpdate:conditions"]))],4)),[[u,e.data.loading]])])):U("",!0)])}]]);function Aa(){const e=I({group_name:null,categories:null}),i=m([]),a=m(!1);return{form:e,devices:i,loading:a,getDevices:async(e,l=(()=>{}))=>{a.value=!0,i.value=await se.dispatch("setting/condition/devices"),re(l)&&l(),a.value=!1}}}const Ma=()=>{const e=m({source:null,conditions:[],sources:[],condition:[]}),i=m(!1),a=m(!1);return{form:e,modal:i,loading:a,isValidJSON:Ba,getSources:async(i={},l=(()=>{}))=>{if(1===i.length)try{a.value=!0;const t=await se.dispatch("setting/condition/showSourceCompanies",i);e.value.sources=t,re(l)&&l(t)}catch(t){e.value.sources=[],re(l)&&l(t)}finally{a.value=!1}},getConditions:async(i={},l=(()=>{}))=>{try{a.value=!0;const t=await se.dispatch("setting/condition/showSourceConditions",{sub_domain:i.sub_domain,data:{category_id:i.category_id,is_mac:i.is_mac,sub_domain:i.sub_domain}});e.value.conditions=t,re(l)&&l(t)}catch(t){e.value.conditions=[],re(l)&&l(t)}finally{a.value=!1}}}},Ia=()=>{const e=m({conditions:[]}),i=m(!1);return{form:e,modal:m({delete:!1,condition:!1,preview:!1}),loading:i,addCondition:async(e={id:void 0,term:void 0,terms:void 0},a=(()=>{}))=>{try{i.value=!0;let l=[];l=[e.term,...e.terms];const t=await se.dispatch("setting/condition/conditionCreate",{id:e.id,data:s(d({},e),{terms:JSON.stringify(l)})});return re(a)&&a(),t}catch{i.value=!1}finally{i.value=!1}},editCondition:async(e={id:void 0,term:void 0,terms:void 0},a=(()=>{}))=>{try{i.value=!0;let l=[];l=[e.term,...e.terms],await se.dispatch("setting/condition/conditionUpdate",{id:e.id,data:{terms:JSON.stringify(l),name:null==e?void 0:e.name}}),re(a)&&a()}catch{i.value=!1}finally{i.value=!1}},deleteCondition:async(e,a=(()=>{}))=>{try{i.value=!0;const l=await se.dispatch("setting/condition/conditionDelete",e);return re(a)&&a(),l}catch{i.value=!1}finally{i.value=!1}},sortingCondition:async(e,a=(()=>{}))=>{try{i.value=!0;const l=await se.dispatch("setting/condition/sort",{sorting:JSON.stringify(e)});return re(a)&&a(),l}catch{i.value=!1}finally{i.value=!1}}}},Ba=e=>{try{return JSON.parse(e),!0}catch(i){return!1}};const Ta=M({name:"ConditionCategory",components:{Input:ae,MultiSelect:Fe},props:{mixin:{type:Object,default:void 0},main:{type:Object,default:void 0},priceEditor:{type:Boolean,default:!1},priceEditorCategory:{type:Object,default:void 0}},emits:["update:modelValue"],async setup(e,i){var a,l,t;const{form:n,loading:o,devices:d,getDevices:s}=e.mixin,r=Ee({group_name:{required:$e},categories:{required:$e}},n,{$lazy:!0}),c=u((()=>({"multiselect--invalid":r.value.categories.$invalid}))),m=u((()=>{var e;if(null==(e=null==n?void 0:n.categories)?void 0:e.length){return[...n.categories].findIndex((e=>e.is_mac))>=0?[...d.value].filter((e=>1===e.is_mac)):[...d.value].filter((e=>0===e.is_mac))}return d.value})),v=p(),g=u((()=>{var e,i;if(!(null==(e=null==n?void 0:n.categories)?void 0:e.length))return!1;const a=[...n.categories].findIndex((e=>e.is_mac));return!!(null==(i=null==v?void 0:v.query)?void 0:i.unique_id)&&a>=0}));(null==(a=e.main)?void 0:a.id)&&(n.group_name=e.main.formEdit.groupName,n.categories=[...null==(t=null==(l=e.main)?void 0:l.formEdit)?void 0:t.categories].filter((e=>!!e.is_checked))),await s(),e.priceEditor&&(n.categories=[...d.value].filter((i=>{var a,l,t;return i.category_id==e.priceEditorCategory.id&&(null==(a=i.name)?void 0:a.toLowerCase())==(null==(t=null==(l=e.priceEditorCategory)?void 0:l.name)?void 0:t.toLowerCase())})));return{form:n,submit:async()=>(await r.value.$validate(),!r.value.$error),loading:o,devices:d,validation:r,getDevices:s,disabledUniqueAndMac:g,devicesComputed:m,multiSelectClass:c}}}),ja={class:"lg:w-2/5 space-y-4"},La={class:"flex items-center gap-x-1"},Da={class:"flex gap-x-4 items-center"},Ea={class:"flex-1"},Oa={key:0,whitelabel:"remove"},Ra={class:"xl:max-w-lg max-w-sm",style:{"word-wrap":"break-word"}},$a={class:"flex gap-x-4 items-center"},Fa={class:"flex-1"},Na={class:"text-sm text-grey-03 mb-1"},Ha={key:0,whitelabel:"remove"},qa={class:"xl:max-w-lg max-w-sm",style:{"word-wrap":"break-word"}};var za=Z(Ta,[["render",function(e,i,a,l,t,n){var o,d,s,r;const c=g("Tooltip"),u=g("Input"),p=g("MultiSelect");return f(),h("div",ja,[k("div",null,[k("div",La,[i[4]||(i[4]=k("label",{for:"CategoryName"}," Category Name ",-1)),S(c,{placement:"top"},{content:w((()=>i[2]||(i[2]=[k("div",{class:"w-64 text-sm"}," The category names are internal only and not customer-facing. ",-1)]))),default:w((()=>i[3]||(i[3]=[k("i",{class:"material-icons text-teal-04"},"info",-1)]))),_:1})]),k("div",Da,[k("div",Ea,[S(u,{modelValue:e.form.group_name,"onUpdate:modelValue":i[0]||(i[0]=i=>e.form.group_name=i),name:"CategoryName",type:"text",placeholder:"Category name",view:e.validation.group_name.$invalid?"danger":"default",class:"w-full",disabled:null==(o=e.main)?void 0:o.synced},null,8,["modelValue","view","disabled"]),(f(!0),h(A,null,L(e.validation.group_name.$errors.length,(e=>(f(),h("span",{key:e,class:"text-red-base mt-2 block"}," Category name is required ")))),128))]),(null==(d=e.main)?void 0:d.synced)?(f(),h("div",Oa,[S(c,{placement:"right"},{content:w((()=>[k("div",Ra,[k("p",null,[i[6]||(i[6]=V(" This product's category name is locked because you are using price sync ")),e.main.companyName?(f(),h(A,{key:0},[i[5]||(i[5]=V(" from ")),k("b",null,P(e.main.companyName),1)],64)):U("",!0),i[7]||(i[7]=V(". ")),i[8]||(i[8]=k("b",null,[k("a",{href:"https://help.reusely.com/en/articles/9176424-how-price-sync-works",target:"_blank",noreferrer:"",noopener:"",class:"mx-2 text-white underline"}," Read More ")],-1))])])])),default:w((()=>i[9]||(i[9]=[k("i",{class:"material-icons icon-md select-none"},"lock",-1)]))),_:1})])):U("",!0)])]),k("div",null,[i[15]||(i[15]=k("label",null,"Assign Your Condition Item",-1)),k("div",$a,[k("div",Fa,[S(p,{modelValue:e.form.categories,"onUpdate:modelValue":i[1]||(i[1]=i=>e.form.categories=i),placeholder:"Search items",label:"name","track-by":"category_id",options:e.devicesComputed,multiple:!0,"hide-selected":!1,"show-labels":!1,"show-no-results":!0,"show-no-options":!0,class:T(e.multiSelectClass),disabled:(null==(s=e.main)?void 0:s.synced)||!!e.priceEditor||e.disabledUniqueAndMac,required:""},{option:w((e=>[k("p",Na,P(e.option.brand),1),k("p",null,P(e.option.name),1)])),_:1},8,["modelValue","options","class","disabled"]),(f(!0),h(A,null,L(e.validation.categories.$errors.length,(e=>(f(),h("span",{key:e,class:"text-red-base mt-2 block"}," Item is required ")))),128))]),(null==(r=e.main)?void 0:r.synced)?(f(),h("div",Ha,[S(c,{placement:"right"},{content:w((()=>{var a,l;return[k("div",qa,[k("p",null,[i[11]||(i[11]=V(" This product's category name is locked because you are using price sync ")),(null==(a=e.main)?void 0:a.companyName)?(f(),h(A,{key:0},[i[10]||(i[10]=V(" from ")),k("b",null,P(null==(l=e.main)?void 0:l.companyName),1)],64)):U("",!0),i[12]||(i[12]=V(". ")),i[13]||(i[13]=k("b",null,[k("a",{href:"https://help.reusely.com/en/articles/9176424-how-price-sync-works",target:"_blank",noreferrer:"",noopener:"",class:"mx-2 text-white underline"}," Read More ")],-1))])])]})),default:w((()=>i[14]||(i[14]=[k("i",{class:"material-icons icon-md select-none"},"lock",-1)]))),_:1})])):U("",!0)])])])}]]);const Ga=M({name:"ConditionModalCautionSource",components:{Modal:ie,Button:ee},props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","cancel","continue"],setup(e,i){const a=u({get:()=>e.modelValue,set:e=>{i.emit("update:modelValue",e)}});return{show:a,handleCancel:()=>{a.value=!1,i.emit("cancel")},handleConfirm:()=>{a.value=!1,i.emit("continue")}}}}),Ja={class:"space-y-8 text-center my-8"},Wa={class:"flex items-center justify-center gap-x-4"};const Ya=M({name:"ConditionMappingSource",components:{Select:te,Button:ee,ConditionModalCautionSource:Z(Ga,[["render",function(e,i,a,l,t,n){const o=g("Button"),d=g("Modal");return f(),_(d,{modelValue:e.show,"onUpdate:modelValue":i[0]||(i[0]=i=>e.show=i),"hide-header":"","hide-footer":"",size:"xs"},{default:w((()=>[k("div",Ja,[i[3]||(i[3]=k("span",{style:{fontSize:"8rem !important",lineHeight:"1"},class:"material-icons text-orange-03"}," error_outline ",-1)),i[4]||(i[4]=k("div",{class:"font-normal text-grey-03"},[k("p",null," You have conditions with the same title already in the active conditions. If you continue, it will replace the existing condition. "),k("p",null," Are you sure you want to proceed? ")],-1)),k("div",Wa,[S(o,{color:"grey",view:"outlined",onClick:e.handleCancel},{default:w((()=>i[1]||(i[1]=[V(" Cancel ")]))),_:1},8,["onClick"]),S(o,{color:"teal",onClick:e.handleConfirm},{default:w((()=>i[2]||(i[2]=[V(" Continue ")]))),_:1},8,["onClick"])])])])),_:1},8,["modelValue"])}]])},props:{mixin:{type:Object,default:void 0},category:{type:Object,default:void 0},active:{type:Object,default:void 0},main:{type:Object,default:void 0},refList:{type:Object,default:void 0},priceEditor:{type:Boolean,default:!1},priceEditorCategory:{type:Object,default:void 0}},emits:["update:modelValue","selectSource","selectCondition"],async setup(e,i){const a=e.main,{form:l,getConditions:t,getSources:n,loading:o,modal:r,isValidJSON:c}=e.mixin,p=u((()=>e.category)),{form:g}=e.active,y=m(null),f=m(!1),h=u((()=>{var e,i,a,l,t,n;if((null==(i=null==(e=p.value)?void 0:e.form)?void 0:i.categories)&&(null==(l=null==(a=p.value)?void 0:a.form)?void 0:l.categories.length))return null==(n=null==(t=p.value)?void 0:t.form)?void 0:n.categories})),b=u((()=>!p.value.form.group_name||(!h.value||(h.value.length>1||(!!o.value||!!(null==a?void 0:a.synced)))))),_=e=>{var i,a,l;if(null==(a=null==(i=g.value)?void 0:i.conditions)?void 0:a.length){const i=[];return null==(l=g.value)||l.conditions.map((a=>{var l,t;const n=null==(l=e.name)?void 0:l.split(" ").join("");(null==(t=a.name)?void 0:t.split(" ").join("")).toLowerCase()===n.toLowerCase()&&i.push(a.name)})),!!i.length}return!1},x=(i,t=-1)=>{if(!i||-1===t)return;if(i.exist)return y.value=s(d({},i),{index:t}),void(r.value=!0);l.value.condition.push(i),l.value.conditions[t].added=!0,e.refList.isEdit=!1;const n=d({},i);delete n.id,a.id?e.refList.saveCondition(n,!0):g.value.conditions.push(n)},C=()=>{const e=[...g.value.conditions].findIndex((e=>{const i=y.value.name.split(" ").join(""),a=e.name.split(" ").join("");return i.toLowerCase()===a.toLowerCase()}));if(e>=0){const i=l.value.conditions[y.value.index];l.value.condition=[...new Set([...l.value.condition,i])],l.value.conditions[y.value.index].added=!0,g.value.conditions[e]=d({},i)}k()},w=()=>{l.value.conditions=[...l.value.conditions].map((e=>{let i=[];try{if(c(e.condition_term)){const a=JSON.parse(e.condition_term);i=Array.isArray(a)?a:[]}}catch(a){console.error("Error parsing condition terms:",a),i=[]}return s(d({},e),{terms:i?i.splice(1,i.length-1):[""],term:i?i[0]:e.condition_term,added:!1,exist:_(e)})}))},k=()=>{r.value=!1,f.value=!1,y.value=null};return v((()=>[h.value,null==a?void 0:a.synced,n]),(()=>{h.value&&n&&!(null==a?void 0:a.synced)?n(h.value):(l.value.source=null,l.value.conditions=[],l.value.sources=[],l.value.condition=[])}),{deep:!0,immediate:!0}),{form:l,main:a,formActive:g,getConditions:t,getSources:n,loading:o,modal:r,sanitize:ce,categoriesSelected:h,disabledSource:b,replacer:y,isAddAll:f,deleteActiveCondtion:e=>{const i=l.value.conditions.findIndex((i=>{var a,l;const t=null==(a=i.name)?void 0:a.split(" ").join("");return(null==(l=e.name)?void 0:l.split(" ").join("")).toLowerCase()===t.toLowerCase()}));l.value.conditions[i]&&(l.value.conditions[i].added=!1,l.value.conditions[i].exist=!1)},handleRelabeling:()=>{l.value.conditions=l.value.conditions.map((e=>e.added?d({},e):s(d({},e),{exist:_(e)})))},handleSelectSource:async e=>{if(Array.isArray(l.value.sources))return l.value.source=[...l.value.sources].find((i=>i.sub_domain===e)),await(async()=>{const e=l.value.source,i=Array.isArray(h.value)&&[...h.value].shift()||[];(null==e?void 0:e.sub_domain)&&i&&(await t({sub_domain:e.sub_domain,category_id:i.category_id,is_mac:i.is_mac}),w())})();l.value.source={}},handleAddCondition:x,handleInitCondition:w,handleCancelCaution:k,handleContinueCaution:()=>{return f.value?(l.value.conditions=null==(i=l.value.conditions)?void 0:i.map((e=>s(d({},e),{added:!0}))),l.value.condition=[...l.value.conditions],void(null==(t=l.value.condition)||t.forEach((async i=>{const l=[...g.value.conditions].findIndex((e=>{const a=i.name.split(" ").join(""),l=e.name.split(" ").join("");return a.toLowerCase()===l.toLowerCase()}));l>=0?(e.refList.isEdit=!0,a.id&&g.value.conditions[l].id?await e.refList.saveCondition({id:g.value.conditions[l].id,name:i.name,term:i.term,terms:i.terms},!0):g.value.conditions[l]=d(d({},g.value.conditions[l]),i)):(e.refList.isEdit=!1,a.id?await e.refList.saveCondition({name:i.name,term:i.term,terms:i.terms},!0):g.value.conditions.push(i))})))):C();var i,t},handleAddAllCondition:()=>{var e,i,a,t,n;const o=(null==(i=null==(e=l.value)?void 0:e.conditions)?void 0:i.length)&&[...null==(a=l.value)?void 0:a.conditions].filter((e=>!!e.exist))||[];if(o.length)return y.value=o,f.value=!0,void(r.value=!0);null==(n=null==(t=l.value)?void 0:t.conditions)||n.forEach(((e,i)=>{e.added||x(e,i)}))},handleReplaceCondition:C}}}),Za={class:"flex flex-col gap-y-8 py-4 px-2"},Ka={class:"space-y-2"},Qa={class:"flex items-center gap-x-4"},Xa={class:"flex-1 flex items-center gap-x-1"},el={key:0,class:"material-icons text-green-04"},il={key:0,class:"space-y-6"},al={class:"space-y-4"},ll={class:"font-semibold title"},tl={class:"material-icons"},nl=["innerHTML"],ol={class:"list-outside list-disc ml-6"},dl=["innerHTML"];var sl=Z(Ya,[["render",function(e,i,a,l,t,n){const o=g("Select"),d=g("Tooltip"),s=g("Button"),r=g("ConditionModalCautionSource"),c=y("loading");return f(),h(A,null,[k("div",Za,[k("div",Ka,[i[2]||(i[2]=k("div",null,[k("div",{class:"bg-green-04 rounded-full text-white inline-flex px-4 items-center justify-center gap-1 text-sm"},[k("span",{class:"material-icons"}," verified "),V(" Recomended ")])],-1)),i[3]||(i[3]=k("p",null," Save time by using these presets to define your conditions without having to start from scratch. ",-1)),S(o,{modelValue:e.form.source,"onUpdate:modelValue":[i[0]||(i[0]=i=>e.form.source=i),e.handleSelectSource],items:e.form.sources,style:{width:"100%",boxShadow:"unset"},disabled:e.disabledSource,loading:e.loading,placeholder:"Choose Preset Condition","max-height":"200px",by:"sub_domain",name:"name","no-border":""},{item:w((({item:i})=>{var a,l,t;return[k("div",Qa,[k("div",{style:O({backgroundImage:`url(${i.logo})`}),class:"w-28 h-7 flex items-center justify-center bg-center bg-contain bg-no-repeat"},null,4),k("div",Xa,[V(P(i.name)+" ",1),(null==(a=e.form)?void 0:a.source)?(f(),h(A,{key:0},[(null==i?void 0:i.sub_domain)===(null==(t=null==(l=e.form)?void 0:l.source)?void 0:t.sub_domain)?(f(),h("i",el,"check_circle")):U("",!0)],64)):U("",!0)])])]})),_:1},8,["modelValue","items","disabled","loading","onUpdate:modelValue"])]),e.form.source?b((f(),h("div",il,[(f(!0),h(A,null,L(e.form.conditions,((a,l)=>(f(),h("div",{key:l,class:T(["condition-source-outline",!a.added&&!!a.exist&&"condition-source-outline--warning",!!a.added&&"condition-source-outline--success"])},[k("div",al,[k("div",ll,[V(P(a.name)+" ",1),a.added||a.exist?(f(),_(d,{key:0,placement:"top"},{content:w((()=>i[4]||(i[4]=[k("p",{class:"w-80 text-sm"}," A condition with this name is already exists. To use this condition please rename the existing one or delete it first. ",-1)]))),default:w((()=>[k("span",tl,P(!a.added?"info":"check_circle"),1)])),_:2},1024)):U("",!0)]),k("div",null,[k("div",{innerHTML:a.term},null,8,nl),k("ul",ol,[(f(!0),h(A,null,L(a.terms||[],((i,a)=>(f(),h(A,{key:a},[i&&(null==i?void 0:i.length)?(f(),h("li",{key:0,class:"text-grey-04",innerHTML:e.sanitize(i)},null,8,dl)):U("",!0)],64)))),128))])]),a.added?U("",!0):(f(),_(s,{key:0,view:"outlined",color:a.exist?"orange":"teal",block:"",dense:"",onClick:i=>e.handleAddCondition(a,l)},{default:w((()=>i[5]||(i[5]=[k("div",{class:"flex items-center justify-center gap-2"},[k("span",null,"Add to Active Conditions"),k("span",{class:"material-icons"}," arrow_forward ")],-1)]))),_:2},1032,["color","onClick"]))])],2)))),128)),e.form.conditions.length&&e.form.conditions.length>=2&&e.form.conditions.length!==e.form.condition.length?(f(),_(s,{key:0,color:"teal",block:"",dense:"",onClick:e.handleAddAllCondition},{default:w((()=>i[6]||(i[6]=[k("div",{class:"flex items-center justify-center gap-2"},[k("span",null,"Add All To Active Conditions"),k("span",{class:"material-icons"}," arrow_forward ")],-1)]))),_:1},8,["onClick"])):U("",!0)])),[[c,e.loading]]):U("",!0)]),S(r,{modelValue:e.modal,"onUpdate:modelValue":i[1]||(i[1]=i=>e.modal=i),onContinue:e.handleContinueCaution,onCancel:e.handleCancelCaution},null,8,["modelValue","onContinue","onCancel"])],64)}],["__scopeId","data-v-6b30141d"]]);const rl=M({name:"ConditionPreview",props:{conditions:{type:Array,default:()=>[]}},setup:e=>({conditions:u((()=>{try{return e.conditions.map((e=>s(d({},e),{condition_term:JSON.parse(e.condition_term)})))}catch(i){return console.error(`Error parsing product condition: ${i}`),[]}}))})}),cl={class:"select-none overflow-y-auto px-4",style:{maxHeight:"75vh"},draggable:"false"},ul={class:"flex flex-col"},pl={class:"text-center my-4"},ml={class:"text-lg font-semibold"},vl={key:0,class:"my-4"},gl=["innerHTML"],yl={class:"my-4"},fl={key:0,class:"flex my-2"},hl=["innerHTML"],bl={key:1,class:"flex justify-center my-4"};var _l=Z(M({name:"ConditionModalPreview",components:{Modal:ie,PreviewCondition:Z(rl,[["render",function(e,i,a,l,t,n){return f(),h("div",cl,[i[4]||(i[4]=R('<div class="stepper" data-v-0b4a18e4><div class="stepper-item --active" data-v-0b4a18e4><div class="stepper-item__icon" data-v-0b4a18e4><svg width="24" height="24" viewBox="0 0 126 126" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-0b4a18e4><path d="M83.5356 25.0537C87.7242 25.0537 89.3881 26.7136 89.3919 30.9397C89.3919 33.2184 89.3895 35.4972 89.3871 37.7762C89.3799 44.6141 89.3726 51.4534 89.4305 58.2901C89.4305 60.2168 88.9132 60.9349 86.9328 60.8878C82.815 60.7888 78.6947 60.8145 74.576 60.8402C73.6328 60.8461 72.6887 60.852 71.7458 60.8564C67.6073 60.8564 65.9551 62.5948 65.9358 66.7895C65.9358 68.0107 65.9317 69.229 65.9277 70.4457C65.9176 73.5292 65.9074 76.603 65.9628 79.6838C65.9898 81.3358 65.488 81.9872 63.77 81.9911C58.6936 81.9911 58.6935 82.0618 58.6897 87.2256V88.5953C58.6897 90.0878 58.6897 90.8224 59.0542 91.2346C59.4076 91.6341 60.1034 91.7308 61.4736 91.9213L61.4847 91.9228C63.1601 92.1583 64.214 93.1393 64.3568 94.8344C64.4997 96.5296 63.4844 97.6323 61.8823 98.06C61.1956 98.2141 60.4927 98.28 59.7899 98.2562H32.3034C31.5986 98.2683 30.8942 98.2131 30.1995 98.0914C28.4932 97.7421 27.4315 96.3884 27.5319 94.7952C27.6323 93.2021 28.856 91.9856 30.6203 91.9268C33.1798 91.8404 35.7508 91.813 38.3064 91.9268C39.9163 91.9935 40.4722 91.4049 40.3834 89.796C40.2772 87.8447 40.2772 85.8888 40.3834 83.9375C40.4683 82.3679 39.8352 81.9362 38.3644 81.948C30.8673 82.0029 23.3703 81.9755 15.8733 81.948C11.5534 81.9519 9.9668 80.3588 9.9668 75.9717V30.8456C9.9668 26.6861 11.5689 25.0537 15.6803 25.0537H83.5356Z" fill="white" data-v-0b4a18e4></path><path fill-rule="evenodd" clip-rule="evenodd" d="M89.3979 67.2003C89.3979 64.7949 88.927 64.269 86.6338 64.2494C83.3911 64.2259 80.1467 64.2337 76.9028 64.2416C75.281 64.2455 73.6587 64.2494 72.0374 64.2494C70.2964 64.2494 69.505 64.9283 69.5436 66.8197C69.608 70.0756 69.5959 73.3315 69.5839 76.5874C69.5786 78.0167 69.5733 79.4461 69.5745 80.8755C69.577 83.999 69.5762 87.1225 69.5753 90.246L69.5745 94.9313C69.5745 97.2621 69.8679 97.58 72.076 97.5918C77.0046 97.6127 81.9344 97.6127 86.8655 97.5918C89.0466 97.5918 89.3902 97.219 89.3941 94.9274C89.4095 85.6824 89.4108 76.44 89.3979 67.2003ZM79.4727 94.276C79.1764 94.276 78.8868 94.1867 78.6405 94.0194C78.3942 93.8521 78.2022 93.6143 78.0888 93.3361C77.9755 93.0579 77.9458 92.7518 78.0036 92.4564C78.0614 92.1611 78.2041 91.8898 78.4135 91.6769C78.623 91.4639 78.8899 91.3189 79.1805 91.2602C79.471 91.2014 79.7722 91.2316 80.0459 91.3468C80.3196 91.4621 80.5535 91.6572 80.7181 91.9076C80.8827 92.158 80.9705 92.4523 80.9705 92.7535C80.971 92.9537 80.9327 93.1521 80.8576 93.3373C80.7826 93.5225 80.6723 93.6908 80.5332 93.8326C80.3941 93.9744 80.2288 94.0869 80.0468 94.1636C79.8648 94.2404 79.6697 94.276 79.4727 94.276Z" fill="white" data-v-0b4a18e4></path><path fill-rule="evenodd" clip-rule="evenodd" d="M116.116 92.2043V50.7314L116.097 50.7236V30.2402C116.089 26.9401 114.255 25.0605 111.016 25.0605H99.4581C96.2501 25.0605 94.2812 27.0226 94.2812 30.303V92.1573C94.289 95.6104 96.2771 97.5724 99.6627 97.5724H110.823C114.159 97.5606 116.116 95.5711 116.116 92.2043ZM105.222 33.0734L105.214 33.0773C104.96 33.0759 104.706 33.077 104.453 33.0781C103.997 33.0801 103.544 33.0821 103.095 33.0695C102.276 33.0498 101.736 32.5319 101.724 31.8726C101.713 31.2134 102.28 30.6954 103.102 30.6954C104.502 30.6771 105.903 30.6771 107.303 30.6954C108.163 30.7033 108.696 31.2409 108.685 31.9197C108.673 32.5986 108.14 33.0459 107.291 33.0734H105.222ZM103.056 34.9608H105.245L105.237 34.9648C105.435 34.9648 105.632 34.9635 105.83 34.9622C106.323 34.959 106.815 34.9558 107.303 34.9726C108.144 34.9961 108.661 35.4631 108.673 36.1498C108.685 36.8365 108.16 37.3466 107.326 37.3466C105.917 37.3663 104.5 37.3663 103.079 37.3466C102.265 37.3349 101.72 36.7933 101.724 36.138C101.728 35.4827 102.284 34.9883 103.056 34.9608ZM104.335 87.1157C104.623 86.994 104.933 86.9337 105.245 86.9383L105.23 86.9422C105.533 86.9269 105.837 86.9739 106.123 87.0803C106.408 87.1866 106.67 87.3503 106.892 87.5615C107.114 87.7727 107.293 88.0272 107.416 88.3097C107.54 88.5923 107.606 88.8972 107.611 89.2064C107.625 89.5279 107.575 89.8489 107.463 90.1501C107.352 90.4513 107.182 90.7267 106.964 90.9597C106.745 91.1926 106.483 91.3784 106.192 91.506C105.902 91.6336 105.589 91.7002 105.272 91.7021C104.967 91.7057 104.665 91.6483 104.383 91.533C104.1 91.4178 103.842 91.2471 103.625 91.0306C103.407 90.8141 103.234 90.5561 103.114 90.2713C102.995 89.9866 102.932 89.6807 102.929 89.3712C102.914 89.0544 102.963 88.7378 103.073 88.441C103.183 88.1442 103.352 87.8735 103.569 87.6456C103.786 87.4177 104.047 87.2373 104.335 87.1157ZM103.056 39.5951H105.245L105.237 39.599C105.394 39.599 105.551 39.598 105.708 39.597C106.241 39.5935 106.772 39.5901 107.303 39.6265C108.144 39.65 108.661 40.1366 108.673 40.8037C108.685 41.4708 108.156 41.9809 107.326 41.9809C106.387 41.9966 105.442 41.9914 104.497 41.9861C104.024 41.9835 103.552 41.9809 103.079 41.9809C102.265 41.9495 101.724 41.4315 101.724 40.7723C101.724 40.1131 102.265 39.6186 103.056 39.5951Z" fill="white" data-v-0b4a18e4></path></svg></div></div><div class="stepper-item" data-v-0b4a18e4><div class="stepper-item__icon" data-v-0b4a18e4><svg width="24" height="24" viewBox="0 0 126 126" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-0b4a18e4><path fill-rule="evenodd" clip-rule="evenodd" d="M109.186 34.7529L105.811 40.5736L109.183 46.3943C109.384 46.7412 109.515 47.1243 109.568 47.5217C109.621 47.919 109.595 48.3229 109.491 48.7102C109.387 49.0975 109.208 49.4606 108.964 49.7788C108.72 50.097 108.415 50.364 108.067 50.5646L102.227 53.9325V60.641C102.227 61.4501 101.905 62.226 101.332 62.7981C100.759 63.3703 99.981 63.6917 99.1701 63.6917H92.4471L89.0749 69.5185C88.6683 70.218 88.0004 70.7281 87.2174 70.9368C86.4345 71.1456 85.6006 71.0359 84.8986 70.632L79.0591 67.264L73.2258 70.632C72.7549 70.9035 72.226 71.0438 71.694 71.0438C71.158 71.0407 70.632 70.8985 70.1678 70.631C69.7035 70.3636 69.3171 69.9802 69.0464 69.5185L65.6711 63.6917H58.9451C58.1342 63.6917 57.3566 63.3703 56.7832 62.7981C56.2099 62.226 55.8877 61.4501 55.8877 60.641V53.9325L50.0483 50.5646C49.3488 50.1567 48.8392 49.4894 48.6308 48.7082C48.4223 47.927 48.5318 47.0953 48.9354 46.3943L52.3107 40.5736L48.9354 34.7529C48.7333 34.4062 48.6018 34.0231 48.5484 33.6256C48.4951 33.228 48.5211 32.8239 48.6248 32.4364C48.7285 32.0488 48.9079 31.6856 49.1527 31.3675C49.3975 31.0493 49.7029 30.7826 50.0513 30.5826L55.8908 27.2147V20.5062C55.8908 19.6972 56.2129 18.9212 56.7863 18.3491C57.3596 17.777 58.1373 17.4556 58.9481 17.4556H65.6711L69.0464 11.6288C69.4519 10.9281 70.1196 10.4169 70.9028 10.2075C71.686 9.99807 72.5205 10.1077 73.2227 10.5122L79.0622 13.8832L84.9016 10.5153C85.249 10.3137 85.6329 10.183 86.0312 10.1306C86.4296 10.0783 86.8344 10.1053 87.2221 10.2102C88.004 10.4222 88.6707 10.933 89.0779 11.6318L92.4501 17.4556H99.1732C99.984 17.4556 100.762 17.777 101.335 18.3491C101.908 18.9212 102.23 19.6972 102.23 20.5062V27.2177L108.07 30.5857C108.772 30.9908 109.283 31.6573 109.493 32.4388C109.702 33.2202 109.592 34.0526 109.186 34.7529ZM74.6592 26.6315C73.7992 25.7728 72.6325 25.2901 71.4158 25.2897C70.1992 25.2893 69.0321 25.7712 68.1715 26.6294C67.3109 27.4875 66.8272 28.6517 66.8268 29.8657C66.8264 31.0798 67.3093 32.2443 68.1694 33.103C69.0294 33.9617 70.1961 34.4444 71.4128 34.4448C72.6295 34.4452 73.7965 33.9633 74.6571 33.1052C75.5177 32.247 76.0014 31.0828 76.0018 29.8688C76.0022 28.6547 75.5193 27.4903 74.6592 26.6315ZM67.4413 50.9185L72.333 54.5762L90.6769 30.1708L85.7852 26.513L67.4413 50.9185ZM84.947 55.4475C85.5035 55.6777 86.1 55.7963 86.7024 55.7965C87.9191 55.7969 89.0861 55.315 89.9467 54.4569C90.8073 53.5987 91.291 52.4345 91.2914 51.2205C91.2918 50.0065 90.8089 48.842 89.9489 47.9832C89.0888 47.1245 87.9221 46.6418 86.7055 46.6414C86.103 46.6412 85.5064 46.7594 84.9498 46.9893C84.3931 47.2191 83.8873 47.5562 83.4612 47.9811C83.035 48.406 82.6969 48.9105 82.4662 49.4658C82.2355 50.0211 82.1166 50.6163 82.1164 51.2174C82.1162 51.8186 82.2347 52.4139 82.465 52.9693C82.6954 53.5248 83.0331 54.0295 83.459 54.4547C83.8848 54.8799 84.3904 55.2173 84.947 55.4475Z" fill="#a5a5a5" data-v-0b4a18e4></path><path d="M20.0155 73.8845C26.0747 70.0668 29.9985 68.1718 32.82 67.7011C37.323 66.9502 43.3475 68.1422 47.0058 70.508C47.9374 71.1105 50.0403 72.7056 51.6786 74.0526C53.317 75.3997 57.1082 77.8897 60.1037 79.5862C63.0992 81.2823 65.941 83.193 66.4191 83.8314C68.0634 86.0295 67.086 89.7339 64.7041 90.3305C64.0804 90.4868 60.8524 90.2346 57.5312 89.7702L51.4927 88.926L45.4966 84.6068C39.9315 80.5973 38.3249 79.8545 38.3249 81.2899C38.3249 82.1704 50.1673 90.7581 52.0872 91.2706C53.0188 91.5191 56.1041 92.032 58.943 92.411C62.9527 92.9456 64.428 92.9933 65.5502 92.6236C67.2211 92.0734 68.5664 90.7737 69.2042 89.0937L69.6513 87.9165L72.8929 89.7778L80.275 88.2469C109.687 82.1481 111.826 81.6316 113.515 82.2819C113.77 82.3798 114.014 82.5041 114.34 82.6399C115.966 83.318 117.508 85.489 117.508 87.1019C117.508 88.5634 116.09 90.7446 114.672 91.4637C112.84 92.3925 72.0511 105.258 68.6524 105.979C66.633 106.407 64.3094 106.552 61.615 106.418C57.7848 106.228 57.0357 106.013 45.967 101.942C39.5728 99.5895 33.7427 97.6653 33.0105 97.6653C31.9892 97.6653 29.4226 99.2 21.9808 104.261C11.4011 111.455 10.7469 111.841 9.76872 111.467C8.77275 111.085 8.77614 84.5624 9.77211 82.0783C10.517 80.2208 12.5851 78.5666 20.0155 73.8845Z" fill="#a5a5a5" data-v-0b4a18e4></path><path d="M85.2227 81.4209C93.3162 79.8566 100.128 78.5134 100.361 78.436C101.994 77.8931 105.029 78.7525 105.665 79.9373C105.893 80.3637 105.937 80.7925 105.762 80.8906C105.586 80.9886 98.3854 82.4544 89.7592 84.1475L74.076 87.2265L72.2916 86.1026C71.3104 85.4844 70.5076 84.8181 70.5076 84.6216C70.5076 84.4251 77.1292 82.9847 85.2227 81.4209Z" fill="#a5a5a5" data-v-0b4a18e4></path></svg></div></div><div class="stepper-item" data-v-0b4a18e4><div class="stepper-item__icon" data-v-0b4a18e4><svg width="24" height="24" viewBox="0 0 126 126" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-0b4a18e4><path d="M82.5175 9.21365C85.2715 9.39705 87.0841 11.3277 87.0741 14.156C87.0795 14.4177 87.0492 14.679 86.984 14.933C86.4812 16.4517 85.9892 17.9738 85.4971 19.4958C84.2346 23.401 82.9723 27.3055 81.5311 31.1501C80.4997 33.8915 77.5254 35.1464 74.5211 34.2776C67.015 32.0563 58.9891 32.0647 51.488 34.3018C50.1198 34.7474 48.6246 34.6572 47.3247 34.0506C46.0247 33.4439 45.024 32.3694 44.5381 31.0584C42.5753 25.8071 40.7476 20.4546 39.2054 15.0537C38.2541 11.6703 40.8177 9.08816 44.483 9.19434C47.0617 9.27157 49.0445 10.5506 50.8321 12.1626C51.3419 12.6275 51.8312 13.1148 52.3202 13.602C52.9888 14.2679 53.6571 14.9335 54.3772 15.5412C55.8243 16.7623 56.9459 16.4003 57.5167 14.6386C57.5987 14.3878 57.6456 14.1246 57.6934 13.8561C57.7303 13.6493 57.7677 13.4393 57.8221 13.2293C58.5131 10.6954 60.7363 8.88545 63.1448 8.91441C65.4431 8.94336 67.6011 10.7002 68.2921 13.1135C68.3565 13.3328 68.4 13.5675 68.4439 13.8042C68.4889 14.0465 68.5342 14.2908 68.6026 14.5228C69.1784 16.4148 70.3201 16.7816 71.8573 15.4495C72.5932 14.8157 73.2823 14.1327 73.9713 13.4498C74.5574 12.8689 75.1433 12.2881 75.7578 11.7379C77.6405 10.039 79.8587 9.03507 82.5175 9.21365Z" fill="#a5a5a5" data-v-0b4a18e4></path><path d="M65.9869 92.7507V82.3544C68.0849 82.7647 69.6271 83.3632 70.4633 84.0872C71.2995 84.8111 71.7051 85.8537 71.7051 87.3016C71.7196 88.0389 71.5599 88.7697 71.238 89.4386C70.9162 90.1076 70.4407 90.6972 69.8474 91.1628C68.7611 92.063 67.4128 92.6176 65.9869 92.7507Z" fill="#a5a5a5" data-v-0b4a18e4></path><path d="M56.2305 72.3346C56.0627 71.9019 55.9951 71.439 56.0326 70.9784C56.0152 70.3546 56.1486 69.7355 56.4224 69.1701C56.6962 68.6046 57.1027 68.1083 57.6099 67.7205C58.5609 66.9698 59.7142 66.496 60.9346 66.3546V75.163C58.5863 74.5452 57.5047 73.9129 57.004 73.4834C56.6623 73.1594 56.3983 72.7673 56.2305 72.3346Z" fill="#a5a5a5" data-v-0b4a18e4></path><path fill-rule="evenodd" clip-rule="evenodd" d="M84.7538 47.8836C99.2446 59.5493 107.702 74.5838 110.07 92.7411C110.786 98.2674 110.11 103.475 106.825 108.118C103.856 112.322 99.3347 114.32 94.3976 115.541C89.1301 116.845 83.7474 117.1 78.3296 117.057C75.05 117.035 71.7704 117.042 68.07 117.049C66.053 117.053 63.9109 117.057 61.5756 117.057C59.0778 116.966 56.3776 117.004 53.5505 117.043C48.4603 117.115 42.9587 117.192 37.486 116.531C31.0468 115.759 24.8629 114.388 20.2863 109.397C18.6178 107.589 17.3538 105.468 16.5733 103.168C15.7927 100.868 15.5124 98.4372 15.7498 96.0279C17.5324 75.1195 26.7957 57.8841 44.6713 45.6634C57.4747 36.913 72.316 37.8783 84.7538 47.8836ZM71.615 96.332C73.5094 95.4953 75.1088 94.1431 76.2166 92.4418C77.3527 90.7482 77.9545 88.7731 77.949 86.7562C77.9885 84.718 77.3245 82.7249 76.0613 81.0899C75.1702 79.9032 74.0089 78.9291 72.6665 78.2423C71.4948 77.6776 69.5019 77.0839 66.5677 76.4324L65.9869 76.302V66.3353C68.6056 66.5766 69.582 67.6433 69.9926 68.4107C69.6824 68.6725 69.4329 68.9943 69.2603 69.3552C69.0878 69.7161 68.9961 70.108 68.9912 70.5054C68.9905 70.9463 69.0865 71.3823 69.2729 71.7849C69.4593 72.1875 69.7318 72.5475 70.0727 72.8414C70.7496 73.4548 71.6474 73.7906 72.5763 73.7778C73.1256 73.7888 73.6708 73.6844 74.1741 73.4718C74.6773 73.2593 75.1265 72.9437 75.4905 72.547C76.2448 71.7472 76.6502 70.6979 76.6221 69.6173C76.6221 67.2813 75.5206 65.2928 73.3424 63.7097C71.4748 62.3438 68.9712 61.4364 65.9669 61.0117V57.6669C65.9669 56.0935 65.0455 55.1282 63.4633 55.1282C61.881 55.1282 60.9346 56.0742 60.9346 57.6669V61.0455C59.2724 61.3184 57.6468 61.7684 56.0877 62.3872C54.2271 63.1794 52.6569 64.4928 51.5812 66.1567C50.4465 67.8226 49.8425 69.7723 49.8437 71.7651C49.777 73.5205 50.2774 75.2525 51.2758 76.7219C52.146 77.9119 53.3446 78.8432 54.7357 79.4103C56.737 80.1778 58.7896 80.8147 60.8796 81.3168H60.9547V92.7749C59.3226 92.7103 57.7328 92.2558 56.328 91.4524C55.3959 90.932 54.686 90.1092 54.3252 89.1309C55.0929 88.9939 55.783 88.593 56.2673 88.0028C56.7517 87.4125 56.9974 86.6729 56.9589 85.9212C56.9709 85.4347 56.8773 84.9511 56.6842 84.5015C56.4911 84.0519 56.2026 83.6461 55.8373 83.3101C55.4785 82.9749 55.0544 82.7115 54.5895 82.535C54.1246 82.3586 53.628 82.2726 53.1284 82.2821C52.4201 82.2627 51.7171 82.4058 51.0772 82.6995C50.4374 82.9932 49.8791 83.4291 49.4482 83.9713C48.5404 85.1407 48.0789 86.576 48.1413 88.0352C48.1383 89.9081 48.7714 91.7303 49.9439 93.2237C51.1778 94.801 52.8345 96.0241 54.7357 96.7615C56.7258 97.516 58.8222 97.9781 60.9547 98.1323V101.699C60.9547 103.133 61.9461 104.025 63.4833 104.025C65.0205 104.025 65.9869 103.147 65.9869 101.699V98.0357C67.9259 97.683 69.8149 97.1112 71.615 96.332Z" fill="#a5a5a5" data-v-0b4a18e4></path></svg></div></div></div><div class="flex flex-wrap items-center my-8" data-v-0b4a18e4><i class="material-icons icon-md" data-v-0b4a18e4>arrow_back</i><h3 class="text-3xl mx-4 font-semibold" data-v-0b4a18e4>Sell your</h3><div class="w-64 py-3 bg-grey-01" data-v-0b4a18e4></div></div>',2)),k("div",ul,[i[3]||(i[3]=R('<div class="flex-auto flex px-4 py-5 bg-grey-lighten my-2" data-v-0b4a18e4><div class="flex-auto" data-v-0b4a18e4><div class="w-32 py-3 bg-grey-01" data-v-0b4a18e4></div></div><div class="flex-auto text-right" data-v-0b4a18e4><i class="material-icons" data-v-0b4a18e4>expand_more</i></div></div><div class="flex-auto flex px-4 py-5 bg-grey-lighten my-2" data-v-0b4a18e4><div class="flex-auto" data-v-0b4a18e4><div class="w-32 py-3 bg-grey-01" data-v-0b4a18e4></div></div><div class="flex-auto text-right" data-v-0b4a18e4><i class="material-icons" data-v-0b4a18e4>expand_more</i></div></div><div class="flex-auto flex px-4 py-5 my-2" data-v-0b4a18e4><div class="flex-auto" data-v-0b4a18e4><h3 class="text-xl font-semibold" data-v-0b4a18e4>Conditions</h3></div><div class="flex-auto text-right" data-v-0b4a18e4><i class="material-icons transform rotate-180" data-v-0b4a18e4>expand_more</i></div></div>',3)),(f(!0),h(A,null,L(e.conditions,((e,a)=>(f(),h("div",{key:e.id,class:"flex-auto px-4"},[k("div",{class:T(["border",0===a?"border-blue-04":"border-blue-01","px-6","py-4","my-2","rounded-lg"])},[k("div",pl,[k("h6",ml,P(e.name),1),i[1]||(i[1]=k("p",{class:"text-blue-04"},"$999.99",-1))]),e.condition_term&&0===a?(f(),h("div",vl,[k("div",{innerHTML:e.condition_term[0]},null,8,gl),k("ul",yl,[(f(!0),h(A,null,L(e.condition_term,((e,a)=>(f(),h(A,{key:a},[0!==a?(f(),h("li",fl,[i[2]||(i[2]=k("i",{class:"material-icons text-green-04"},"check_circle",-1)),k("div",{innerHTML:e,class:"mx-4"},null,8,hl)])):U("",!0)],64)))),128))])])):U("",!0),0===a?(f(),h("div",bl,[k("button",{class:"py-4 px-6 rounded-lg text-white font-semibold bg-blue-04",onClick:i[0]||(i[0]=$((()=>{}),["prevent"]))}," Confirm Condition ")])):U("",!0)],2)])))),128))])])}],["__scopeId","data-v-0b4a18e4"]])},props:{modelValue:{type:Boolean,default:!1},condition:{type:Object,default:void 0}},emits:["update:modelValue","update:conditions"],setup:(e,i)=>({show:u({get:()=>e.modelValue,set:e=>{i.emit("update:modelValue",e)}}),conditions:u((()=>e.conditions||{}))})}),[["render",function(e,i,a,l,t,n){const o=g("PreviewCondition"),d=g("Modal");return f(),_(d,{modelValue:e.show,"onUpdate:modelValue":i[0]||(i[0]=i=>e.show=i),title:"Preview Condition",size:"md","hide-footer":""},{default:w((()=>[S(o,{conditions:e.conditions,class:"mb-4"},null,8,["conditions"])])),_:1},8,["modelValue"])}]]);var xl=Z(M({name:"ConditionModalDelete",components:{Modal:ie,Button:ee},props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","delete","cancel"],setup:(e,i)=>({show:u({get:()=>e.modelValue,set:e=>{i.emit("update:modelValue",e)}}),loading:m(!1),deleteCondition:()=>i.emit("delete"),cancelCondition:()=>i.emit("cancel")})}),[["render",function(e,i,a,l,t,n){const o=g("Button"),d=g("Modal");return f(),_(d,{modelValue:e.show,"onUpdate:modelValue":i[0]||(i[0]=i=>e.show=i),title:"Delete Condition",onClose:e.cancelCondition},{footer:w((()=>[S(o,{color:"red",loading:e.loading.delete,onClick:e.deleteCondition},{default:w((()=>i[1]||(i[1]=[V(" Delete ")]))),_:1},8,["loading","onClick"])])),default:w((()=>[i[2]||(i[2]=k("h6",{class:"font-normal mb-5 text-lg"}," Are you sure want to delete this condition? ",-1))])),_:1},8,["modelValue","onClose"])}]]);const Cl=M({name:"ConditionFormPreview",components:{Fieldset:Ne},props:{conditionName:{type:String,default:""},conditionGuideline:{type:String,default:""},conditionTerms:{type:Array,default:()=>[]}},setup:e=>({sanitizedConditionTerms:u((()=>e.conditionTerms.map((e=>ce(e||""))))),sanitizedConditionGuideline:u((()=>ce(e.conditionGuideline||"")))})}),wl={class:"h-full"},kl={class:"mb-4 p-4"},Sl={class:"my-2"},Pl={class:"text-lg"},Vl=["innerHTML"],Ul={class:"list"},Al=["innerHTML"];const Ml=M({name:"ConditionModalForm",components:{Modal:ie,Input:ae,Button:ee,Draggable:He,FormPreview:Z(Cl,[["render",function(e,i,a,l,t,n){const o=g("Fieldset");return f(),h("div",wl,[S(o,{class:"h-full"},{label:w((()=>i[0]||(i[0]=[k("span",{class:"text-grey-04"},"Preview Condition",-1)]))),default:w((()=>[k("div",kl,[k("div",Sl,[k("h2",Pl,P(e.conditionName),1),k("div",{innerHTML:e.sanitizedConditionGuideline,class:"my-4"},null,8,Vl)]),k("ul",Ul,[(f(!0),h(A,null,L(e.sanitizedConditionTerms,((e,i)=>(f(),h(A,{key:i},[e?(f(),h("li",{key:0,innerHTML:e},null,8,Al)):U("",!0)],64)))),128))])])])),_:1})])}]])},props:{modelValue:{type:Boolean,default:!1},conditions:{type:Array,default:void 0},condition:{type:Object,default:void 0},isEdit:{type:Boolean,default:!1}},emits:["update:modelValue","save","cancel"],setup(e,i){const a=u({get:()=>e.modelValue,set:e=>{i.emit("update:modelValue",e)}}),l=m({}),t=m(!1),n=m(!1),o={name:{required:$e},term:{required:$e},terms:{required:$e,minLength:Re(1),$each:{required:$e,minLength:Re(1)}}},s=Ee(o,l,{$lazy:!0}),r=m(!1);return v((()=>[a.value,e.isEdit]),(()=>{a.value&&(r.value=!1,s.value.$reset()),a.value&&e.isEdit?l.value=d({},e.condition):l.value={name:"",term:"",terms:[""]}})),{show:a,form:l,loading:t,validation:s,submitting:r,errorExist:n,createTerm:()=>{r.value=!1,l.value.terms.push("")},deleteTerm:e=>{r.value=!1,l.value.terms.splice(e,1)},saveCondition:()=>{var a;if(r.value=!0,s.value.$validate(),!s.value.$invalid&&(()=>{const e=s.value.terms.$model;if(e.length<=0)return!1;for(let i=0;i<e.length;i++)if(ue(e[i])||e[i].length<1)return!1;return!0})()){if(((null==(a=e.conditions)?void 0:a.length)?[...e.conditions].filter((e=>e.name.split(" ").join("").toLowerCase()===l.value.name.split(" ").join("").toLowerCase())):[]).length&&!l.value.id)return F({type:"warning",message:"Condition name is already taken!"});n.value=!1,r.value=!1,i.emit("save",l.value)}},cancelCondition:()=>{r.value=!1,s.value.$reset(),i.emit("cancel")}}}}),Il={key:0,class:"mb-4 bg-red-01 rounded-lg px-6 py-4"},Bl={class:"grid md:grid-cols-5 grid-cols-1 gap-6"},Tl={class:"col-span-3 space-y-3"},jl={key:0,class:"text-red-base mt-2 block"},Ll={key:1,class:"text-red-base mt-2 block"},Dl={class:"block"},El={class:"flex justify-between items-center -mx-2"},Ol={class:"px-2 flex-1 font-semibold"},Rl={key:0},$l={class:"pb-2 flex items-center -mx-1"},Fl={class:"px-1 mx-6"},Nl={class:"col-span-2"};const Hl=M({name:"ConditionMappingList",components:{ConditionModalPreview:_l,ConditionModalDelete:xl,ConditionModalForm:Z(Ml,[["render",function(e,i,a,l,t,n){var o;const d=g("Input"),s=g("Button"),r=g("Draggable"),c=g("FormPreview"),u=g("Modal");return f(),_(u,{modelValue:e.show,"onUpdate:modelValue":i[2]||(i[2]=i=>e.show=i),size:"lg",title:(null==(o=Object.keys(e.form))?void 0:o.length)?"Edit Condition":"Add Condition",onClose:e.cancelCondition},{footer:w((()=>{var a;return[S(s,{loading:e.loading,disabled:e.loading||0===(null==(a=e.form.terms)?void 0:a.length),color:"teal",onClick:e.saveCondition},{default:w((()=>i[11]||(i[11]=[V(" Save ")]))),_:1},8,["loading","disabled","onClick"])]})),default:w((()=>[k("div",null,[e.errorExist?(f(),h("div",Il," Condition ")):U("",!0),k("div",Bl,[k("div",Tl,[k("div",null,[S(d,{modelValue:e.form.name,"onUpdate:modelValue":i[0]||(i[0]=i=>e.form.name=i),type:"text",label:"Condition Name",class:"w-full",view:e.validation.name.$invalid?"danger":"default"},null,8,["modelValue","view"]),i[3]||(i[3]=k("span",{class:"text-xs text-grey-04 mt-2 block"}," ( Example: Broken, Normal, New, etc... ) ",-1)),(f(!0),h(A,null,L(e.validation.name.$errors,((e,i)=>(f(),h("span",{class:"text-red-base mt-2 block",key:i},P(e.$message)+". ",1)))),128))]),k("div",null,[S(d,{modelValue:e.form.term,"onUpdate:modelValue":i[1]||(i[1]=i=>e.form.term=i),disabled:!e.form.name,type:"text",label:"Condition Guideline",class:"w-full",view:e.validation.term.$invalid?"danger":"default"},null,8,["modelValue","disabled","view"]),i[4]||(i[4]=k("span",{class:"text-xs text-grey-04 mt-2 block"}," ( Examples: Choose if ALL of the following are true: ) ",-1)),(f(!0),h(A,null,L(e.validation.term.$errors,((e,i)=>(f(),h("p",{key:i},[e&&"minLength"===e.$validator?(f(),h("span",jl," Title is required ")):(f(),h("span",Ll,P(e.$message),1))])))),128))]),k("div",Dl,[i[9]||(i[9]=k("label",{class:"mb-2"},"Terms",-1)),S(r,{list:e.form.terms,handle:".dragable__icon"},{default:w((()=>[(f(!0),h(A,null,L(e.form.terms,((a,l)=>(f(),h("div",{key:l,class:"condition__draggable py-2"},[k("div",El,[i[7]||(i[7]=k("div",{class:"pb-2"},[k("span",{class:"material-icons text-grey-04 text-2xl mr-3 cursor-move dragable__icon"}," drag_handle ")],-1)),k("div",Ol,[S(d,{modelValue:e.form.terms[l],"onUpdate:modelValue":i=>e.form.terms[l]=i,disabled:!e.form.name,type:"text",class:"mb-2",block:"",view:e.validation.terms.$model[l].length<1&&e.submitting?"danger":"default"},null,8,["modelValue","onUpdate:modelValue","disabled","view"]),e.validation.terms.$model[l].length<1&&e.submitting?(f(),h("div",Rl,i[5]||(i[5]=[k("span",{class:"text-red-base text-xs mt-2 block"}," It must be at least one characters in length ",-1)]))):U("",!0)]),k("div",$l,[k("div",Fl,[S(s,{disabled:1===e.form.terms.length,color:"red",dense:"",onClick:i=>e.deleteTerm(l)},{default:w((()=>i[6]||(i[6]=[k("span",{class:"material-icons text-sm"},"delete",-1)]))),_:2},1032,["disabled","onClick"])])])])])))),128))])),_:1},8,["list"]),i[10]||(i[10]=k("span",{class:"text-xs text-grey-04 block"}," ( Examples: Activation Locked, Item Power On, etc... ) ",-1)),S(s,{class:"mt-4",view:"outlined",color:"teal",dense:"",onClick:e.createTerm},{default:w((()=>i[8]||(i[8]=[k("span",{class:"mx-2"},"Add Terms",-1)]))),_:1},8,["onClick"])])]),k("div",Nl,[S(c,{"condition-name":e.form.name,"condition-guideline":e.form.term,"condition-terms":e.form.terms},null,8,["condition-name","condition-guideline","condition-terms"])])])])])),_:1},8,["modelValue","title","onClose"])}]]),Draggable:He,Button:ee},props:{mixin:{type:Object,default:void 0},preset:{type:Object,default:void 0},category:{type:Object,default:void 0},main:{type:Object,default:void 0},refSource:{type:Object,default:void 0},priceEditor:{type:Boolean,default:!1},priceEditorCategory:{type:Object,default:void 0}},emits:["update:modelValue","update:modal","update:condition","openModal","setCondition","sortingCondition","confirmSave","confirmDelete"],setup(e,i){const a=e.main,{form:l,loading:t,modal:n,addCondition:o,editCondition:r,deleteCondition:c,sortingCondition:v}=e.mixin,{form:g,isValidJSON:y}=e.preset,{form:f}=e.category,h=u({get:()=>[...l.value.conditions],set:e=>{l.value.conditions=[...e]}}),b=m(!1),_=m(null),x={conditions:{required:$e,minLength:Re(1)}},C=p(),w=u((()=>{var e;const i=[...f.categories].findIndex((e=>e.is_mac));return!!(null==(e=null==C?void 0:C.query)?void 0:e.unique_id)&&i>=0})),k=Ee(x,l,{$lazy:!0}),S=()=>{b.value=!1,_.value=null,Object.keys(n.value).forEach((e=>{n.value[e]=!1}))},P=()=>{l.value.conditions=[...a.formEdit.conditions].map((e=>{let i=[];try{if(y(e.condition_term)){const a=JSON.parse(e.condition_term);i=Array.isArray(a)?a:[]}}catch(a){console.error("Error parsing condition terms:",a),i=[]}return s(d({},e),{terms:i?i.splice(1,i.length-1):[""],term:i?i[0]:e.condition_term})}))};return a.id&&P(),{main:a,form:l,modal:n,isEdit:b,loading:t,formPreset:g,dataToDrag:h,formCategory:f,sanitize:ce,selected:_,validation:k,submit:async()=>(await k.value.conditions.$validate(),!k.value.conditions.$error),openModalAdd:()=>{b.value=!1,_.value=null,n.value.condition=!0},openModalUpdate:(e,i)=>{b.value=!0,_.value=s(d({},e),{index:i}),n.value.condition=!0},openModaPreview:(e,i)=>{_.value=s(d({},e),{index:i}),n.preview=!0},openModalDelete:(e,i)=>{b.value=!0,_.value=s(d({},e),{index:i}),n.value.delete=!0},closeModal:S,saveCondition:async(i,t=!1)=>{n.value.condition=!1,b.value?a.id&&i.id?(await r(d({id:i.id},i)),await a.getDetail({id:a.id,priceSync:{uniqueId:a.uniqueId,sync:a.sync}}),P()):l.value.conditions[i.index]=d(d({},l.value.conditions[i.index]),i):a.id?(await o(d({id:a.id},i)),await a.getDetail({id:a.id,priceSync:{uniqueId:a.uniqueId,sync:a.sync}}),P()):l.value.conditions.push(i),t||e.refSource.handleRelabeling(),S()},deleteCondition:async()=>{n.value.delete=!1,e.refSource.loading=!0,e.refSource.deleteActiveCondtion(_.value),a.id?(await c(_.value.id),await a.getDetail({id:a.id,priceSync:{uniqueId:a.uniqueId,sync:a.sync}}),P()):l.value.conditions.splice(_.value.index,1),e.refSource.loading=!1,S()},sortingCondition:async e=>{var i,t,n;null==(t=null==(i=e.moved)?void 0:i.element)||t.id;const o=[...null==(n=l.value)?void 0:n.conditions].map(((e,i)=>({id:e.id,sort:i})));a.id&&await v(o)},previewCondition:()=>{},disabledUniqueAndMac:w}}}),ql={key:0,class:"flex w-full gap-4"},zl={class:"flex-1"},Gl={class:"font-semibold mb-2"},Jl=["innerHTML"],Wl={class:"list"},Yl=["innerHTML"],Zl={key:1,class:"lg:opacity-0 group-hover:opacity-100 transition-opacity"},Kl={class:"flex items-center justify-end"},Ql={key:1,class:"text-center border-2 border-grey-01 border-dashed px-6 py-8 rounded-lg"},Xl={key:2,class:"my-4"};const et=M({name:"ConditionMapping",components:{ConditionMappingSource:sl,ConditionMappingList:Z(Hl,[["render",function(e,i,a,l,t,n){var o;const d=g("Button"),s=g("Draggable"),r=g("ConditionModalForm"),c=g("ConditionModalPreview"),u=g("ConditionModalDelete"),p=y("loading");return f(),h(A,null,[k("div",null,[b((f(),h("div",null,[e.form.conditions.length>0?(f(),_(s,{key:0,modelValue:e.dataToDrag,"onUpdate:modelValue":i[0]||(i[0]=i=>e.dataToDrag=i),handle:".drag_indicator",disabled:e.disabledUniqueAndMac,onChange:e.sortingCondition},{default:w((()=>[(f(!0),h(A,null,L(e.dataToDrag,((a,l)=>{var t,n,o;return f(),h("div",{class:T([(null==(t=e.main)?void 0:t.synced)?"bg-opacity-50":"bg-opacity-10","border rounded-lg mb-4","border-grey-01 border-opacity-50 bg-grey-01","py-3 px-5","condition__draggable group","hover:border-opacity-80 transition-all ease-in-out duration-300"]),key:l},[a?(f(),h("div",ql,[(null==(n=e.main)?void 0:n.synced)?U("",!0):(f(),h("span",{key:0,class:T([e.disabledUniqueAndMac&&"opacity-30 cursor-not-allowed","material-icons text-grey-04 text-4xl cursor-move drag_indicator"])}," drag_indicator ",2)),k("div",zl,[k("p",Gl,P(a.name),1),k("div",{innerHTML:a.term},null,8,Jl),k("ul",Wl,[(f(!0),h(A,null,L(a.terms||[],((i,a)=>(f(),h(A,{key:a},[i&&i.length?(f(),h("li",{key:0,class:"text-grey-04",innerHTML:e.sanitize(i)},null,8,Yl)):U("",!0)],64)))),128))])]),e.disabledUniqueAndMac?U("",!0):(f(),h("div",Zl,[k("div",Kl,[S(d,{color:"teal",class:"mr-3 text-sm",dense:"",icon:"",onClick:i=>e.openModalUpdate(a,l)},{default:w((()=>i[4]||(i[4]=[k("span",{class:"material-icons text-sm"},"edit",-1)]))),_:2},1032,["onClick"]),(null==(o=e.main)?void 0:o.synced)?U("",!0):(f(),_(d,{key:0,color:"red",dense:"",onClick:i=>e.openModalDelete(a,l)},{default:w((()=>i[5]||(i[5]=[k("span",{class:"material-icons text-sm"}," delete ",-1)]))),_:2},1032,["onClick"]))])]))])):U("",!0)],2)})),128))])),_:1},8,["modelValue","disabled","onChange"])):(f(),h("div",Ql,i[6]||(i[6]=[k("p",{class:"text-grey-02 max-w-lg mx-auto w-full text-sm"},' Use the "Add New Condition" button below to create your item conditions from scratch, or save time and use our Preset Conditions ',-1)]))),(null==(o=e.main)?void 0:o.synced)?U("",!0):(f(),h("div",Xl,[S(d,{class:"block w-full",color:"teal",disabled:!e.formCategory.categories||!e.formCategory.categories.length||!e.formCategory.group_name||e.disabledUniqueAndMac,onClick:e.openModalAdd},{default:w((()=>i[7]||(i[7]=[k("span",{class:"flex items-center justify-center"},[k("i",{class:"material-icons icon-xxs mr-2"},"add"),V(" Add New Condition ")],-1)]))),_:1},8,["disabled","onClick"])]))])),[[p,e.loading]]),S(r,{modelValue:e.modal.condition,"onUpdate:modelValue":i[1]||(i[1]=i=>e.modal.condition=i),condition:e.selected,conditions:e.form.conditions,"is-edit":e.isEdit,onSave:e.saveCondition,onCancel:e.closeModal},null,8,["modelValue","condition","conditions","is-edit","onSave","onCancel"]),S(c,{modelValue:e.modal.preview,"onUpdate:modelValue":i[2]||(i[2]=i=>e.modal.preview=i),condition:e.selected},null,8,["modelValue","condition"]),S(u,{modelValue:e.modal.delete,"onUpdate:modelValue":i[3]||(i[3]=i=>e.modal.delete=i),onCancel:e.closeModal,onDelete:e.deleteCondition},null,8,["modelValue","onCancel","onDelete"])]),(f(!0),h(A,null,L(e.validation.conditions.$errors.length,(e=>(f(),h("div",{key:e,class:"bg-red-lighten rounded-lg py-4 px-6 my-6"},i[8]||(i[8]=[k("span",{class:"text-red-base block"}," Please add at least 1 condition ",-1)]))))),128))],64)}]]),Fieldset:Ne},props:{mixin:{type:Object,default:void 0},category:{type:Object,default:void 0},main:{type:Object,default:void 0},priceEditor:{type:Boolean,default:!1},priceEditorCategory:{type:Object,default:void 0}},setup(e,i){const{preset:a,active:l}=e.mixin,t=e.category,n=e.main,o=m(),d=m();return{main:n,isMac:u((()=>{var e,i,a;return!!(null==(a=null==(i=null==(e=null==t?void 0:t.form)?void 0:e.categories)?void 0:i.filter((e=>!!Number(e.is_mac))))?void 0:a.length)})),preset:a,active:l,category:t,mappingList:o,mappingSource:d}}}),it={class:"flex flex-col lg:flex-row gap-4"},at={class:"lg:w-1/4"},lt={class:"flex-1"};const tt=M({components:{Button:ee,Modal:ie,ConditionCategory:za,ConditionMapping:Z(et,[["render",function(e,i,a,l,t,n){const o=g("ConditionMappingSource"),d=g("Fieldset"),s=g("ConditionMappingList");return f(),h("div",it,[k("div",at,[S(d,{class:"rounded-lg"},{label:w((()=>i[0]||(i[0]=[V("Preset Condition")]))),default:w((()=>[S(o,{ref:"mappingSource",mixin:e.preset,category:e.category,active:e.active,main:e.main,refList:e.mappingList,"price-editor":e.priceEditor,"price-editor-category":e.priceEditorCategory},null,8,["mixin","category","active","main","refList","price-editor","price-editor-category"])])),_:1})]),k("div",lt,[S(d,{class:"rounded-lg"},{label:w((()=>i[1]||(i[1]=[V("Active Conditions")]))),default:w((()=>[S(s,{ref:"mappingList",mixin:e.active,preset:e.preset,category:e.category,main:e.main,refSource:e.mappingSource,"price-editor":e.priceEditor,"price-editor-category":e.priceEditorCategory},null,8,["mixin","preset","category","main","refSource","price-editor","price-editor-category"])])),_:1})])])}]])},props:{id:{type:[Number,String],default:void 0},isPriceSync:{type:Boolean,default:!1},companySource:{type:String,default:""},priceEditor:{type:Boolean,default:!1},priceEditorCategory:{type:Object,default:void 0},noSave:{type:Boolean,default:!1}},async setup(e,{emit:i}){const{main:a,category:l,condition:t}=(()=>{const e=m(!1),i=m({groupName:null,conditions:[],categories:[]}),a=u((()=>se.state.setting.condition.price_sync_company_source));return{main:{loading:e,formEdit:i,action:{add:async e=>await se.dispatch("setting/condition/create",{group_name:e.group_name,categories:JSON.stringify(e.categories),conditions:JSON.stringify(e.conditions.map((e=>s(d({},e),{terms:[e.term,...e.terms]}))))}),update:async e=>await se.dispatch("setting/condition/update",{id:e.id,data:{group_name:e.group_name,categories:JSON.stringify(e.categories)}}),delete:async e=>await se.dispatch("setting/condition/delete",e)},companyName:a,getDetail:async(a,l=(()=>{}))=>{var t,n;try{e.value=!0;const o=await se.dispatch("setting/condition/show",d(d({id:a.id},a.priceSync.uniqueId&&(null==(t=a.priceSync)?void 0:t.sync)&&{params:{unique_id:a.priceSync.uniqueId,is_price_sync:null==(n=a.priceSync)?void 0:n.sync}}),a.priceSync.uniqueId&&{params:{unique_id:a.priceSync.uniqueId}}));i.value.groupName=o.group_name,i.value.conditions=o.conditions,i.value.categories=o.categories,re(l)&&l(o)}catch(o){re(l)&&l(o)}finally{e.value=!1}}},category:Aa(),condition:{preset:Ma(),active:Ia()}}})(),n=p(),o=N(),{unique_id:r,price_sync:c}=n.query,v=u((()=>c)),g=u((()=>r&&1==c)),y=u((()=>r||null)),f=m(s(d({},a),{sync:v,synced:g,uniqueId:y})),h=m(),b=m(),_=m(!1),x=()=>{f.value.loading=!1,_.value=!1};return e.id&&await f.value.getDetail({id:e.id,priceSync:{sync:v.value,uniqueId:y.value}}),{main:f,category:l,condition:t,refCategory:b,refMapping:h,resetData:x,modalDelete:_,saveCondition:async()=>{const i=await b.value.submit(),a=await h.value.mappingList.submit();i&&a&&(f.value.loading=!0,e.id?await f.value.action.update({id:e.id,group_name:b.value.form.group_name,categories:b.value.form.categories}).then((()=>{x(),e.priceEditor||o.push({name:"settingCondition"})})).catch((()=>{x()})):await f.value.action.add({group_name:b.value.form.group_name,categories:b.value.form.categories,conditions:h.value.mappingList.form.conditions}).then((()=>{x(),e.priceEditor||o.push({name:"settingCondition"})})).catch((()=>{x()})))},deleteCondition:async()=>{e.id&&(_.value=!1,f.value.loading=!0,await f.value.action.delete(e.id).then((()=>{x(),o.push({name:"settingCondition"})})).catch((()=>{x()})))},router:o,route:n}}}),nt={class:"flex flex-col gap-6"},ot={class:"space-y-4"},dt={class:"lg:ml-14"},st={class:"space-y-4"},rt={class:"lg:ml-14"};const ct=M({name:"BulkPriceEditorMappingCondition",components:{Modal:ie,Button:ee,ConditionForm:Z(tt,[["render",function(e,i,a,l,t,n){var o;const r=g("ConditionCategory"),c=g("ConditionMapping"),u=g("Button"),p=g("Modal"),m=y("loading");return b((f(),h("div",null,[k("div",nt,[k("div",ot,[i[4]||(i[4]=k("div",{class:"flex items-center gap-6"},[k("div",{class:"flex items-center justify-center bg-teal-04 rounded-full text-white font-semibold w-8 h-8"},[k("span",null,"1")]),k("h6",{class:"text-lg text-teal-04"},"Set Category")],-1)),k("div",dt,[i[3]||(i[3]=k("div",{class:"flex items-center text-left border-l-4 border-orange-02 px-4 py-2 gap-2 mb-2 info-warning"},[k("i",{class:"material-icons"},"info_outline"),k("p",null,"To assign a Preset Condition to more than one item in a group, first select one item, apply a preset, and then add more items as needed.")],-1)),S(r,{ref:"refCategory",mixin:e.category,main:s(d({},e.main),{id:e.id}),"price-editor":e.priceEditor,"price-editor-category":e.priceEditorCategory},null,8,["mixin","main","price-editor","price-editor-category"])])]),k("div",st,[i[5]||(i[5]=k("div",{class:"flex items-center gap-6"},[k("div",{class:"flex items-center justify-center bg-teal-04 rounded-full text-white font-semibold w-8 h-8"},[k("span",null,"2")]),k("h6",{class:"text-lg text-teal-04"},"Set Condition")],-1)),k("div",rt,[S(c,{ref:"refMapping",mixin:e.condition,category:e.category,main:s(d({},e.main),{id:e.id}),"price-editor":e.priceEditor,"price-editor-category":e.priceEditorCategory},null,8,["mixin","category","main","price-editor","price-editor-category"])])])]),(null==(o=e.main)?void 0:o.synced)||e.priceEditor?U("",!0):(f(),h("div",{key:0,class:T([[e.id||!e.noSave?"border-t":""],"mt-10 -mx-6 -mb-6 px-10 py-6 border-grey-01"])},[k("div",{class:T(["flex items-center",e.id&&!e.noSave?"justify-between":"justify-end"])},[e.id?b((f(),h("a",{key:0,href:"#",class:"text-red-04 hover:text-red-02 focus:text-red-02",onClick:i[0]||(i[0]=$((i=>e.modalDelete=!0),["prevent"]))},i[6]||(i[6]=[V(" Delete ")]))),[[m,e.main.loading]]):U("",!0),e.noSave?U("",!0):(f(),_(u,{key:1,color:"teal",loading:e.main.loading,onClick:e.saveCondition},{default:w((()=>i[7]||(i[7]=[V(" Save ")]))),_:1},8,["loading","onClick"]))],2)],2)),e.id&&!e.main.synced?(f(),_(p,{key:1,modelValue:e.modalDelete,"onUpdate:modelValue":i[2]||(i[2]=i=>e.modalDelete=i),title:"Delete Category",size:"xs"},{footer:w((()=>[S(u,{view:"outlined",color:"teal",class:"mr-5",disabled:e.main.loading,onClick:i[1]||(i[1]=i=>e.modalDelete=!1)},{default:w((()=>i[8]||(i[8]=[V(" Cancel ")]))),_:1},8,["disabled"]),S(u,{view:"smooth",color:"red",loading:e.main.loading,onClick:e.deleteCondition},{default:w((()=>i[9]||(i[9]=[V(" Delete ")]))),_:1},8,["loading","onClick"])])),default:w((()=>[i[10]||(i[10]=k("h6",{class:"text-lg font-normal mb-5"}," Are you sure want to delete this category? ",-1))])),_:1},8,["modelValue"])):U("",!0)])),[[m,e.main.loading]])}],["__scopeId","data-v-0df15304"]])},emits:["back","save"],props:{modelValue:{type:Boolean,default:!1},pricingSource:{type:Object,default:void 0},main:{type:Object,default:void 0},category:{type:Object,default:void 0}},emits:["update:modelValue","back","save"],async setup(e,i){const a=m(),l=m(!1),t=u({get:()=>e.modelValue,set:e=>i.emit("update:modelValue",e)}),n=u((()=>null==e?void 0:e.category));return{app:app,loading:l,modal:t,categoryId:n,conditionForm:a,handleSave:async()=>{l.value=!0,await a.value.saveCondition(),l.value=!1,t.value=!1,i.emit("save")},handleBack:()=>{t.value=!1,i.emit("back")}}}}),ut={class:"border-b border-grey-01 px-10 pb-5 mb-5 -mx-12"},pt={class:"flex items-center"},mt={class:"flex items-center justify-between"};const vt=M({name:"BulkPriceEditorSources",components:{Modal:ie,Input:ae,Button:ee,Checkbox:pe,SelectCountry:Te,SelectCurrency:je,BulkPriceEditorMappingMethod:Ua,BulkPriceEditorMappingCondition:Z(ct,[["render",function(e,i,a,l,t,n){const o=g("Tooltip"),d=g("ConditionForm"),s=g("Button"),r=g("Modal"),c=y("loading");return f(),_(r,{modelValue:e.modal,"onUpdate:modelValue":i[1]||(i[1]=i=>e.modal=i),size:"xl","hide-header":""},{footer:w((()=>[k("div",mt,[b((f(),h("a",{href:"#",onClick:i[0]||(i[0]=$(((...i)=>e.handleBack&&e.handleBack(...i)),["prevent"]))},i[5]||(i[5]=[V(" Go Back ")]))),[[c,e.loading]]),S(s,{color:"teal",loading:e.loading,onClick:e.handleSave},{default:w((()=>i[6]||(i[6]=[V(" Save ")]))),_:1},8,["loading","onClick"])])])),default:w((()=>[k("div",ut,[k("div",pt,[i[4]||(i[4]=k("h6",{class:"font-semibold"},"Add Manual Condition",-1)),S(o,{placement:"top"},{content:w((()=>i[2]||(i[2]=[k("div",{class:"w-80 text-sm"},"Price Sync is a tool that allows you to sync buyback pricing with a specific data source in real-time automatically. You can set rules to match, markup, or markdown the buyback price based on a percentage or fixed amount.",-1)]))),default:w((()=>[i[3]||(i[3]=k("i",{class:"material-icons mx-2 cursor-pointer"},"help",-1))])),_:1})])]),b((f(),h("div",null,[S(d,{ref:"conditionForm","price-editor-category":e.category,"price-editor":""},null,8,["price-editor-category"])])),[[c,e.loading]])])),_:1},8,["modelValue"])}]])},props:{modal:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},item:{type:Object,default:void 0},overlayModals:{type:[Boolean,Array],default:!1},priceSharing:{type:Boolean,default:!1}},emits:["update:modal","update:editing","update:item","cancel","apply"],setup(e,i){const a=m(!1),l=m(),t=m("3"),n=m("1"),o=m(0),r=m(""),c=m(""),p=m(""),g=u((()=>[...G.value].filter((e=>e.checked)))),y=m(),f=u({get:()=>e.modal,set:e=>i.emit("update:modal",e)}),h=u({get:()=>e.editing,set:e=>i.emit("update:editing",e)}),b=u({get:()=>e.item,set:e=>i.emit("update:item",e)}),_=u((()=>{var i,a;const l=(null==(a=null==(i=null==e?void 0:e.item)?void 0:i.level_names)?void 0:a.length)?[...e.item.level_names]:[];return(null==l?void 0:l.length)?null==l?void 0:l.shift():""})),x=m(null),C=m({}),w=m(!1),k=u((()=>!!(null==w?void 0:w.value)||(Array.isArray(e.overlayModals)?e.overlayModals.includes(!0):e.overlayModals))),S=u((()=>e.loading)),{me:P}=Q(),{state:V,action:U,loading:A,actionCoverage:M,actionCheckDevicePricingSource:I}=me();ve();const{loading:B,actionAll:T,actionConditionUpdate:j,getRule:L}=ge(),{actionSetLevel:D}=K(),E=m([]),O=m(void 0),R=m(!1),$=u((()=>{const e=P.value.currency.split("");return e.pop(),e.join("").toLowerCase()})),F=m(!0),N=m(!1),H=m(!1),q=u((()=>{const e=new Map;return E.value.forEach((i=>{i.country_code&&i.country_name&&!e.has(i.country_code)&&e.set(i.country_code,{country_code:i.country_code,nicename:i.country_name,iso3:i.country_code})})),Array.from(e.values()).sort(((e,i)=>e.nicename.localeCompare(i.nicename)))})),z=u((()=>{const e=new Map;return E.value.forEach((i=>{i.currency&&!e.has(i.currency)&&e.set(i.currency,{currency_code:i.currency,country_code:i.country_code,name:i.currency})})),Array.from(e.values()).sort(((e,i)=>e.currency_code.localeCompare(i.currency_code)))})),G=u((()=>{let e=[...E.value];return c.value&&(e=e.filter((e=>{var i;return(null==(i=e.country_code)?void 0:i.toLowerCase())===c.value.toLowerCase()}))),p.value&&(e=e.filter((e=>{var i;return(null==(i=e.currency)?void 0:i.toLowerCase())===p.value.toLowerCase()}))),e}));let J=!1;const W=()=>{c.value="",p.value=""},Y=()=>{t.value="3",n.value="1",o.value=0,x.value=null,E.value=[],W(),f.value=!1},Z=()=>D(b.value),X=async()=>{E.value=[...V.value].map((i=>s(d({},i),{loading:!0,checked:!1,disabled:e.priceSharing&&!i.is_scraper}))),await Promise.all([E.value.forEach((async e=>{e=await M({category_id:null==b?void 0:b.value.id,level:Z(),source:e.sub_domain},e,(i=>{e.price_coverage=parseFloat(((null==i?void 0:i.price_coverage)||0).toFixed(2))}))}))])},ee=u((()=>{if("single"===y.value&&h.value&&!R.value)return"You're using the same data source and pricing rules for all your items. To use different data sources for different items, start by selecting more than one data source from the list below, map the conditions, set pricing rules, and click Apply. Then, click the arrow next to the brand name on the left to expand the list. Hover over an item with active price sync to reveal the Edit button, and click it to select your\n          preferred data source for that item.";if("multiple"===y.value&&h.value&&!R.value)return"You're using multiple data sources for various items. To view them, click 'Cancel,' then click the arrow next to the brand name on the left to expand the list. Next, hover over an item with an active price sync to reveal the edit button, then click it to view its data source and pricing rule. If you want to change the data source and pricing rule for all items at once, use the menu below.";if("single"===y.value&&h.value&&R.value){return"device"===Z()?"You're using multiple data sources and different pricing rules for various items. To view them, click 'Cancel,' then click the arrow next to the brand name on the left to expand the list. Next, hover over an item with an active price sync to reveal the edit button, then click it to view its data source and pricing rule. If you want to change the data source and pricing rule for all items at once, use the menu below.":"You're using different pricing rules for this item. To view it, click 'Cancel, then click the arrow next to the brand name on the left to expand the list. Next, hover over the item to reveal the edit button, then click it to view its data source and pricing rule. If you want to change the data source and pricing rule for all item variants at once, use the menu below."}if("multiple"===y.value&&h.value&&R.value){return"device"===Z()?"You're using multiple data sources and different pricing rules for various items. To view them, click 'Cancel', then click the arrow next to the brand name on the left to expand the list. Next, hover over an item with an active price sync to reveal the edit button, then click it to view its data source and pricing rule. If you want to change the data source and pricing rule for all items at once, use the menu below.":"You're using different pricing rules for this item. To view it, click 'Cancel, then click the arrow next to the brand name on the left to expand the list. Next, hover over the item to reveal the edit button, then click it to view its data source and pricing rule. If you want to change the data source and pricing rule for all item variants at once, use the menu below."}}));return v((()=>f.value),(async()=>{var e;f.value&&(F.value=!0,await U({category_id:null==(e=b.value)?void 0:e.id}),X(),h.value&&(F.value=!1,await(async()=>{var e,i,a,l,r;B.all=!0,R.value=!1;try{const c=await L({category_id:null==(e=b.value)?void 0:e.id,level:Z()}),{rules:u,selected_sources:p,sources_conditions:m,device_mapping_type:v}=c;p&&(y.value=(null==p?void 0:p.length)>1?"multiple":"single");const g=u?p:null;if((null==g?void 0:g.length)&&Object.keys(m).length&&(null==u?void 0:u.length)||(R.value=!0),C.value={rules:u,selectedSources:g,sourcesConditions:m,mappingType:v},(null==(a=null==(i=C.value)?void 0:i.selectedSources)?void 0:a.length)&&C.value.selectedSources.forEach((e=>{const i=E.value.findIndex((i=>i.sub_domain===e));E.value[i]&&(E.value[i]=s(d({},E.value[i]),{checked:!0}))})),"auto"===v||(null==(r=null==(l=null==C?void 0:C.value)?void 0:l.selectedSources)?void 0:r.length)<2){const e=[...C.value.rules].shift();t.value=e.type,n.value=e.amount_type,o.value=e.amount_price}}catch(c){console.error("Error fetching rule:",c),R.value=!0}finally{B.all=!1}})()))})),v(g,(e=>{const i=e.map((e=>e.sub_domain)).join("-");r.value=i}),{immediate:!0}),{me:P,type:t,rules:C,modal:f,state:V,action:U,editing:h,loading:A,sources:E,noRules:R,nameTitle:_,showTooltip:a,modalFormCondition:w,mappingType:x,connectData:O,loadingRule:S,amountType:n,isOverlays:k,flagDefault:$,amountPrice:o,itemSelected:b,sourceSelected:g,isUnavailable:F,handleCancel:()=>{Y(),i.emit("cancel")},handleApply:async()=>{var a,d,s,r,c,u;if(!(await(null==(a=null==l?void 0:l.value)?void 0:a.onSubmit())))return;const p=1===(null==(s=null==(d=null==l?void 0:l.value)?void 0:d.data)?void 0:s.method)?"auto":"manual",m=(Array.isArray(null==(c=null==(r=null==l?void 0:l.value)?void 0:r.data)?void 0:c.conditions)?[...l.value.data.conditions]:[]).map((i=>{var a,l,d,s;if(!("manual"===p?i.source_condition_id:i.id))return null;const r="manual"===p?Array.isArray(null==i?void 0:i.source_condition_id)?i.source_condition_id:[i.source_condition_id]:[i.id],c=(null==(a=g.value)?void 0:a.length)>1?Array.isArray(null==i?void 0:i.source)?i.source:[null==(l=null==i?void 0:i.source)?void 0:l.sub_domain]:[null==(s=null==(d=oe(g.value))?void 0:d.shift())?void 0:s.sub_domain];return r.map(((a,l)=>{var d,s,r,u;return{source_condition_id:(null==a?void 0:a.id)||a,member_condition_id:"manual"===p?i.id:null,source:(null==(d=c[l])?void 0:d.sub_domain)||c[0],type:(null==(s=g.value)?void 0:s.length)>1||e.priceSharing||(null==i?void 0:i.is_duplicate)?Number(i.pricingRuleType):Number(t.value),amount_type:(null==(r=g.value)?void 0:r.length)>1||e.priceSharing||(null==i?void 0:i.is_duplicate)?i.amountType:n.value,amount_price:(null==(u=g.value)?void 0:u.length)>1||e.priceSharing||(null==i?void 0:i.is_duplicate)?i.amountPrice:o.value}}))})).flat().filter(Boolean),v={category_id:b.value.id,mapping_type:p,level:Z(),mapping:m},y=!(null==e?void 0:e.editing)||((e,i)=>{if((null==e?void 0:e.length)!==(null==i?void 0:i.length))return!0;const a=["source_condition_id","member_condition_id","source","type","amount_type","amount_price"];for(let l of i){let i=e.find((e=>e.source_condition_id===l.source_condition_id));if(!i)return!0;for(let e of a)if(l[e]!=i[e])return!0}return!1})(v.mapping,null==(u=null==C?void 0:C.value)?void 0:u.rules);await Promise.all([i.emit("apply",{data:v,isNew:y},Y)])},loadingPricing:B,refMappingMethod:l,isDifferentRules:N,handleInitValue:X,handleManualMapping:()=>{w.value=!0},handleValidateSelected:e=>{H.value=(null==e?void 0:e.isAllDuplicate)||!1,e.selected.length?F.value=!1:F.value=!0},handleIntercomeMessage:()=>{window.CustomerSupport.use("showNewMessage","Hi, I would like to learn more about your custom data services")},handleSelectedMethod:e=>{F.value=1!==e},handleBackMappingCondition:()=>{},handleSaveMappingCondition:()=>{l.value.handleSelectMethod(2)},messageCase:ee,isRemoveStepThree:H,typeSelectedSource:y,handleChangeSource:()=>{x.value=null,l.value.handleReset()},handleCountryFilterChange:e=>{var i,a;const l=e?null==(i=e.country_code)?void 0:i.toLowerCase():"",t=null==(a=c.value)?void 0:a.toLowerCase();c.value=t&&l===t?"":l},handleCurrencyFilterChange:e=>{var i,a;if(J)return;J=!0;const l=e?null==(i=e.currency_code)?void 0:i.toLowerCase():"",t=null==(a=p.value)?void 0:a.toLowerCase();p.value=t&&l===t?"":l,setTimeout((()=>{J=!1}),50)},currencyOptions:z,countryOptions:q,selectedCountryFilter:c,selectedCurrencyFilter:p,filteredSources:G,countryOptions:q,currencyOptions:z,clearFilters:W,keyForm:r}}}),gt={class:"border-b border-grey-01 px-10 pb-5 mb-5 -mx-12"},yt={key:0,class:"flex items-center gap-x-2"},ft={class:"font-semibold"},ht={key:1,class:"font-semibold"},bt={class:"space-y-10"},_t={key:0,class:"bg-teal-01 bg-opacity-50 rounded-md px-4 py-1.5 flex items-center gap-x-4"},xt={class:"space-y-6"},Ct={class:"space-y-4"},wt={class:"space-y-6"},kt={class:"flex justify-end gap-x-4"},St={class:"w-64"},Pt={class:"w-64"},Vt={class:"border border-grey-01 rounded-md relative"},Ut={class:"max-h-80 overflow-y-auto overflow-x-hidden py-6 px-4"},At={class:"flex gap-x-4"},Mt={class:"lowercase"},It={class:"flex flex-wrap md:flex-nowrap justify-end items-center gap-x-2 md:gap-y-0 gap-y-2"},Bt={key:0,class:"bg-green-01 text-green-04 text-sm rounded-full px-4 py-1 flex items-center"},Tt={class:"group-hover:bg-white bg-grey-01 bg-opacity-20 px-3 py-1 rounded-full"},jt={class:"font-semibold"},Lt={class:"group-hover:bg-white bg-grey-01 bg-opacity-20 px-3 py-1 rounded-full"},Dt={key:0,class:"font-semibold"},Et={key:1,class:"font-semibold"},Ot={class:"flex items-center gap-4 mx-2 text-sm text-grey-03"},Rt=["src","alt"],$t={class:"text-xl font-medium"},Ft={key:0,class:"flex items-center justify-between"},Nt={class:"max-w-lg"},Ht={key:0,class:"grid grid-cols-2 max-w-lg gap-2"},qt={class:"max-w-xs text-sm"},zt={key:0,class:"text-grey-03"},Gt={key:1,class:"text-grey-03"},Jt={class:"flex justify-between items-center"};var Wt=Z(vt,[["render",function(e,i,a,l,t,n){const o=g("Tooltip"),d=g("SelectCountry"),s=g("SelectCurrency"),r=g("Checkbox"),c=g("tooltip"),u=g("BulkPriceEditorMappingMethod"),p=g("RadioButton"),m=g("RadioGroup"),v=g("Input"),x=g("Button"),C=g("Modal"),M=g("BulkPriceEditorMappingCondition"),I=y("loading");return f(),h(A,null,[k("div",{class:T(e.isOverlays?"hidden":"block")},[S(C,{modelValue:e.modal,"onUpdate:modelValue":i[10]||(i[10]=i=>e.modal=i),size:"xl","hide-header":""},{footer:w((()=>{var a,l;return[k("div",Jt,[k("a",{href:"javascript:void(0)",class:"text-red-04 hover:text-red-02 mr-8",onClick:i[9]||(i[9]=(...i)=>e.handleCancel&&e.handleCancel(...i))}," Cancel "),S(x,{loading:e.loadingRule||e.loading.check||e.loadingPricing.all,disabled:!e.editing&&(e.isUnavailable||e.editing||!(null==(a=e.sourceSelected)?void 0:a.length)||(null==(l=e.sourceSelected)?void 0:l.length)>5),color:"teal",class:"ml-auto small",onClick:e.handleApply},{default:w((()=>i[34]||(i[34]=[V(" Apply ")]))),_:1},8,["loading","disabled","onClick"])])]})),default:w((()=>{var a,l,t,n,g,y,x,C,M,B,j;return[k("div",gt,[e.nameTitle?(f(),h("div",yt,[k("h6",ft," Price Sync - "+P(e.nameTitle)+" Category ",1),S(o,{placement:"top"},{content:w((()=>i[12]||(i[12]=[k("div",{class:"max-w-sm text-sm"}," Price Sync is a tool that allows you to automatically price your items using one or more of the data sources below. You can create rules to match, mark up, or mark down buyback prices based on a set percentage or fixed amount. ",-1)]))),default:w((()=>[i[13]||(i[13]=k("i",{class:"material-icons cursor-default"},"info",-1))])),_:1})])):(f(),h("h6",ht,"Price Sync"))]),e.messageCase&&(null==(l=null==(a=e.itemSelected)?void 0:a.children)?void 0:l.length)>0?(f(),h("div",{key:0,class:T(["bg-blue-01 text-blue-04 bg-opacity-50 rounded-md px-4 py-1.5 flex gap-x-4",e.editing&&e.noRules?"mb-4":"mb-10"])},[i[14]||(i[14]=k("span",{class:"material-icons"},"info",-1)),k("p",null,P(e.messageCase),1)],2)):U("",!0),k("div",bt,[e.editing&&e.noRules?b((f(),h("div",_t,i[15]||(i[15]=[k("span",{class:"material-icons"},"info",-1),k("p",null,"Price sync has been edited for some items in this category.",-1)]))),[[I,(null==(t=e.loading)?void 0:t.check)||(null==(n=e.loading)?void 0:n.all)||(null==(g=e.loadingPricing)?void 0:g.all)]]):U("",!0),b((f(),h("div",xt,[i[27]||(i[27]=k("div",{class:"flex items-center gap-x-4"},[k("div",{class:"bg-teal-04 w-6 h-6 rounded-full flex items-center justify-center text-white"},"1"),k("span",{class:"font-medium text-lg"},"Select your data source")],-1)),k("div",Ct,[k("div",wt,[i[24]||(i[24]=k("div",{class:"flex flex-wrap gap-x-4 gap-y-2"},[k("div",{class:"text-green-04 flex items-center gap-x-1 text-sm bg-green-01 bg-opacity-80 rounded-full px-4"},[k("span",{class:"material-icons"},"check_circle"),k("p",{class:"whitespace-pre-wrap"},"Support all countries")]),k("div",{class:"text-green-04 flex items-center gap-x-1 text-sm bg-green-01 bg-opacity-80 rounded-full px-4"},[k("span",{class:"material-icons"},"check_circle"),k("p",{class:"whitespace-pre-wrap"},"Automatically converts the currency")]),k("div",{whitelabel:"remove",class:"text-green-04 flex items-center gap-x-1 text-sm bg-green-01 bg-opacity-80 rounded-full px-4"},[k("span",{class:"material-icons"},"check_circle"),k("p",{class:"whitespace-pre-wrap"},"Supports using up to 5 data sources at the same time")])],-1)),k("div",kt,[S(o,{placement:"top"},{content:w((()=>i[16]||(i[16]=[k("div",{class:"max-w-xs text-sm"}," If there are no sources available for your region, you can use sources from other regions, as the currency will automatically convert to your local currency, and you can adjust the pricing rules accordingly. ",-1)]))),default:w((()=>[k("div",null,[k("div",St,[S(d,{selected:e.selectedCountryFilter,countries:e.countryOptions,placeholder:"Select Region",rounded:"",noBorder:"",onChange:e.handleCountryFilterChange},null,8,["selected","countries","onChange"])])])])),_:1}),S(o,{placement:"top"},{content:w((()=>i[17]||(i[17]=[k("div",{class:"max-w-xs text-sm"}," If there are no sources available for your region, you can use sources from other regions, as the currency will automatically convert to your local currency, and you can adjust the pricing rules accordingly. ",-1)]))),default:w((()=>[k("div",Pt,[S(s,{selected:e.selectedCurrencyFilter,currencies:e.currencyOptions,placeholder:"Select Currency",rounded:"",onChange:e.handleCurrencyFilterChange},null,8,["selected","currencies","onChange"])])])),_:1})]),k("div",Vt,[i[23]||(i[23]=k("span",{class:"bg-white text-sm absolute rounded-full px-2 py-1 -top-4 left-3 text-grey-03",style:{"z-index":"1"}},"Data Source",-1)),k("div",Ut,[(f(!0),h(A,null,L(e.filteredSources,((a,l)=>(f(),_(o,{key:l,placement:"top-start",disabled:!a.disabled},{content:w((()=>i[18]||(i[18]=[k("p",{class:"max-w-xl text-sm font-normal"},"As a price source on the platform, you cannot use another price source that is also using the platform; you are only permitted to use scraping sources like BuybackBoss, BuybackWorld, ItsWorthMore, and Atlas.",-1)]))),default:w((()=>{var l,t;return[k("div",{class:T([a.disabled?"opacity-50":"","hover:bg-grey-01 hover:bg-opacity-50 group flex flex-wrap md:flex-nowrap items-center justify-between px-4 md:py-0 py-4 md:h-16 gap-x-4 gap-y-2 md:gap-y-0"])},[k("div",At,[S(r,{modelValue:a.checked,"onUpdate:modelValue":e=>a.checked=e,value:!0,"value-off":!1,disabled:(null==(l=e.sourceSelected)?void 0:l.length)>=5&&!a.checked||a.disabled,class:T(["font-medium",!a.checked&&!a.disabled&&(null==(t=e.sourceSelected)?void 0:t.length)<5&&"checkbox-blink"]),color:"teal",view:"smooth",type:"checkbox",block:"",onChange:e.handleChangeSource},{default:w((()=>[k("span",Mt,P(a.name),1)])),_:2},1032,["modelValue","onUpdate:modelValue","disabled","class","onChange"])]),k("div",It,[a.is_support_sell_instantly?(f(),h("div",Bt,i[19]||(i[19]=[k("span",{class:"material-icons"},"flash_on",-1),V(" Support Sell Instantly ")]))):U("",!0),k("div",Tt,[i[20]||(i[20]=V(" Data Refresh Frequency: ")),k("span",jt,P(a.refresh_frequency),1)]),k("div",Lt,[i[22]||(i[22]=V(" Item Coverage: ")),a.loading?b((f(),h("span",Et,i[21]||(i[21]=[V(P("...%"))]))),[[I,a.loading]]):(f(),h("span",Dt,P(`${a.price_coverage}%`),1))]),k("div",Ot,[S(c,{placement:"top"},{content:w((()=>[V(P(a.country_name),1)])),default:w((()=>{var e;return[k("img",{src:`/flag/${null==(e=a.country_code)?void 0:e.toLowerCase()}.svg`,width:"20",alt:a.country_name,class:"rounded"},null,8,Rt)]})),_:2},1024),k("div",null,[k("span",$t,P(a.currency_symbol),1)])])])],2)]})),_:2},1032,["disabled"])))),128))])])]),e.connectData?(f(),h("div",Ft,[i[26]||(i[26]=k("span",{class:"text-sm"},"Custom ("+P("Connect Any Data")+")",-1)),k("button",{class:"rounded-full bg-teal-04 px-6 py-0.5 text-white flex items-center justify-center gap-x-4 text-sm",onClick:i[0]||(i[0]=(...i)=>e.handleIntercomeMessage&&e.handleIntercomeMessage(...i))},i[25]||(i[25]=[V(" Learn More "),k("i",{class:"material-icons"},"chevron_right",-1)]))])):U("",!0)])])),[[I,(null==(y=e.loading)?void 0:y.check)||(null==(x=e.loading)?void 0:x.all)||(null==(C=e.loadingPricing)?void 0:C.all)]]),k("div",{class:T([(null==(M=e.sourceSelected)?void 0:M.length)?"opacity-100":"opacity-30","space-y-6"])},[i[28]||(i[28]=k("div",{class:"flex items-center gap-x-4"},[k("div",{class:"bg-teal-04 w-6 h-6 rounded-full flex items-center justify-center text-white"},"2"),k("span",{class:"font-medium text-lg"},"Map The Condition")],-1)),k("div",null,[(f(),_(u,{key:e.keyForm,ref:"refMappingMethod",type:e.mappingType,"onUpdate:type":[i[1]||(i[1]=i=>e.mappingType=i),e.handleSelectedMethod],category:e.itemSelected,"pricing-source":e.sourceSelected,editing:e.editing,rules:e.rules,"different-rules":e.isDifferentRules,"company-source":e.priceSharing,onManualMapping:e.handleManualMapping,"onUpdate:different":i[2]||(i[2]=i=>e.isDifferentRules=i),onSelectedCondition:e.handleValidateSelected},null,8,["type","category","pricing-source","editing","rules","different-rules","company-source","onUpdate:type","onManualMapping","onSelectedCondition"]))])],2),e.isDifferentRules||e.priceSharing||e.isRemoveStepThree?U("",!0):(f(),h("div",{key:1,class:T([(null==(B=e.sourceSelected)?void 0:B.length)&&e.mappingType?"opacity-100":"opacity-30","space-y-2"])},[i[33]||(i[33]=k("div",{class:"flex items-center gap-x-4 mb-5"},[k("div",{class:"bg-teal-04 w-6 h-6 rounded-full flex items-center justify-center text-white"},"3"),k("span",{class:"font-medium text-lg"},"Set your pricing rules")],-1)),k("div",Nt,[S(m,{modelValue:e.type,"onUpdate:modelValue":i[3]||(i[3]=i=>e.type=i),class:"radio--full",disabled:!(null==(j=e.sourceSelected)?void 0:j.length)||!e.mappingType},{default:w((()=>[S(p,{label:"3"},{default:w((()=>i[29]||(i[29]=[V("Match")]))),_:1}),S(p,{label:"2"},{default:w((()=>i[30]||(i[30]=[V("Markup")]))),_:1}),S(p,{label:"1"},{default:w((()=>i[31]||(i[31]=[V("Markdown")]))),_:1})])),_:1},8,["modelValue","disabled"])]),3!=e.type?(f(),h("div",Ht,[S(m,{modelValue:e.amountType,"onUpdate:modelValue":i[4]||(i[4]=i=>e.amountType=i),class:"radio--full mb-4"},{default:w((()=>[S(p,{label:"1"},{default:w((()=>i[32]||(i[32]=[V(" % Percentage ")]))),_:1}),S(p,{label:"0"},{default:w((()=>[V(P(e.me.currency_symbol)+" Fixed ",1)])),_:1})])),_:1},8,["modelValue"]),S(o,{modelValue:e.showTooltip,"onUpdate:modelValue":i[8]||(i[8]=i=>e.showTooltip=i),placement:"top",manual:""},{content:w((()=>[k("p",qt,"Items priced at "+P(1==e.me.currency_prefix?`${e.me.currency_symbol}0`:`0${e.me.currency_symbol}`)+" are not subject to pricing rules.",1)])),default:w((()=>[S(v,{modelValue:e.amountPrice,"onUpdate:modelValue":i[5]||(i[5]=i=>e.amountPrice=i),right:"0"!=e.amountPrice,min:0,max:1==e.amountType?100:"auto",type:"number",class:"w-full","icon-block":"",icon:"",onFocusIn:i[6]||(i[6]=i=>e.showTooltip=!0),onFocusOut:i[7]||(i[7]=i=>e.showTooltip=!1)},{icon:w((()=>["0"==e.amountType?(f(),h("span",zt,P(e.me.currency_symbol),1)):(f(),h("span",Gt," % "))])),_:1},8,["modelValue","right","max"])])),_:1},8,["modelValue"])])):U("",!0)],2))])]})),_:1},8,["modelValue"])],2),S(M,{modelValue:e.modalFormCondition,"onUpdate:modelValue":i[11]||(i[11]=i=>e.modalFormCondition=i),category:e.itemSelected,"pricing-source":e.sourceSelected,onBack:e.handleBackMappingCondition,onSave:e.handleSaveMappingCondition},null,8,["modelValue","category","pricing-source","onBack","onSave"])],64)}]]);const Yt=M({name:"BulkPriceEditorList",components:{Input:ae,Button:ee,ExpandablePanel:Be,DeviceInput:wi,SyncPricing:ri,Pagination:ye,BulkPriceEditorSources:Wt,Alert:fe},props:{id:{type:[String,Number],default:void 0},items:{type:Object,default:()=>({})},automatedPrice:{type:[Boolean,Number,String],default:!1},isLoading:{type:Boolean,default:!1},roundUp:{type:[String,Number],default:void 0},priceSharing:{type:Boolean,default:!1},priceScraper:{type:Boolean,default:!1},availablePrice:{type:[String,Number],default:void 0},sycnablePrice:{type:[String,Number],default:void 0},search:{type:String,default:null},disabledAction:{type:Object,default:void 0}},emits:["refetch-device","pricing-flag-updated","show-prices"],setup(e,i){const a=p(),{loading:l,actionAll:t,actionUpdate:n,actionSetRule:o,actionUnsetRule:r,actionSetLevel:c}=K(a.params.tab),{items:g,sources:y,loading:f,resetBulkCustomPriceV2:h,handleTimeOut:b,handleSetPriceSyncCustomPrice:_,handleUnsetPriceSyncCustomPrice:x,handleResetPriceSyncCustomPrice:C,handleSavePriceSyncCustomPrice:w,handleSetItems:k,handleSetDevices:S}=he(),{getRule:P}=ge(),V=m([]);m();const U=u((()=>{var e;return(null==(e=V.value)?void 0:e.length)>1})),A=(e,i)=>{var a;if(!e||!e.data)return void(i.devices={data:[],filters:{page:1,limit:50,search:""},isFetched:!0});const l=S(e)||{};i.conditions_sources=(null==(a=null==l?void 0:l.data[0])?void 0:a.price)||[];const{current_page:t,first_page_url:n,from:o,last_page:r,last_page_url:c,next_page_url:u,path:p,per_page:m,prev_page_url:v,to:g,total:y}=e,{filters:f}=(null==i?void 0:i.devices)||{};i.devices=s(d({filters:{page:(null==e?void 0:e.current_page)||1,limit:(null==e?void 0:e.per_page)||50,search:(null==f?void 0:f.search)||(null==i?void 0:i.search)||"",current_page:t,first_page_url:n,from:o,last_page:r,last_page_url:c,next_page_url:u,path:p,per_page:m,prev_page_url:v,to:g,total:y}},l),{isFetched:!0})},M=async(e,i=!1)=>{var a,l,n;const o=(null==(a=e.devices)?void 0:a.isFetched)||(null==(l=e.children)?void 0:l.length)>0;if(e.loading=!0,o&&!i)return!0;try{const i={id:e.id},a=(null==(n=e.devices)?void 0:n.filters)||{},l=[];if(e.is_price_sync){const i=P({category_id:e.id,level:B(e)}).then((e=>(V.value=e.selected_sources,e)));l.push(i)}const o=t(i,d({},a),(i=>{A(i,e)}));return l.push(o),await Promise.all(l),!0}catch(s){return console.log("Fetching device Error",s),!1}finally{e.loading=!1}},I=de((async(e,i,a)=>{var l,t;(null==(l=null==e?void 0:e.devices)?void 0:l.filters)&&Object.keys(null==(t=null==e?void 0:e.devices)?void 0:t.filters).includes(a)&&(e.devices.filters[a]=i,"limit"===a&&(e.devices.filters.page=1),await M(e,!0))}),500),B=e=>c(e),T=async(e,i,a=!0)=>{y.value={modal:!0,item:e,isEdit:a,key:i}},j=(e,i)=>{var a;if(null==(a=null==i?void 0:i.children)?void 0:a.length)for(const l of i.children)j(e,l);else A(e,i)};return v((()=>({items:e.items,roundUp:e.roundUp})),((e,i)=>{JSON.stringify(null==e?void 0:e.items)!==JSON.stringify(null==i?void 0:i.items)&&k(e.items,e.roundUp)}),{immediate:!0,deep:!0}),{items:g,route:a,loading:l,sources:y,setItemRefs:e=>i=>{g.value[e].refDom=i},handleGetDevice:M,handleExpandItem:async(a,l=(()=>{}))=>{var t,n,o;if((null==(t=a.devices)?void 0:t.isFetched)||(null==(n=a.children)?void 0:n.length)>0)return void l();a.collapse&&e.search&&((null==(o=null==a?void 0:a.devices)?void 0:o.filters)?a.devices.filters.search=e.search:a.devices={filters:{search:e.search}});await M(a)&&(l(),i.emit("show-prices",a))},handleFetchDevice:I,loadingCustomPrice:f,changeAutomatedPricing:async(e,a,{toggle:l,isExpanded:t})=>{const n=i=>{e.loading=i};try{e.is_price_sync?(n(!0),T(e,a,!1)):(n(!0),await r({category_id:e.id,level:B(e)}),i.emit("refetch-device"))}catch(o){console.error("Error changing automated pricing:",o)}finally{n(!1)}},handleDeviceUpdate:async e=>{let{row:i,index:a,item:l,isSync:t}=e;const o={product_id:i.id,condition_id:i.price[a].id,price:i.price[a].price,is_sync:t?1:0};return await n(o,((e,l)=>{e||(i=b(i,a,1e3),l.data.pricing.forEach(((e,l)=>{1!=i.price[l].is_subcondition&&l!==a||(i.price[l].price=e.price,i.price[l].last_update=e.last_update,i.price[l].original_price=e.price)})))})),i},handleLoadedPrice:j,handleSetOriginalPrice:(e,i)=>(e.price[i].original_price=e.price[i].price,e),handleSetPriceSyncCustomPrice:_,handleSavePriceSyncCustomPrice:w,handleUnsetPriceSyncCustomPrice:x,handleResetPriceSyncCustomPrice:C,handleResetPriceSyncCustomPriceBulk:async e=>{const a={last_child_id:e.id};try{const l=await h(a);if(l&&l.pricing_status){const a=B(e);e.missing_price_flags="model"==a?l.pricing_status.model_id_has_no_price:l.pricing_status.last_child_id_has_no_price;const t=g.value.findIndex((i=>i.id===e.id));-1!==t&&(g.value[t].missing_price_flags="model"==a?l.pricing_status.model_id_has_no_price:l.pricing_status.last_child_id_has_no_price),i.emit("pricing-flag-updated",{itemId:"model"==a?e.parent_id:e.top_category_id,deviceIdHasNoPrice:l.pricing_status.device_id_has_no_price})}await M(e,!0)}catch(l){console.error("Error resetting price:",l)}},cancelAutomatedPricing:()=>{g.value[y.value.key].loading=!1,y.value.isEdit||(g.value[y.value.key].is_price_sync=0),y.value={modal:!1,item:void 0,isEdit:!1,key:void 0}},applyRule:async(e,a=(()=>{}))=>{const t=g.value[y.value.key];if(!t||!e.isNew)return a();l.rule=!0;if(await o(e.data))return a(),t.collapse=!1,y.value={modal:!1,item:void 0,isEdit:!1,key:void 0},l.rule=!1,i.emit("refetch-device"),await M(t,!0),t;l.rule=!1},editAutomate:T,handleSetLevel:B,refetchDevice:e=>{i.emit("refetch-device",e)},actionUpdate:n,sourceList:V,hasMultipleSources:U,handleSaveCustomPrice:async(e,a,l,t)=>{const n=await w(e,a,l,t);if(n&&n.pricing_status){const e=B(l),a="model"==e?n.pricing_status.model_id_has_no_price:n.pricing_status.last_child_id_has_no_price,t=g.value.findIndex((e=>e.id===l.id));-1!==t&&(g.value[t]=s(d({},g.value[t]),{missing_price_flags:a})),Object.assign(l,{missing_price_flags:a});const o=g.value.map((e=>s(d({},e),{collapse:!1})));i.emit("pricing-flag-updated",{itemId:"model"==e?l.parent_id:l.top_category_id,deviceIdHasNoPrice:n.pricing_status.device_id_has_no_price,children:o})}},handleResetCustomPrice:async(e,a,l)=>{const t=await C(e,a,l);if(t&&t.data.pricing_status){const e=B(l);l.missing_price_flags="model"==e?t.data.pricing_status.model_id_has_no_price:t.data.pricing_status.last_child_id_has_no_price;const a=g.value.findIndex((e=>e.id===l.id));-1!==a&&(g.value[a].missing_price_flags="model"==e?t.data.pricing_status.model_id_has_no_price:t.data.pricing_status.last_child_id_has_no_price),i.emit("pricing-flag-updated",{itemId:"model"==e?l.parent_id:l.top_category_id,deviceIdHasNoPrice:t.data.pricing_status.device_id_has_no_price})}}}}}),Zt={class:"space-y-6"},Kt={class:"grid grid-cols-2 action-child"},Qt=["onClick"],Xt={class:"el-icon-arrow-right"},en={class:"flex items-center gap-2"},an={class:"mb-0"},ln={class:"action-btn-child"},tn={key:0},nn={key:0,class:"space-y-8"},on=["id"],dn={class:"col-span-8"},sn={key:2,class:"flex justify-end mt-4"},rn={key:0,class:"text-center mb-8"},cn={class:"text-grey-04"},un={key:0},pn={key:0},mn={key:1},vn={class:"flex flex-col"},gn={class:"flex justify-start items-center gap-x-2"},yn={class:"flex flex-col gap-0"},fn={class:"font-semibold text-base text-black mb-3"},hn=["innerHTML"],bn={class:"list w-full"},_n={key:0,class:"text-xs text-grey-02 capitalize"},xn={key:0},Cn={key:0,class:"text-right"},wn={class:"text-right"},kn={key:1},Sn={key:0,class:"p-8"},Pn={key:1,class:"p-8"};var Vn=Z(Yt,[["render",function(e,i,a,l,t,n){var o;const d=g("Tooltip"),s=g("SyncPricing"),r=g("Button"),c=g("Input"),u=g("Alert"),p=g("router-link"),m=g("TableColumn"),v=g("Popover"),x=g("DeviceInput"),C=g("Table"),M=g("Pagination"),I=g("BulkPriceEditorList"),B=g("ExpandablePanel"),j=g("BulkPriceEditorSources"),D=y("loading");return f(),h("div",Zt,[(f(!0),h(A,null,L(e.items,((a,l)=>(f(),_(B,{modelValue:a.collapse,"onUpdate:modelValue":e=>a.collapse=e,key:`${a.parent_id}_${a.id}`},{header:w((({toggle:t})=>[k("div",Kt,[k("div",{class:"flex items-center gap-x-2 cursor-pointer",onClick:i=>e.handleExpandItem(a,t)},[k("div",{class:T({"el-table__expand-icon el-table__expand-icon--expanded":a.collapse,"el-table__expand-icon":!a.collapse})},[b(k("i",Xt,null,512),[[D,a.loading]])],2),k("div",en,[k("p",an,P(a.name),1),(null==a?void 0:a.missing_price_flags)?(f(),_(d,{key:0,placement:"top"},{content:w((()=>i[4]||(i[4]=[k("div",{class:"max-w-sm"}," This item is flagged due to unavailable prices for certain conditions. Expand the submenu to manually price them. ",-1)]))),default:w((()=>[i[5]||(i[5]=k("span",{class:"text-red-04 material-icons leading-4",style:{"font-size":"1.25rem !important"}},"flag",-1))])),_:1})):U("",!0)]),(null==a?void 0:a.child)?(f(),h("div",{key:0,class:T(["ml-auto flex z-10",{hidden:!a.collapse}]),tabindex:"0"},null,2)):U("",!0)],8,Qt),1!=e.sycnablePrice||e.priceScraper?U("",!0):(f(),h("div",{key:0,class:T(["flex items-center gap-x-2",0!=a.is_price_sync&&e.sycnablePrice?"ml-11":"ml-12"])},[e.sycnablePrice?(f(),_(s,{key:0,modelValue:a.is_price_sync,"onUpdate:modelValue":[e=>a.is_price_sync=e,i=>e.changeAutomatedPricing(a,l,{toggle:t,isExpanded:e.isExpanded})],"is-syncable":e.sycnablePrice,loading:a.loading,item:a,"disabled-action":e.disabledAction,onLoadedPrice:e.handleLoadedPrice},null,8,["modelValue","onUpdate:modelValue","is-syncable","loading","item","disabled-action","onLoadedPrice"])):(f(),_(s,{key:1,modelValue:a.is_price_sync,"onUpdate:modelValue":e=>a.is_price_sync=e,item:a,"disabled-action":e.disabledAction},null,8,["modelValue","onUpdate:modelValue","item","disabled-action"])),k("div",ln,[0!=a.is_price_sync&&e.sycnablePrice?(f(),_(r,{key:0,loading:a.loading,color:"teal",dense:"",disabled:e.disabledAction.priceUploadByProgress,onClick:i=>e.editAutomate(a,l)},{default:w((()=>i[6]||(i[6]=[k("span",{class:"material-icons text-sm"},"edit",-1)]))),_:2},1032,["loading","disabled","onClick"])):U("",!0)])],2))])])),default:w((()=>{var t,n,o,d,s;return[k("div",{ref_for:!0,ref:e.setItemRefs(l)},[a.collapse?(f(),h("div",tn,[Array.isArray(null==(t=a.devices)?void 0:t.data)?(f(),h("div",nn,[k("div",{id:`device-list-${a.id}`,class:"grid grid-cols-8"},[k("div",dn,[a.devices.filters?(f(),_(c,{key:0,value:a.devices.filters.search,"onUpdate:modelValue":i=>e.handleFetchDevice(a,i,"search"),placeholder:"Search product",block:"",icon:""},{icon:w((()=>i[7]||(i[7]=[k("span",{class:"material-icons"},"search",-1)]))),_:2},1032,["value","onUpdate:modelValue"])):U("",!0),(null==a?void 0:a.missing_price_flags)?(f(),_(u,{key:1,color:"red",view:"smooth",class:"mt-4",dense:""},{default:w((()=>i[8]||(i[8]=[k("div",{class:"flex items-center"},[k("i",{class:"material-icons mr-2"},"info"),V(),k("p",null,"Conditions priced at $0 must be manually priced to visible to your customers.")],-1)]))),_:1})):U("",!0),a.is_price_sync&&!e.disabledAction.priceUploadByProgress?(f(),h("div",sn,[S(r,{dense:"",loading:e.loadingCustomPrice.resetBulk.has(a.id)||a.loading||e.isLoading,color:"teal",onClick:i=>e.handleResetPriceSyncCustomPriceBulk(a)},{default:w((()=>i[9]||(i[9]=[k("span",{class:"text-sm mx-2"},[k("i",{class:"material-icons mr-2"},"history"),V(" Reset Manually Priced Products ")],-1)]))),_:2},1032,["loading","onClick"])])):U("",!0)])],8,on),(null==(n=null==a?void 0:a.conditions)?void 0:n.length)||e.disabledAction.priceUploadByProgress?b((f(),_(C,{key:1,class:"w-full",data:(null==(o=null==a?void 0:a.devices)?void 0:o.data)||[]},{default:w((()=>{var l,t,n,o;return["mac"===(null==(t=null==(l=e.route)?void 0:l.params)?void 0:t.tab)?(f(),_(m,{key:0,label:"MPN","min-width":"120"},{default:w((e=>[e.row.mpn?(f(),h("span",un,[(f(!0),h(A,null,L(e.row.mpn.split(","),((a,l)=>{var t;return f(),h("span",{key:l},[V(P(a),1),l<(null==(t=e.row.mpn.split(","))?void 0:t.length)-1?(f(),h("span",pn,",")):U("",!0),i[13]||(i[13]=k("br",null,null,-1))])})),128))])):(f(),h("span",mn," - "))])),_:2},1024)):U("",!0),S(m,{prop:"product_name",label:"Item","min-width":"mac"===(null==(o=null==(n=e.route)?void 0:n.params)?void 0:o.tab)?"350":"150"},null,8,["min-width"]),(f(!0),h(A,null,L(a.conditions_sources,((l,t)=>{var n,o,d,s;return f(),_(m,{key:`${t}_${l.id}`,label:l.name,"min-width":"mac"===(null==(o=null==(n=e.route)?void 0:n.params)?void 0:o.tab)&&a.is_price_sync?"220":"mac"===(null==(s=null==(d=e.route)?void 0:d.params)?void 0:s.tab)?"150":"230"},{header:w((()=>[k("div",vn,[k("div",gn,[k("div",yn,[k("div",null,P(l.name),1)]),S(v,{width:250,placement:"bottom-start",trigger:"hover"},{reference:w((()=>i[14]||(i[14]=[k("div",{class:"text-teal-04 text-xs"},[k("span",{class:"material-icons text-lg"},"info")],-1)]))),default:w((()=>[k("h6",fn," Condition: "+P(l.name),1),k("p",{innerHTML:l.title_rule,class:"text-dark mb-2"},null,8,hn),k("ul",bn,[(f(!0),h(A,null,L(l.rules,((e,i)=>(f(),h("li",{key:i,class:"break-normal"},P(e),1)))),128))])])),_:2},1024)]),l.is_mapping&&l.source&&!e.priceSharing&&!e.hasMultipleSources?(f(),h("span",_n,P(l.source_name),1)):U("",!0)])])),default:w((i=>{var n,o;return[(null==(o=null==(n=i.row)?void 0:n.price)?void 0:o.length)?(f(),h("div",xn,[S(x,{data:{condition:l,row:i.row,items:e.items,index:t},"is-automated-price":a.is_price_sync,"has-pricing-source":!!a.pricing_source,disabled:e.disabledAction.priceUploadByProgress||(!!a.is_price_sync&&!i.row.price[t].is_custom_price||!a.is_price_sync&&!!i.row.price[t].is_subcondition)&&!i.row.price[t].is_editable_custom_price,onFocusOut:e.handleDeviceUpdate,onSetCustomPrice:a=>e.handleSetPriceSyncCustomPrice(i.row,t),onUnsetCustomPrice:a=>e.handleUnsetPriceSyncCustomPrice(i.row,t),onResetCustomPrice:l=>e.handleResetCustomPrice(i.row,t,a),onSetOriginalPrice:a=>e.handleSetOriginalPrice(i.row,t),onSaveCustomPrice:l=>e.handleSaveCustomPrice(i.row,t,a,e.actionUpdate)},null,8,["data","is-automated-price","has-pricing-source","disabled","onFocusOut","onSetCustomPrice","onUnsetCustomPrice","onResetCustomPrice","onSetOriginalPrice","onSaveCustomPrice"]),a.is_price_sync?U("",!0):(f(),h("div",Cn,[k("small",wn,P(i.row.price[t].last_update?i.row.price[t].last_update:"-"),1)]))])):(f(),h("div",kn,[S(x)]))]})),_:2},1032,["label","min-width"])})),128))]})),_:2},1032,["data"])),[[D,a.loading||e.isLoading]]):(f(),h("div",rn,[k("span",cn,[i[11]||(i[11]=V(" Please setup your ")),S(p,{to:{name:"settingCondition"}},{default:w((()=>i[10]||(i[10]=[V(" conditions ")]))),_:1}),i[12]||(i[12]=V(" first "))])])),a.devices.filters?(f(),_(M,{key:2,data:a.devices.filters,page:a.devices.filters.page,limit:a.devices.filters.limit,"onUpdate:page":i=>e.handleFetchDevice(a,i,"page"),"onUpdate:limit":i=>e.handleFetchDevice(a,i,"limit")},null,8,["data","page","limit","onUpdate:page","onUpdate:limit"])):U("",!0)])):(f(),h(A,{key:1},[e.loading.all?b((f(),h("div",Sn,null,512)),[[D,!0]]):U("",!0),e.loading.all||0!=(null==(d=null==a?void 0:a.children)?void 0:d.length)?U("",!0):(f(),h("div",Pn,i[15]||(i[15]=[k("span",null,"No data to show",-1)])))],64))])):U("",!0),a.children&&(null==(s=a.children)?void 0:s.length)>0?(f(),_(I,{key:1,id:e.id,items:a,"automated-price":a.is_price_sync,"level-names":a.level_names,"round-up":a.rounde_up,"sycnable-price":e.sycnablePrice,"price-sharing":e.priceSharing,"price-scraper":e.priceScraper,search:e.search,"disabled-action":e.disabledAction,onRefetchDevice:i=>e.refetchDevice(a)},null,8,["id","items","automated-price","level-names","round-up","sycnable-price","price-sharing","price-scraper","search","disabled-action","onRefetchDevice"])):U("",!0)],512)]})),_:2},1032,["modelValue","onUpdate:modelValue"])))),128)),1==e.sycnablePrice?(f(),_(j,{key:0,modal:e.sources.modal,"onUpdate:modal":i[0]||(i[0]=i=>e.sources.modal=i),item:e.sources.item,"onUpdate:item":i[1]||(i[1]=i=>e.sources.item=i),editing:e.sources.isEdit,"onUpdate:editing":i[2]||(i[2]=i=>e.sources.isEdit=i),priceSharing:e.priceSharing,"onUpdate:priceSharing":i[3]||(i[3]=i=>e.priceSharing=i),loading:null==(o=e.loading)?void 0:o.rule,onCancel:e.cancelAutomatedPricing,onApply:e.applyRule},null,8,["modal","item","editing","priceSharing","loading","onCancel","onApply"])):U("",!0)])}]]);const Un=M({name:"BulkPriceEditorPricingManual",components:{Select:qe,Button:ee,Input:ae},props:{conditions:{type:Array,default:()=>[]},options:{type:Array,default:()=>[]},disabled:{type:Array,default:()=>[]},item:{type:Object,default:()=>({})},keyComponent:{type:[String,Number],default:void 0},disabledFromPrice:{type:Boolean,default:!1}},emits:["update:conditions","update:disabled","update:options","change:condition","applyPricing"],setup(e,i){const a=m([{class:"md:w-44",name:"Condition"},{class:"md:w-56",name:"Choose Pricing From"},{class:"md:w-40",name:"Set Percentage"},{class:"md:w-36",name:"Set Value"},{class:"",name:""}]),l=u({get:()=>e.conditions.map((e=>s(d({},e),{disabled_select:-1!=n.value.findIndex((i=>i.parent_id==e.id)),show_tooltip:void 0!==(null==e?void 0:e.show_tooltip)&&e.show_tooltip}))),set:e=>{i.emit("update:conditions",e)}}),t=u({get:()=>e.options,set:e=>i.emit("update:options",e)}),n=u({get:()=>e.disabled,set:e=>i.emit("update:disabled",e)}),{me:o}=Q(),r=de((e=>{const i=l.value,a=l.value.findIndex((i=>i.id==e.id));return"min"==i[a].set_percentage&&Number(i[a].condition_sub_value)>0&&(i[a].condition_sub_value=-Math.abs(Number(i[a].condition_sub_value))),l.value=i,l.value}),300);return{me:o,rows:l,columns:a,options:t,disabled:n,handleApply:a=>{const t=l.value.findIndex((e=>e.id==a.id));i.emit("applyPricing",{conditionIndex:t,condition:a,item:e.item,index:e.keyComponent})},handleShowTooltip:(e,i=!1)=>{var a;const t=l.value,n=l.value.findIndex((i=>i.id==e.id));return void 0!==(null==(a=t[n])?void 0:a.show_tooltip)&&(t[n].show_tooltip=i),l.value=t,l.value},handleCheckValue:r,filterFecthOption:(e,i)=>e&&e.length?[...e].filter((e=>e.name!==(null==i?void 0:i.name)&&e.id!==(null==i?void 0:i.id)&&!e.parent_id)):e,filterDisabledOption:e=>{var i;const a=!!(null==(i=null==n?void 0:n.value)?void 0:i.length)&&(null==n?void 0:n.value.findIndex((i=>Number(i.parent_id)===Number(e))))||-1;return console.log(a),-1!==a},handleChangeCondition:a=>{const t=l.value;t[l.value.findIndex((e=>e.id==a.id))].parent_id=a.parent_id,l.value=t,i.emit("change:condition",{row:a,item:e.item})},handleChangePercentage:e=>{const i=l.value,a=l.value.findIndex((i=>i.id==e.id));"plus"==e.set_percentage&&-1!=a?i[a].condition_sub_value=Math.abs(Number(i[a].condition_sub_value)):i[a].condition_sub_value=-Math.abs(Number(i[a].condition_sub_value)),l.value=i}}}}),An={class:"border border-grey-02 border-opacity-70 rounded-md relative"},Mn={class:"px-4 pb-4 pt-8"},In={class:"overflow-x-auto"},Bn={class:"table-price-manual"},Tn={class:"max-w-xs text-sm"};const jn=M({name:"BulkPriceEditor",components:{Button:ee,Alert:fe,SyncPricing:ri,BulkPriceEditorList:Vn,BulkPriceEditorSources:Wt,BulkPriceEditorPricingManual:Z(Un,[["render",function(e,i,a,l,t,n){const o=g("Tooltip"),d=g("Select"),s=g("RadioButton"),r=g("RadioGroup"),c=g("Input"),u=g("Button");return f(),h("div",An,[S(o,{placement:"top"},{content:w((()=>i[0]||(i[0]=[k("p",null,"This does not apply to items with active Price Sync.",-1)]))),default:w((()=>[i[1]||(i[1]=k("span",{class:"absolute -top-3.5 left-4 px-2 bg-white font-semibold"}," Pricing Rules for Manually Priced Items ",-1))])),_:1}),k("div",Mn,[k("div",In,[k("table",Bn,[k("thead",null,[k("tr",null,[(f(!0),h(A,null,L(e.columns,((e,i)=>(f(),h("th",{key:i,class:T(e.class)},P(e.name),3)))),128))])]),k("tbody",null,[(f(!0),h(A,null,L(e.rows,((a,l)=>(f(),h("tr",{key:l},[k("td",null,P(a.name),1),k("td",null,[S(d,{modelValue:a.parent_id,"onUpdate:modelValue":e=>a.parent_id=e,by:"id",name:"name",class:"w-full",items:e.filterFecthOption(e.options,a),loading:null==a.parent_id&&a.loading,disabled:a.disabled_select||e.disabledFromPrice,dense:"",onInput:i=>e.handleChangeCondition(a)},null,8,["modelValue","onUpdate:modelValue","items","loading","disabled","onInput"])]),k("td",null,[null!==a.parent_id?(f(),_(r,{key:0,modelValue:a.set_percentage,"onUpdate:modelValue":e=>a.set_percentage=e,size:"mini",disabled:e.disabledFromPrice,onChange:i=>e.handleChangePercentage(a)},{default:w((()=>[S(s,{label:"min"},{default:w((()=>i[2]||(i[2]=[V("- %")]))),_:1}),S(s,{label:"plus"},{default:w((()=>i[3]||(i[3]=[V("+ %")]))),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])):U("",!0)]),k("td",null,[S(o,{modelValue:a.show_tooltip,"onUpdate:modelValue":e=>a.show_tooltip=e,placement:"top",manual:""},{content:w((()=>[k("p",Tn,"Items priced at "+P(1==e.me.currency_prefix?`${e.me.currency_symbol}0`:`0${e.me.currency_symbol}`)+" are not subject to pricing rules.",1)])),default:w((()=>[k("div",null,[null!==a.parent_id?(f(),_(c,{key:0,modelValue:a.condition_sub_value,"onUpdate:modelValue":e=>a.condition_sub_value=e,type:"number",icon:"",right:"",dense:"",disabled:e.disabledFromPrice,onFocusIn:i=>e.handleShowTooltip(a,!0),onFocusOut:i=>e.handleShowTooltip(a,!1),onInput:i=>e.handleCheckValue(a)},{icon:w((()=>i[4]||(i[4]=[k("span",{class:"text-base"},"%",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onFocusIn","onFocusOut","onInput"])):U("",!0)])])),_:2},1032,["modelValue","onUpdate:modelValue"])]),k("td",null,[null!==a.parent_id?(f(),_(u,{key:0,loading:a.loading,disabled:a.loading||e.disabledFromPrice,color:"teal",dense:"",onClick:i=>e.handleApply(a)},{default:w((()=>i[5]||(i[5]=[V(" Apply ")]))),_:2},1032,["loading","disabled","onClick"])):U("",!0)])])))),128))])])])])])}],["__scopeId","data-v-c648116e"]])},props:{items:{type:Array,default:()=>[]},conditions:{type:Array,default:()=>[]},pathId:{type:String,default:null},loadingTable:{type:Boolean},priceSharing:{type:Boolean,default:!1},priceScraper:{type:Boolean,default:!1},roundUp:{type:[String,Number],default:void 0},disallowSync:{type:Boolean,default:!1},subDomainLinked:{type:Boolean,default:!1},search:{type:String,default:null},disabledAction:{type:Object,default:void 0}},emits:["refetch-pricing","pricing-flag-updated"],setup(e,i){const a=m(),l=m(!1),t=m(!1),n=m(!1),o=p(),{loading:r,actionAll:c,actionUpdate:g,actionSetRule:y,actionUnsetRule:f,actionSetLevel:h,actionGetChildren:b}=K(o.params.tab),{loading:_,actionSpecificV2:x,actionConditionUpdate:C}=ge(),w=m(null),k=m(e.items),S=m(null),P=m(!1),V=u((()=>{const e=[];return"true"===o.query.ref&&k.value.map((i=>{i.brand===o.params.manufacturer&&e.push(i.id)})),k.value.forEach((i=>{(i.expand||"true"===o.query.ref&&i.brand===o.params.manufacturer)&&e.push(i.id)})),e}));o.query.model&&"true"===o.query.ref&&k.value.map((e=>{const i=[...e.child].findIndex((e=>e.name===o.query.model));return i>=0&&(e.child[i].collapse=!0,e.child[i].loading=!0),e}));const U=async e=>{var i,a;const{condition:l,item:t}=e,n=k.value.findIndex((e=>e.id===t.id)),d=k.value[n].conditions.findIndex((e=>e.id===l.id));k.value[n].conditions[d].loading=!0;const{id:s,parent_id:r,condition_sub_value:c}=null!=(a=null==(i=k.value[n])?void 0:i.conditions[d])?a:l;try{await C({route:o.params,data:{id:s,data:{parent_id:r,sub_value:c}}}),k.value[n].children=A(k.value[n].children,!0),k.value[n].renderKey=Date.now()}finally{k.value[n].conditions[d].loading=!1}},A=(e=[],i=!1)=>e.map((e=>s(d(s(d({},e),{collapse:!1}),i&&{devices:{}}),{children:A(e.children||[])}))),M=(e,i)=>e.map((e=>s(d({},e),{children:e.child?M(e.child):[],collapse:!1,devices:null}))),I=()=>{k.value=k.value.map((e=>d(d({},e),e.children&&{children:M(e.children)})))},B=e=>{l.value=!1,n.value=!1,w.value,a.value=Date.now()};v((()=>e.items),(e=>{k.value=(null==e?void 0:e.length)?[...e]:[]}),{deep:!0});H((()=>{window.addEventListener("beforeunload",(e=>{t.value&&(e.preventDefault(),e.returnValue="")}))})),q((()=>{window.removeEventListener("beforeunload",(()=>{}))}));return{keyList:a,items:k,modal:n,isEditAutomate:l,deviceAll:async e=>{0!==e.children.length||e.devices||await c(e.id,(i=>{e.devices=i.devices.devices,e.child_conditions=i.conditions}))},listLoading:P,deviceUpdate:async(e,i)=>{g({pricing:JSON.stringify([{product_id:e.id,pricing:[{condition_id:e.price[i].id,price:e.price[i].price}]}])})},route:o,changeAutomatedPricing:async e=>{t.value=!0,r.rules.push(e.id),P.value=!0,1==e.is_price_sync?(n.value=!0,w.value=e):(await f({category_id:e.id,level:h(e)}),i.emit("refetch-pricing")),I(),P.value=!1;const a=r.rules.findIndex((i=>i===e.id));a>-1&&r.rules.splice(a,1),t.value=!1},cancelAutomatedPricing:()=>{let e=k.value.findIndex((e=>Number(e.id)===Number(w.value.id)));k.value[e].loading=!1,l.value||(k.value[e].is_price_sync=0,I()),B()},selected:w,loading:r,applyRule:async(e,a=(()=>{}))=>{if(!e.isNew)return a(),B();r.rule=!0,await y(e.data,(e=>{if(e){const e=()=>{r.rule=!1,a(),B()};i.emit("refetch-pricing",e)}}))},tableElement:S,updateCategoryCondition:U,changeCondition:async({row:e,item:i})=>{null==e.parent_id&&(e.condition_sub_value=0,await U({condition:e,item:i})),e.id!=e.parent_id&&(i.disabled.push(e),i.disabled.forEach((e=>{let a=i.conditions.findIndex((i=>e.parent_id==i.parent_id)),l=i.conditions.findIndex((i=>e.parent_id==i.id));if(-1==a){let e=i.disabled.filter((e=>e.parent_id!=i.conditions[l].id));i.disabled=e}})))},editAutomate:async e=>{e.loading=!0,l.value=!0,n.value=!0,w.value=e},filterFecthOption:(e,i)=>e&&e.length?[...e].filter((e=>e.name!==(null==i?void 0:i.name)&&e.id!==(null==i?void 0:i.id))):e,loadingPricing:_,expands:V,refetchDevice:async e=>{var i;await x({manufacturer:e.brand,categories:null==(i=null==o?void 0:o.params)?void 0:i.tab})},handlePricingFlagUpdate:e=>{const a=k.value.findIndex((i=>i.id===e.itemId));-1!==a&&(k.value[a].missing_price_flags=e.deviceIdHasNoPrice,e.children&&(k.value[a].children=e.children)),i.emit("pricing-flag-updated",e)},onCollapse:async e=>{var i;if(!e.loading)return(null==(i=e.children)?void 0:i.length)?(e.collapse=!e.collapse,void(e.collapse||(e.children=A(e.children,!1)))):(e.loading=!0,await b({id:e.id},(i=>{var a,l,t,n,o,d,s;e.children=null!=(a=null==i?void 0:i.children)?a:[],e.conditions=null!=(l=null==i?void 0:i.conditions)?l:[],e.conditions_group=null!=(t=null==i?void 0:i.conditions_group)?t:[],e.conditions_group_id=null!=(n=null==i?void 0:i.conditions_group_id)?n:null,e.condition_options=null!=(o=null==i?void 0:i.condition_options)?o:[],e.alert=null!=(d=null==i?void 0:i.alert)&&d,e.disabled=null!=(s=null==i?void 0:i.disabled)?s:[]})),e.collapse=!e.collapse,e.loading=!1,e.renderKey=Date.now(),e)},onShowPrices:e=>{var i,a;const l=k.value.findIndex((i=>i.id===e.top_id));if((null==(i=k.value[l])?void 0:i.collapse)&&l>=0){const i=null==(a=k.value[l])?void 0:a.children.findIndex((i=>i.id===e.id));k.value[l].children[i]&&(k.value[l].children[i]=d(d({},k.value[l].children[i]),e),k.value[l].renderKey=Date.now())}}}}}),Ln={class:"bulk-price-editor overflow-x-auto"},Dn={class:"table-price-editor w-full table-fixed overflow-x-auto"},En={class:"table-price-editor__row"},On={key:0,class:"table-price-editor__colhead w-40"},Rn=["id"],$n={class:"table-price-editor__col"},Fn=["onClick"],Nn={class:"el-icon-arrow-right"},Hn={class:"table-price-editor__col"},qn={class:"flex items-center gap-x-2"},zn={class:"table-price-editor__col"},Gn={class:"table-price-editor__col"},Jn={key:0,class:"flex items-center gap-x-4"},Wn={class:"action"},Yn={key:1,class:"flex items-center gap-x-4"},Zn={key:0,class:"table-price-editor__col"},Kn={key:0},Qn={key:1},Xn={key:2},eo={key:0,class:"table-price-editor__row expanded"},io=["colspan"],ao={class:"py-6 md:pr-16"},lo={key:0,class:"condition-group"},to={key:0,class:"condition-group__container",style:{"z-index":"10","background-color":"rgba(235,0,27,0.5)"}},no={class:"condition-group__modal-container"},oo={class:"condition-group__modal-content text-red-base"},so={class:"flex"},ro={class:"w-full"},co={class:"list condition-group__list my-6"},uo={class:"flex flex-wrap"},po={class:"flex space-x-4"},mo={class:"list-disc ml-5 mb-6"};var vo=Z(jn,[["render",function(e,i,a,l,t,n){var o,d;const s=g("Tooltip"),r=g("SyncPricing"),c=g("Button"),u=g("Alert"),p=g("BulkPriceEditorPricingManual"),m=g("BulkPriceEditorList"),v=g("BulkPriceEditorSources"),x=y("loading");return f(),h("div",Ln,[b((f(),h("table",Dn,[k("tr",En,[i[5]||(i[5]=k("th",{class:"table-price-editor__colhead"},null,-1)),i[6]||(i[6]=k("th",{class:"table-price-editor__colhead md:w-96"},"Brand",-1)),i[7]||(i[7]=k("th",{class:"table-price-editor__colhead md:w-96"},"Category",-1)),i[8]||(i[8]=k("th",{class:"table-price-editor__colhead w-40"},"Price Sync",-1)),e.priceScraper||e.disabledAction.availabilityCondition?U("",!0):(f(),h("th",On," Pricing Status "))]),(f(!0),h(A,null,L(e.items,((a,l)=>{var t;return f(),h(A,{key:l},[k("tr",{id:`row_${l}`,class:"table-price-editor__row"},[k("td",$n,[e.disabledAction.priceUploadByProgress||e.disabledAction.availabilityCondition?U("",!0):(f(),h("div",{key:0,class:T({"el-table__expand-icon el-table__expand-icon--expanded":a.collapse,"el-table__expand-icon":!a.collapse}),onClick:i=>e.onCollapse(a)},[b(k("i",Nn,null,512),[[x,a.loading]])],10,Fn))]),k("td",Hn,[k("div",qn,[V(P(a.brand)+" ",1),a.is_price_sync||!a.conditions||a.conditions.length?U("",!0):(f(),_(s,{key:0,placement:"top"},{content:w((()=>i[9]||(i[9]=[k("div",{class:"w-72"},' To manage the pricing for this item, you can either set up manual conditions using the "Setup Condition" or enable price sync for automatic pricing. ',-1)]))),default:w((()=>[i[10]||(i[10]=k("span",{class:"text-orange-04 material-icons leading-4",style:{"font-size":"1.25rem !important"}},"warning",-1))])),_:1})),(null==a?void 0:a.missing_price_flags)?(f(),_(s,{key:1,placement:"right"},{content:w((()=>i[11]||(i[11]=[k("div",{class:"max-w-lg"}," One or more items are flagged due to unavailable prices for certain conditions. Expand the submenu to view the flagged items and manually price them. ",-1)]))),default:w((()=>[i[12]||(i[12]=k("span",{class:"text-red-04 material-icons leading-4",style:{"font-size":"1.25rem !important"}},"flag",-1))])),_:1})):U("",!0)])]),k("td",zn,P(a.name),1),k("td",Gn,[e.priceScraper?U("",!0):(f(),h("div",Jn,[k("div",null,[e.subDomainLinked||a.is_syncable?(f(),_(r,{key:0,modelValue:a.is_price_sync,"onUpdate:modelValue":[e=>a.is_price_sync=e,i=>e.changeAutomatedPricing(a)],"is-syncable":a.is_syncable,loading:e.loading.rules.includes(a.id),tooltip:"",item:a,"disabled-action":e.disabledAction},null,8,["modelValue","onUpdate:modelValue","is-syncable","loading","item","disabled-action"])):(f(),_(r,{key:1,modelValue:a.is_price_sync,"onUpdate:modelValue":e=>a.is_price_sync=e,item:a,"disabled-action":e.disabledAction},null,8,["modelValue","onUpdate:modelValue","item","disabled-action"]))]),k("div",Wn,[0==a.is_price_sync&&a.conditions&&!a.conditions.length?(f(),_(c,{key:0,loading:a.loading,color:"teal",dense:"",class:"action-btn",onClick:i[0]||(i[0]=i=>e.$router.push({name:"settingCondition"}))},{default:w((()=>i[13]||(i[13]=[k("div",{class:"flex items-center justify-center"},[V(" Set item conditions "),k("span",{class:"material-icons text-sm"},"chevron_right")],-1)]))),_:2},1032,["loading"])):U("",!0),0!=a.is_price_sync&&a.is_syncable?(f(),_(c,{key:1,loading:a.loading,color:"teal",dense:"",class:"action-btn",disabled:e.disabledAction.priceUploadByProgress,onClick:i=>e.editAutomate(a)},{default:w((()=>i[14]||(i[14]=[k("span",{class:"material-icons text-sm"},"edit",-1)]))),_:2},1032,["loading","disabled","onClick"])):U("",!0)])])),e.priceScraper?(f(),h("div",Yn,[k("div",null,[S(r,{item:a,"price-scraper":e.priceScraper,"disabled-action":e.disabledAction},null,8,["item","price-scraper","disabled-action"])])])):U("",!0)]),e.priceScraper||e.disabledAction.availabilityCondition?U("",!0):(f(),h("td",Zn,[a.total_device_manual&&!a.total_device_sync?(f(),h("p",Kn," All Items Manually Priced ")):!a.total_device_manual&&a.total_device_sync?(f(),h("p",Qn,P("manual"===a.mapping_type?"All Items Prices Synced":"All Items Prices Synced (Auto Mapped)"),1)):a.total_device_manual&&a.total_device_sync?(f(),h("p",Xn,P(a.total_device_sync)+" "+P(a.total_device_sync>1?"Items":"Item")+" price synced, "+P(a.total_device_manual)+" "+P(a.total_device_manual>1?"Items":"Item")+" manually priced ",1)):U("",!0)]))],8,Rn),a.collapse?(f(),h("tr",eo,[i[22]||(i[22]=k("td",{class:"table-price-editor__col"},null,-1)),k("td",{colspan:e.priceScraper||e.disabledAction.availabilityCondition?3:4,class:"table-price-editor__col"},[k("div",ao,[0==a.is_price_sync?(f(),h("div",lo,[S(j,{name:"fade"},{default:w((()=>[a.alert&&!e.disabledAction.priceUploadByProgress?(f(),h("div",to,[k("div",no,[k("div",oo,[k("div",so,[i[18]||(i[18]=k("i",{class:"material-icons mr-4"},"error",-1)),k("div",ro,[i[17]||(i[17]=k("p",null,[k("span",{class:"font-semibold"},"Warning!"),V(" Changing the pricing rules on this window "),k("br"),V(" will affect all of the following device: ")],-1)),k("ul",co,[(f(!0),h(A,null,L(a.conditions_group,(e=>(f(),h("li",{key:e},P(e),1)))),128))]),k("div",uo,[S(c,{color:"teal",view:"outlined",class:"mr-4 my-2",onClick:i=>e.$router.push({name:"settingConditionEdit",params:{conditionId:a.conditions_group_id||0}})},{default:w((()=>i[15]||(i[15]=[V(" Go to Conditions ")]))),_:2},1032,["onClick"]),S(c,{color:"teal",view:"outlined",class:"my-2",onClick:e=>a.alert=!1},{default:w((()=>i[16]||(i[16]=[V(" Continue Pricing ")]))),_:2},1032,["onClick"])])])])])])])):U("",!0)])),_:2},1024),0===a.conditions_group.length||0!=a.alert||e.disabledAction.priceUploadByProgress?U("",!0):(f(),_(u,{key:0,color:"red",view:"smooth",class:"mb-5",dense:""},{default:w((()=>[k("div",po,[i[21]||(i[21]=k("div",null,[k("i",{class:"material-icons"},"error")],-1)),k("div",null,[i[20]||(i[20]=V(" Warning! Changing the pricing rules on this window will affect all of the following devices: ")),k("ul",mo,[(f(!0),h(A,null,L(a.conditions_group,(e=>(f(),h("li",{class:"font-semibold",key:e},P(e),1)))),128))]),S(c,{color:"teal",view:"outlined",onClick:i=>e.$router.push({name:"settingConditionEdit",params:{conditionId:a.conditions_group_id||0}})},{default:w((()=>i[19]||(i[19]=[V(" Go to Conditions ")]))),_:2},1032,["onClick"])])])])),_:2},1024)),(null==(t=null==a?void 0:a.conditions)?void 0:t.length)?b((f(),_(p,{key:1,conditions:a.conditions,"onUpdate:conditions":e=>a.conditions=e,options:a.condition_options,"onUpdate:options":e=>a.condition_options=e,disabled:a.disabled,"onUpdate:disabled":e=>a.disabled=e,item:a,"key-component":l,"disabled-action":e.disabledAction,"onChange:condition":e.changeCondition,onApplyPricing:e.updateCategoryCondition},null,8,["conditions","onUpdate:conditions","options","onUpdate:options","disabled","onUpdate:disabled","item","key-component","disabled-action","onChange:condition","onApplyPricing"])),[[x,e.listLoading]]):U("",!0)])):U("",!0),(f(),_(m,{key:`${a.id}-${a.renderKey||0}`,id:a.id,items:a,"round-up":e.roundUp,"sycnable-price":a.is_syncable&&"auto"!==a.mapping_type?1:0,"price-scraper":e.priceScraper,"price-sharing":e.priceSharing,search:e.search,"disabled-action":e.disabledAction,onShowPrices:e.onShowPrices,onRefetchDevice:i=>e.refetchDevice(a),onPricingFlagUpdated:e.handlePricingFlagUpdate},null,8,["id","items","round-up","sycnable-price","price-scraper","price-sharing","search","disabled-action","onShowPrices","onRefetchDevice","onPricingFlagUpdated"]))])],8,io)])):U("",!0)],64)})),128))])),[[x,e.loadingTable||(null==(o=e.loadingPricing)?void 0:o.all)]]),S(v,{modal:e.modal,"onUpdate:modal":i[1]||(i[1]=i=>e.modal=i),item:e.selected,"onUpdate:item":i[2]||(i[2]=i=>e.selected=i),editing:e.isEditAutomate,"onUpdate:editing":i[3]||(i[3]=i=>e.isEditAutomate=i),priceSharing:e.priceSharing,"onUpdate:priceSharing":i[4]||(i[4]=i=>e.priceSharing=i),loading:null==(d=e.loading)?void 0:d.rule,onCancel:e.cancelAutomatedPricing,onApply:e.applyRule},null,8,["modal","item","editing","priceSharing","loading","onCancel","onApply"])])}]]);const go=M({components:{Input:ae,Currency:ze},props:{productParent:{type:Object},item:{type:Object},disabled:{type:Boolean,default:!1},loading:{type:Boolean},basePrice:{type:[String,Number],default:0}},setup(e){const{emit:i}=z(),a=p(),l=m(e.item),t=u((()=>e.disabled)),{actionUpdate:n}=K(a.params.tab),o=I({specs:[]});return v((()=>e.item),(e=>{l.value=e})),{item:l,loadingUpdate:o,deviceUpdate:async(a,t,d)=>{const s=a.devices.specs.map((e=>({spec_id:e.spec.id,percentage:e.spec.price}))),r=a.devices.condition_price.map((e=>({condition_id:e.condition_id,percentage:e.percentage}))),c={product_id:a.id,category_id:a.devices.mac_category_id,base_price:e.basePrice,pricing:r,specs:s};if("spec"===t){const i=`${a.id}-${a.devices.specs[d].spec.id}`;o.specs.push(i),await n({pricing:JSON.stringify([c]),products:e.productParent},(e=>{l.value.devices.specs[d].spec.price=e.data[d].price,l.value.devices.specs[d].spec.conditions=e.data[d].conditions}));const t=o.specs.findIndex((e=>e===i));t>-1&&o.specs.splice(t,1)}else await n({pricing:JSON.stringify([c]),products:e.productParent}),i("getDevice",a)},disableInput:t,sanitize:ce}}}),yo={class:"mb-8"},fo={class:"flex justify-start items-center"},ho={class:"ml-2"},bo={class:"font-semibold text-base text-black mb-3"},_o={key:0},xo=["innerHTML"],Co={class:"list w-full"},wo={key:0,class:"break-normal"};const ko=M({name:"Device",components:{Button:ee,Checkbox:pe,Input:ae,Select:qe,ExpandablePanel:Be,ComputerTable:Z(go,[["render",function(e,i,a,l,t,n){const o=g("TableColumn"),d=g("Input"),s=g("Table",!0),r=g("Popover"),c=g("Currency"),u=y("loading");return f(),h("div",null,[k("div",yo,[i[1]||(i[1]=k("p",{class:"font-semibold mb-4 text-dark"},"Set Condition Pricing",-1)),b((f(),_(s,{data:e.item.devices?e.item.devices.condition_price:[]},{default:w((()=>[S(o,{prop:"name",label:"Condition Name",width:"150"}),S(o,{label:"Set Percentage from Base Price",width:"250"},{default:w((a=>[S(d,{modelValue:a.row.percentage,"onUpdate:modelValue":e=>a.row.percentage=e,type:"number",disabled:e.disableInput,onFocusOut:i=>e.deviceUpdate(e.item,"condition",a.$index),icon:"",right:"",block:"",dense:""},{icon:w((()=>i[0]||(i[0]=[k("span",{class:"text-base"},"%",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onFocusOut"])])),_:1}),S(o,{prop:"last_update",label:"Last Update"},{default:w((e=>[k("span",null,P(e.row.last_update?e.row.last_update:"-"),1)])),_:1})])),_:1},8,["data"])),[[u,e.loading]])]),i[4]||(i[4]=k("p",{class:"font-semibold mb-4 text-dark"},"Price Preview",-1)),b((f(),_(s,{data:e.item.devices?e.item.devices.specs:[]},{default:w((()=>[S(o,{prop:"name",label:"Spec Category",width:"150"}),S(o,{prop:"name",label:"Spec name",width:"150"},{default:w((e=>[V(P(e.row.spec.spec_name),1)])),_:1}),S(o,{prop:"name",label:"Spec (%)",width:"100"},{default:w((a=>{var l,t;return[b((f(),_(d,{modelValue:a.row.spec.price,"onUpdate:modelValue":e=>a.row.spec.price=e,type:"number",disabled:e.disableInput||0===(null==(t=null==(l=e.item.devices)?void 0:l.condition_price)?void 0:t.length),onFocusOut:i=>e.deviceUpdate(e.item,"spec",a.$index),icon:"",right:"",block:"",dense:""},{icon:w((()=>i[2]||(i[2]=[k("span",{class:"text-base"},"%",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onFocusOut"])),[[u,e.loadingUpdate.specs.includes(`${e.item.id}-${a.row.spec.id}`)]])]})),_:1}),e.item.devices?(f(!0),h(A,{key:0},L(e.item.devices.condition_price,((a,l)=>(f(),_(o,{key:l,"min-width":"170"},{header:w((()=>[k("div",fo,[k("div",null,P(a.name),1),k("div",ho,[S(r,{width:250,placement:"bottom-start",trigger:"hover"},{reference:w((()=>i[3]||(i[3]=[k("div",{class:"text-teal-04 text-xs"},[k("span",{class:"material-icons text-lg"},"info")],-1)]))),default:w((()=>{var i;return[k("h6",bo," Condition: "+P(a.name),1),(null==a?void 0:a.terms)?(f(),h("div",_o,[k("p",{class:"text-dark mb-2",innerHTML:(null==(i=JSON.parse(a.terms))?void 0:i.length)>1?e.sanitize(JSON.parse(a.terms)[0]):""},null,8,xo),k("ul",Co,[(f(!0),h(A,null,L(JSON.parse(a.terms),((i,a)=>(f(),h(A,{key:a},[0!==a?(f(),h("li",wo,P(e.sanitize(i)),1)):U("",!0)],64)))),128))])])):U("",!0)]})),_:2},1024)])])])),default:w((e=>[S(c,{value:e.row.spec.conditions[l].condition_value},null,8,["value"])])),_:2},1024)))),128)):U("",!0)])),_:1},8,["data"])),[[u,e.loading]])])}]]),Modal:ie,Alert:fe},props:{items:{type:Array,default:()=>[]},pathId:{type:String,default:null},loadingTable:{type:Boolean},priceSharing:{type:Boolean,default:!1},pricingSources:{type:Array,default:()=>[]}},setup(e){const i=m(!1),a=I({type:"3",amount_type:"1",amount_price:0,selected_model:null}),{me:l}=Q(),t=m(!1),n=m(null),o=p(),r=m(null),{loading:c,actionAll:g,actionUpdate:y,actionUnsetRule:f,actionSetRule:h,actionPreview:b,actionSetBasePrice:_}=K(o.params.tab),{loading:x,actionAll:C,getRule:w}=ge(),{actionCheckDevicePricingSource:k,loading:S,action:P}=me(),{features:V}=ve(),U=m(e.items),A=I({name:null,logo:null,status:null}),M=m(!1),B=m(!1),T=u((()=>e.pricingSources.filter((e=>!(null===e.id&&!V.value.priceEditor.customRequest))))),j=u((()=>"not available"===A.status)),L=u((()=>{var i;return A.name?null==(i=e.pricingSources.find((e=>e.sub_domain===A.name)))?void 0:i.name:""})),D=u((()=>{const e=[];return"true"===o.query.ref&&o.query.model&&U.value.map((i=>{i.brand===o.params.manufacturer&&i.name===o.query.model&&e.push(i.id)})),e})),E=u((()=>{const e=l.value.currency.split("");return e.pop(),e.join("").toLowerCase()})),O=async(e,i=!1,l=!1)=>{if(!e.devices||i){let i;e.loading=!0,i=l?await b({product_id:a.selected_model.id,amount_price:a.amount_price,amount_type:a.amount_type,source:A.name,type:a.type}):await g(e.id),i.devices.product.specs=Object.entries(i.devices.product.specs).reduce(((e,i)=>(i[1].length>0&&i[1].forEach((a=>{e.push({name:i[0],spec:a})})),e)),[]),e.pricing_source={source:i.source,source_logo:i.source_logo},e.base_price=i.devices.product.base_price,l?a.selected_model.devices=i.devices.product:e.devices=i.devices.product,e.loading=!1}},R=()=>{a.type="3",a.amount_type="1",a.amount_price=0,a.selected_model=null,A.name=null,A.logo=null,A.status=null},$=e=>{let i=U.value.findIndex((i=>i.id==e.id));U.value[i].child.forEach((e=>{e.collapse=!1,e.devices=null})),r.value.toggleRowExpansion(U.value[i],!1)},F=async e=>{if(!e)return;const i={category_id:n.value.id,is_mac:1,sub_domain:e};await k(i,(e=>{A.logo=e.logo,A.status=e.status}))},N=()=>{U.value=U.value.map((e=>s(d({},e),{child:e.child.map((e=>s(d({},e),{collapse:!1,devices:null})))})))},z=(e=null)=>{e&&(A.name=e)};return v((()=>e.items),(e=>{U.value=e})),v((()=>a.type),(e=>{3==e&&(a.amount_type=0,a.amount_price=0),a.selected_model=null})),v((()=>A.name),F),H((()=>{window.addEventListener("beforeunload",(e=>{B.value&&(e.preventDefault(),e.returnValue="")}))})),q((()=>{window.removeEventListener("beforeunload",(()=>{}))})),{items:U,deviceAll:O,deviceUpdate:async(e,i=null)=>{const a=e.devices.specs.map((e=>({spec_id:e.spec.id,percentage:e.spec.price}))),l=e.devices.condition_price.map((e=>({condition_id:e.condition_id,percentage:e.percentage}))),t={product_id:e.id,category_id:e.devices.mac_category_id,base_price:e.devices.base_price,pricing:l,specs:a};null!==i&&t.pricing.push({condition_id:e.devices.condition_price[i].condition_id,percentage:e.devices.condition_price[i].percentage}),await y({pricing:JSON.stringify([t])}),O(e,!0)},me:l,tableElement:r,changeAutomatedPricing:async i=>{var a;B.value=!0,c.rules.push(i.id),M.value=!0,"1"===i.is_automated_price?await P({syncable:1,is_mac:"mac"==o.params.tab?1:0,category_id:i.id},(()=>{t.value=!0,n.value=s(d({},i),{devices:null})})):await f({category_id:i.id,is_computer:1}),M.value=!1;const l=c.rules.findIndex((e=>e===i.id));l>-1&&c.rules.splice(l,1),N(),B.value=!1,Array.isArray(e.pricingSources)&&1===e.pricingSources.length&&z((null==(a=e.pricingSources[0])?void 0:a.sub_domain)||null)},listLoading:M,cancelAutomatedPricing:()=>{if(n.value){if(!i.value){let e=U.value.findIndex((e=>e.id===n.value.id));U.value[e].is_automated_price=0}R(),t.value=!1}},applyRule:async()=>{c.rule=!0;await h({category_id:n.value.id,type:Number(a.type),source:A.name,amount_type:a.amount_type,amount_price:a.amount_price,is_computer:1})&&(await C(o.params),$(n.value),c.rule=!1,t.value=!1,n.value=null,R())},modal:t,dataModal:a,loading:c,selected:n,selectModel:async()=>{O(a.selected_model,!0,!0)},editAutomate:async e=>{e.loading=!0,await P({syncable:1,is_mac:"mac"==o.params.tab?1:0,category_id:e.id}),await w({category_id:e.id,is_computer:!0}).then((l=>{i.value=!0;let o=U.value.findIndex((e=>e.id==l.category_id));n.value=s(d({},l),{id:l.category_id,child:U.value[o].child,devices:null}),a.amount_type=l.amount_type,a.amount_price=l.amount_price,a.type=l.type,A.name=l.source,t.value=!0,e.loading=!1}))},getDevice:e=>{O(e,!0)},pricing_source:A,loadingPricingSource:S,loadingPricing:x,currencyFlagDefault:E,isPricingSourceUnavailable:j,pricingSources:T,features:V,handlePricingSourceChange:F,selectedCompanyPricingSourceName:L,handleIntercomeMessage:()=>{if(!isWhiteLabel.value)return window.open("https://forms.clickup.com/8427959/f/816dq-50256/3ZVVXIRACGV7NVG7QD","_blank");window.CustomerSupport.use("showNewMessage","Hi, I would like to learn more about your custom data services")},handleResetDeviceInfo:N,handleSetBasePrice:async e=>{await _(e,(async(i,a)=>{i||(e.base_price=a.base_price,e.devices&&(e.devices.base_price=a.base_price),await O(e,!0))}))},handleUpdatePricingSource:z,expands:D}}}),So={key:0},Po={class:"flex space-x-4"},Vo={class:"list-disc ml-5"},Uo={class:"px-5"},Ao={key:0,class:"text-center my-4"},Mo={class:"text-grey-04"},Io={class:"flex items-center mb-8"},Bo={key:0,class:"flex items-center mr-5"},To={key:0,class:"mr-4"},jo={class:"text-dark text-lg"},Lo={key:1},Do=["src"],Eo={class:"flex items-center justify-between"},Oo=["onClick"],Ro={class:"mb-0"},$o={class:"mx-10"},Fo={key:0},No={class:"text-dark text-lg"},Ho={class:"py-1"},qo={class:"space-y-10"},zo={class:"space-y-8"},Go={class:"grid lg:grid-cols-4 md:grid-cols-2 grid-cols-1 gap-4"},Jo=["onClick"],Wo={key:0,class:"flex flex-col items-center justify-center gap-6 h-full"},Yo=["src"],Zo={class:"flex justify-center items-center gap-x-2 max-w-max"},Ko={key:0,class:"material-icons text-teal-04"},Qo={class:"text-sm font-semibold inline-block w-full text-center break-words"},Xo={key:0,class:"bg-grey-01 bg-opacity-50 p-2 px-4 rounded-md flex items-center justify-start gap-x-4"},ed={class:"flex items-center gap-x-2"},id=["src"],ad={class:"text-sm"},ld={class:"flex items-center gap-x-2"},td=["src"],nd={class:"text-sm"},od={key:1,class:"flex items-center gap-x-2"},dd=["src"],sd={class:"text-sm"},rd={key:1},cd={key:1,class:"flex flex-col items-center justify-center gap-6 h-full"},ud={class:"space-y-2"},pd={key:0,class:"max-w-lg"},md={key:1,class:"grid grid-cols-2 max-w-lg gap-2"},vd={key:0,class:"text-grey-03"},gd={key:1,class:"text-grey-03"},yd={key:0},fd={key:0,class:"border border-grey-02 rounded-md p-5 mt-8"},hd={class:"flex items-center mb-5"},bd={class:"text-dark font-semibold mr-8"},_d={class:"font-normal ml-4"},xd={class:"flex items-center mr-8"},Cd=["src"],wd={class:"flex justify-end"};var kd=Z(ko,[["render",function(e,i,a,l,t,n){const o=g("router-link"),s=g("Alert"),r=g("Input"),c=g("ComputerTable"),u=g("ExpandablePanel"),p=g("TableColumn"),m=g("Checkbox"),v=g("Tooltip"),x=g("Popover"),C=g("Button"),M=g("Table"),I=g("RadioButton"),B=g("RadioGroup"),j=g("Select"),E=g("Modal"),O=y("loading");return f(),h("div",null,[b((f(),_(M,{ref:"tableElement","row-key":"id","expand-row-keys":e.expands,data:e.items,class:"mb-4"},{default:w((()=>[S(p,{type:"expand"},{default:w((a=>[a.row.conditions_group?(f(),h("div",So,[0!==a.row.conditions_group.length?(f(),_(s,{key:0,color:"orange",view:"smooth",class:"mb-5",dense:""},{default:w((()=>[k("div",Po,[i[11]||(i[11]=k("div",null,[k("i",{class:"material-icons"},"error")],-1)),k("div",null,[i[10]||(i[10]=V(" Warning! Changing the pricing rules on this window will affect all of the following items: ")),k("ul",Vo,[(f(!0),h(A,null,L(a.row.conditions_group,(e=>(f(),h("li",{class:"font-semibold",key:e},P(e),1)))),128))]),S(o,{to:{name:"settingConditionEdit",params:{conditionId:a.row.conditions_group_id}}},{default:w((()=>i[9]||(i[9]=[V(" Conditions ")]))),_:2},1032,["to"])])])])),_:2},1024)):U("",!0)])):U("",!0),(f(!0),h(A,null,L(a.row.child,((l,t)=>(f(),_(u,{key:t,modelValue:l.collapse,"onUpdate:modelValue":e=>l.collapse=e,class:"mb-4",onClickHeader:i=>e.deviceAll(l)},{header:w((({toggle:t,isExpanded:n})=>[k("div",Eo,[k("div",{onClick:t,class:"flex items-center cursor-pointer py-2"},[k("span",{class:T(["material-icons mr-2 text-2xl transform transition-all",{"rotate-90":l.collapse}])},"chevron_right",2),k("p",Ro,P(l.name),1),k("span",$o,"EMC "+P(Array.isArray(l.emc_number)?l.emc_number.map((e=>`#${e}`)).join(", "):""),1)],8,Oo),n?U("",!0):(f(),h("div",Fo,[i[17]||(i[17]=k("label",{class:"font-semibold mr-4 ml-0 text-dark"},"Base Price: ",-1)),S(r,{modelValue:l.base_price,"onUpdate:modelValue":e=>l.base_price=e,type:"number",min:"0",onFocusOut:i=>e.handleSetBasePrice(l),onClick:i[1]||(i[1]=$((()=>{}),["stop"])),icon:"","icon-block":"",disabled:e.loading.set_base_price.has(l.id)||1==a.row.is_automated_price||!a.row.is_condition_exist},{icon:w((()=>[k("span",No,P(e.me.currency_symbol),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onFocusOut","disabled"])]))])])),default:w((()=>{var t,n,d,s;return[k("div",Uo,[(null==(t=l.devices)?void 0:t.condition_price)&&0===(null==(d=null==(n=l.devices)?void 0:n.condition_price)?void 0:d.length)?(f(),h("div",Ao,[k("span",Mo,[i[13]||(i[13]=V("Please setup your ")),S(o,{to:{name:"settingCondition"}},{default:w((()=>i[12]||(i[12]=[V("conditions")]))),_:1}),i[14]||(i[14]=V(" first"))])])):U("",!0),k("div",Io,[(null==l?void 0:l.devices)?(f(),h("div",Bo,[1==a.row.is_automated_price?(f(),h("p",To,[i[15]||(i[15]=k("span",{class:"font-semibold"},"Source of Pricing:",-1)),V(" "+P(l.pricing_source.source||"-"),1)])):U("",!0),i[16]||(i[16]=k("label",{class:"font-semibold mr-4 ml-0 text-dark"},"Base Price: ",-1)),S(r,{modelValue:l.devices.base_price,"onUpdate:modelValue":e=>l.devices.base_price=e,type:"number",disabled:1==a.row.is_automated_price||0===l.devices.condition_price.length||l.loading||e.listLoading||!a.row.is_condition_exist,min:"0",onFocusOut:i=>e.deviceUpdate(l),onClick:i[0]||(i[0]=$((()=>{}),["stop"])),icon:"","icon-block":""},{icon:w((()=>[k("span",jo,P(e.me.currency_symbol),1)])),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onFocusOut"])])):U("",!0),(null==l?void 0:l.pricing_source)&&1==a.row.is_automated_price?(f(),h("div",Lo,[l.pricing_source.source_logo?(f(),h("img",{key:0,src:l.pricing_source.source_logo,alt:"company-logo",class:"h-10"},null,8,Do)):U("",!0)])):U("",!0)]),S(c,{"product-parent":{priceSync:a.row.is_automated_price,brand:a.row.brand,category:a.row.name},"base-price":null==(s=null==l?void 0:l.devices)?void 0:s.base_price,item:l,disabled:1==a.row.is_automated_price,loading:l.loading||e.listLoading,onGetDevice:e.getDevice},null,8,["product-parent","base-price","item","disabled","loading","onGetDevice"])])]})),_:2},1032,["modelValue","onUpdate:modelValue","onClickHeader"])))),128))])),_:1}),S(p,{prop:"brand",label:"Brand"}),S(p,{prop:"name",label:"Category"}),S(p,null,{header:w((()=>i[18]||(i[18]=[k("span",null,"Price Sync",-1)]))),default:w((a=>[k("div",Ho,[S(x,{trigger:"hover",disabled:!e.priceSharing,width:"400"},{reference:w((()=>[a.row.is_syncable?(f(),_(m,{key:0,modelValue:a.row.is_automated_price,"onUpdate:modelValue":e=>a.row.is_automated_price=e,type:"toggle",color:"teal",disabled:e.priceSharing,loading:e.loading.rules.includes(a.row.id),value:"1","value-off":"0",onInput:i=>e.changeAutomatedPricing(a.row)},null,8,["modelValue","onUpdate:modelValue","disabled","loading","onInput"])):(f(),_(v,{key:1,placement:"top"},{content:w((()=>i[19]||(i[19]=[k("div",{class:"w-60 text-xs"},"There are currently no pricing sources available for this item. You can price it manually by using the dropdown menu or contact support to add a custom data source.",-1)]))),default:w((()=>[S(m,{class:"py-3",type:"toggle",color:"teal",value:"1","value-off":"0",disabled:"",loading:e.loading.rules.includes(a.row.id)},null,8,["loading"])])),_:2},1024))])),default:w((()=>[i[20]||(i[20]=k("span",{class:"font-semibold"},"When price sharing is enabled, prices must be manually entered.",-1))])),_:2},1032,["disabled"])])])),_:1}),S(p,null,{default:w((a=>[0!=a.row.is_automated_price?(f(),_(C,{key:0,color:"teal",dense:"",class:"lg:opacity-0 group-hover:opacity-100 transition-all",loading:a.row.loading,onClick:i=>e.editAutomate(a.row)},{default:w((()=>i[21]||(i[21]=[k("span",{class:"material-icons text-sm"},"edit",-1)]))),_:2},1032,["loading","onClick"])):U("",!0)])),_:1})])),_:1},8,["expand-row-keys","data"])),[[O,e.loadingTable]]),S(E,{class:"modal",size:"lg",modelValue:e.modal,"onUpdate:modelValue":i[8]||(i[8]=i=>e.modal=i),"hide-header":""},{footer:w((()=>[k("div",wd,[k("a",{href:"javascript:void(0)",class:"text-red-04 hover:text-red-02 mr-8",onClick:i[7]||(i[7]=(...i)=>e.cancelAutomatedPricing&&e.cancelAutomatedPricing(...i))},"Cancel"),S(C,{class:"ml-auto small",color:"teal",loading:e.loading.rule||e.loadingPricingSource.check||e.loadingPricing.all,disabled:e.isPricingSourceUnavailable||!e.pricing_source.name,onClick:e.applyRule},{default:w((()=>i[37]||(i[37]=[V("Apply")]))),_:1},8,["loading","disabled","onClick"])])])),default:w((()=>{var a,l;return[i[38]||(i[38]=k("div",{class:"border-b border-grey-01 px-10 pb-5 mb-5 -mx-12"},[k("h6",{class:"font-semibold"},"Price Sync")],-1)),k("div",qo,[b((f(),h("div",zo,[i[27]||(i[27]=k("div",{class:"flex items-center gap-x-4"},[k("div",{class:"bg-teal-04 w-6 h-6 rounded-full flex items-center justify-center text-white"},"1"),k("span",{class:"font-semibold text-sm"},"Select your data source")],-1)),k("div",Go,[(f(!0),h(A,null,L(e.pricingSources,((a,l)=>(f(),h("div",D({key:l,ref_for:!0},d({},l===e.pricingSources.length-1&&{whiteLabel:"remove"}),{class:["border",a.sub_domain?"hover:border-teal-04 cursor-pointer":"",a.sub_domain===e.pricing_source.name?"border-teal-04":"border-grey-01",!e.pricingSources.length||1===e.pricingSources.length&&a.sub_domain?"opacity-50 cursor-not-allowed":"opacity-100","rounded-lg p-4"],onClick:i=>e.handleUpdatePricingSource(a.sub_domain)}),[a.sub_domain?(f(),h("div",Wo,[k("img",{src:a.logo,class:"pricing-source-logo"},null,8,Yo),k("div",Zo,[e.pricing_source.name===a.sub_domain?(f(),h("i",Ko,"check_circle")):U("",!0),k("span",Qo,P(a.name),1)]),e.me?(f(),h("div",Xo,[e.me.currency!==a.currency?(f(),h(A,{key:0},[k("div",ed,[a.country_code?(f(),h("img",{key:0,src:`/flag/${a.country_code.toLowerCase()}.svg`,width:"28",height:"24"},null,8,id)):U("",!0),k("span",ad,P(a.currency),1)]),i[22]||(i[22]=k("span",{class:"bg-teal-04 rounded-full w-6 h-6 flex justify-center items-center text-white text-lg"},[k("i",{class:"material-icons"},"arrow_right_alt")],-1)),k("div",ld,[k("img",{src:`/flag/${e.currencyFlagDefault}.svg`,width:"28",height:"24"},null,8,td),k("span",nd,P(e.me.currency),1)])],64)):(f(),h("div",od,[k("img",{src:`/flag/${a.country_code.toLowerCase()}.svg`,width:"28",height:"24"},null,8,dd),k("span",sd,P(a.currency),1)]))])):U("",!0),a.is_support_sell_instantly?(f(),h("div",rd,[S(v,{placement:"top"},{content:w((()=>i[23]||(i[23]=[k("div",{class:"w-60 text-xs"}," You can sell excess inventory directly from the inventory page to this pricing source. ",-1)]))),default:w((()=>[i[24]||(i[24]=k("button",{class:"text-orange-04 bg-orange-01 px-2 py-1 rounded-full flex justify-center items-center"},[k("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[k("path",{d:"M6.25 3V8.5H7.75V13L11.25 7H9.25L11.25 3H6.25Z",fill:"currentColor"})]),k("span",{class:"text-xs"},"Supports Sell Instantly")],-1))])),_:1})])):U("",!0)])):(f(),h("div",cd,[i[25]||(i[25]=k("img",{src:Ge,alt:"custom",class:"w-48 mx-auto"},null,-1)),i[26]||(i[26]=k("span",{class:"text-sm font-semibold"},"Connect Any Data",-1)),k("button",{class:"bg-teal-04 text-white px-4 py-2 rounded-lg hover:text-white text-sm",onClick:i[2]||(i[2]=(...i)=>e.handleIntercomeMessage&&e.handleIntercomeMessage(...i))},"Learn More")]))],16,Jo)))),128))])])),[[O,e.loadingPricingSource.check]]),k("div",ud,[i[33]||(i[33]=k("div",{class:"flex items-center gap-x-4 mb-5"},[k("div",{class:"bg-teal-04 w-6 h-6 rounded-full flex items-center justify-center text-white"},"2"),k("span",{class:"font-semibold text-sm"},"Set your pricing rules")],-1)),!e.pricing_source.name||e.isPricingSourceUnavailable||e.loadingPricingSource.check?U("",!0):(f(),h("div",pd,[S(B,{modelValue:e.dataModal.type,"onUpdate:modelValue":i[3]||(i[3]=i=>e.dataModal.type=i),class:"radio--full"},{default:w((()=>[S(I,{label:"3"},{default:w((()=>i[28]||(i[28]=[V("Match")]))),_:1}),S(I,{label:"2"},{default:w((()=>i[29]||(i[29]=[V("Markup")]))),_:1}),S(I,{label:"1"},{default:w((()=>i[30]||(i[30]=[V("Markdown")]))),_:1})])),_:1},8,["modelValue"])])),3!=e.dataModal.type?(f(),h("div",md,[S(B,{modelValue:e.dataModal.amount_type,"onUpdate:modelValue":i[4]||(i[4]=i=>e.dataModal.amount_type=i),class:"radio--full"},{default:w((()=>[S(I,{label:"1"},{default:w((()=>i[31]||(i[31]=[V("Percentage")]))),_:1}),S(I,{label:"0"},{default:w((()=>i[32]||(i[32]=[V("Fixed")]))),_:1})])),_:1},8,["modelValue"]),S(r,{modelValue:e.dataModal.amount_price,"onUpdate:modelValue":i[5]||(i[5]=i=>e.dataModal.amount_price=i),icon:"","icon-block":"",currency:!0,min:0,right:"0"!=e.dataModal.amount_type,type:"number",class:"w-full"},{icon:w((()=>["0"==e.dataModal.amount_type?(f(),h("span",vd,P(e.me.currency_symbol),1)):(f(),h("span",gd,"%"))])),_:1},8,["modelValue","right"])])):U("",!0)]),!e.pricing_source.name||e.isPricingSourceUnavailable||e.loadingPricingSource.check?U("",!0):(f(),h("div",yd,[i[34]||(i[34]=k("div",{class:"flex items-center gap-x-4 mb-5"},[k("div",{class:"bg-teal-04 w-6 h-6 rounded-full flex items-center justify-center text-white"},"3"),k("span",{class:"font-semibold text-sm"},"Preview Price from Model")],-1)),S(j,{modelValue:e.dataModal.selected_model,"onUpdate:modelValue":i[6]||(i[6]=i=>e.dataModal.selected_model=i),placeholder:"Please Select",name:"name",class:"w-full max-w-lg",items:null==(a=e.selected)?void 0:a.child,onInput:e.selectModel},null,8,["modelValue","items","onInput"])]))]),e.dataModal.selected_model?(f(),h("div",fd,[k("div",hd,[k("p",bd,[i[35]||(i[35]=V("Source of Pricing: ")),k("span",_d,P(e.selectedCompanyPricingSourceName),1)]),k("div",xd,[i[36]||(i[36]=k("label",{class:"font-semibold mr-4"},"Base Price: ",-1)),S(r,{modelValue:null==(l=e.dataModal.selected_model.devices)?void 0:l.base_price,type:"number",disabled:!0,icon:"",dense:""},{icon:w((()=>[V(P(e.me.currency_symbol),1)])),_:1},8,["modelValue"])]),e.pricing_source.logo?b((f(),h("img",{key:0,src:e.pricing_source.logo,alt:"company-logo",class:"h-12 mx-4"},null,8,Cd)),[[O,e.loadingPricingSource.check]]):U("",!0)]),S(c,{item:e.dataModal.selected_model,disabled:"",loading:e.dataModal.selected_model.loading},null,8,["item","loading"])])):U("",!0)]})),_:1},8,["modelValue"])])}],["__scopeId","data-v-2d1b4fb8"]]);const Sd=M({name:"BulkPriceEditorMassPricingSearch",components:{Input:ae},props:{showSearch:{type:Boolean,default:!1},search:{type:String,default:void 0},selected:{type:Array,default:()=>[]},items:{type:Object,default:()=>({})},placeholder:{type:String,default:"Search item or model"},loading:{type:Boolean,default:!1},searchCallBack:{type:Function,default:()=>{}}},emits:["update:selected","update:search","update:loading","update:showSearch"],setup(e,i){const a=u({get:()=>e.showSearch,set:e=>i.emit("update:showSearch",e)}),l=u({get:()=>e.search,set:e=>i.emit("update:search",e)}),t=u({get:()=>e.selected||[],set:e=>i.emit("update:selected",e)}),n=u((()=>{const i=Object.keys(e.items).filter((e=>"model"!==e)),a=[];return i.forEach((i=>{e.items[i].forEach((e=>{a.push(d({name_parent:i},e))}))})),a})),o=u((()=>{var i;return(null==(i=oe(e.items.model||[]))?void 0:i.map((e=>d({},e))))||[]})),s=de((async(i,t)=>{var n;(null==(n=l.value)?void 0:n.length)>=3&&!(null==a?void 0:a.value)&&(a.value=!0),await e.searchCallBack(l.value)}),300);return{searchQuery:l,itemOptions:n,modelOptions:o,selectedItemsModel:t,handleSearch:s,handleSelectItem:(e,i=(()=>{}))=>{let l=oe(t.value),n=l.findIndex((i=>i.device_id===e.device_id));if(n>=0){if(l.find((i=>i.device_id===e.device_id&&i.category_id===e.category_id)))return;l[n].category_id?l.push(e):l[n]=e}else l.push(e);t.value=l,a.value=!1},handleRemoveItem:e=>{t.value.splice(e,1),i.emit("update:selected",t.value)},showDropdown:a,closeDropdown:()=>a.value=!1}}}),Pd={class:"mass-price"},Vd={class:"relative"},Ud={class:"trigger"},Ad={class:"input"},Md={class:"whitespace-normal"},Id=["onClick"],Bd=["placeholder"],Td={key:0,class:"z-10 absolute top-full max-h-80 overflow-y-auto left-0 right-0 transform translate-y-2 border border-grey-01 border-opacity-20 bg-white rounded-md shadow"},jd={key:0,class:"space-y-2 py-4"},Ld={key:0,class:"space-y-3"},Dd=["onClick"],Ed={key:1,class:"space-y-3"},Od=["onClick"],Rd={key:1,class:"my-8"},$d={class:"text-center text-grey-03"},Fd={key:2,class:"my-4"};var Nd=Z(Sd,[["render",function(e,i,a,l,t,n){var o,d,s,r,c,u,p,m;const v=y("outside");return b((f(),h("div",Pd,[k("div",Vd,[k("div",Ud,[i[2]||(i[2]=k("div",{class:"icon"},[k("span",{class:"material-icons"},"search")],-1)),k("div",Ad,[e.selectedItemsModel.length?(f(!0),h(A,{key:0},L(e.selectedItemsModel,((i,a)=>(f(),h("div",{key:a,class:"bg-grey-01 px-4 py-0.5 rounded-full text-sm text-grey-03 bg-opacity-30 flex flex-nowrap items-center gap-x-2"},[k("span",Md,P((null==i?void 0:i.name)||(null==i?void 0:i.product_name)),1),k("span",{class:"cursor-pointer hover:opacity-50 material-icons",onClick:$((i=>e.handleRemoveItem(a)),["stop"])}," close ",8,Id)])))),128)):U("",!0),(null==(o=e.selectedItemsModel)?void 0:o.length)<5?b((f(),h("input",{key:1,"onUpdate:modelValue":i[0]||(i[0]=i=>e.searchQuery=i),placeholder:e.placeholder,onInput:i[1]||(i[1]=i=>e.handleSearch(i,e.isExpanded))},null,40,Bd)),[[G,e.searchQuery]]):U("",!0)])]),e.showDropdown?(f(),h("div",Td,[(null==(d=e.itemOptions)?void 0:d.length)>0||(null==(s=e.modelOptions)?void 0:s.length)>0?(f(),h("div",jd,[(null==(r=e.itemOptions)?void 0:r.length)>0?(f(),h("div",Ld,[i[3]||(i[3]=k("span",{class:"px-4 py-2 font-semibold text-sm text-grey-03"}," Items ",-1)),k("div",null,[(f(!0),h(A,null,L(e.itemOptions,((i,a)=>(f(),h("a",{key:`${i.device_id}_${a}`,tabindex:"1",class:"p-4 flex items-center gap-x-4 hover:bg-grey-01 text-teal-04 hover:text-teal-04",onClick:$((a=>e.handleSelectItem(i)),["prevent"])},[k("div",{style:O({width:"30px",height:"30px",backgroundImage:`url(${i.image})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"})},null,4),V(" "+P(i.name),1)],8,Dd)))),128))])])):U("",!0),(null==(c=e.modelOptions)?void 0:c.length)>0?(f(),h("div",Ed,[i[4]||(i[4]=k("span",{class:"px-4 py-2 font-semibold text-sm text-grey-03"}," Models ",-1)),k("div",null,[(f(!0),h(A,null,L(e.modelOptions,((i,a)=>(f(),h("a",{key:`${i.device_id}_${i.category_id}_${a}`,tabindex:"1",class:"p-4 flex items-center gap-x-4 hover:bg-grey-01 text-teal-04 hover:text-teal-04",onClick:$((a=>e.handleSelectItem(i)),["prevent"])},[k("div",{style:O({width:"30px",height:"30px",backgroundImage:`url(${i.image})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"})},null,4),V(" "+P((null==i?void 0:i.product_name)||(null==i?void 0:i.name)||"-"),1)],8,Od)))),128))])])):U("",!0)])):(null==(u=e.searchQuery)?void 0:u.length)>=3&&(null==(p=e.modelOptions)?void 0:p.length)<1&&(null==(m=e.itemOptions)?void 0:m.length)<1?(f(),h("div",Rd,[k("p",$d,P(e.loading?"Please wait...":"No data to show"),1)])):(f(),h("div",Fd,i[5]||(i[5]=[k("div",{class:"flex justify-center items-center py-4"},[k("p",{class:"text-left text-grey-03"},"Search for item or model")],-1)])))])):U("",!0)])])),[[v,e.closeDropdown]])}],["__scopeId","data-v-16ad1fec"]]);const Hd=M({name:"BulkPriceEditorMassPricingRules",components:{Input:ae},props:{currencySymbol:{type:String,default:()=>"-"},currencyPrefix:{type:[String,Number],default:()=>1},modelValue:{type:Object,default:()=>({type:null,amountType:null,amountPrice:null,conditions:[]})}},emits:["update:modelValue"],setup(e,i){const a=m(!1);return{form:u({get:()=>e.modelValue,set:e=>{i.emit("update:modelValue",e)}}),showTooltip:a}}}),qd={class:"max-w-lg"},zd={key:0,class:"grid grid-cols-2 max-w-lg gap-2"},Gd={class:"max-w-xs text-sm"},Jd={key:0,class:"text-grey-03"},Wd={key:1,class:"text-grey-03"};var Yd=Z(Hd,[["render",function(e,i,a,l,t,n){var o,d,s;const r=g("RadioButton"),c=g("RadioGroup"),u=g("Input"),p=g("Tooltip");return f(),h(A,null,[k("div",qd,[S(c,{modelValue:e.form.type,"onUpdate:modelValue":i[0]||(i[0]=i=>e.form.type=i),class:"radio--full",disabled:(null==(d=null==(o=e.form)?void 0:o.selectedConditions)?void 0:d.length)<=0},{default:w((()=>[S(r,{label:"2"},{default:w((()=>i[6]||(i[6]=[V("Markup")]))),_:1}),S(r,{label:"1"},{default:w((()=>i[7]||(i[7]=[V("Markdown")]))),_:1})])),_:1},8,["modelValue","disabled"])]),["1","2"].includes(null==(s=e.form)?void 0:s.type)?(f(),h("div",zd,[S(c,{modelValue:e.form.amountType,"onUpdate:modelValue":i[1]||(i[1]=i=>e.form.amountType=i),class:"radio--full mb-4"},{default:w((()=>[S(r,{label:"1"},{default:w((()=>i[8]||(i[8]=[V(" % Percentage ")]))),_:1}),S(r,{label:"0"},{default:w((()=>[V(P(e.currencySymbol)+" Fixed ",1)])),_:1})])),_:1},8,["modelValue"]),S(p,{modelValue:e.showTooltip,"onUpdate:modelValue":i[5]||(i[5]=i=>e.showTooltip=i),placement:"top",manual:""},{content:w((()=>[k("p",Gd,"Items priced at "+P(1==e.currencyPrefix?`${e.currencySymbol}0`:`0${e.currencySymbol}`)+" are not subject to pricing rules.",1)])),default:w((()=>[S(u,{modelValue:e.form.amountPrice,"onUpdate:modelValue":i[2]||(i[2]=i=>e.form.amountPrice=i),right:"0"!=e.form.amountType,min:0,max:1==e.form.amountType?100:"auto",type:"number",class:"w-full","icon-block":"",icon:"",onFocusIn:i[3]||(i[3]=i=>e.showTooltip=!0),onFocusOut:i[4]||(i[4]=i=>e.showTooltip=!1)},{icon:w((()=>["0"==e.form.amountType?(f(),h("span",Jd,P(e.currencySymbol),1)):(f(),h("span",Wd," % "))])),_:1},8,["modelValue","right","max"])])),_:1},8,["modelValue"])])):U("",!0)],64)}]]);const Zd=M({name:"BulkPriceEditorMassPricingCondition",components:{BDropdown:Je,Checkbox:pe,Input:ae},props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:"label"},groupLabel:{type:String,default:"name"},childKey:{type:String,default:"conditions"},value:{type:String,default:void 0},products:{type:Array,default:()=>[]},conditions:{type:Array,default:()=>[]}},emits:["update-conditions","update:modelValue"],setup(e,i){const a=u({get:()=>e.modelValue,set:e=>i.emit("update:modelValue",e)}),l=u((()=>e.conditions)),t=u((()=>{var i;return null==(i=e.conditions.map((e=>e.conditions)))?void 0:i.flat()})),n=u((()=>e.conditions.some((e=>0===e.conditions.length)))),o=u((()=>{var i;return(null==(i=null==e?void 0:e.products)?void 0:i.length)>1})),d=u((()=>{var e;return o.value?[]:(null==(e=l.value[0])?void 0:e.conditions)||[]}));return B((()=>{a.value=t.value||[],v((()=>null==t?void 0:t.value),(()=>{a.value=t.value||[]}),{deep:!0})})),{selectedOptions:a,multipleItems:o,options:l,singleOptions:d,optionsFlat:t,hasEmptyConditions:n}}}),Kd={class:"border rounded-lg block w-full px-5 py-2.5 border-grey-01"},Qd={class:"flex items-center justify-between"},Xd={key:0,class:"text-base text-grey-02"},es={key:1},is={key:2},as={class:"max-h-72 py-4"},ls={class:"space-y-2"},ts={class:"font-semibold px-4"},ns={class:"font-normal"},os={key:1,class:"px-4 py-3"},ds={class:"text-grey-03 text-sm"},ss={key:1},rs={class:"font-normal"},cs={key:1,class:"px-4 py-3"},us={class:"text-grey-03 text-sm text-center"};const ps=M({name:"BulkPriceEditorMassPricing",components:{Modal:ie,Button:ee,Search:Nd,Rules:Yd,Conditions:Z(Zd,[["render",function(e,i,a,l,t,n){const o=g("Checkbox"),d=g("BDropdown");return f(),_(d,{block:""},{default:w((({isExpanded:i})=>{var a;return[k("button",Kd,[k("div",Qd,[e.selectedOptions.length?U("",!0):(f(),h("p",Xd," Select Condition ")),e.selectedOptions.length&&e.selectedOptions.length===(null==(a=e.optionsFlat)?void 0:a.length)&&!e.hasEmptyConditions?(f(),h("div",es,"All Condition")):e.selectedOptions.length>0?(f(),h("div",is,P(e.selectedOptions.length)+" Condition Selected",1)):U("",!0),k("span",{class:T(["transform material-icons","text-grey-03",i&&"rotate-180"])}," arrow_drop_down ",2)])])]})),dropdown:w((()=>{var a,l;return[k("div",as,[e.multipleItems?(f(!0),h(A,{key:0},L(e.options,((a,l)=>{var t;return f(),h("ul",{key:l,class:"space-y-2"},[k("li",ls,[k("span",ts,P(a[e.groupLabel]),1),k("ul",null,[(null==(t=a[e.childKey])?void 0:t.length)>0?(f(!0),h(A,{key:0},L(a[e.childKey],((a,t)=>(f(),h("li",{key:`${l}_${t}`,class:"hover:bg-teal-01 hover:bg-opacity-30 px-4 py-3"},[S(o,{modelValue:e.selectedOptions,"onUpdate:modelValue":i[0]||(i[0]=i=>e.selectedOptions=i),value:a,id:t},{default:w((()=>[k("span",ns,P(a[e.label]),1)])),_:2},1032,["modelValue","value","id"])])))),128)):(f(),h("li",os,[k("p",ds,P(a[e.groupLabel]||"The item or model")+" do not have a condition yet. ",1)]))])])])})),128)):(f(),h("ul",ss,[(null==(a=e.singleOptions)?void 0:a.length)>0?(f(!0),h(A,{key:0},L(e.singleOptions,((a,l)=>(f(),h("li",{key:l,class:"hover:bg-teal-01 hover:bg-opacity-30 px-4 py-3"},[S(o,{modelValue:e.selectedOptions,"onUpdate:modelValue":i[1]||(i[1]=i=>e.selectedOptions=i),value:a,id:l},{default:w((()=>[k("span",rs,P(a[e.label]),1)])),_:2},1032,["modelValue","value","id"])])))),128)):(f(),h("li",cs,[k("p",us,P((null==(l=e.options[0])?void 0:l.name)||"The item or model")+" do not have a condition yet. ",1)]))]))])]})),_:1})}]])},props:{disabled:{type:Boolean,default:!1}},emits:["submit"],setup(e,i){const{me:a}=Q(),{data:l,modal:t,loading:n,getConditions:o,getModelItems:d,canceling:s,readyToSave:r,selectingProducts:c,setRules:u}=be(),p=m(!1),v=()=>{s(),p.value=!1};return{me:a,data:l,modal:t,loading:n,readyToSave:r,triggerClick:async()=>{e.disabled||(t.value=!t.value,t.value&&await o())},canceling:s,showSearch:p,selectingProducts:c,getModelItems:d,getConditions:o,handleSubmit:async()=>{await u((e=>{200!==e.response&&"success"!==e||(t.value=!1,v(),i.emit("submit"))}))},handleClose:v}}}),ms={class:"inline-block"},vs={class:"max-w-xs text-sm"},gs={class:T(["transition-all duration-300 ease-in-out","text-grey-03 hover:text-grey-04 flex items-center gap-x-3"])},ys={class:"text-xl"},fs={key:0,class:"space-y-8"},hs={class:"flex flex-col gap-y-8"},bs={class:"space-y-2"};var _s=Z(ps,[["render",function(e,i,a,l,t,n){const o=g("Button"),d=g("Tooltip"),s=g("Search"),r=g("Conditions"),c=g("Rules"),u=g("Modal"),p=y("loading");return f(),h(A,null,[k("div",ms,[S(d,{trigger:"hover",placement:"top-end",disabled:e.disabled},{content:w((()=>[k("div",vs,"Items priced at "+P(e.me.currency_prefix?`${e.me.currency_symbol}0`:`0${e.me.currency_symbol}`)+" are not subject to pricing rules.",1)])),default:w((()=>[e.$slots.trigger?U("",!0):(f(),_(o,{key:0,disabled:e.disabled,color:"white",onClick:e.triggerClick},{default:w((()=>[k("div",gs,[k("span",ys,P(e.me.currency_symbol),1),i[7]||(i[7]=k("span",null,"Mass Pricing",-1))])])),_:1},8,["disabled","onClick"])),e.$slots.trigger?J(e.$slots,"trigger",W(D({key:1},{click:e.triggerClick}))):U("",!0)])),_:3},8,["disabled"])]),S(u,{modelValue:e.modal,"onUpdate:modelValue":i[6]||(i[6]=i=>e.modal=i),size:"sm","hide-header":e.loading.all,"body-scroll":!e.showSearch,onClose:e.handleClose},{header:w((()=>i[8]||(i[8]=[k("span",{class:"font-medium"}," Category Mass Price Adjustments ",-1)]))),default:w((()=>{var a,l,t,n;return[e.modal?(f(),h("div",fs,[i[11]||(i[11]=k("div",{class:"flex gap-x-2"},[k("i",{class:"material-icons"},"info"),k("div",{class:"text-sm space-y-4"},[k("p",null," Mass pricing adjustments apply only to manually priced items and allow you to adjust prices for up to five items or models at a time. You can increase or decrease prices by a set amount or percentage for selected items, models, or specific conditions within those categories. "),k("p",null," For example, you can raise all iPhone prices by $1 in one click, applying the change to every model and condition, or you can set rules for specific conditions or specific models. ")])],-1)),b((f(),h("div",hs,[k("div",null,[S(s,{selected:e.data.selectedProducts,"onUpdate:selected":[i[0]||(i[0]=i=>e.data.selectedProducts=i),e.selectingProducts],search:e.data.search,"onUpdate:search":i[1]||(i[1]=i=>e.data.search=i),loading:e.loading.search,"onUpdate:loading":i[2]||(i[2]=i=>e.loading.search=i),showSearch:e.showSearch,"onUpdate:showSearch":i[3]||(i[3]=i=>e.showSearch=i),items:e.data.products,searchCallBack:e.getModelItems},null,8,["selected","search","loading","showSearch","items","searchCallBack","onUpdate:selected"])]),(null==(l=null==(a=e.data)?void 0:a.selectedProducts)?void 0:l.length)>0?(f(),h(A,{key:0},[b((f(),h("div",bs,[i[9]||(i[9]=k("span",{class:"font-medium"},"Condtion",-1)),S(r,{modelValue:e.data.selectedConditions,"onUpdate:modelValue":i[4]||(i[4]=i=>e.data.selectedConditions=i),products:e.data.selectedProducts,conditions:e.data.conditions,label:"name",value:"id","group-label":"name","child-key":"conditions"},null,8,["modelValue","products","conditions"])])),[[p,e.loading.conditions]]),b((f(),h("div",{class:T(["space-y-2",(null==(n=null==(t=e.data)?void 0:t.selectedConditions)?void 0:n.length)<=0&&"opacity-30"])},[i[10]||(i[10]=k("span",{class:"font-medium"},"Adjustment Rules",-1)),S(c,{modelValue:e.data,"onUpdate:modelValue":i[5]||(i[5]=i=>e.data=i),"currency-symbol":e.me.currency_symbol,"currency-prefix":e.me.currency_prefix},null,8,["modelValue","currency-symbol","currency-prefix"])],2)),[[p,e.loading.conditions]])],64)):U("",!0)])),[[p,e.loading.all]])])):U("",!0)]})),footer:w((()=>[S(o,{color:"teal",loading:e.loading.all,disabled:e.readyToSave,onClick:e.handleSubmit},{default:w((()=>i[12]||(i[12]=[V(" Save Changes ")]))),_:1},8,["loading","disabled","onClick"])])),_:1},8,["modelValue","hide-header","body-scroll","onClose"])],64)}]]);const xs=M({name:"PriceUploadDownloadTemplate",components:{Button:ee,Modal:ie},props:{disabled:{type:Boolean,default:!1},modalCancel:{type:Boolean,default:!1}},emits:["download","continueDownload","confirmClose"],setup(e,i){var a,l,t,n;const o=u((()=>{var e;return null==(e=d.pricing)?void 0:e.processing})),{state:d,progress:s,templates:r,templateSelected:c,showInstructions:p,action:m,cancelDownload:v,saveStateDownload:g}=_e(),y=u((()=>{var e;const i=[...r.value].find((e=>e.loading));return(null==i?void 0:i.loading)||(null==(e=d.value)?void 0:e.downloadProgress)>0||!1}));return(null==(l=null==(a=d.pricing)?void 0:a.processing)?void 0:l.downloadProgress)>0&&(c.value=null==(t=d.value)?void 0:t.typeDownload,s.value=null==(n=d.value)?void 0:n.downloadProgress),{state:d,progress:s,templates:r,pricingState:o,loadingDownload:y,showInstructions:p,templateSelected:c,handleDownload:async e=>{i.emit("download",!0),await m(e),i.emit("download",!1)},handleContinue:()=>i.emit("continueDownload"),handleAbort:async()=>{g(),await Y(),v(),await Y(),i.emit("confirmClose")}}}}),Cs={class:"space-y-4"},ws={class:"p-4 pb-6 rounded-xl space-y-6 border border-grey-01"},ks={class:"border border-grey-01 rounded-lg"},Ss={class:"flex items-center justify-between gap-x-1"},Ps={class:"text-sm text-grey-03"},Vs={key:0,class:"px-4 pb-4 space-y-4 text-sm text-grey-03"},Us={class:"space-y-2"},As={class:"flex flex-wrap gap-4"},Ms={class:"flex items-center gap-x-2"},Is={class:"w-80 text-sm"},Bs={key:0},Ts={class:"text-left text-xs text-grey-03"},js={class:"w-full bg-grey-01 bg-opacity-80 rounded-full h-1"},Ls={key:0},Ds={class:"py-10 space-y-8"},Es={class:"space-y-4"},Os={class:"flex items-center justify-center flex-col gap-y-4"},Rs={class:"text-center text-grey-02"},$s={class:"w-full bg-grey-01 bg-opacity-80 rounded-full h-1"},Fs={class:"flex items-center justify-center gap-x-6"};var Ns=Z(xs,[["render",function(e,i,a,l,t,n){const o=g("Button"),d=g("Tooltip"),s=g("Modal");return f(),h(A,null,[k("div",Cs,[k("div",ws,[k("div",ks,[k("div",{class:"flex items-center justify-between p-4 cursor-pointer",onClick:i[0]||(i[0]=i=>e.showInstructions=!e.showInstructions)},[i[3]||(i[3]=k("p",{class:"text-sm font-semibold"},"Ensure no price cells are left blank. Price upload wont work with items under Price Sync.",-1)),k("div",Ss,[k("p",Ps," Show "+P(e.showInstructions?"Less":"More"),1),k("span",{class:T([["material-icons","transform transition-all","ease-out duration-300",e.showInstructions&&"-rotate-180"],"material-icons"])},"expand_more",2)])]),S(j,{name:"slide-fade"},{default:w((()=>[e.showInstructions?(f(),h("div",Vs,i[4]||(i[4]=[k("p",null,"In the template, items or conditions priced at $0 won't appear in the Widget after upload, and any blank price cells will trigger a validation error. Your upload will continue, and you will see a validation report with a list of errors, if any, once it is complete.",-1),k("p",null,"Price upload won't work for items under price sync; it only applies to manually priced items. During price uploads, you won't be able to make changes to prices, the catalog, item conditions, or the price editor, and the settings for these will not be accessible. Also, do not alter anything other than prices in the template, as modifying or deleting any other data will cause the affected items to not appear on your Widget.",-1)]))):U("",!0)])),_:1})]),i[6]||(i[6]=k("ul",{class:"list-disc text-sm mx-4 text-grey-04"},[k("li",null,"$0 items or conditions wont appear in the Widget."),k("li",null,"Blank price cells will cause a validation error."),k("li",null,"Price upload works only for manually priced items, not those under price sync."),k("li",null,"During price uploads, edits and settings for prices, the catalog, and conditions will be inaccessible."),k("li",null,"Only edit prices; changing other data may remove items from the Widget.")],-1)),i[7]||(i[7]=k("div",{class:"bg-blue-01 bg-opacity-50 rounded-md flex gap-4 p-4 text-blue-03"},[k("span",{class:"material-icons"},"tips_and_updates"),k("p",{class:"text-sm"},"Pro Tip: If you dont want to buy an item or a condition in the template, set its price to $0, then upload it, and it wont be visible to your customers.")],-1)),k("div",Us,[k("div",As,[(f(!0),h(A,null,L(e.templates,(a=>(f(),_(d,{placement:"top",key:a.id},{content:w((()=>[k("p",Is,P(a.tooltip),1)])),default:w((()=>[S(o,{disabled:e.disabled||e.loadingDownload,color:"teal",view:e.disabled||e.loadingDownload?"":"outlined",dense:"",onClick:i=>e.handleDownload(a.id)},{default:w((()=>[k("div",Ms,[i[5]||(i[5]=k("span",{class:"material-icons"},"download",-1)),V(" "+P(a.name),1)])])),_:2},1032,["disabled","view","onClick"])])),_:2},1024)))),128))]),S(j,{name:"fade"},{default:w((()=>{var i;return[e.loadingDownload?(f(),h("div",Bs,[k("p",Ts,"Downloading "+P(e.templateSelected)+" template...",1),k("div",js,[k("div",{class:"bg-teal-04 h-1 rounded-full transition-all ease-out duration-300",style:O({width:`${(null==(i=e.state)?void 0:i.downloadProgress)||0}%`})},null,4)])])):U("",!0)]})),_:1})])])]),e.loadingDownload?(f(),h("div",Ls,[S(s,{modelValue:e.modalCancel,"onUpdate:modelValue":i[2]||(i[2]=i=>e.modalCancel=i),size:"xs","hide-header":"","hide-footer":""},{default:w((()=>{var a;return[k("div",Ds,[k("div",Es,[k("div",Os,[i[8]||(i[8]=k("img",{src:xe,alt:"Warning icon"},null,-1)),i[9]||(i[9]=k("h6",null,"Download in Progress",-1)),k("p",Rs,"A template file is currently downloading "+P(e.templateSelected||"CSV/XLSX")+". If you close this window, your download will be interrupted.",1)])]),k("div",null,[i[10]||(i[10]=k("p",{class:"text-left text-sm"},"Downloading Progress",-1)),k("div",$s,[k("div",{class:"bg-teal-04 h-1 rounded-full transition-all ease-out duration-300",style:O({width:`${null==(a=e.state)?void 0:a.downloadProgress}%`})},null,4)])]),k("div",Fs,[k("a",{href:"#",onClick:i[1]||(i[1]=$(((...i)=>e.handleContinue&&e.handleContinue(...i)),["prevent"]))},"Continue Download"),S(o,{color:"orange",onClick:e.handleAbort},{default:w((()=>i[11]||(i[11]=[V("Close Anyway")]))),_:1},8,["onClick"])])])]})),_:1},8,["modelValue"])])):U("",!0)],64)}]]);const Hs=M({name:"PriceUploadImportData",components:{FileUpload:We,Button:ee},props:{files:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["completed","error","remove","uploading"],setup(e,i){const a=I({url:"/v1/pos/pricing/upload-pricing",method:"post",field:"file"}),l=u((()=>{if(e.files.length){return[e.files[0].name.split(".").pop()]}return["csv","xlsx"]})),t=m({alternates:!1}),n=m(Ce);return{computedAccept:l,fileUploadConfig:a,collapses:t,alternateTutorials:n,handlCollapse:e=>{t.value[e]=!t.value[e]},handleUploading:e=>{i.emit("uploading",e)},handleCompleteUpload:(e=[])=>{i.emit("completed",e)},handleErrorUpload:(e=[])=>{i.emit("error",e)},handleRemovedFile:(e=null)=>{i.emit("remove",e)}}}}),qs={class:"space-y-4"},zs={class:"relative"},Gs={class:"bg-grey-01 bg-opacity-10 rounded-md p-8 flex flex-col items-center gap-4"},Js=["onClick"],Ws={key:0,class:"text-xs"},Ys={key:1,class:"text-xs"},Zs={class:"block mt-4"},Ks={class:"rounded-b-md bg-grey-01 bg-opacity-10"},Qs={key:0},Xs={class:"text-sm font-medium"},er={class:"relative w-full"},ir={class:"flex items-center"},ar={class:"file-list__file-name text-sm"},lr={class:"file-list__file-size text-sm"},tr={class:"file-list__file-remove pl-6"},nr={key:1,class:"px-4 pt-4 pb-6"},or={class:"text-sm font-medium"},dr={class:"relative w-full"},sr={class:"flex items-center"},rr={class:"file-list__file-name text-sm"},cr={class:"file-list__file-size text-sm text-grey-02"},ur={class:"file-list__file-remove pl-6"},pr=["onClick"],mr={key:0,class:"absolute top-0 left-0 right-0 bottom-0 bg-white opacity-50 cursor-not-allowed"},vr={class:"border border-grey-01 rounded-lg"},gr={key:0,class:"p-4 space-y-4"},yr=["onClick"],fr={class:"font-medium"},hr={key:0,class:"px-4 pb-4"},br={class:"space-y-4"},_r={class:"bg-teal-04 w-8 h-8 flex items-center justify-center rounded-full text-white"},xr={class:"flex-1 space-y-4"},Cr=["innerHTML"],wr=["innerHTML"],kr={key:2,class:"flex"},Sr={class:"flex-1 flex gap-4 items-start"},Pr=["src","alt"];var Vr=Z(Hs,[["render",function(e,i,a,l,t,n){const o=g("Button"),d=g("FileUpload");return f(),h("div",qs,[k("div",zs,[S(d,{accept:e.computedAccept,config:e.fileUploadConfig,files:e.files,"single-upload":e.computedAccept.length<=1&&e.computedAccept.includes("xlsx"),offline:"",onCompleted:e.handleCompleteUpload,onError:e.handleErrorUpload,onUploading:e.handleUploading,onRemove:e.handleRemovedFile},{default:w((({openDialog:a,acceptedFileTypes:l})=>{var t;return[k("div",Gs,[k("div",{class:"flex items-center gap-1 flex-col text-grey-03",onClick:a},[i[2]||(i[2]=k("svg",{xmlns:"http://www.w3.org/2000/svg","enable-background":"new 0 0 24 24",height:"32px",viewBox:"0 0 24 24",width:"32px",fill:"currentColor"},[k("g",null,[k("rect",{fill:"none",height:"24",width:"24"})]),k("g",null,[k("path",{d:"M18,15v3H6v-3H4v3c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2v-3H18z M7,9l1.41,1.41L11,7.83V16h2V7.83l2.59,2.58L17,9l-5-5L7,9z"})])],-1)),i[3]||(i[3]=k("p",{class:"text-grey-04 font-medium text-xl"},"Choose files or drag them here",-1)),(null==(t=e.files)?void 0:t.length)?(f(),h("p",Ys,"Upload "+P(l),1)):(f(),h("p",Ws,"Upload multiple "+P(l),1))],8,Js),S(o,{color:"teal",view:"outlined",onClick:a},{default:w((()=>i[4]||(i[4]=[V(" Browse Files ")]))),_:2},1032,["onClick"])])]})),types:w((({acceptedFileTypes:e})=>[k("small",Zs,[i[5]||(i[5]=k("span",{class:"font-semibold"},"File:",-1)),V(" "+P(e),1)])])),"file-list":w((({files:a,removeFile:l,isEmptyFiles:t})=>{var n,o,d;return[k("div",Ks,[t&&(null==(n=e.files)?void 0:n.length)>0?(f(),h("div",Qs,[i[8]||(i[8]=k("div",{class:"px-7 text-grey-01"},[k("hr")],-1)),k("p",Xs,P(null==(o=e.files)?void 0:o.length)+" "+P((null==(d=e.files)?void 0:d.length)>1?"files":"file")+" selected ",1),(f(!0),h(A,null,L(e.files,(a=>(f(),h("div",{key:a.name,class:T(["file-list__item"])},[i[7]||(i[7]=k("div",{class:"file-list__file-icon pr-6"},[k("i",{class:"material-icons"},"insert_drive_file")],-1)),k("div",er,[k("div",ir,[k("div",ar,P(a.name),1),k("div",lr,P(e.fileSizeFormat(a.size)),1)])]),k("div",tr,[k("a",{onClick:i[0]||(i[0]=$((i=>e.handleRemovedFile(null)),["prevent"]))},i[6]||(i[6]=[k("i",{class:"material-icons"},"cancel",-1)]))])])))),128))])):t?U("",!0):(f(),h("div",nr,[i[10]||(i[10]=k("div",{class:"px-2 text-grey-01 mb-8"},[k("hr")],-1)),k("p",or,P(null==a?void 0:a.length)+" "+P((null==a?void 0:a.length)>1?"files":"file")+" selected ",1),(f(!0),h(A,null,L(a,(e=>(f(),h("div",{key:e.name,class:T(["file-list__item","bg-opacity-50 rounded-lg",e.status.error?"file-list__item--error":"bg-grey-01",,e.status.progress<100?"file-list__item--onprogress":""]),style:O({padding:e.status.progress<100?"0.5rem 1.5rem 0.725rem 1.5rem":"0.5rem 1.5rem"})},[i[9]||(i[9]=k("div",{class:"file-list__file-icon pr-2"},[k("i",{class:"material-icons",style:{"font-size":"1.725rem !important"}},"insert_drive_file")],-1)),k("div",dr,[k("div",sr,[k("div",null,[k("div",rr,P(e.name),1)]),k("div",cr,P(e.size),1)]),S(j,{name:"fade"},{default:w((()=>[e.status.progress<100?(f(),h("div",{key:0,class:"file-list__progress-bar",style:O({width:`${e.status.progress}%`})},null,4)):U("",!0)])),_:2},1024)]),k("div",ur,[k("a",{onClick:$((i=>l(e.id)),["prevent"])},[k("i",{class:T([!e.status.error&&"text-grey-04","material-icons"])},"cancel",2)],8,pr)])],6)))),128))]))])]})),_:1},8,["accept","config","files","single-upload","onCompleted","onError","onUploading","onRemove"]),e.loading?(f(),h("div",mr)):U("",!0)]),k("div",vr,[k("div",{class:"p-4 flex items-center justify-between gap-4 cursor-pointer",onClick:i[1]||(i[1]=i=>e.handlCollapse("alternates"))},i[11]||(i[11]=[k("span",{class:"font-medium"},"Alternates",-1),k("span",{class:"material-icons"},"expand_more",-1)])),S(j,{name:"slide-fade"},{default:w((()=>[e.collapses.alternates?(f(),h("div",gr,[i[13]||(i[13]=k("div",{class:"bg-blue-01 bg-opacity-50 rounded-md flex gap-4 p-3 py-2 text-blue-03"},[k("p",{class:"text-sm"},[V(" Update prices for items in your active catalog through "),k("a",{href:"https://docs.reusely.com/reference/reusely-api-overview",class:"text-blue-03 hover:text-blue-03 underline",target:"_blank"}," our API "),k("span",{class:"ml-1 material-icons",style:{"line-height":"1"}}," open_in_new ")])],-1)),i[14]||(i[14]=k("p",null,"This is an example of how to integrate the API",-1)),(f(!0),h(A,null,L(e.alternateTutorials,((e,a)=>(f(),h("div",{key:a,class:T(["bg-grey-01","rounded-lg",e.collapse?"bg-opacity-20":"bg-opacity-50"])},[k("div",{class:T(["p-4 flex items-center","justify-between gap-4",!e.collapse&&"cursor-pointer"]),onClick:i=>e.collapse=!e.collapse},[k("span",fr,P(null==e?void 0:e.title),1),i[12]||(i[12]=k("span",{class:"material-icons"},"expand_more",-1))],10,yr),S(j,{name:"slide-fade"},{default:w((()=>[e.collapse?(f(),h("div",hr,[k("div",null,[k("ol",br,[(f(!0),h(A,null,L(null==e?void 0:e.howTo,((e,i)=>{var l;return f(),h("li",{key:`${a}_${i}`,class:"flex items-start gap-x-4"},[k("span",_r,P(i+1),1),k("div",xr,[(null==e?void 0:e.codes)?(f(),h("div",{key:0,innerHTML:null==e?void 0:e.codes},null,8,Cr)):U("",!0),(null==e?void 0:e.text)?(f(),h("p",{key:1,class:"mt-0.5",innerHTML:e.text},null,8,wr)):U("",!0),(null==(l=null==e?void 0:e.images)?void 0:l.length)?(f(),h("div",kr,[k("div",Sr,[(f(!0),h(A,null,L(null==e?void 0:e.images,(e=>(f(),h("img",{key:e,src:`/images/price-external-source/${e}`,alt:e,class:"w-auto h-auto",style:{"max-width":"45%"}},null,8,Pr)))),128))])])):U("",!0)])])})),128))])])])):U("",!0)])),_:2},1024)],2)))),128))])):U("",!0)])),_:1})])])}]]);const Ur=M({name:"PriceUploadInProgress",components:{Button:ee},setup(e,i){const a=m(401.92),l=u((()=>80)),t=u((()=>a.value-a.value*l.value/100));return{progressPercentage:l,baseOffset:a,calculatedOffset:t}}}),Ar={class:"space-y-4 border border-grey-01 p-2 rounded-lg"},Mr={class:"flex items-center"},Ir={class:"mr-2"},Br={width:"80",height:"80",viewBox:"-18.5 -18.5 185 185",version:"1.1",xmlns:"http://www.w3.org/2000/svg",style:{transform:"rotate(-90deg)"}},Tr=["stroke-dasharray"],jr=["stroke-dashoffset","stroke-dasharray"],Lr=["x"];const Dr=M({name:"PriceUpload",components:{Modal:ie,Button:ee,PriceUploadDownloadTemplate:Ns,PriceUploadImportData:Vr,PriceUploadInProgress:Z(Ur,[["render",function(e,i,a,l,t,n){return f(),h("div",Ar,[k("div",Mr,[k("div",Ir,[(f(),h("svg",Br,[V(P(e.calculatedOffset)+" ",1),k("circle",{r:"64",cx:"74",cy:"74",fill:"transparent",stroke:"#e0e0e0","stroke-width":"12","stroke-dasharray":`${e.baseOffset}px`,"stroke-dashoffset":"0"},null,8,Tr),k("circle",{r:"64",cx:"74",cy:"74",stroke:"#3b82f6","stroke-width":"12","stroke-linecap":"round","stroke-dashoffset":`${e.calculatedOffset}px`,fill:"transparent","stroke-dasharray":`${e.baseOffset}px`},null,8,jr),k("text",{x:e.progressPercentage<100?e.progressPercentage<25?"50px":"42px":"40px",y:"87px",fill:"#262626","font-size":"32px","font-weight":"bold",style:{transform:"rotate(90deg) translate(0, -144px)","text-align":"center"}},P(e.progressPercentage||0)+"% ",9,Lr)]))]),i[0]||(i[0]=k("div",{class:"mr-4"},[k("p",null,"Status: Updating"),k("h3",{class:"text-xl font-medium"},"Price Editor")],-1))])])}]])},props:{disabled:{default:!1,type:Boolean},pro:{type:Boolean,default:!0}},emits:["submit"],setup(e,i){const{modal:a,loading:l,loadingDownload:t,state:n,_state:o,modalCancelDownload:d,handleModalShow:s,handleUploadCompleted:r,handleUploadError:c,handleUploading:u,handleRemovedFile:p,handleClose:m,handleCloseWarning:v,handleUpdatePricing:g}=we(),{open:y}=ke();return{modal:a,state:n,storeState:o,loading:l,loadingDownload:t,modalCancelDownload:d,handleShowValidation:()=>{e.disabled||s()},handleClose:m,handleUploadCompleted:r,handleUploadError:c,handleUploading:u,handleRemovedFile:p,handleUpdatePricing:g,handleSubmit:async()=>{if(!e.pro)return y({title:"Update Pricing via Price Sheet",description:"To make manual bulk pricing updates easier, you can edit your prices offline using our XLSX or CSV templatesall the data is already there. Just update the prices, upload the file, and boom, youre done! Enjoy quick and efficient price adjustments across multiple products.",image_url:"/images/paywall/paywall-price-upload.svg"});let a;const l=n.value.latestUploadedFile.map((e=>e.file));if(null==l?void 0:l.length){a=l[0].name.split(".").pop();const e=new FormData;l.forEach(((i,a)=>{e.append("files[]",i)})),e.append("type","xlsx"===a?"excel":"csv"),await g(e,i.emit)}},handleDownload:e=>{t.value=e,d.value=!1},handleCloseWarning:v,handleConfirmClose:()=>{a.value=!1,t.value=!1,d.value=!1}}}}),Er={class:"inline-block"},Or={key:0,class:"space-y-8"},Rr={class:"space-y-4"},$r={class:"pl-11"},Fr={class:"space-y-4"},Nr={class:"pl-11"},Hr={key:1};const qr=M({components:{Checkbox:pe,BulkPriceEditor:vo,BulkPriceEditorComputer:kd,BulkPriceEditorMassPricing:_s,BulkPriceEditorPriceUpload:Z(Dr,[["render",function(e,i,a,l,t,n){const o=g("Button"),d=g("PriceUploadDownloadTemplate"),s=g("PriceUploadImportData"),r=g("PriceUploadInProgress"),c=g("Modal"),u=y("loading");return f(),h(A,null,[k("div",Er,[e.$slots.trigger?U("",!0):(f(),_(o,{key:0,disabled:e.disabled,color:"white",onClick:e.handleShowValidation},{default:w((()=>i[2]||(i[2]=[k("div",{class:T(["transition-all duration-300 ease-in-out","text-grey-03 hover:text-grey-04 flex items-center gap-x-3"])},[k("span",{class:"material-icons"},"table_view"),k("span",null,"Price Upload")],-1)]))),_:1},8,["disabled","onClick"])),e.$slots.trigger?J(e.$slots,"trigger",W(D({key:1},{click:e.handleShowValidation,disabled:e.disabled})),void 0,!0):U("",!0)]),S(c,{modelValue:e.modal,"onUpdate:modelValue":i[1]||(i[1]=i=>e.modal=i),size:"md","no-close":""},{header:w((()=>[k("div",null,[i[3]||(i[3]=k("span",{class:"font-medium"}," Price Upload ",-1)),e.loading?U("",!0):(f(),h("a",{key:0,href:"#",class:"modal__content-header-close top-0 right-0",onClick:i[0]||(i[0]=$(((...i)=>e.handleClose&&e.handleClose(...i)),["prevent"]))},""))])])),default:w((()=>{var a,l,t;return[b((f(),h("div",null,[(null==(a=e.state)?void 0:a.inProgress)?(f(),h("div",Hr,[S(r)])):(f(),h("div",Or,[k("div",Rr,[i[4]||(i[4]=k("div",{class:"flex items-center gap-4"},[k("div",{class:T(["bg-teal-04 w-7 h-7","rounded-full flex","items-center justify-center","text-white"])}," 1 "),k("span",{class:"font-medium text-base"},"Download Template")],-1)),k("div",$r,[S(d,{"modal-cancel":e.modalCancelDownload,disabled:!!(null==(l=e.state.latestUploadedFile)?void 0:l.length),onDownload:e.handleDownload,onContinueDownload:e.handleCloseWarning,onConfirmClose:e.handleConfirmClose},null,8,["modal-cancel","disabled","onDownload","onContinueDownload","onConfirmClose"])])]),k("div",Fr,[i[5]||(i[5]=k("div",{class:"flex items-center gap-4"},[k("div",{class:T(["bg-teal-04 w-7 h-7","rounded-full flex","items-center justify-center","text-white"])}," 2 "),k("span",{class:"font-medium text-base"},"Import Data")],-1)),k("div",Nr,[S(s,{files:e.state.latestUploadedFile,loading:e.loading||e.loadingDownload||(null==(t=e.storeState)?void 0:t.downloadProgress)>0,onCompleted:e.handleUploadCompleted,onError:e.handleUploadError,onUploading:e.handleUploading,onRemove:e.handleRemovedFile},null,8,["files","loading","onCompleted","onError","onUploading","onRemove"])])])]))])),[[u,e.loading]])]})),footer:w((()=>{var a,l,t;return[k("div",null,[S(o,{disabled:e.loading||!(null==(l=null==(a=e.state)?void 0:a.latestUploadedFile)?void 0:l.length)||(null==(t=e.state)?void 0:t.inProgress),color:"teal",onClick:e.handleSubmit},{default:w((()=>i[6]||(i[6]=[k("div",{class:"flex items-center justify-center gap-x-2"},[k("span",null,"Update Pricing")],-1)]))),_:1},8,["disabled","onClick"])])]})),_:1},8,["modelValue"])],64)}],["__scopeId","data-v-5a9d3430"]]),BulkPriceEditorPriceUploadInvalid:Se,Input:ae,Button:ee,Pagination:ye},async setup(){const e=p(),{isActive:i,dismiss:a}=(e=>{const i=c();return{isActive:a=>u((()=>i.getters["alert/isAlertActive"](e,a))),trigger:a=>{i.dispatch("alert/triggerAlert",{module:e,id:a})},dismiss:a=>{i.dispatch("alert/dismissAlert",{module:e,id:a})}}})("pricing"),l=u((()=>{var e;return null==(e=i(Me.PRICING.INVALID_PRICE_UPLOAD))?void 0:e.value})),{data:t,actionAll:n,loading:o,state:d}=ge(),{state:s,actionGet:r,actionUpdate:g}=Pe(),{me:y}=Q(),{state:f,openNotification:h}=Ve(),{data:b,actionConditionDeviceConditionAvailability:_}=Ie(),x=m(0),C=de((async()=>{await n(e.params)}),500),w=de((async()=>{await g({is_round_up_price_enable:x.value}),d.value=[],await Promise.all([n(e.params),r()])}),500);v((()=>e.params),(async()=>{t.search="",e.params.tab&&(await Promise.all([n(e.params)]),x.value=s.value.status.is_round_up_price_enable)}),{immediate:!0});const k=u((()=>1==y.value.is_price_sharing)),S=u((()=>1==t.isScraper)),P=u((()=>3==y.value.is_price_sharing)),V=u((()=>!!y.value.sub_domain_linked)),U=u((()=>{const e=Ae.value.uploadProgress>0&&Ae.value.uploadProgress<100,i=!(null==b?void 0:b.availabilityCondition);return{priceUpload:e||i,priceUploadByProgress:e,massPricing:e||i,availabilityCondition:i}})),A=u((()=>y.value.package_id)),M=async(i=(()=>{}))=>{try{await n(e.params),"function"==typeof i&&i()}catch(a){console.log("Failed To Set Rule")}};return await Promise.all([r(),_()]),{me:y,globals:Ue,stateRoundup:s,processingUpload:Ae,roundupPayload:x,data:t,state:d,dataDevice:b,showAlert:l,actionSearch:C,loading:o,isPriceSharing:k,isScraper:S,disallowSync:P,subDomainLinked:V,updateRoundup:w,disableActions:U,stateNotifcation:f,typeOfPackage:A,refetchPricing:M,handleChangePage:async i=>{t.page=Number(t.page),await n(e.params)},handleChangeLimit:async()=>{t.page=1,t.perPage=Number(t.perPage),await n(e.params)},handleClearAlert:()=>{a(Me.PRICING.INVALID_PRICE_UPLOAD)},handleSubmitPriceUpload:async()=>{await M(),h("NotificationPriceUpload")}}}}),zr={class:"md:flex items-center justify-between gap-x-8 md:space-y-0 space-y-4 mt-6 mb-5"},Gr={class:"flex items-center justify-end gap-3"},Jr={class:T(["transition-all duration-300 ease-in-out","text-grey-03 hover:text-grey-04 flex items-center gap-x-2"])},Wr={key:0,class:"material-icons text-orange-04"},Yr={class:T(["transition-all duration-300 ease-in-out","text-grey-03 hover:text-grey-04 flex items-center gap-x-2"])},Zr={key:0,class:"material-icons text-orange-04"},Kr={class:"mb-5"},Qr={key:0,class:"mb-5"},Xr={class:"bg-green-02 bg-opacity-20 p-4 rounded-md"},ec={class:"grid lg:grid-cols-2 gap-4 text-green-04"},ic={class:"flex items-center gap-x-2"},ac={class:"flex flex-wrap items-center justify-end gap-4"},lc={class:"flex items-center justify-between gap-x-4"},tc={class:"mt-4"};var nc=Z(qr,[["render",function(e,i,a,l,t,n){const o=g("Input"),d=g("Button"),s=g("BulkPriceEditorPriceUpload"),r=g("Tooltip"),c=g("BulkPriceEditorMassPricing"),u=g("Checkbox"),p=g("BulkPriceEditorPriceUploadInvalid"),m=g("BulkPriceEditor"),v=g("Pagination"),x=y("loading");return f(),h("div",null,[k("div",zr,[S(o,{icon:"",modelValue:e.data.search,"onUpdate:modelValue":i[0]||(i[0]=i=>e.data.search=i),disabled:e.disableActions.priceUploadByProgress,placeholder:"Search",class:"w-full md:w-2/5",onInput:e.actionSearch},{icon:w((()=>i[4]||(i[4]=[k("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue","disabled","onInput"]),b((f(),h("div",Gr,[S(r,{trigger:"hover",placement:"top-end",disabled:!e.disableActions.priceUpload},{content:w((()=>i[5]||(i[5]=[k("p",{class:"max-w-xs whitespace-normal text-sm",style:{"word-break":"keep-all"}}," You must have at least one active item with one or more conditions applied in order to download the template. ",-1)]))),default:w((()=>[k("div",null,[S(s,{pro:17==e.typeOfPackage,disabled:e.disableActions.priceUpload,onSubmit:e.handleSubmitPriceUpload},{trigger:w((({click:a})=>[S(d,{disabled:e.disableActions.priceUpload,color:"white",onClick:a},{default:w((()=>[k("div",Jr,[i[6]||(i[6]=k("span",{class:"material-icons"},"table_view",-1)),i[7]||(i[7]=k("span",null,"Price Upload",-1)),e.disableActions.priceUpload?(f(),h("span",Wr," warning ")):U("",!0)])])),_:2},1032,["disabled","onClick"])])),_:1},8,["pro","disabled","onSubmit"])])])),_:1},8,["disabled"]),e.disableActions.massPricing?(f(),_(r,{key:0,trigger:"hover",placement:"top-end"},{content:w((()=>i[8]||(i[8]=[k("p",{class:"max-w-sm whitespace-normal text-sm",style:{"word-break":"keep-all"}}," You must have at least one active item with one or more conditions applied in order to update mass pricing. ",-1)]))),default:w((()=>[k("div",null,[S(d,{disabled:"",color:"white"},{default:w((()=>[k("div",Yr,[k("span",null,P(e.me.currency_symbol),1),i[9]||(i[9]=k("span",null,"Mass Pricing",-1)),e.disableActions.massPricing?(f(),h("span",Zr," warning ")):U("",!0)])])),_:1})])])),_:1})):(f(),_(c,{key:1,onSubmit:e.refetchPricing},null,8,["onSubmit"]))])),[[x,e.loading.all]])]),k("div",Kr,[S(u,{type:"toggle",modelValue:e.roundupPayload,"onUpdate:modelValue":i[1]||(i[1]=i=>e.roundupPayload=i),disabled:e.disableActions.priceUpload,color:"teal",value:"1","value-off":"0",onInput:e.updateRoundup},null,8,["modelValue","disabled","onInput"]),i[10]||(i[10]=k("span",{class:"my-auto"},"Round-up item pricing to the nearest dollar",-1))]),S(j,{name:"fade"},{default:w((()=>[e.processingUpload.invalid&&e.showAlert?(f(),h("div",Qr,[k("div",Xr,[k("div",ec,[k("div",ic,[i[12]||(i[12]=k("span",{class:"material-icons"},"info",-1)),k("span",null,[i[11]||(i[11]=V(P("Total successfully uploaded and updated items: ")+" ")),k("b",null,P(e.processingUpload.totalInvalid),1)])]),k("div",ac,[k("span",null,[i[13]||(i[13]=V("Last Update: ")),k("b",null,P(e.processingUpload.dateInvalid),1)]),k("div",lc,[S(p,null,{trigger:w((({click:e})=>[S(d,{color:"red",dense:"",onClick:e},{default:w((()=>i[14]||(i[14]=[V(" View Invalid Data ")]))),_:2},1032,["onClick"])])),_:1}),S(d,{color:"teal",view:"outlined",dense:"",onClick:e.handleClearAlert},{default:w((()=>i[15]||(i[15]=[k("div",{class:"flex items-center justify-center gap-x-2"},[k("span",{class:"material-icons"},"close"),V(" Clear Notification ")],-1)]))),_:1},8,["onClick"])])])])])])):U("",!0)])),_:1}),S(m,{search:e.data.search,items:e.state,loadingTable:e.loading.all,"price-sharing":e.isPriceSharing,"price-scraper":e.isScraper,"round-up":e.roundupPayload,onRefetchPricing:e.refetchPricing,disallowSync:e.disallowSync,"disabled-action":e.disableActions,subDomainLinked:e.subDomainLinked},null,8,["search","items","loadingTable","price-sharing","price-scraper","round-up","onRefetchPricing","disallowSync","disabled-action","subDomainLinked"]),k("div",tc,[S(v,{page:e.data.page,"onUpdate:page":[i[2]||(i[2]=i=>e.data.page=i),e.handleChangePage],limit:e.data.perPage,"onUpdate:limit":[i[3]||(i[3]=i=>e.data.perPage=i),e.handleChangeLimit],data:e.data.pagination},null,8,["page","limit","data","onUpdate:page","onUpdate:limit"])])])}]]),oc=M({setup(){const{genSuspense:e}=r();return()=>e(nc)}});export{oc as default};
