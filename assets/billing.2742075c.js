var a=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,n,l)=>n in t?a(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,c=(a,t)=>{for(var n in t||(t={}))e.call(t,n)&&i(a,n,t[n]);if(l)for(var n of l(t))o.call(t,n)&&i(a,n,t[n]);return a},r=(a,l)=>t(a,n(l));import{s,v as d}from"./index.10c203ea.js";import{p}from"./packages.2dec7882.js";import{r as u,f as y,g as h}from"./vendor.9695fe57.js";const g=()=>{const a=u({all:!1,checkout:!1}),t=y("monthly"),n=y({price_id:null,total_selected_location:null}),l=u({monthly:[],annually:[]}),e=h((()=>(l[t.value]||[]).sort(((a,t)=>a.sort-t.sort)))),o=(a=[])=>a.map((a=>{var t;return r(c({},(t=a.package_id,p.find((a=>a.id===t))||p[0])),{price_id:a.price_id,price:a.price,is_current_plan:!!a.current_price_id,saving_amount:(null==a?void 0:a.saving_amount)||null})}));return{loading:a,selectedSubscriptionOption:t,selectedPlan:n,subscriptionOptions:[{id:"monthly",label:"Monthly"},{id:"annually",label:"Yearly"}],plans:e,getPlans:async()=>{try{a.all=!0;const t=await s.dispatch("billing/getBillingPackages");let{monthly:n=[],yearly:e=[]}=t||{};l.monthly=o(n),l.annually=o(e)}catch(t){console.warn("Error fetching plans: ",t)}finally{a.all=!1}},checkoutPlanWithPriceId:async(t={},l=(()=>{}))=>{try{a.checkout=!0;const{price_id:e,total_location:o}=t||{},i={data:{price_id:e||n.price_id,total_location:o||n.total_selected_location||null}};if(!i.data.price_id)throw new Error("Price ID cannot be empty");const c=await s.dispatch("billing/checkoutBillingWithPriceId",i);d(l)&&l(null,c)}catch(e){console.warn("Error checkouting package/plan ",e),d(l)&&l(e,null)}finally{a.checkout=!1}},unsetSelectedPlan:()=>{n.price_id=null,n.total_selected_location=null}}},_=()=>{const a=u({feedback:"",note:"",password:""}),t=y(!1);return{data:a,loading:t,action:async(n=(()=>{}))=>{try{t.value=!0,await s.dispatch("billing/cancelSubscription",a),d(n)&&n()}finally{t.value=!1}}}},b=()=>{(()=>{const a=y(!1)})();const a=u({locations:[],transfers:[]}),t=y(!1);return{form:a,loading:t,removeLocation:async(n=(()=>{}))=>{t.value=!0;try{const l=a.transfers.map((a=>({store_id:a.id,new_store_id:a.transfer})));await s.dispatch("billing/removeLocation",{unsubscribe_location:l}),d(n)&&n(null)}catch(l){d(n)&&n(l)}finally{t.value=!1}}}},f=()=>{const a=u({location:!1,transfer:!1}),t=u({locations:[]}),n=y({page:1,limit:10});return{loading:a,data:t,query:n,showLocation:async()=>{var n;try{a.location=!0;const l=await s.dispatch("billing/showLocation");t.locations=(null==(n=null==l?void 0:l.data)?void 0:n.length)&&l.data.map((a=>r(c({},a),{checked:!1})))||[]}catch(l){t.locations=[]}finally{a.location=!1}}}};export{f as a,b,_ as c,g as u};
