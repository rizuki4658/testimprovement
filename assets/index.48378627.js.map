{"version":3,"file":"index.48378627.js","sources":["../../src/views/setting/workflow/create/index.vue"],"sourcesContent":["<template>\n  <div>\n    <Breadcrumb\n      class=\"mt-2 mb-8\"\n      pageTitle=\"Add Workflow\"\n      :backTo=\"{ name: 'settingWorkflow' }\"\n      :items=\"breadcrumb\">\n      <template #right>\n        <Button\n          color=\"teal\"\n          :loading=\"loading\"\n          @click=\"createWorkflow\">\n          Save\n        </Button>\n      </template>\n    </Breadcrumb>\n    <Card class=\"mb-24\">\n      <WorkflowForm\n\t\t\t\tv-loading=\"loadingInit\"\n        :data=\"data\"\n        ref=\"refForm\"\n        @preview-email=\"handlePreviewEmailTemplate\"\n        :loading-preview-email=\"loadingPreviewEmailTemplate\"\n        :disable-email-preview=\"isDisableEmailPreview\"\n      />\n    </Card>\n  </div>\n  <PreviewEmail v-model:show=\"isPreview\" :body=\"previewedTemplate\" />\n</template>\n\n<script>\nimport { computed, defineComponent, onMounted, ref } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useWorkflowForm, usePreviewEmailTemplate } from 'composable/setting'\nimport Button from 'bbUi/components/button/button.vue'\nimport Card from 'bbUi/components/card/card.vue'\nimport WorkflowForm from 'components/Workflow/Form.vue'\nimport Modal from 'bbUi/components/modal/modal.vue'\nimport Breadcrumb from 'components/Breadcrumb.vue'\nimport PreviewEmail from 'components/EmailTemplate/PreviewEmailTemplate.vue'\n\nexport default defineComponent({\n  components: {\n    Button,\n    Card,\n    WorkflowForm,\n    Breadcrumb,\n    Modal,\n    PreviewEmail\n  },\n  setup() {\n    const router = useRouter()\n    const route = useRoute()\n    const refForm = ref(null)\n    const { data, loading, loadingInit, actionCreate, actionShowInitData } =\n      useWorkflowForm()\n    const {\n      emailBody,\n      isPreview,\n      previewedTemplate,\n      loading: loadingPreviewEmailTemplate,\n      actionWorkflowEmailCreate: actionPreviewEmailTemplate\n    } = usePreviewEmailTemplate()\n\n    const isDisableEmailPreview = computed(() => !data.status_name)\n\n    const createWorkflow = async () => {\n      const isValid = await refForm.value.validate()\n      if(!isValid) return\n      await actionCreate(route.params.buyback, async (res) => {\n        res && res.status === 200 && await router.push({\n          name: 'settingWorkflow'\n        })\n      })\n    }\n    const handlePreviewEmailTemplate = async () => {\n      emailBody.value = data.email_template\n      await actionPreviewEmailTemplate(\n        data.status_name,\n        data.color_mail_template,\n        data.is_mail_logo_show\n      )\n    }\n\n    const breadcrumb = [\n      {\n        text: 'Settings',\n        to: {\n          name: 'setting'\n        }\n      },\n      {\n        text: 'Workflow',\n        to: {\n          name: 'settingWorkflow'\n        }\n      },\n      {\n        text: 'Add Workflow'\n      }\n    ]\n\n    onMounted(async () => {\n      await actionShowInitData()\n    })\n\n    return {\n      data,\n      loading,\n      breadcrumb,\n      refForm,\n      emailBody,\n      isPreview,\n      isDisableEmailPreview,\n      previewedTemplate,\n      loadingPreviewEmailTemplate,\n\t\t\tloadingInit,\n      handlePreviewEmailTemplate,\n      createWorkflow\n    }\n  }\n})\n</script>\n"],"names":["defineComponent","components","Button","Card","WorkflowForm","Breadcrumb","Modal","PreviewEmail","[object Object]","router","useRouter","route","useRoute","refForm","ref","data","loading","loadingInit","actionCreate","actionShowInitData","useWorkflowForm","emailBody","isPreview","previewedTemplate","loadingPreviewEmailTemplate","actionWorkflowEmailCreate","actionPreviewEmailTemplate","usePreviewEmailTemplate","isDisableEmailPreview","computed","status_name","onMounted","async","breadcrumb","text","to","name","handlePreviewEmailTemplate","value","email_template","color_mail_template","is_mail_logo_show","createWorkflow","validate","params","buyback","res","status","push","_openBlock","_createElementBlock","_Fragment","_createVNode","_component_Breadcrumb","class","pageTitle","backTo","_withCtx","_component_Button","color","_ctx","_cache","_withDirectives","_component_WorkflowForm","onPreviewEmail","loading-preview-email","_component_PreviewEmail","onUpdate:show","$event"],"mappings":"6yBAyCkBA,EAAa,CAC7BC,WAAY,CACVC,OAAAA,EACAC,KAAAA,EACAC,aAAAA,EACAC,WAAAA,QACAC,EACAC,aAAAA,GAEFC,QACE,MAAMC,EAASC,IACTC,EAAQC,IACRC,EAAUC,EAAI,OACdC,KAAEA,EAAAC,QAAMA,EAASC,YAAAA,EAAAC,aAAaA,qBAAcC,GAChDC,KACIC,UACJA,EAAAC,UACAA,EAAAC,kBACAA,EACAP,QAASQ,EACTC,0BAA2BC,GACzBC,IAEEC,EAAwBC,GAAS,KAAOd,EAAKe,cA0C5C,OAJPC,GAAUC,gBACFb,OAGD,CACLJ,KAAAA,EACAC,QAAAA,EACAiB,WAzBiB,CACjB,CACEC,KAAM,WACNC,GAAI,CACFC,KAAM,YAGV,CACEF,KAAM,WACNC,GAAI,CACFC,KAAM,oBAGV,CACEF,KAAM,iBAYRrB,QAAAA,EACAQ,UAAAA,EACAC,UAAAA,EACAM,sBAAAA,EACAL,kBAAAA,EACAC,4BAAAA,EACHP,YAAAA,EACGoB,2BA1CiCL,UACjCX,EAAUiB,MAAQvB,EAAKwB,qBACjBb,EACJX,EAAKe,YACLf,EAAKyB,oBACLzB,EAAK0B,oBAsCPC,eApDqBV,gBACCnB,EAAQyB,MAAMK,kBAE9BzB,EAAaP,EAAMiC,OAAOC,SAASb,MAAOc,IAC9CA,GAAsB,MAAfA,EAAIC,cAAwBtC,EAAOuC,KAAK,CAC7CZ,KAAM,sKA7CRa,OAAAA,IAAAC,EAAAC,EAAA,KAAA,GAXS,MAAA,KAAA,CAZXC,EAAiBC,EAAA,CACjBC,MAAA,YACCC,UAAmC,eACnCC,OAAiB,CAAApB,KAAA,uCACP,OAMAqB,GAAA,IAAA,CAJPL,EAAYM,EAAA,CACXC,MAAO,OACP3C,QAAO4C,EAAc5C,kDAExB6C,EAAA,OAAA,GAAA,uDAYG,EAAA,CAAA,cADH,CAAAP,MAAA,SAAA,YAPF,IAOE,CALCQ,EAAUV,EAAAW,EAAA,CACXhD,KAAa6C,EAAA7C,KACZD,IAAA,UACAkD,eAAAJ,EAAAvB,2BACA4B,wBAAuBL,EAAqBpC,6GAL3B,wBAAA,0BAAA,gCASF4B,EAAec,EAAA,kBAAGC,gBAAuBN,EAAA,OAAA,GAAAO,GAAAR,EAAAtC,UAAA8C"}