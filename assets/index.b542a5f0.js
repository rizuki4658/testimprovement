var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;import{g as s,r as i,y as n,_ as r,k as d,f as m,o as u,t as c,B as p,a2 as g,a3 as f,F as v,Q as y,q as b,K as C,a4 as h,U as D,m as _,n as w,w as x,D as P,I as S,a5 as O,s as k,a0 as T,T as L,A as I,S as A,O as V,ar as R,aI as U}from"./vendor.f1efedad.js";import{B as E}from"./Breadcrumb.5c6bcf4b.js";import{s as N,v as M,E as F,_ as j,d as G,b as B,f as $,j as Y,c as W,u as z,am as q,S as H,o as K,g as Q,e as J,P as X,r as Z,B as ee}from"./index.161fb295.js";import{c as ae,r as te}from"./index.05b14cb2.js";import{c as oe}from"./copy.ef53d68d.js";import{u as le}from"./index.32689823.js";import{C as se}from"./card.6a96327d.js";import{_ as ie}from"./fieldset.dc1b9649.js";import{_ as ne}from"./badge.b78bf7eb.js";import{I as re}from"./InputFile.0c236f2e.js";import{_ as de}from"./attention-warning.f7b3f9bc.js";import{R as me,u as ue}from"./RevisedOfferPreview.3fb7b746.js";import{_ as ce}from"./tab.1390e648.js";import"./breadcrumb.2d36d495.js";import"./CollapsibleCard.374b9a03.js";import"./IframeRender.ac49ebc3.js";const pe=()=>{const{getCustomerDomain:e}=ge(),r=s((()=>N.state.setting.customerPortal.loading.customDomain)),d=i({domain:null}),m=i({domain:{required:ae.withMessage("Domain name is required",te),url:ae.withMessage("Invalid domain name",(()=>(!d.domain||!d.domain||"."!==d.domain[d.domain.length-1])&&psl.isValid(d.domain)))}}),u=s((()=>N.getters["setting/customerPortal/isVerifiedCustomDomain"])),c=s((()=>N.getters["setting/customerPortal/isSSLProcessing"])),p=s((()=>N.state.setting.customerPortal.customerDomain.defaultDomain)),g=s((()=>[{id:1,title:"Custom Subdomain",description:"Set your own custom subdomain for the customer portal.",icon:"/icon/menu-icon/domain.svg",selected:v.value,isActive:u.value},{id:2,title:"Use Reusely hosted customer portal",description:`The customer portal uses <b>${p.value}</b> as the default subdomain. Your logo will appear in the top right corner by default so customers clearly know it's you.`,icon:"/icon/menu-icon/reusely.svg",selected:!v.value,isActive:!(v.value&&u.value)}])),f=s((()=>{return e=d,Object.entries(e).filter((([e,a])=>void 0===a||""===a||null===a)).length>0;var e})),v=s((()=>N.getters["setting/customerPortal/isCustomDomain"]));return n((()=>d),(e=>{N.commit("setting/customerPortal/SET_CUSTOM_DOMAIN",((e,s)=>{for(var i in s||(s={}))t.call(s,i)&&l(e,i,s[i]);if(a)for(var i of a(s))o.call(s,i)&&l(e,i,s[i]);return e})({},e))}),{deep:!0}),{loading:r,form:d,formValidationRules:m,domainOptions:g,isIncompleteForm:f,isCustomDomain:v,isVerifiedCustomDomain:u,isSSLProcessing:c,submitForm:async(a=(()=>{}))=>{try{N.commit("setting/customerPortal/SET_LOADING_CUSTOM_DOMAIN",!0),await N.dispatch("setting/customerPortal/customDomain"),await e(),M(a)&&a(null)}catch(t){M(a)&&a(t)}finally{N.commit("setting/customerPortal/SET_LOADING_CUSTOM_DOMAIN",!1)}},verifyCustomDomain:async(a=(()=>{}))=>{try{N.commit("setting/customerPortal/SET_LOADING_VERIFY_CUSTOM_DOMAIN",!0);const t="Verified"===await N.dispatch("setting/customerPortal/verifyCustomDomain");await e(),M(a)&&a(null,t)}catch(t){M(a)&&a(t,!1)}finally{N.commit("setting/customerPortal/SET_LOADING_VERIFY_CUSTOM_DOMAIN",!1)}},resetCustomDomain:async(a=(()=>{}))=>{try{N.commit("setting/customerPortal/SET_LOADING_RESET_CUSTOM_DOMAIN",!0),await N.dispatch("setting/customerPortal/resetCustomDomain"),await e(),M(a)&&a(null)}catch(t){M(a)&&a(t)}finally{N.commit("setting/customerPortal/SET_LOADING_RESET_CUSTOM_DOMAIN",!1)}}}},ge=()=>({loading:s((()=>N.state.setting.customerPortal.loading.customerDomain)),customerDomain:s((()=>N.state.setting.customerPortal.customerDomain.domain)),dnsRecords:s((()=>N.state.setting.customerPortal.customerDomain.dnsRecords)),customerPortalLogin:s((()=>N.state.setting.customerPortal.customerDomain.customerPortalLogin)),customerPortalFavicon:s((()=>N.state.setting.customerPortal.customerDomain.customerPortalFavicon)),defaultDomain:s((()=>N.state.setting.customerPortal.customerDomain.defaultDomain)),uploadIcon:async e=>{try{N.commit("setting/customerPortal/SET_LOADING_CUSTOMER_DOMAIN",!0),await N.dispatch("setting/customerPortal/uploadIcon",e),r({type:"success",message:"Favicon changed"})}finally{N.commit("setting/customerPortal/SET_LOADING_CUSTOMER_DOMAIN",!1)}},getCustomerDomain:async()=>{try{N.commit("setting/customerPortal/SET_LOADING_CUSTOMER_DOMAIN",!0),await N.dispatch("setting/customerPortal/getCustomerDomain")}finally{N.commit("setting/customerPortal/SET_LOADING_CUSTOMER_DOMAIN",!1)}}});const fe=d({name:"CustomerPortalDomainSelection",props:{options:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},defaultDomain:{type:String,default:"sell.reusely.com"}},emits:["select"],setup(e,{emit:a}){const t=m([{id:1,title:"Custom Subdomain",description:"Set your own custom subdomain for the customer portal.",icon:"/icon/menu-icon/domain.svg",selected:!1,isActive:!1},{id:2,title:"Use reusely hoster customer portal",description:`The customer portal uses <b>${e.defaultDomain}</b> as the default subdomain. Your logo will appear in the top right corner by default so customers clearly know it's you.`,icon:"/icon/menu-icon/reusely.svg",selected:!1,isActive:!1}]);return n((()=>e.options),(e=>t.value=e),{immediate:!0}),{domainOptions:t,isWhiteLabel:F,handleSelectDomainOption:t=>{e.disabled||a("select",t)}}}}),ve={class:"domain-selection"},ye=["onClick"],be={class:"domain-option__content"},Ce={class:"domain-option__header"},he={class:"domain-option__title"},De={class:"domain-option__description"},_e={class:"domain-option__status"},we={key:0,class:"domain-option__badge"};var xe=j(fe,[["render",function(e,a,t,o,l,s){return u(),c("div",null,[p("div",ve,[(u(!0),c(g,null,f(e.domainOptions,((a,t)=>(u(),c("div",{key:t,onClick:t=>e.handleSelectDomainOption(a),class:v(["domain-option",a.selected?"domain-option--selected":"",e.disabled?"domain-option--disabled":""])},[p("div",{class:"domain-option__icon",style:y(`-webkit-mask-image: url('${a.icon}')`)},null,4),p("div",be,[p("div",Ce,[p("div",he,[b(e.$slots,"title",h({ref_for:!0},{option:a}),(()=>[p("span",null,C(a.title),1)]),!0)])]),p("div",De,[b(e.$slots,"description",h({ref_for:!0},{option:a}),(()=>[p("p",null,C(a.description),1)]),!0)])]),p("div",_e,[a.isActive?(u(),c("div",we," Active ")):D("",!0)])],10,ye)))),128))])])}],["__scopeId","data-v-495514eb"]]);const Pe=d({name:"CustomerPortalDomainRecords",components:{Badge:ne},props:{records:{type:Array,default:()=>[]}},setup(e){const a=m([]);return n((()=>e.records),(e=>{a.value=e}),{immediate:!0}),{domainRecords:a,copy:oe}}}),Se={class:"flex flex-wrap items-center"},Oe={class:"mr-2"},ke=["onClick"],Te={class:"flex flex-wrap items-center"},Le={class:"mr-2"},Ie=["onClick"];const Ae=d({name:"settingCustomerPortalCustomerDomain",components:{Card:se,Modal:G,Button:B,Input:$,InputFile:re,Fieldset:ie,DomainSelection:xe,DomainRecords:j(Pe,[["render",function(e,a,t,o,l,s){const i=_("TableColumn"),n=_("Badge"),r=_("Table");return u(),w(r,{data:e.domainRecords},{default:x((()=>[P(i,{label:"Type"},{default:x((({row:e})=>[p("p",null,C(e.type),1)])),_:1}),P(i,{label:"Name"},{default:x((({row:a})=>[p("div",Se,[p("p",Oe,C(a.name),1),p("i",{onClick:t=>e.copy(a.name),class:"material-icons text-teal-04"},"file_copy",8,ke)])])),_:1}),P(i,{label:"Value"},{default:x((({row:a})=>[p("div",Te,[p("p",Le,C(a.value),1),p("i",{onClick:t=>e.copy(a.value),class:"material-icons text-teal-04"},"file_copy",8,Ie)])])),_:1}),P(i,{label:"Status"},{default:x((({row:e})=>[P(n,{color:"orange"},{default:x((()=>[S(C(e.status),1)])),_:2},1024)])),_:1})])),_:1},8,["data"])}]]),Alert:Y},async setup(){const e=m(!1),a=m(null),t=m(!1),o=m(!1),l=m(!1),i=m(void 0),d=m(isWhiteLabel.value?W[window.whiteLabel.company].setting_domain_link:"sell.reusely.com"),u=m(null);O();const{loading:c,form:p,formValidationRules:g,isIncompleteForm:f,isCustomDomain:v,isVerifiedCustomDomain:y,isSSLProcessing:b,domainOptions:C,submitForm:h,verifyCustomDomain:D,resetCustomDomain:_}=pe(),{loading:w,customerDomain:x,dnsRecords:P,customerPortalLogin:S,defaultDomain:T,getCustomerDomain:L}=ge(),{open:I}=q(),{isProPlan:A}=z();n((()=>S.value),(()=>{d.value=S.value}),{immediate:!0}),n((()=>l.value),(e=>{e||clearTimeout(i.value)}));const V=s((()=>o.value?"Edit Custom Subdomain":"Add Custom Subdomain")),R=le(g,p,{$lazy:!0}),U=(e=null)=>{t.value=!0,e&&(o.value=!0,p.domain=e)},E=async()=>{t.value=!1,p.domain=null,o.value=!1,await k(),R.value.$reset()};return await Promise.all([L()]),{link:d,showCopied:l,favicon:u,loadingCustomDomain:c,loadingCustomerDomain:w,modalConfirmChangeDomain:e,modalCustomDomain:t,modalConfirmType:a,customDomainModalTitle:V,isWhiteLabel:isWhiteLabel,customDomainForm:p,customerDomain:x,dnsRecords:P,customerPortalLogin:S,defaultDomain:T,copyText:oe,handleCopyLinkLogin:e=>{l.value=!0,oe(e),i.value=setTimeout((()=>{l.value=!1}),2e3)},handleSelectDomainOption:async t=>{t.selected||(e.value=!0,a.value=t.id)},handleCustomDomain:U,handleResetCustomDomain:E,customDomainValidation:R,handleSubmitCustomDomain:async()=>{if(!A.value)return void I({title:"Custom Domain",description:"Use your own custom domain for the customer portal to ensure your buyback program is fully white-labeled to match your brands look and feel.",image_url:"/images/paywall/paywall-custom-domain.svg"});if(c.value.add)return;R.value.$validate(),!R.value.$invalid&&await h((e=>{e||E()}))},isIncompleteCustomDomainForm:f,isCustomDomain:v,isVerifiedCustomDomain:y,isSSLProcessing:b,isProPlan:A,domainOptions:C,domainVerificationInstructions:["Sign in to your domain provider","Go to your DNS settings","Add the following records to your DNS settings:"],verifyCustomDomain:D,handleOpenLoginPortal:()=>{window.open(d.value.includes("https://")?d.value:`https://${d.value}`)},handleVerifyCustomDomain:(e,a)=>{e||r(a?{type:"success",message:"Your custom subdomain is verified"}:{type:"warning",message:"Your custom subdomain is not verified yet"})},handleChangeDomain:async()=>{const t=1===a.value,o=2===a.value;t?U():o&&await _(),e.value=!1,a.value=null}}}}),Ve={class:"items-center h-full"},Re={class:"text-lg"},Ue={class:"flex items-center flex-wrap"},Ee={whitelabel:"text-replace","data-label":"domain custom alert"},Ne={key:0,class:"block py-1 px-4 bg-green-04 text-white rounded-full ml-4 font-medium"},Me=["innerHTML"],Fe={key:0,class:"flex items-center bg-orange-lighten text-orange-04 rounded-lg p-2 my-4"},je={class:"my-6"},Ge={class:"w-6 md:w-10 select-none"},Be={class:"w-8 md:w-10 h-8 md:h-10 bg-teal-04 rounded-full flex items-center justify-center font-medium text-white"},$e={class:"flex-auto px-6 md:py-2"},Ye={class:"font-semibold"},We={class:"md:pl-16 p-0"},ze={class:"w-max"},qe={class:"-mx-4 -my-4 px-6 py-6"},He={class:"flex items-center gap-x-4 gap-y-4 md:gap-y-0 flex-wrap"},Ke={class:"flex flex-col items-center my-8"},Qe={class:"grid grid-cols-1"},Je={class:"flex justify-between items-center"};var Xe=j(Ae,[["render",function(e,a,t,o,l,s){const i=_("Alert"),n=_("Button"),r=_("DomainSelection"),d=_("DomainRecords"),m=_("Fieldset"),v=_("Input"),y=_("Tooltip"),b=_("Card"),h=_("Modal"),O=T("loading");return u(),c("div",null,[P(b,null,{header:x((()=>a[11]||(a[11]=[p("h2",{class:"text-xl"},"Customer Portal Subdomain",-1)]))),default:x((()=>[p("div",null,[e.isSSLProcessing?(u(),w(i,{key:0,color:"orange",view:"smooth",class:"my-5",dense:""},{left:x((()=>a[12]||(a[12]=[p("span",{class:"material-icons text-4xl"},"info",-1)]))),default:x((()=>[p("div",Ve,[p("p",Re,C(e.isCustomDomain?"We are verifying your custom portal subdomain, we will send you an\n              email once it's verified":"Your custom subdomain is being removed, it can take 5 - 10 minutes until it's completely removed then you are able to switch back to the custom subdomain."),1)])])),_:1})):D("",!0),P(r,{onSelect:e.handleSelectDomainOption,options:e.domainOptions,disabled:e.isSSLProcessing,"default-domain":e.defaultDomain},{title:x((({option:t})=>[p("div",Ue,[p("span",Ee,C(1===t.id&&e.isCustomDomain?e.customerDomain:t.title),1),e.isProPlan||1!==t.id?D("",!0):(u(),c("div",Ne,a[13]||(a[13]=[p("p",null,"Pro",-1)])))]),1===t.id&&e.isCustomDomain?(u(),w(n,{key:0,onClick:a[0]||(a[0]=a=>e.handleCustomDomain(e.customerDomain)),class:"mx-2",color:"teal",view:"smooth",dense:"",disabled:e.isSSLProcessing},{default:x((()=>a[14]||(a[14]=[p("i",{class:"material-icons"},"edit",-1)]))),_:1},8,["disabled"])):D("",!0)])),description:x((({option:t})=>[p("p",{innerHTML:t.description},null,8,Me),1===t.id&&e.isCustomDomain&&!e.isVerifiedCustomDomain?(u(),c("div",Fe,a[15]||(a[15]=[p("div",{class:"pl-2 self-start"},[p("i",{class:"material-icons"},"info")],-1),p("div",{whitelabel:"text-replace","data-label":"domain custom alert",class:"flex-auto mx-2"}," Your custom subdomain is not verified yet. You will continue to use Reusely hosted customer portal until it is fully verified. ",-1)]))):D("",!0)])),_:1},8,["onSelect","options","disabled","default-domain"]),P(L,{name:"slide-fade"},{default:x((()=>[e.isCustomDomain&&!e.isVerifiedCustomDomain?(u(),w(m,{key:0,class:"my-6 min-w-0"},{label:x((()=>a[16]||(a[16]=[p("span",null,"Copy Your Records",-1)]))),default:x((()=>[I((u(),c("div",null,[a[18]||(a[18]=p("h2",{class:"text-xl"}," Follow these instructions to add your subdomain ",-1)),p("div",je,[(u(!0),c(g,null,f(e.domainVerificationInstructions,((e,a)=>(u(),c("div",{key:a,class:"flex my-4"},[p("div",Ge,[p("div",Be,C(a+1),1)]),p("div",$e,[p("p",Ye,C(e),1)])])))),128))]),p("div",We,[P(d,{records:e.dnsRecords},null,8,["records"]),p("div",ze,[P(n,{onClick:a[1]||(a[1]=a=>e.verifyCustomDomain(e.handleVerifyCustomDomain)),loading:e.loadingCustomDomain.verify,class:"my-4",view:"smooth",color:"teal",disabled:e.isSSLProcessing},{default:x((()=>a[17]||(a[17]=[S("Verify")]))),_:1},8,["loading","disabled"])])])])),[[O,e.loadingCustomerDomain]])])),_:1})):D("",!0)])),_:1}),P(L,{name:"slide-fade"},{default:x((()=>[P(m,{class:"rounded-lg mt-4"},{label:x((()=>a[19]||(a[19]=[p("span",{class:"text-grey-03"},"Customer Portal Link",-1)]))),default:x((()=>[p("div",qe,[e.isCustomDomain&&!e.isVerifiedCustomDomain?(u(),w(i,{key:0,color:"orange",view:"smooth",style:{padding:"0.5rem"},dense:""},{default:x((()=>a[20]||(a[20]=[p("div",{class:"flex items-center gap-x-2"},[p("span",{class:"material-icons text-3xl"},"info"),p("p",{whitelabel:"text-replace","data-label":"domain custom alert",class:"text-sm"}," Your custom domain is not verified yet. You will continue to use Reusely hosted customer portal until it is fully verified. ")],-1)]))),_:1})):D("",!0),a[25]||(a[25]=p("p",{class:"py-4"},"Share this link on your site or send directly to your customers.",-1)),p("div",He,[P(v,{modelValue:e.link,"onUpdate:modelValue":a[2]||(a[2]=a=>e.link=a),disabled:"",class:"w-96"},null,8,["modelValue"]),e.showCopied?(u(),w(y,{key:0,placement:"top"},{content:x((()=>a[21]||(a[21]=[p("span",null,"Copied",-1)]))),default:x((()=>[P(n,{color:"teal"},{default:x((()=>a[22]||(a[22]=[p("span",{class:"material-symbols-outlined text-3xl"},"content_copy",-1)]))),_:1})])),_:1})):(u(),w(n,{key:1,color:"teal",onClick:a[3]||(a[3]=a=>e.handleCopyLinkLogin(e.link))},{default:x((()=>a[23]||(a[23]=[p("span",{class:"material-symbols-outlined text-3xl"},"content_copy",-1)]))),_:1})),P(n,{color:"teal",onClick:e.handleOpenLoginPortal},{default:x((()=>a[24]||(a[24]=[p("span",{class:"material-icons text-3xl"},"open_in_new",-1)]))),_:1},8,["onClick"])])])])),_:1})])),_:1})])])),_:1}),P(h,{modelValue:e.modalConfirmChangeDomain,"onUpdate:modelValue":a[6]||(a[6]=a=>e.modalConfirmChangeDomain=a),"hide-footer":"","hide-header":"",size:"xs"},{default:x((()=>[p("div",Ke,[a[28]||(a[28]=p("img",{class:"h-36",src:de,alt:"Warning"},null,-1)),a[29]||(a[29]=p("h3",{class:"text-center text-xl my-12"},"Change Subdomain",-1)),p("div",null,[P(n,{onClick:a[4]||(a[4]=a=>e.handleChangeDomain()),color:"orange",view:"outlined",class:"mx-2",loading:e.loadingCustomDomain.reset},{default:x((()=>a[26]||(a[26]=[S("Yes, Change It")]))),_:1},8,["loading"]),P(n,{onClick:a[5]||(a[5]=a=>e.modalConfirmChangeDomain=!1),disabled:e.loadingCustomDomain.reset,color:"teal",view:"smooth",class:"mx-2"},{default:x((()=>a[27]||(a[27]=[S("Cancel")]))),_:1},8,["disabled"])])])])),_:1},8,["modelValue"]),p("form",{onSubmit:a[10]||(a[10]=A(((...a)=>e.handleSubmitCustomDomain&&e.handleSubmitCustomDomain(...a)),["prevent"]))},[P(h,{modelValue:e.modalCustomDomain,"onUpdate:modelValue":a[9]||(a[9]=a=>e.modalCustomDomain=a),title:e.customDomainModalTitle,size:"xs"},{default:x((()=>[p("div",Qe,[a[30]||(a[30]=p("div",{class:"bg-grey-lighten text-grey-04 rounded-lg mb-6 px-6"},[p("p",{class:"my-4 leading-loose"},[p("b",null,"Example:"),S(" if your root domain is "),p("span",{class:"bg-grey-darken text-orange-04 px-4 py-2 rounded-lg"},"example.com")]),p("p",{class:"my-4 leading-loose"},[S(" you can create a subdomain like "),p("span",{class:"bg-grey-darken text-orange-04 px-4 py-2 rounded-lg"},"newpage.example.com")])],-1)),p("div",null,[P(v,{modelValue:e.customDomainForm.domain,"onUpdate:modelValue":a[7]||(a[7]=a=>e.customDomainForm.domain=a),placeholder:"Your subdomain name",label:"Subdomain Name",block:"",view:e.customDomainValidation.domain.$invalid?"danger":"default"},null,8,["modelValue","view"]),(u(!0),c(g,null,f(e.customDomainValidation.domain.$errors,((e,a)=>(u(),c("small",{class:"text-red-base block my-2",key:a},C(e.$message)+". ",1)))),128))])])])),footer:x((()=>[p("div",Je,[p("a",{class:"text-red-04 hover:text-red-02",onClick:a[8]||(a[8]=A(((...a)=>e.handleResetCustomDomain&&e.handleResetCustomDomain(...a)),["prevent"]))},"Cancel"),P(n,{onClick:e.handleSubmitCustomDomain,disabled:e.isIncompleteCustomDomainForm,loading:e.loadingCustomDomain.add,color:"teal",view:"smooth"},{default:x((()=>a[31]||(a[31]=[S("Save")]))),_:1},8,["onClick","disabled","loading"])])])),_:1},8,["modelValue","title"])],32)])}]]);const Ze=d({components:{Fieldset:ie,Select:H},props:{loading:{type:Boolean,default:!1},lang:{type:Array,default:()=>[]},label:{type:String,default:"name"},value:{type:String,default:"value"},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup:(e,{emit:a})=>({languages:s((()=>e.lang.map((a=>K(a)?{name:a[e.label]||null,value:a[e.value]||null}:{name:a,value:a})))),handleUpdate:e=>a("update:modelValue",e)})});const ea=d({components:{Card:se,Fieldset:ie,InputFile:re,Select:H,Language:j(Ze,[["render",function(e,a,t,o,l,s){const i=_("Select"),n=_("Fieldset");return u(),w(n,{class:"rounded-lg"},{label:x((()=>a[0]||(a[0]=[p("span",{class:"text-grey-03"},"Language",-1)]))),default:x((()=>[P(i,{onChange:e.handleUpdate,loading:e.loading,modelValue:e.modelValue,items:e.languages,"max-height":"250px",placeholder:"Choose any language",block:"",searchable:""},null,8,["onChange","loading","modelValue","items"])])),_:1})}]])},async setup(){const{customerPortalFavicon:e,loading:a,uploadIcon:t}=ge(),{language:o,languages:l,loading:i,getLanguages:d,updateLanguage:u}={languages:s((()=>N.state.languages)),language:s({get:()=>N.state.setting.customerPortal.general.language,set:e=>{e&&N.commit("setting/customerPortal/SET_LANGUAGE",e)}}),loading:s((()=>N.state.setting.customerPortal.loading.general)),getLanguages:async(e=(()=>{}))=>{try{N.commit("setting/customerPortal/SET_LOADING_LANGUAGE",!0),await N.dispatch("getLanguages"),M(e)&&e(null)}catch(a){M(e)&&e(a)}finally{N.commit("setting/customerPortal/SET_LOADING_LANGUAGE",!1)}},updateLanguage:async(e={code:null,name:null},a=(()=>{}))=>{try{N.commit("setting/customerPortal/SET_LOADING_LANGUAGE",!0),await N.dispatch("setting/customerPortal/updateLanguage",{customer_portal_lang_code:e.code,customer_portal_lang_name:e.name}),M(a)&&a(null)}catch(t){M(a)&&a(t)}finally{N.commit("setting/customerPortal/SET_LOADING_LANGUAGE",!1)}}},c=m(null),p=s((()=>l.value.map((e=>({code:e.code,name:`${e.name} - (${e.code.toUpperCase()})`}))))),g=Q((async e=>{o.value=e.value,await u({code:e.value,name:e.name.split(" -")[0]},(e=>{e||r({type:"success",message:"Customer portal language updated"})}))}),500);return n((()=>e.value),(e=>{c.value=e}),{immediate:!0}),await Promise.allSettled([d()]),{customerPortalFavicon:e,favicon:c,loadingCustomerDomain:a,loadingGeneral:i,language:o,handleUpload:async e=>{c.value=e;let a=new FormData;a.append("favicon",null===e?0:e),await t(a)},handleUpdateLanguage:g,formattedLanguages:p}}}),aa={class:"-mx-4 -my-4 px-6 py-6"},ta={class:"w-full"};var oa=j(ea,[["render",function(e,a,t,o,l,s){const i=_("Language"),n=_("InputFile"),r=_("Fieldset"),d=_("Card");return u(),c("div",null,[P(d,null,{header:x((()=>a[0]||(a[0]=[p("h2",{class:"text-xl"},"Customer Portal Settings",-1)]))),default:x((()=>[P(L,{name:"slide-fade"},{default:x((()=>[P(i,{modelValue:e.language,"onUpdate:modelValue":e.handleUpdateLanguage,lang:e.formattedLanguages,label:"name",value:"code",loading:e.loadingGeneral.language},null,8,["modelValue","onUpdate:modelValue","lang","loading"])])),_:1}),P(L,{name:"slide-fade"},{default:x((()=>[P(r,{class:"rounded-lg mt-4"},{label:x((()=>a[1]||(a[1]=[p("span",{class:"text-grey-03"},"Browser Icon (Favicon)",-1)]))),default:x((()=>[p("div",aa,[p("div",ta,[P(n,{file:e.favicon,loading:e.loadingCustomerDomain,"button-action":!1,onInput:e.handleUpload},{suggestedLabel:x((()=>a[2]||(a[2]=[p("span",{class:"mt-6"},[p("b",null,"Suggested:"),S(" 64x64px ; "),p("b",null,"File"),S(": PNG ; "),p("b",null,"Max"),S(" 250KB ")],-1)]))),_:1},8,["file","loading","onInput"])])])])),_:1})])),_:1})])),_:1})])}]]);const la=d({components:{RevisedOfferPreview:me,Checkbox:J,Pagination:X,Button:B,Card:se,Tab:ce},async setup(){const e=V(),{state:a,data:t,loading:o,isMailIn:l,previewedRevisedOffer:i,isPreviewRevisedOffer:n,revisedOfferTypes:r,location:d,actionAll:m,actionPreviewRevisedOffer:u}=ue(),c=s((()=>Z(a.value)));return await Promise.all([m()]),{state:a,data:t,loading:o,isMailIn:l,previewedRevisedOffer:i,isPreviewRevisedOffer:n,revisedOfferTypes:r,revisedOffers:c,location:d,editTemplate:a=>{e.push({name:"settingCustomerPortalTemplateRevisedOffer",params:{templateId:a.id,type:a.type}})},handleUpdateEmailTemplateType:e=>{t.all.type=e},handlePreviewRevisedOffer:async(e,a)=>{t.type=a,await u(e)}}}}),sa={class:"flex items-center justify-center gap-4"},ia={key:0,class:"px-3 py-1 -ml-2 bg-teal-04 text-white rounded-full flex items-center justify-center box-border text-xs"},na={key:1,class:"border-b border-grey-01 mb-6 flex items-center"},ra={class:"p-2 border-b-4 border-teal-04 text-teal-04 font-bold cursor-pointer"};const da=d({name:"settingCustomerPortal",components:{BaseLoading:ee,Breadcrumb:E,DomainSettings:Xe,GeneralSettings:oa,RevisedOfferSettings:j(la,[["render",function(e,a,t,o,l,s){const i=_("Tab"),n=_("TableColumn"),r=_("Button"),d=_("DropdownItem"),m=_("DropdownMenu"),f=_("Dropdown"),v=_("Table"),y=_("Pagination"),b=_("Card"),h=_("RevisedOfferPreview"),O=T("loading");return u(),c(g,null,[p("div",null,[P(b,null,{header:x((()=>a[3]||(a[3]=[p("h2",{class:"text-xl"},"Customer Portal Revised Offer",-1)]))),default:x((()=>["both"==e.location?(u(),w(i,{key:0,modelValue:e.data.all.type,items:e.revisedOfferTypes,name:"name",by:"value","onUpdate:modelValue":e.handleUpdateEmailTemplateType,component:""},{title:x((e=>[p("div",sa,[S(C(e.item.name)+" ",1),"easy-offer"===e.item.value?(u(),c("div",ia," API ")):D("",!0)])])),_:1},8,["modelValue","items","onUpdate:modelValue"])):e.revisedOfferTypes.length?(u(),c("div",na,[p("div",ra,C(e.revisedOfferTypes[0].name),1)])):D("",!0),a[7]||(a[7]=p("div",{class:"flex items-center mb-4"},[p("div",{class:"flex-auto"})],-1)),I((u(),w(v,{data:e.revisedOffers.all.data,class:"mb-6"},{default:x((()=>[P(n,{prop:"name",label:"Title"}),P(n,{prop:"desc",label:"Description"}),P(n,{label:"",align:"right"},{default:x((t=>[P(f,{trigger:"click",placement:"bottom-end","hide-on-click":"",class:"mr-8"},{dropdown:x((()=>[P(m,{class:"py-1"},{default:x((()=>[P(d,{class:"text-base",onClick:a=>e.editTemplate(t.row)},{default:x((()=>a[5]||(a[5]=[p("span",{class:"material-icons mr-2"},"edit",-1),S(" Edit ")]))),_:2},1032,["onClick"]),P(d,{class:"text-base",onClick:a=>e.handlePreviewRevisedOffer(t.row.id,t.row.name)},{default:x((()=>a[6]||(a[6]=[p("span",{class:"material-icons mr-2"},"visibility",-1),S(" Preview ")]))),_:2},1032,["onClick"])])),_:2},1024)])),default:x((()=>[P(r,{class:"btn-action",color:"teal",view:"outlined",dense:"",icon:""},{default:x((()=>a[4]||(a[4]=[p("span",{class:"material-icons"},"more_horiz",-1)]))),_:1})])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[O,e.loading.all]]),P(y,{page:e.data.all.page,"onUpdate:page":a[0]||(a[0]=a=>e.data.all.page=a),limit:e.data.all.limit,"onUpdate:limit":a[1]||(a[1]=a=>e.data.all.limit=a),data:e.state.all},null,8,["page","limit","data"])])),_:1})]),P(h,{show:e.isPreviewRevisedOffer,"onUpdate:show":a[2]||(a[2]=a=>e.isPreviewRevisedOffer=a),body:e.previewedRevisedOffer,type:e.data.type,title:"Preview Text","render-type":"direct"},null,8,["show","body","type"])],64)}],["__scopeId","data-v-53efb7fe"]])},setup:()=>({breadcrumb:m([{text:"Settings",to:{name:"setting"}},{text:"Customer Portal"}])})}),ma={class:"flex justify-between items-center mb-8"},ua={class:"grid grid-cols-5 gap-6"},ca={class:"col-span-4 space-y-6"},pa={class:"w-full flex items-center justify-center"},ga={class:"w-full flex items-center justify-center"},fa={class:"w-full flex items-center justify-center"};var va=j(da,[["render",function(e,a,t,o,l,s){const i=_("Breadcrumb"),n=_("DomainSettings"),r=_("BaseLoading"),d=_("RevisedOfferSettings"),m=_("GeneralSettings");return u(),c("div",null,[p("div",ma,[P(i,{pageTitle:"Customer Portal",backTo:{name:"setting"},items:e.breadcrumb},null,8,["items"])]),p("div",ua,[p("div",ca,[P(L,{name:"slide-fade"},{default:x((()=>[(u(),w(U,null,[(u(),w(R,null,{default:x((()=>[P(n)])),fallback:x((()=>[p("div",pa,[P(r)])])),_:1}))],1024))])),_:1}),P(L,{name:"slide-fade"},{default:x((()=>[(u(),w(U,null,[(u(),w(R,null,{default:x((()=>[p("div",null,[P(d)])])),fallback:x((()=>[p("div",ga,[P(r)])])),_:1}))],1024))])),_:1})]),p("div",null,[P(L,{name:"slide-fade"},{default:x((()=>[(u(),w(U,null,[(u(),w(R,null,{default:x((()=>[P(m)])),fallback:x((()=>[p("div",fa,[P(r)])])),_:1}))],1024))])),_:1})])])])}]]);export{va as default};
