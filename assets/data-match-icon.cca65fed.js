var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,d=(e,a)=>{for(var l in a||(a={}))i.call(a,l)&&n(e,l,a[l]);if(t)for(var l of t(a))s.call(a,l)&&n(e,l,a[l]);return e},o=(e,t)=>a(e,l(t));import{e as u}from"./bulkquote.38ab78f5.js";import{j as r,k as p,N as c,f as g,g as m,y as v,_ as h,m as b,a0 as f,o as _,t as y,n as k,w as S,A as w,I as x,a2 as C,a3 as V,B as L,F as I,D as U,K as N,U as $,S as j,W as O,T as B,L as q,ap as K,r as T,a5 as P}from"./vendor.f1efedad.js";import{z as A,d as D,b as Q,_ as F,R as W,t as z,W as E,f as M,a9 as R,j as G}from"./index.9aa6481b.js";import{g as Y}from"./buyback.8c173696.js";import{u as H}from"./notes.2b722abc.js";import{_ as J}from"./fieldset.49a14fc7.js";import{_ as X}from"./BuybackNotesWarning.b689e74e.js";import{B as Z}from"./BTable.59e23b62.js";import{u as ee}from"./index.32689823.js";import{c as ae,r as le,f as te}from"./index.05b14cb2.js";import{r as ie,v as se}from"./index.a87b789d.js";import{I as ne}from"./InputPhone.e8268c4d.js";import{c as de}from"./copy.ef53d68d.js";import{d as oe}from"./setting.2daa7691.js";const ue=r("buybackShipping",{state:()=>({shippingInfo:{isLoading:!1,modal:!1,result:void 0},additionalShipping:{isLoading:!1,modal:!1,result:void 0},shippingKit:{isLoading:!1,modal:!1,result:void 0}}),actions:{async $createMultipleLabels(e={id:void 0,data:void 0}){const a=await A({url:`/v1/pos/order/shipping-label/generate-multiple/${e.id}`,method:"post",data:e.data});this.additionalShipping.result=a},$actionCheckCustomTracking:async e=>await A({url:`/v1/pos/order/custom-tracking/check-courier?shipping_tracking=${e}`,method:"get"}),$actionSaveCustomTracking:async e=>await A({url:`/v1/pos/order/custom-tracking/${e.id}`,method:"post",data:e.data}),$downloadShippingKit:async(e={id:void 0,params:void 0})=>await A({url:`/v1/shipping/kit/print/${e.id}`,method:"get",params:e.params,responseType:"arraybuffer"}),$downloadBulkShippingKit:async(e={id:void 0,params:void 0})=>await A({url:`/v1/pos/order/shipping-label/print-batch/${e.id}`,method:"post",params:e.params,responseType:"arraybuffer"})}}),re=p({name:"BulkQuoteDetailFormStatus",components:{Modal:D,Button:Q,Fieldset:J,BuybackNotesWarning:X},props:{modelValue:{type:Boolean,default:!1},quoteId:{type:String,default:void 0,required:!0},status:{type:Object,default:void 0},order:{type:Object,default:void 0}},emits:["update:modelValue","updateStatus"],setup(e,a){const l=H(),t=c(),i=g(!1),s=g(!1),n=m({get:()=>e.modelValue,set:e=>a.emit("update:modelValue",e)}),u=g(!1),r=g(0),p=g([]),b=g(void 0),f=m((()=>{var a;return 0!==(null==(a=null==e?void 0:e.order)?void 0:a.is_signature_exist)})),_=g(!1),y=g(!1),k=g(!1),{state:S,actionAll:w}=Y("online"),x=async()=>{var n,d;if(s.value=!0,i.value=!0,[3,7].includes(null==(n=b.value)?void 0:n.id)&&(l.warningNotes.ids=[null==(d=e.order)?void 0:d.id],!l.warningNotes.isReviewed&&await l.$getNotesUnread(),l.warningNotes.notes.length))return l.warningNotes.modal=!0,i.value=!1,void(s.value=!1);await t.dispatch("bulkQuote/updateQuoteStatus",{id:e.quoteId,data:{status_id:b.value.id,new_step:b.value.step_bulk}}).then((()=>{s.value=!1,i.value=!1,u.value=!1,h({message:"Quote status updated successfully.",type:"success"}),a.emit("updateStatus",!0)})).catch((()=>{s.value=!1,i.value=!1,u.value=!1})),k.value&&callback&&callback()};return v((()=>n.value),(async()=>{n.value?await(async()=>{i.value=!0,s.value=!0;try{const[a,l]=await Promise.all([t.dispatch("bulkQuote/getQuoteStatuses"),t.dispatch("bulkQuote/getBulkQuoteItemInfo",{id:e.quoteId})]);(null==a?void 0:a.length)?(p.value=a.map((a=>{var l,t;return o(d({},a),{disabled:!![9e3,9001].includes(null==(l=e.status)?void 0:l.id)&&![9e3,9001].includes(a.id),active:a.id===(null==(t=e.status)?void 0:t.id)})})),b.value=p.value.find((a=>{var l;return a.id===(null==(l=e.status)?void 0:l.id)}))):(p.value=[],b.value=void 0),_.value=(null==l?void 0:l.total_reconcile)>0}catch{p.value=[],b.value=void 0}finally{i.value=!1,s.value=!1}})():p.value=[]})),{show:n,selected:b,showWarning:u,warningType:r,loading:i,loadingUpdate:s,listStatus:p,isSignedContract:f,reviewed:y,showNotesWarning:k,notes:S,showNotes:w,handleSave:()=>{var a,l,t,i,s,n,d,o,c,g,m,v,h,y,k;if((null==(a=b.value)?void 0:a.id)===(null==(l=e.status)?void 0:l.id)||!e.quoteId)return;if(9001===(null==(t=e.status)?void 0:t.id)&&9e3===(null==(i=b.value)?void 0:i.id)||9e3===(null==(s=e.status)?void 0:s.id)&&9001===(null==(n=b.value)?void 0:n.id))return r.value=9e3===(null==(d=e.status)?void 0:d.id)&&9001===(null==(o=b.value)?void 0:o.id)?0:1,void(u.value=!0);if(_.value&&[9003,9004].includes(null==(c=e.status)?void 0:c.id)&&[9e3,9001,9002,2].includes(null==(g=b.value)?void 0:g.id))return r.value=1,void(u.value=!0);if(f&&9e3!==(null==(m=b.value)?void 0:m.id)&&9001!==(null==(v=b.value)?void 0:v.id))return void x();const S=[...p.value].slice(0,p.value.findIndex((a=>{var l;return a.id===(null==(l=e.status)?void 0:l.id)}))).some((e=>{var a;return e.id===(null==(a=b.value)?void 0:a.id)}))&&(null==(h=e.order)?void 0:h.is_signature_exist)||[9004,3].includes(null==(y=e.status)?void 0:y.id)&&![9004,3].includes(null==(k=b.value)?void 0:k.id);r.value=S?0:1,u.value=!0},handleCancelUpdate:()=>{u.value=!1,r.value=0},handleUpdateStatus:x,handleSelectStatus:e=>{e.active||e.disabled||(b.value=e,p.value=p.value.map((e=>o(d({},e),{active:b.value.id===e.id}))))}}}}),pe={key:0,class:"border-grey-01 border"},ce=["onClick"],ge={key:0,class:"my-0 border-grey-01"},me={class:"flex items-center justify-end"},ve={key:0,class:"flex flex-col gap-6 items-center my-6"},he={class:"flex flex-wrap items-center justify-center gap-14"},be={key:1,class:"flex flex-col gap-6 items-center my-6"},fe={class:"flex flex-wrap items-center justify-center gap-14"};const _e=p({name:"BulkQuoteDetailStatus",components:{Button:Q,BulkQuoteDetailFormStatus:F(re,[["render",function(e,a,l,t,i,s){const n=b("Tooltip"),d=b("Fieldset"),o=b("Button"),u=b("Modal"),r=b("BuybackNotesWarning"),p=f("loading");return _(),y("div",null,[e.showWarning?$("",!0):(_(),k(u,{key:0,modelValue:e.show,"onUpdate:modelValue":a[0]||(a[0]=a=>e.show=a),title:"Update Status",size:"xs",class:""},{default:S((()=>[w((_(),k(d,{class:"rounded-md"},{label:S((()=>a[4]||(a[4]=[x("Choose Status")]))),default:S((()=>{var l;return[(null==(l=e.listStatus)?void 0:l.length)?(_(),y("ul",pe,[(_(!0),y(C,null,V(e.listStatus,((l,t)=>(_(),y("li",{key:t},[L("div",{class:I(["px-2 py-1.5 text-center",!l.disabled&&!l.active&&!e.loadingUpdate&&"hover:bg-teal-01 hover:bg-opacity-50 cursor-pointer text-grey-02",!l.disabled&&!!l.active&&!e.loadingUpdate&&"bg-teal-02 bg-opacity-40 cursor-pointer",(!!l.disabled||!!e.loadingUpdate)&&"bg-teal-01 bg-opacity-30 cursor-not-allowed text-grey-01"]),onClick:a=>e.handleSelectStatus(l)},[U(n,{placement:"top",disabled:!l.disabled},{content:S((()=>a[5]||(a[5]=[L("div",null,[L("p",null,"Quote must be signed first to unlock this status")],-1)]))),default:S((()=>[L("p",null,N(l.status_name),1)])),_:2},1032,["disabled"])],10,ce),t!==e.listStatus.length-1?(_(),y("hr",ge)):$("",!0)])))),128))])):$("",!0)]})),_:1})),[[p,e.loading]])])),footer:S((()=>{var l,t;return[L("div",me,[U(o,{color:"teal",disabled:!e.selected||(null==(l=e.selected)?void 0:l.id)==(null==(t=e.status)?void 0:t.id),loading:e.loadingUpdate,onClick:e.handleSave},{default:S((()=>a[6]||(a[6]=[x(" Update Status ")]))),_:1},8,["disabled","loading","onClick"])])]})),_:1},8,["modelValue"])),U(u,{modelValue:e.showWarning,"onUpdate:modelValue":a[3]||(a[3]=a=>e.showWarning=a),class:I(e.showNotesWarning&&"hidden"),size:"xs","hide-header":"","hide-footer":""},{default:S((()=>[0==e.warningType?(_(),y("div",ve,[a[8]||(a[8]=L("img",{src:W},null,-1)),a[9]||(a[9]=L("h6",{class:"text-3xl font-medium"},"Proceed With Quote?",-1)),a[10]||(a[10]=L("p",{class:"text-grey-02 text-center"}," Ensure the payout is correct, then make sure to send the Customer Portal link to the customer for contract access and review. ",-1)),L("div",he,[L("a",{href:"",onClick:a[1]||(a[1]=j(((...a)=>e.handleCancelUpdate&&e.handleCancelUpdate(...a)),["prevent"])),class:"px-6 py-4 hover:text-teal-03"}," Cancel "),U(o,{loading:e.loading,color:"teal",onClick:e.handleUpdateStatus},{default:S((()=>a[7]||(a[7]=[x(" Yes, proceed ")]))),_:1},8,["loading","onClick"])])])):$("",!0),1==e.warningType?(_(),y("div",be,[a[12]||(a[12]=L("img",{src:W},null,-1)),a[13]||(a[13]=L("h6",{class:"text-3xl font-medium"},"Change Status?",-1)),a[14]||(a[14]=L("p",{class:"text-grey-02 text-center"}," Your reconciled quantity will be reset to the original quoted quantity. ",-1)),L("div",fe,[U(o,{loading:e.loading,color:"teal",onClick:e.handleUpdateStatus},{default:S((()=>a[11]||(a[11]=[x(" Yes, change status ")]))),_:1},8,["loading","onClick"]),L("a",{href:"",onClick:a[2]||(a[2]=j(((...a)=>e.handleCancelUpdate&&e.handleCancelUpdate(...a)),["prevent"])),class:"px-6 py-4 hover:text-teal-03"}," Cancel ")])])):$("",!0)])),_:1},8,["modelValue","class"]),U(r,{onProceed:e.handleUpdateStatus},null,8,["onProceed"])])}]])},props:{status:{type:Object,default:()=>({id:null,name:null,short_name:null})},statusNameKey:{type:String,default:"name"},statusShortNameKey:{type:String,default:"short_name"},statusIdKey:{type:String,default:"id"},loading:{type:Boolean,default:!1},quoteId:{type:String,required:!0},disabled:{type:Boolean,default:!1},order:{type:Object,default:void 0}},emits:["updateStatus"],setup(e,{emit:a}){const{statuses:l,loading:t,getQuoteStatuses:i,updateQuoteStatus:s}=u(),n=g(!1),d=m((()=>({id:e.status[e.statusIdKey]||"",name:e.status[e.statusNameKey]||"Quote Status",short_name:e.status[e.statusShortNameKey]||"Quote Status"})));return O((async()=>{await i()})),{modalFormUpdateStatus:n,currentStatus:d,loadingQuoteStatus:t,handleUpdateStatus:async(e=!1)=>{n.value=!0},handleConfirmUpdateStatus:()=>{n.value=!1,a("updateStatus",!0)}}}}),ye={class:"flex flex-wrap items-center gap-4"},ke={class:"quote-status"},Se={class:"quote-status__status"},we={class:"quote-status__status-badge"},xe={class:"block"},Ce=["disabled"];var Ve=F(_e,[["render",function(e,a,l,t,i,s){const n=b("BulkQuoteDetailFormStatus"),d=f("loading");return _(),y("div",null,[L("div",ye,[a[3]||(a[3]=L("label",{class:"font-medium"},"Status:",-1)),w((_(),y("div",ke,[L("div",Se,[L("div",we,[L("span",xe,N(e.currentStatus.short_name),1)])]),L("button",{class:I(["quote-status__action",e.disabled&&"quote-status__action--disabled"]),onClick:a[0]||(a[0]=(...a)=>e.handleUpdateStatus&&e.handleUpdateStatus(...a)),disabled:e.disabled,tabindex:"0"},a[2]||(a[2]=[L("i",{class:"material-icons"},"edit",-1)]),10,Ce)])),[[d,e.loadingQuoteStatus||e.loading]])]),U(n,{modelValue:e.modalFormUpdateStatus,"onUpdate:modelValue":a[1]||(a[1]=a=>e.modalFormUpdateStatus=a),quoteId:e.quoteId,status:e.currentStatus,order:e.order,onUpdateStatus:e.handleConfirmUpdateStatus},null,8,["modelValue","quoteId","status","order","onUpdateStatus"])])}],["__scopeId","data-v-6eb997e4"]]);const Le={class:"space-y-4"},Ie={key:0,class:"flex-width"},Ue={key:1,class:"flex-width",style:{"min-width":"80px"}},Ne={key:0},$e={key:0},je={key:1},Oe={key:1,class:"w-10"},Be=["onClick"],qe=["onMouseenter","onMouseleave"],Ke={__name:"BuybackShippingKitDownload",props:{id:"-",shippings:{type:Array,default:()=>[]}},setup(e){const a=c(),l=ue(),t=e,i=g([]),s=g([{key:"order_shipping_label",column_name:"Label",meta:{}},{key:"shipping_tracking",column_name:"Tracking Number",meta:{}},{key:"shipping_label_status",column_name:"Label Status",meta:{}},{key:"action",column_name:"",meta:{}}]),n=m((()=>{var e;return null!=(e=null==t?void 0:t.shippings)?e:[]})),d=m((()=>{var e,l,t;return null==(t=null==(l=null==(e=a.state)?void 0:e.shipping)?void 0:l.processing)?void 0:t.loadingDownload})),o=()=>{l.shippingKit.modal=!1},u=async()=>{await z(l.shippingKit,(async()=>{await l.$downloadBulkShippingKit({id:t.id,params:{order_shipping_label_id:n.value.map((e=>e.order_shipping_label))}}).then((()=>{h({message:"Download in progress... Feel free to navigate away or close the window",type:"info"}),a.dispatch("notification/closeNotification","NotificationShippingKitDownload",{root:!0}),a.commit("shipping/SET_PROCESSING_DOWNLOAD_SHIPPING_KIT_PROGRESS",{progress:1,path:null,type:"zip",loading:!0},{root:!0}),a.commit("notification/OPEN_NOTIFICATION","NotificationShippingKitDownload",{root:!0}),a.commit("notification/SET_NOTIFICATION_CLOSABLE",{name:"NotificationShippingKitDownload",closable:!1},{root:!0})}))}))};return(e,a)=>{const r=f("loading");return _(),k(D,{modelValue:K(l).shippingKit.modal,"onUpdate:modelValue":a[1]||(a[1]=e=>K(l).shippingKit.modal=e),size:"md","hide-footer":"",onClose:o},{header:S((()=>a[2]||(a[2]=[L("h5",{class:"text-2xl font-medium"}," Shipping Kit Download ",-1)]))),default:S((()=>[w((_(),y("div",Le,[U(B,{name:"fade"},{default:S((()=>{var e;return[w(U(Q,{view:"outlined",color:"teal",dense:"",onClick:u},{default:S((()=>a[3]||(a[3]=[L("div",{class:"flex items-center justify-center gap-x-4"},[L("span",{class:"material-icons"}," print "),L("span",null,"Bulk Download Shipping Kit")],-1)]))),_:1},512),[[q,!!(null==(e=i.value)?void 0:e.length)]])]})),_:1}),U(Z,{selected:i.value,"onUpdate:selected":a[0]||(a[0]=e=>i.value=e),headers:s.value,items:n.value,"item-value":"order_shipping_label",selectable:n.value.length>1},{header:S((({header:e})=>["action"!==e.key?(_(),y("th",Ie,N(e.column_name),1)):(_(),y("th",Ue,N(e.column_name),1))])),column:S((({row:e,key:i,preventRowClick:s,resetRowClick:n})=>["shipping_label_status"===i?(_(),y("td",Ne,[(null==e?void 0:e.shipping_tracking)?(_(),y("span",$e,N("Available"))):(_(),y("span",je,N("Unavailable")))])):"action"===i?(_(),y("td",Oe,[L("a",{class:I(d.value?"opacity-50 cursor-not-allowed":"opacity-100"),color:"white",onClick:j((a=>(async e=>{await z(l.shippingKit,(async()=>{await l.$downloadShippingKit({id:t.id,params:{order_shipping_label_id:e.order_shipping_label}}).then((e=>{E(e)}))}))})(e)),["prevent"])},a[4]||(a[4]=[L("span",{class:"material-icons"}," print ",-1)]),10,Be)])):(_(),y("td",{key:2,onMouseenter:s,onMouseleave:n},N(e[i]),41,qe))])),_:1},8,["selected","headers","items","selectable"])])),[[r,K(l).shippingKit.isLoading]])])),_:1},8,["modelValue"])}}};var Te="/assets/show-original.c4e04b0d.svg";const Pe=p({name:"ShippingLabelInfo",components:{Input:M,InputPhone:ne},props:{data:{type:Object,default:()=>({shipping_firstname:null,shipping_lastname:null,shipping_address1:null,shipping_suite:"",shipping_city:null,shipping_country:null,shipping_state:null,shipping_zip:null,shipping_phone:null,shipping_address_text:null,company_name:null,custom_fields:null})},isEasyOffer:{type:Boolean,default:!1}},emits:["update:data"],setup(e,{emit:a}){const l=T(e.data),t=g(null);Object.assign(l,{valid:l.shipping_address_text&&""!==l.shipping_address_text&&null!==l.shipping_address_text});const i={shipping_firstname:{required:ie},shipping_lastname:{required:ie},shipping_phone:{required:ie,invalidNumber:ae.withMessage("Phone number is invalid",(()=>{var e;return!l.shipping_phone||(null==(e=t.value)?void 0:e.isValid)}))},valid:{sameAs:se}},s=ee(i,l,{$lazy:!0});return v((()=>d({},l)),(()=>{a("update:data",l)})),{phoneNumber:R,data:l,refInputPhone:t,validation:s,validate:()=>(s.value.$validate(),!s.value.$invalid),address:{valid:"valid",route:"shipping_address1",locality:"shipping_city",administrative_area_level_1:"shipping_state",formatted_address:"shipping_address_text",postal_code:"shipping_zip",country:"shipping_country",disallowCustomAddress:!0,subpremise:"shipping_suite"}}}}),Ae={class:"grid grid-cols-2 gap-6"},De={key:0,class:"col-span-2"},Qe={class:"col-span-2"},Fe={class:"col-span-2"},We={class:"col-span-2"};var ze=F(Pe,[["render",function(e,a,l,t,i,s){const n=b("Input"),d=b("InputPhone"),o=f("gmap");return _(),y("div",Ae,[L("div",null,[U(n,{modelValue:e.data.shipping_firstname,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.shipping_firstname=a),label:"First Name",block:"",view:e.validation.shipping_firstname.$invalid?"danger":"default"},null,8,["modelValue","view"]),(_(!0),y(C,null,V(e.validation.shipping_firstname.$errors,((e,a)=>(_(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),L("div",null,[U(n,{modelValue:e.data.shipping_lastname,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.shipping_lastname=a),label:"Last Name",block:""},null,8,["modelValue"]),(_(!0),y(C,null,V(e.validation.shipping_lastname.$errors,((e,a)=>(_(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),e.isEasyOffer?(_(),y("div",De,[U(n,{modelValue:e.data.company_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.company_name=a),label:"Company Name",block:""},null,8,["modelValue"])])):$("",!0),L("div",Qe,[w(U(n,{modelValue:e.data.shipping_address_text,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.shipping_address_text=a),label:"Street Address",block:""},null,8,["modelValue"]),[[o,e.address]]),a[6]||(a[6]=L("small",null,"Street address, P.O box, company name, c/o.",-1)),(_(!0),y(C,null,V(e.validation.valid.$errors,((e,a)=>(_(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),L("div",Fe,[U(n,{modelValue:e.data.shipping_suite,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.shipping_suite=a),block:""},null,8,["modelValue"]),a[7]||(a[7]=L("small",null,"Apartment, suite, unit, building, floor, etc.",-1))]),L("div",We,[U(d,{ref:"refInputPhone",modelValue:e.data.shipping_phone,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.shipping_phone=a),label:"Phone",block:"","country-autofill-setting":""},null,8,["modelValue"]),(_(!0),y(C,null,V(e.validation.shipping_phone.$errors,((e,a)=>(_(),y("small",{class:"text-red-base block",key:a},N(e.$message)+". ",1)))),128))]),e.data.custom_fields&&e.isEasyOffer?(_(!0),y(C,{key:1},V(Object.entries(e.data.custom_fields),(([a,l])=>(_(),y("div",{key:a,class:"col-span-2"},[U(n,{modelValue:e.data.custom_fields[a],"onUpdate:modelValue":l=>e.data.custom_fields[a]=l,label:a,block:""},null,8,["modelValue","onUpdate:modelValue","label"])])))),128)):$("",!0)])}]]);const Ee={key:0,class:"border border-grey-01 rounded-xl p-6 w-full mb-6"},Me={class:"space-y-4"},Re={class:"flex items-center justify-between"},Ge={class:"font-medium text-xl"},Ye={class:"grid grid-cols-2 gap-4"},He={class:"flex items-end gap-x-1"},Je={class:"text-grey-02"},Xe={class:"text-grey-02"},Ze={__name:"BuybackShippingInformation",props:{id:"-",shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},regenerateShippingLabel:{type:Function,default:()=>{}}},emits:["saved"],setup(e,{emit:a}){const l=ue(),t=e,i=a,s=g({}),n=g(t.shippings),u=()=>{l.shippingInfo.modal=!1,s.value={},n.value={}};return v((()=>t.shippings),(e=>{e&&e.length>0&&(n.value=e.map((e=>o(d({},e),{isLoading:!1}))))}),{deep:!0,immediate:!0}),v((()=>l.shippingInfo.modal),(()=>{l.shippingInfo.modal?n.value=t.shippings.map((e=>o(d({},e),{isLoading:!1}))):n.value=[]})),(a,d)=>(_(),k(D,{modelValue:K(l).shippingInfo.modal,"onUpdate:modelValue":d[0]||(d[0]=e=>K(l).shippingInfo.modal=e),size:"sm","hide-footer":"",onClose:u},{header:S((()=>d[1]||(d[1]=[L("h5",{class:"text-2xl font-medium"}," Shipping Information ",-1)]))),default:S((()=>["1"!==e.shippingLabelStatus?(_(),y("div",Ee,[d[3]||(d[3]=L("div",{class:"flex items-center gap-2 mb-4"},[L("i",{class:"material-icons text-red-base icon-md"},"warning"),L("p",{class:"text-2xl font-bold"},"Regenerate Shiping Label")],-1)),d[4]||(d[4]=L("p",null,"Shipping label fails to generates. Once the root cause is resolved, you can use this option to regenerate both the shipping label and shipping kit. Once regenerated, the new tracking number and shipping kit will be automatically attached to the offer. ",-1)),U(Q,{class:"btn btn-teal btn-outlined mt-6",rounded:"",dense:"",onClick:e.regenerateShippingLabel},{default:S((()=>d[2]||(d[2]=[L("div",{class:"flex items-center gap-2 px-2 py-1"},[L("i",{class:"material-icons text-base"},"refresh"),L("span",{class:"font-medium"},"Regenerate Shiping Label")],-1)]))),_:1},8,["onClick"])])):$("",!0),L("div",Me,[(_(!0),y(C,null,V(n.value,((e,a)=>(_(),y("div",{key:a,class:"border border-grey-01 rounded-xl p-5 space-y-4"},[L("div",Re,[L("h5",Ge,N(`Shipping Label ${e.order_shipping_label}`),1),U(Q,{disabled:!(null==e?void 0:e.custom_tracking)||!(null==e?void 0:e.custom_tracking.length),loading:e.isLoading,view:"outlined",color:"teal",dense:"",onClick:a=>(async e=>{var a,n,d,o;if(e.isLoading=!0,await z(l.shippingInfo,(()=>l.$actionCheckCustomTracking(e.shipping_tracking).then((e=>{const[a]=e;s.value=a})).catch((()=>{s.value={}})))),(null==(a=s.value)?void 0:a.courier_code)&&(null==(n=s.value)?void 0:n.courier_name)){const a={id:t.id,data:{order_shipping_label_id:e.order_shipping_label,shipping_tracking:e.custom_tracking,courier_code:null==(d=null==s?void 0:s.value)?void 0:d.courier_code,courier_name:null==(o=null==s?void 0:s.value)?void 0:o.courier_name,force_courier_code:0}};await z(l.shippingInfo,(()=>l.$actionSaveCustomTracking(a).then((()=>{i("saved"),u()})).catch((()=>{s.value={}}))))}e.isLoading=!1})(e)},{default:S((()=>d[5]||(d[5]=[x(" Save ")]))),_:2},1032,["disabled","loading","onClick"])]),L("div",Ye,[L("div",He,[U(M,{modelValue:e.shipping_tracking,"onUpdate:modelValue":a=>e.shipping_tracking=a,disabled:"",block:""},{label:S((()=>d[6]||(d[6]=[L("span",{class:"font-medium"}," Tracking Number ",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue"]),U(Q,{color:"teal",view:"outlined",icon:"",class:"btn-action w-16",style:{paddingRight:0,paddingLeft:0},onClick:a=>K(de)(null==e?void 0:e.shipping_tracking)},{default:S((()=>d[7]||(d[7]=[L("span",{class:"material-icons"},"content_copy",-1)]))),_:2},1032,["onClick"])]),L("div",null,[U(M,{modelValue:e.custom_tracking,"onUpdate:modelValue":a=>e.custom_tracking=a,disabled:e.isLoading,block:""},{label:S((()=>d[8]||(d[8]=[L("span",{class:"font-medium"}," Custom Tracking Number ",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),L("div",null,[d[9]||(d[9]=L("label",{class:"block font-medium"},"Label Status",-1)),L("span",Je,N(e.shipping_label_status?"Available":"Unavailable"),1)]),L("div",null,[d[10]||(d[10]=L("label",{class:"block font-medium"},"Date Created",-1)),L("span",Xe,N(null==e?void 0:e.created_at),1)])])])))),128))])])),_:1},8,["modelValue"]))}},ea={class:"space-y-8"},aa={class:"space-y-6"},la={class:"text-grey-02 text-xs"},ta={key:0},ia={rows:"8",class:"block w-full border border-grey-01 rounded-md px-4 py-4 text-grey-02"},sa={class:"space-y-6"},na={class:"space-y-2"},da={class:"flex items-center justify-between gap-4"},oa={__name:"BuybackShippingAdditional",props:{id:"-",total:0,shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},offerType:{type:String,default:"Mail-In"}},emits:["created","failed"],setup(e,{emit:a}){const l=ue(),t=e,i=a,s=oe(),n=T({add_shipping_label_number:1}),u=g({}),r=m((()=>n.add_shipping_label_number>=4?3:n.add_shipping_label_number>1?n.add_shipping_label_number:1)),p=ee({add_shipping_label_number:{required:le,minValue:te(1)}},n,{$lazy:!0}),c=m((()=>{var e,a,l,i;return(null!=(a=null==(e=null==u?void 0:u.value)?void 0:e.label_qty)?a:1)-(null!=(i=null==(l=t.shippings)?void 0:l.length)?i:1)-n.add_shipping_label_number})),b=e=>{var a;n.add_shipping_label_number=Number(null==(a=null==e?void 0:e.target)?void 0:a.value)},f=()=>{n.add_shipping_label_number=1,l.additionalShipping.modal=!1},w=async()=>{await p.value.$validate()&&await z(l.additionalShipping,(async()=>{await l.$createMultipleLabels({id:t.id,data:n}).then((()=>{var e,a;h({message:null==(a=null==(e=l.additionalShipping)?void 0:e.result)?void 0:a.message,type:"info"}),i("created"),f()})).catch((()=>{i("failed")}))}))};return v((()=>l.additionalShipping.modal),(async e=>{e&&(l.additionalShipping.isLoading=!0,await s.actionAll(!0,(e=>{var a,l,i;const s=null!=(l=null==(a=e.param)?void 0:a.shipping_rules_multiple_label)?l:[];if(s.length){const e=s.find((e=>e.offer_type===t.offerType));u.value=o(d({},null!=e?e:{}),{label_qty:null!=(i=Number(null==e?void 0:e.label_qty))?i:1})}else u.value=void 0})),l.additionalShipping.isLoading=!1)})),(a,i)=>(_(),k(D,{modelValue:K(l).additionalShipping.modal,"onUpdate:modelValue":i[1]||(i[1]=e=>K(l).additionalShipping.modal=e),size:"xs",onClose:f},{header:S((()=>i[2]||(i[2]=[L("h5",{class:"text-2xl font-medium"}," Additional Shipping Info ",-1)]))),default:S((()=>{var a,s;return[L("div",ea,[U(G,{color:"blue",view:"smooth",dense:""},{default:S((()=>i[3]||(i[3]=[L("div",{class:"flex items-center gap-x-4"},[L("span",{class:"material-icons",style:{"line-height":"1"}},"info"),L("p",null,"Labels will be created using the first shipping data")],-1)]))),_:1}),L("div",aa,[L("div",null,[U(M,{modelValue:n.add_shipping_label_number,"onUpdate:modelValue":i[0]||(i[0]=e=>n.add_shipping_label_number=e),max:15,disabled:K(l).additionalShipping.isLoading,view:K(p).add_shipping_label_number.$error?"danger":"default",type:"number",block:"",ltr:"",onChange:b},{label:S((()=>i[4]||(i[4]=[L("span",{class:"font-medium"},"Number of Additional Labels",-1)]))),_:1},8,["modelValue","disabled","view"]),L("p",null,[(_(!0),y(C,null,V(K(p).add_shipping_label_number.$errors,((e,a)=>(_(),y("small",{key:a,class:"text-red-04"},N(e.$message),1)))),128))]),L("small",la,N(c.value<0?0:c.value)+" "+N(c.value>1?"labels":"label")+" left to generate. ",1)]),1==e.shippingLabelStatus?(_(),y("div",ta,[L("div",ia,[L("div",sa,[i[7]||(i[7]=L("h6",{class:"font-medium text-lg text-grey-04"},"Preview:",-1)),L("div",na,[L("div",null,[i[5]||(i[5]=L("span",{class:"font-medium text-grey-04"},"Base Tracking:",-1)),x(" "+N(null!=(s=null==(a=t.shippings[0])?void 0:a.shipping_tracking)?s:"-"),1)]),i[6]||(i[6]=L("p",null,"New labels will have tracking numbers like:",-1)),L("div",null,[(_(!0),y(C,null,V(r.value,(e=>{var a,l;return _(),y("p",{key:e},N((null==(a=t.shippings[0])?void 0:a.shipping_tracking)?`${null==(l=t.shippings[0])?void 0:l.shipping_tracking}-${e}`:`-${e}`)+" "+N(r.value===e&&r.value>1?".etc":""),1)})),128))])])])])])):$("",!0)])])]})),footer:S((()=>[L("div",da,[U(Q,{disabled:K(l).additionalShipping.isLoading,color:"white",onClick:f},{default:S((()=>i[8]||(i[8]=[x(" Cancel ")]))),_:1},8,["disabled"]),U(Q,{disabled:K(l).additionalShipping.isLoading||c.value<0,loading:K(l).additionalShipping.isLoading,color:"teal",onClick:w},{default:S((()=>i[9]||(i[9]=[x(" Create Labels ")]))),_:1},8,["disabled","loading"])])])),_:1},8,["modelValue"]))}},ua={__name:"BuybackShippingOptions",props:{id:"-",multiple:!1,total:0,shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},regenerateShippingLabel:{type:Function,default:()=>{}}},emits:["succeed","failed"],setup(e,{emit:a}){const l=P(),t=ue(),i=e,s=a,n=m((()=>{var e,a;return(null==(e=null==l?void 0:l.name)?void 0:e.toLowerCase().includes("bulkquote"))?"Bulk Offer":(null==(a=null==l?void 0:l.name)?void 0:a.toLowerCase().includes("easyoffer"))?"Easy Offer":"Mail-In"})),d=e=>{1==e?t.shippingInfo.modal=!0:2==e&&(t.additionalShipping.modal=!0)},o=()=>{s("succeed")},u=()=>{s("failed")},r=()=>{s("succeed")};return(e,a)=>{const l=b("DropdownItem"),t=b("DropdownMenu"),s=b("Dropdown");return _(),y(C,null,[U(s,{trigger:"click",placement:"bottom-end","hide-on-click":"",onCommand:d},{dropdown:S((()=>[U(t,null,{default:S((()=>[U(l,{command:"1"},{default:S((()=>a[1]||(a[1]=[L("div",{class:"flex items-center gap-2 text-base"},[L("span",{class:"material-icons"},"local_shipping"),x(" Shipping Information ")],-1)]))),_:1}),U(l,{command:"2"},{default:S((()=>a[2]||(a[2]=[L("div",{class:"flex items-center gap-2 text-base"},[L("span",{class:"material-icons"},"add"),x(" Additional Shipping Label ")],-1)]))),_:1})])),_:1})])),default:S((()=>[U(Q,{color:"teal",view:"outlined",dense:"",icon:"",class:"btn-action"},{default:S((()=>a[0]||(a[0]=[L("span",{class:"material-icons"},"more_horiz",-1)]))),_:1})])),_:1}),U(Ze,{id:i.id,shippings:i.shippings,shippingLabelStatus:i.shippingLabelStatus,regenerateShippingLabel:i.regenerateShippingLabel,onSaved:r},null,8,["id","shippings","shippingLabelStatus","regenerateShippingLabel"]),U(oa,{id:i.id,total:i.total,shippings:i.shippings,shippingLabelStatus:i.shippingLabelStatus,"offer-type":n.value,onCreated:o,onFailed:u},null,8,["id","total","shippings","shippingLabelStatus","offer-type"])],64)}}};var ra="/assets/no-item.d2e9bfac.svg",pa="/assets/data-match-icon.5fe238bc.svg";export{Ve as B,ze as S,Ke as _,Te as a,ua as b,ra as c,pa as d,ue as u};
