var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,s=(e,s)=>{for(var i in s||(s={}))a.call(s,i)&&o(e,i,s[i]);if(t)for(var i of t(s))l.call(s,i)&&o(e,i,s[i]);return e};import{k as i,f as n,g as r,y as d,o as c,t as m,B as u,F as p,m as f,a0 as g,D as b,w as h,n as C,a4 as v,U as k,K as y,a2 as x,a3 as w,I as _,A as F,S as D}from"./vendor.f1efedad.js";import{g as I}from"./customer.a2559fd1.js";import{_ as S,b as T,f as j,P as A,d as L,u as R,a9 as V,a7 as E,ad as B,g as U}from"./index.e231b017.js";import{_ as M}from"./tab.9f764545.js";import{T as O}from"./TextLimit.43017255.js";import{A as z}from"./index.0dabe17d.js";import{C as P,a as $}from"./CustomTableExport.4aa547cf.js";import{B as N}from"./BTable.e686e826.js";import{F as H}from"./FilterDropdown.587ed5af.js";import{f as Y}from"./date.f86face7.js";import{_ as K}from"./attention.c511405b.js";import"./format.f845777a.js";import"./index.32689823.js";import"./index.1c09f422.js";import"./vue-draggable-next.esm-bundler.0ebea46e.js";import"./fieldset.32ceb9ab.js";import"./BDropdown.58f98060.js";const q=i({props:{type:{type:String,default:"none"}},emits:["change"],setup(e,{emit:t}){const a=["ascending","asc","descending","desc","none"],l=n(null),o=r((()=>{const e=["sort"];if("string"==typeof l.value)switch(l.value.toLowerCase()){case"ascending":e.push("--asc");break;case"descending":e.push("--desc");break;default:e.push("--none")}else e.push("--none");return e}));return d((()=>e.type),(e=>{if("string"==typeof e&&a.includes(e.toLowerCase()))return"asc"===e.toLowerCase()&&(e="ascending"),"desc"===e.toLowerCase()&&(e="descending"),l.value=e,null;l.value="none"}),{immediate:!0}),{sortType:l,sortClasses:o,handleChangeSortType:e=>{"string"==typeof e&&(l.value=e===l.value?"none":e,t("change",l.value))}}}});const G=i({components:{Tab:M,Button:T,Input:j,Pagination:A,Modal:L,TextLimit:O,TableSort:S(q,[["render",function(e,t,a,l,o,s){return c(),m("div",{class:p(e.sortClasses)},[u("div",{onClick:t[0]||(t[0]=t=>e.handleChangeSortType("ascending")),class:"sort__icon --asc"}),u("div",{onClick:t[1]||(t[1]=t=>e.handleChangeSortType("descending")),class:"sort__icon --desc"})],2)}],["__scopeId","data-v-912c3ae0"]]),Address:z,CustomTableManager:P,CustomTableExport:$,BTable:N,FilterDropdown:H},props:{statusId:{type:[Number,String],default:1},choose:{type:Boolean,default:!1},linkCustomer:{type:Boolean,default:!0},loadingExport:{type:Boolean,default:!1},statusName:{type:String,default:"Active"},showCustomTableSetting:{type:Boolean,default:!1}},emits:["choose","export-customer"],async setup(e,{emit:t}){const{data:a,state:l,loading:o,modal:i,selected:c,filterList:m,filterDateOptions:u,isDateShow:p,filterDateFocus:f,filterDateRef:g,isFiltered:b,clearFilter:h,clearAllFilter:C,unsetData:v,openModal:k,actionAll:y,actionDelete:x,actionRestore:w}=I(),{me:_}=R(),F=n(!0),D=n("csv"),S=n(!1),T=n(!1),j=r((()=>{const e={from:null,to:null};if(!!a.date){const[t,l]=a.date;e.from=Y(t),e.to=Y(l)}return e})),A=r((()=>{const t=j.value,a=!!t.from&&!!t.to;return`${e.statusName}${a?` ${t.from} to ${t.to}`:""}`})),L=r((()=>[{name:"Select Date",key:"date",count_selected:0}])),M=r((()=>0===m.value.filter((e=>!!e.value)).length));d((()=>({route:e.statusId,limit:a.limit,search:a.search})),(()=>{a.page=1}),{deep:!0}),d((()=>({statusId:e.statusId,page:a.page,limit:a.limit,search:a.search})),U((async()=>{await y(e.statusId)}),500),{immediate:!0,deep:!0});const O=async()=>{S.value=!0,T.value=!0,await y(e.statusId),S.value=!1};return{isClickableRow:F,data:a,state:l,loading:o,modal:i,unsetModal:()=>{F.value=!0,v()},me:_,filterList:m,filterDateOptions:u,isDateShow:p,filterDateFocus:f,filterDateRef:g,isFiltered:b,clearFilter:h,clearAllFilter:C,openModalSelected:(e,t)=>{F.value=!1,k(e,(()=>{c.value=t.customer_id}))},deleteCustomer:()=>x(e.statusId),restoreCustomer:()=>w(e.statusId),onChoose:e=>{F.value&&t("choose",e)},phoneNumber:V,nameCapitalize:E,handleTableSort:(e,t)=>{if(e&&t){const l="ascending"===t?"ASC":"descending"===t?"DESC":null;a[e]=l}},titleCase:B,loginCustomer:e=>{F.value=!0,window.open(e,"_blank","noreferrer noopener"),F.value=!1},handleUpdateCustomTable:async()=>{await y(e.statusId)},handleExportCustomerData:()=>{const e=D.value;t("export-customer",{format:e,filename:A.value,filters:s({},j.value)})},exportCustomerFormat:D,exportFilename:A,isLoadingDropdownFilter:S,isAppliedFilter:T,dropdownFilterOptions:L,handleApplyFilter:O,handleResetFilter:async()=>{S.value=!0,T.value=!1,C(),await y(e.statusId),S.value=!1},handleDropdownItemClick:e=>{e&&"date"===e.key&&f()},handleClearFilter:e=>{h(e),O(),M.value&&(T.value=!1)},dropdownItemFilterLoading:()=>o.all,dropdownItemFilterDisableHover:e=>"date"===e.key}}}),J={class:"flex lg:flex-row flex-col mb-6"},Q={class:"flex flex-wrap flex-auto md:mr-3 md:mb-0 mb-3"},W={class:"flex-auto mr-2"},X={class:"lg:flex-auto mr-2"},Z={class:"text-grey-03"},ee={key:0,class:"flex flex-wrap"},te={class:"flex flex-start flex-row my-4"},ae=["onClick"],le={key:0,class:"inline-block mx-2"},oe={style:{minHeight:"100px"}},se={key:0},ie={key:0,class:"mb-2"},ne={key:1,class:"block text-teal-04 mb-2"},re={key:0,class:"mb-2"},de={key:1,class:"block text-teal-04 mb-2"},ce={key:1},me={class:"flex flex-wrap items-center"},ue=["onClick","href"],pe={class:"text-center py-10"},fe={class:"text-center py-10"};var ge=S(G,[["render",function(e,t,a,l,o,s){const i=f("Input"),n=f("DatePicker"),r=f("FilterDropdown"),d=f("CustomTableManager"),p=f("CustomTableExport"),I=f("Button"),S=f("TextLimit"),T=f("router-link"),j=f("Tooltip"),A=f("BTable"),L=f("Pagination"),R=f("Modal"),V=g("loading");return c(),m("div",null,[u("div",J,[u("div",Q,[u("div",W,[b(i,{modelValue:e.data.search,"onUpdate:modelValue":t[0]||(t[0]=t=>e.data.search=t),placeholder:"Search Everything",class:"w-full",icon:""},{icon:h((()=>t[10]||(t[10]=[u("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue"])]),u("div",X,[b(r,{onItemClick:e.handleDropdownItemClick,onApplyFilter:e.handleApplyFilter,onResetFilter:e.handleResetFilter,onCollapse:t[2]||(t[2]=t=>e.isDateShow=!1),"item-loading":e.dropdownItemFilterLoading,"item-disable-hover":e.dropdownItemFilterDisableHover,filters:e.dropdownFilterOptions,loading:e.isLoadingDropdownFilter},{label:h((({item:a})=>["date"===a.key?(c(),C(n,v({key:0,modelValue:e.data.date,"onUpdate:modelValue":t[1]||(t[1]=t=>e.data.date=t)},e.filterDateOptions,{ref:"filterDateRef",type:"daterange",class:"hide-picker"}),null,16,["modelValue"])):k("",!0),u("p",Z,y(a.name),1)])),_:1},8,["onItemClick","onApplyFilter","onResetFilter","item-loading","item-disable-hover","filters","loading"])])]),e.showCustomTableSetting?(c(),m("div",ee,[b(d,{type:"customer",status:e.statusId,onUpdateTable:e.handleUpdateCustomTable},null,8,["status","onUpdateTable"]),b(p,{modelValue:e.exportCustomerFormat,"onUpdate:modelValue":t[3]||(t[3]=t=>e.exportCustomerFormat=t),onExport:e.handleExportCustomerData,"export-filename":e.exportFilename,loading:e.loadingExport,class:"mx-2"},null,8,["modelValue","onExport","export-filename","loading"])])):k("",!0)]),u("div",te,[e.isAppliedFilter?(c(),m(x,{key:0},[(c(!0),m(x,null,w(e.filterList,((t,a)=>(c(),m("div",{class:"inline-block",key:a},[t.value?(c(),C(I,{key:0,color:"grey",view:"smooth",dense:"",class:"mx-1"},{default:h((()=>[u("b",null,y(t.name)+":",1),_(" "+y(e.titleCase(t.value)),1),u("i",{class:"material-icons text-sm ml-2",onClick:a=>e.handleClearFilter(t)},"close",8,ae)])),_:2},1024)):k("",!0)])))),128)),e.isFiltered?(c(),m("div",le,[b(I,{onClick:e.handleResetFilter,color:"teal",view:"smooth",dense:""},{default:h((()=>t[11]||(t[11]=[u("i",{class:"material-icons text-sm mr-1"},"close",-1),_("Clear all ")]))),_:1},8,["onClick"])])):k("",!0)],64)):k("",!0)]),F((c(),m("div",oe,[b(A,{class:"mb-4",items:e.state.data||[],headers:e.state.header_table||[],onRowClick:e.onChoose,"clickable-row":e.isClickableRow},{column:h((({row:t,column:a,key:l})=>["customer_name"===l?(c(),m("td",se,[e.linkCustomer?(c(),C(T,{key:0,class:"font-bold",to:{name:"customerDetail",params:{customerId:t.customer_id,category:"in-store"}}},{default:h((()=>[b(S,{text:a||""},{default:h((({text:t})=>[e.nameCapitalize(t).length?(c(),m("div",ie,[(c(!0),m(x,null,w(e.nameCapitalize(t),((e,t)=>(c(),m("span",{key:t,class:"text-teal-04 capitalize"},y(`${e} `),1)))),128))])):(c(),m("span",ne,y(t),1))])),_:2},1032,["text"])])),_:2},1032,["to"])):(c(),C(S,{key:1,text:a||""},{default:h((({text:t})=>[e.nameCapitalize(t).length?(c(),m("div",re,[(c(!0),m(x,null,w(e.nameCapitalize(t),((e,t)=>(c(),m("span",{key:t,class:"text-teal-04 capitalize"},y(`${e} `),1)))),128))])):(c(),m("span",de,y(t),1))])),_:2},1032,["text"]))])):(c(),m("td",ce,y(a||"-"),1))])),action:h((({row:a})=>[u("div",me,[b(I,{color:"teal",class:"mr-2",to:{name:"customerEdit",params:{customerId:a.customer_id}},link:"",dense:""},{default:h((()=>t[12]||(t[12]=[u("span",{class:"material-icons text-base"}," mode_edit ",-1)]))),_:2},1032,["to"]),"1"===e.statusId.toString()?(c(),C(j,{key:0,placement:"bottom",content:"Archive customer",effect:"light"},{default:h((()=>[b(I,{color:"red",class:"mr-2",onClick:t=>e.openModalSelected("delete",a),dense:""},{default:h((()=>t[13]||(t[13]=[u("span",{class:"material-icons text-base"}," archive ",-1)]))),_:2},1032,["onClick"])])),_:2},1024)):(c(),C(j,{key:1,placement:"bottom",content:"Restore Customer",effect:"light"},{default:h((()=>[b(I,{color:"teal",onClick:t=>e.openModalSelected("restore",a),dense:""},{default:h((()=>t[14]||(t[14]=[u("i",{class:"fas fa-undo-alt"},null,-1)]))),_:2},1032,["onClick"])])),_:2},1024)),"1"===e.statusId.toString()&&"#"!==a.login_link?(c(),C(j,{key:2,placement:"bottom",content:"Login into customer account",effect:"light",offset:20},{default:h((()=>[u("a",{onClick:D((t=>e.loginCustomer(a.login_link)),["prevent"]),target:"_blank",href:a.login_link},[b(I,{color:"green",dense:""},{default:h((()=>t[15]||(t[15]=[u("span",{class:"material-icons text-base"},"vpn_key",-1)]))),_:1})],8,ue)])),_:2},1024)):k("",!0)])])),_:1},8,["items","headers","onRowClick","clickable-row"])])),[[V,e.loading.all]]),b(L,{page:e.data.page,"onUpdate:page":t[4]||(t[4]=t=>e.data.page=t),limit:e.data.limit,"onUpdate:limit":t[5]||(t[5]=t=>e.data.limit=t),data:e.state},null,8,["page","limit","data"]),b(R,{size:"xs",modelValue:e.modal.delete,"onUpdate:modelValue":t[7]||(t[7]=t=>e.modal.delete=t),title:"Archive Customer Location",onClose:e.unsetModal,"hide-header":"","hide-footer":""},{default:h((()=>[u("div",pe,[t[18]||(t[18]=u("img",{class:"mb-10 mx-auto",src:K,alt:"Success Icon"},null,-1)),t[19]||(t[19]=u("div",{class:"mt-8 mb-10"},[u("h6",null,"Archive Customer Data?")],-1)),b(I,{view:"smooth",color:"teal",class:"mr-5",loading:e.loading.delete,disabled:e.loading.delete,onClick:e.deleteCustomer},{default:h((()=>t[16]||(t[16]=[_("Yes, Archive")]))),_:1},8,["loading","disabled","onClick"]),b(I,{view:"outlined",color:"teal",disabled:e.loading.delete,onClick:t[6]||(t[6]=t=>e.modal.delete=!1)},{default:h((()=>t[17]||(t[17]=[_("Cancel")]))),_:1},8,["disabled"])])])),_:1},8,["modelValue","onClose"]),b(R,{size:"xs",modelValue:e.modal.restore,"onUpdate:modelValue":t[9]||(t[9]=t=>e.modal.restore=t),title:"Restore Customer",onClose:e.unsetModal,"hide-header":"","hide-footer":""},{default:h((()=>[u("div",fe,[t[22]||(t[22]=u("img",{class:"mb-10 mx-auto",src:K,alt:"Success Icon"},null,-1)),t[23]||(t[23]=u("div",{class:"mt-8 mb-10"},[u("h5",{class:"mb-4"},"Attention?"),u("p",null,"Are you sure want to restore this data?")],-1)),b(I,{view:"smooth",color:"teal",class:"mr-3",loading:e.loading.restore,onClick:e.restoreCustomer},{default:h((()=>t[20]||(t[20]=[_("Yes, Restore")]))),_:1},8,["loading","onClick"]),b(I,{view:"outlined",color:"teal",class:"bg-white",disabled:e.loading.restore,onClick:t[8]||(t[8]=t=>e.modal.restore=!1)},{default:h((()=>t[21]||(t[21]=[_("Cancel")]))),_:1},8,["disabled"])])])),_:1},8,["modelValue","onClose"])])}]]);export{ge as default};
