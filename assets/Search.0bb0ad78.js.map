{"version":3,"file":"Search.0bb0ad78.js","sources":["../../src/components/Invoice/Device/Search.vue"],"sourcesContent":["<template>\n  <!--  <Tab view=\"smooth\" :items=\"tab\" />-->\n  <div class=\"flex flex-col md:flex-row mb-6\">\n    <div class=\"flex-grow md:mr-3 md:mb-0 mb-3\">\n      <Input ref=\"refSearch\" autofocus=\"true\" v-model=\"data.search\" placeholder=\"Search by Name, or IMEI/Serial Number\" class=\"w-full\" icon>\n        <template #icon>\n          <span class=\"material-icons\">search</span>\n        </template>\n      </Input>\n    </div>\n  </div>\n  <Table class=\"mb-6\" :data=\"state.data\" ref=\"refTable\" @row-click=\"rowClick\" @select=\"choose\" @select-all=\"choose\" v-loading=\"loading\">\n<!--    <TableColumn type=\"selection\" width=\"55\" />-->\n    <TableColumn prop=\"name\" label=\"Name\" />\n    <TableColumn prop=\"condition\" label=\"Condition\" />\n    <TableColumn prop=\"imei_sn\" label=\"Imei/Serial Number\" />\n<!--    <TableColumn prop=\"select\" label=\"Action\">-->\n<!--      <template #default=\"scope\">-->\n<!--        <Button view=\"smooth\" color=\"green\" @click=\"$emit('choose', scope.row)\" dense>Choose</Button>-->\n<!--      </template>-->\n<!--    </TableColumn>-->\n  </Table>\n  <Pagination v-model:page=\"data.page\" v-model:limit=\"data.limit\" :data=\"state\" />\n</template>\n\n<script>\nimport { defineComponent, ref, watch } from 'vue'\nimport { useShowItemsCreate } from 'composable/invoice'\nimport Tab from 'bbUi/components/tab/tab.vue'\nimport Button from 'bbUi/components/button/button.vue'\nimport Input from 'bbUi/components/input/input.vue'\nimport Pagination from 'components/Pagination.vue'\nimport debounce from 'utils/debounce'\n\nexport default defineComponent({\n  components: {\n    Tab,\n    Button,\n    Input,\n    Pagination\n  },\n  props: {\n    selected: {\n      type: Array,\n      default: () => ([])\n    },\n    data: {\n      type: Object,\n      default: () => ({\n        selected: []\n      })\n    }\n  },\n  emits: [\n    'choose',\n    'update:data',\n    'update:selected'\n  ],\n  async setup(props, { emit }) {\n    const refTable = ref(null)\n    const { data, state, loading, actionAll } = useShowItemsCreate('invoice')\n    const devices = []\n    const refSearch = ref(null)\n\n    const updateData = (selectedDevice) => {\n      const index = devices.findIndex(item => item.id === selectedDevice.id)\n      if(index === -1) devices.push(selectedDevice)\n      else devices.splice(index, 1)\n\n      emit('update:data', {\n        selected: devices\n      })\n      emit('update:selected', devices)\n    }\n    const choose = (selection, row) => {\n      emit('choose', row)\n      updateData(row)\n    }\n    const rowClick = (row) => {\n      emit('choose', row)\n      devices.push(row)\n    }\n\n    watch(() => ({\n      limit: data.limit,\n      search: data.search\n    }), () => {\n      data.page = 1\n    }, {\n      deep: true\n    })\n    watch(data, debounce(async () => {\n      await actionAll()\n      if(props.selected.length > 0) state.value.data.forEach(item => {\n        const filtered = props.selected.map(item => item.id)\n        if(filtered.includes(item.id)) refTable.value.toggleRowSelection(item)\n      })\n      refSearch.value.focus()\n    }, 500), {\n      immediate: true\n    })\n\n    return {\n      data,\n      state,\n      loading,\n      refTable,\n      choose,\n      rowClick,\n      refSearch\n    }\n  }\n})\n</script>"],"names":["_sfc_main","defineComponent","components","Tab","Button","Input","Pagination","props","selected","type","Array","default","data","Object","emits","[object Object]","emit","refTable","ref","state","loading","actionAll","useShowItemsCreate","devices","refSearch","watch","limit","search","page","deep","debounce","async","length","value","forEach","item","map","item2","id","includes","toggleRowSelection","focus","immediate","choose","selection","row","selectedDevice","index","findIndex","push","splice","updateData","rowClick","_hoisted_1","class","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_hoisted_2","_createVNode","_component_Input","autofocus","modelValue","_ctx","onUpdate:modelValue","_cache","$event","placeholder","icon","_withCtx","_withDirectives","_createBlock","_component_Table","onRowClick","onSelect","_component_TableColumn","prop","_component_Pagination","onUpdate:page","onUpdate:limit"],"mappings":"mRAkCA,MAAKA,EAAaC,EAAa,CAC7BC,WAAY,CACVC,IAAAA,EACAC,OAAAA,QACAC,EACAC,WAAAA,GAEFC,MAAO,CACLC,SAAU,CACRC,KAAMC,MACNC,QAAS,IAAO,IAElBC,KAAM,CACJH,KAAMI,OACNF,QAAS,KAAO,CACdH,SAAU,OAIhBM,MAAO,CACL,SACA,cACA,mBAEIC,YAAMR,GAAOS,KAAEA,IACnB,MAAMC,EAAWC,EAAI,OACfN,KAAEA,EAAAO,MAAMA,EAAOC,QAAAA,EAAAC,UAASA,GAAcC,EAAmB,WACzDC,EAAU,GACVC,EAAYN,EAAI,MAwCf,OAnBPO,GAAM,KAAO,CACXC,MAAOd,EAAKc,MACZC,OAAQf,EAAKe,WACX,KACFf,EAAKgB,KAAO,IACX,CACDC,MAAM,IAEFJ,EAAAb,EAAMkB,GAASC,gBACbV,IACHd,EAAMC,SAASwB,OAAS,GAASb,EAAAc,MAAMrB,KAAKsB,SAAgBC,IAC5C5B,EAAMC,SAAS4B,QAAYC,EAAKC,KACrCC,SAASJ,EAAKG,KAAKrB,EAASgB,MAAMO,mBAAmBL,MAEnEX,EAAUS,MAAMQ,UACf,KAAM,CACPC,WAAW,IAGN,CACL9B,KAAAA,EACAO,MAAAA,EACAC,QAAAA,EACAH,SAAAA,EACA0B,OAjCa,CAACC,EAAWC,KACzB7B,EAAK,SAAU6B,GAXE,CAACC,IAClB,MAAMC,EAAQxB,EAAQyB,WAAkBb,GAAAA,EAAKG,KAAOQ,EAAeR,MACtD,IAAVS,EAAcxB,EAAQ0B,KAAKH,GACzBvB,EAAQ2B,OAAOH,EAAO,GAE3B/B,EAAK,cAAe,CAClBR,SAAUe,IAEZP,EAAK,kBAAmBO,IAIb4B,CAAAN,IAgCXO,SA9BgBP,IAChB7B,EAAK,SAAU6B,GACftB,EAAQ0B,KAAKJ,IA6BbrB,UAAAA,MA1GG6B,EAAA,CAAAC,MAAM,4MADbC,OAAAA,IAQMC,EAAAC,EAAA,KAAA,CAPJC,EAAA,QAMM,GADI,MAAAC,EAAA,CAJDC,EAAeC,EAAA,CAAC3C,IAAA,YAA0B4C,UAAA,OAAAC,WAAAC,EAAApD,KAAAe,OAAasC,sBAAmDC,EAAA,KAAAA,EAAA,GAAAC,GAAAH,EAAApD,KAAAe,OAAAwC,GAACC,YAAc,wCAACd,MAAI,kBACxH,CACTe,KAAAC,GAAA,IAAAJ,EAAM,OAAM,GAAA,+EAKbK,GAAYC,IAAAA,EAAAC,EAAA,CAAEnB,MAAW,OAAO1C,KAAcoD,EAAA7C,MAAAP,KAAEM,IAAA,WAAsBwD,WAAcV,EAAAZ,SAAGuB,SAAAX,EAAkBrB,sCAEtE2B,GAAA,IAAA,CAA3BV,EAAWgB,EAAA,CAACC,2BACZjB,EAAgBgB,EAAA,CAACC,qCACjBjB,EAAcgB,EAAA,CAACC,2EAJsG,WAAA,iBAAA,mBAWtGC,EAAK,CAATlD,KAAAoC,EAAApD,KAAAgB,KAAmBmD,gBAAYb,EAAK,KAAAA,EAAA,GAAAC,GAAAH,EAAApD,KAAAgB,KAAAuC,GAAVzC,MAAAsC,EAAApD,KAAAc,MAAasD,iBAAWd,EAAA,KAAAA,EAAA,GAAAC,GAAAH,EAAApD,KAAAc,MAAAyC"}