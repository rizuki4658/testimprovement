var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(a,l,i)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[l]=i,o=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&s(e,l,a[l]);if(i)for(var l of i(a))n.call(a,l)&&s(e,l,a[l]);return e},d=(e,i)=>a(e,l(i));import{e as u}from"./bulkquote.d18fd3c5.js";import{j as r,k as p,N as c,f as m,g,y as v,_ as h,m as _,$ as b,o as f,t as y,n as k,w as S,A as w,I as x,a1 as C,a2 as L,B as I,F as V,D as N,K as U,U as $,S as O,W as j,s as q,T,L as B,ap as A,a4 as K,r as P,a5 as D}from"./vendor.9695fe57.js";import{z as Q,d as F,b as M,_ as W,R as z,t as E,W as R,f as H,a9 as G,S as Y,g as J,j as X}from"./index.6438e939.js";import{g as Z}from"./buyback.cda0d82b.js";import{u as ee}from"./notes.04c74527.js";import{_ as ae}from"./fieldset.85092f83.js";import{_ as le}from"./BuybackNotesWarning.bad7ef2a.js";import{B as ie}from"./BTable.08f01735.js";import{u as te}from"./index.f40e4a9e.js";import{c as ne,r as se,f as oe,g as de}from"./index.6b6f6369.js";import{r as ue,v as re}from"./index.54844a74.js";import{I as pe}from"./InputPhone.a6e71a14.js";import{c as ce}from"./copy.6c996115.js";import{d as me}from"./setting.1af98a84.js";const ge=r("buybackShipping",{state:()=>({shippingInfo:{isLoading:!1,modal:!1,result:void 0,controller:null},additionalShipping:{isLoading:!1,modal:!1,result:void 0},shippingKit:{isLoading:!1,modal:!1,result:void 0}}),actions:{async $createMultipleLabels(e={id:void 0,data:void 0}){const a=await Q({url:`/v1/pos/order/shipping-label/generate-multiple/${e.id}`,method:"post",data:e.data});this.additionalShipping.result=a},async $actionCheckCustomTracking(e){var a,l,i,t;return await Q({url:`/v1/pos/order/custom-tracking/check-courier?shipping_tracking=${e.number}`,method:"get",signal:null!=(t=null==(a=null==e?void 0:e.controller)?void 0:a.signal)?t:null==(i=null==(l=this.shippingInfo)?void 0:l.controller)?void 0:i.signal})},$actionSaveCustomTracking:async e=>await Q({url:`/v1/pos/order/custom-tracking/${e.id}`,method:"post",data:e.data}),$downloadShippingKit:async(e={id:void 0,params:void 0})=>await Q({url:`/v1/shipping/kit/print/${e.id}`,method:"get",params:e.params,responseType:"arraybuffer"}),$downloadBulkShippingKit:async(e={id:void 0,params:void 0})=>await Q({url:`/v1/pos/order/shipping-label/print-batch/${e.id}`,method:"post",params:e.params,responseType:"arraybuffer"})}}),ve=p({name:"BulkQuoteDetailFormStatus",components:{Modal:F,Button:M,Fieldset:ae,BuybackNotesWarning:le},props:{modelValue:{type:Boolean,default:!1},quoteId:{type:String,default:void 0,required:!0},status:{type:Object,default:void 0},order:{type:Object,default:void 0}},emits:["update:modelValue","updateStatus"],setup(e,a){const l=ee(),i=c(),t=m(!1),n=m(!1),s=g({get:()=>e.modelValue,set:e=>a.emit("update:modelValue",e)}),u=m(!1),r=m(0),p=m([]),_=m(void 0),b=g((()=>{var a;return 0!==(null==(a=null==e?void 0:e.order)?void 0:a.is_signature_exist)})),f=m(!1),y=m(!1),k=m(!1),{state:S,actionAll:w}=Z("online"),x=async()=>{var s,o;if(n.value=!0,t.value=!0,[3,7].includes(null==(s=_.value)?void 0:s.id)&&(l.warningNotes.ids=[null==(o=e.order)?void 0:o.id],!l.warningNotes.isReviewed&&await l.$getNotesUnread(),l.warningNotes.notes.length))return l.warningNotes.modal=!0,t.value=!1,void(n.value=!1);await i.dispatch("bulkQuote/updateQuoteStatus",{id:e.quoteId,data:{status_id:_.value.id,new_step:_.value.step_bulk}}).then((()=>{n.value=!1,t.value=!1,u.value=!1,h({message:"Quote status updated successfully.",type:"success"}),a.emit("updateStatus",!0)})).catch((()=>{n.value=!1,t.value=!1,u.value=!1})),k.value&&callback&&callback()};return v((()=>s.value),(async()=>{s.value?await(async()=>{t.value=!0,n.value=!0;try{const[a,l]=await Promise.all([i.dispatch("bulkQuote/getQuoteStatuses"),i.dispatch("bulkQuote/getBulkQuoteItemInfo",{id:e.quoteId})]);(null==a?void 0:a.length)?(p.value=a.map((a=>{var l,i;return d(o({},a),{disabled:!![9e3,9001].includes(null==(l=e.status)?void 0:l.id)&&![9e3,9001].includes(a.id),active:a.id===(null==(i=e.status)?void 0:i.id)})})),_.value=p.value.find((a=>{var l;return a.id===(null==(l=e.status)?void 0:l.id)}))):(p.value=[],_.value=void 0),f.value=(null==l?void 0:l.total_reconcile)>0}catch{p.value=[],_.value=void 0}finally{t.value=!1,n.value=!1}})():p.value=[]})),{show:s,selected:_,showWarning:u,warningType:r,loading:t,loadingUpdate:n,listStatus:p,isSignedContract:b,reviewed:y,showNotesWarning:k,notes:S,showNotes:w,handleSave:()=>{var a,l,i,t,n,s,o,d,c,m,g,v,h,y,k;if((null==(a=_.value)?void 0:a.id)===(null==(l=e.status)?void 0:l.id)||!e.quoteId)return;if(9001===(null==(i=e.status)?void 0:i.id)&&9e3===(null==(t=_.value)?void 0:t.id)||9e3===(null==(n=e.status)?void 0:n.id)&&9001===(null==(s=_.value)?void 0:s.id))return r.value=9e3===(null==(o=e.status)?void 0:o.id)&&9001===(null==(d=_.value)?void 0:d.id)?0:1,void(u.value=!0);if(f.value&&[9003,9004].includes(null==(c=e.status)?void 0:c.id)&&[9e3,9001,9002,2].includes(null==(m=_.value)?void 0:m.id))return r.value=1,void(u.value=!0);if(b&&9e3!==(null==(g=_.value)?void 0:g.id)&&9001!==(null==(v=_.value)?void 0:v.id))return void x();const S=[...p.value].slice(0,p.value.findIndex((a=>{var l;return a.id===(null==(l=e.status)?void 0:l.id)}))).some((e=>{var a;return e.id===(null==(a=_.value)?void 0:a.id)}))&&(null==(h=e.order)?void 0:h.is_signature_exist)||[9004,3].includes(null==(y=e.status)?void 0:y.id)&&![9004,3].includes(null==(k=_.value)?void 0:k.id);r.value=S?0:1,u.value=!0},handleCancelUpdate:()=>{u.value=!1,r.value=0},handleUpdateStatus:x,handleSelectStatus:e=>{e.active||e.disabled||(_.value=e,p.value=p.value.map((e=>d(o({},e),{active:_.value.id===e.id}))))}}}}),he={key:0,class:"border-grey-01 border"},_e=["onClick"],be={key:0,class:"my-0 border-grey-01"},fe={class:"flex items-center justify-end"},ye={key:0,class:"flex flex-col gap-6 items-center my-6"},ke={class:"flex flex-wrap items-center justify-center gap-14"},Se={key:1,class:"flex flex-col gap-6 items-center my-6"},we={class:"flex flex-wrap items-center justify-center gap-14"};const xe=p({name:"BulkQuoteDetailStatus",components:{Button:M,BulkQuoteDetailFormStatus:W(ve,[["render",function(e,a,l,i,t,n){const s=_("Tooltip"),o=_("Fieldset"),d=_("Button"),u=_("Modal"),r=_("BuybackNotesWarning"),p=b("loading");return f(),y("div",null,[e.showWarning?$("",!0):(f(),k(u,{key:0,modelValue:e.show,"onUpdate:modelValue":a[0]||(a[0]=a=>e.show=a),title:"Update Status",size:"xs",class:""},{default:S((()=>[w((f(),k(o,{class:"rounded-md"},{label:S((()=>a[4]||(a[4]=[x("Choose Status")]))),default:S((()=>{var l;return[(null==(l=e.listStatus)?void 0:l.length)?(f(),y("ul",he,[(f(!0),y(C,null,L(e.listStatus,((l,i)=>(f(),y("li",{key:i},[I("div",{class:V(["px-2 py-1.5 text-center",!l.disabled&&!l.active&&!e.loadingUpdate&&"hover:bg-teal-01 hover:bg-opacity-50 cursor-pointer text-grey-02",!l.disabled&&!!l.active&&!e.loadingUpdate&&"bg-teal-02 bg-opacity-40 cursor-pointer",(!!l.disabled||!!e.loadingUpdate)&&"bg-teal-01 bg-opacity-30 cursor-not-allowed text-grey-01"]),onClick:a=>e.handleSelectStatus(l)},[N(s,{placement:"top",disabled:!l.disabled},{content:S((()=>a[5]||(a[5]=[I("div",null,[I("p",null,"Quote must be signed first to unlock this status")],-1)]))),default:S((()=>[I("p",null,U(l.status_name),1)])),_:2},1032,["disabled"])],10,_e),i!==e.listStatus.length-1?(f(),y("hr",be)):$("",!0)])))),128))])):$("",!0)]})),_:1})),[[p,e.loading]])])),footer:S((()=>{var l,i;return[I("div",fe,[N(d,{color:"teal",disabled:!e.selected||(null==(l=e.selected)?void 0:l.id)==(null==(i=e.status)?void 0:i.id),loading:e.loadingUpdate,onClick:e.handleSave},{default:S((()=>a[6]||(a[6]=[x(" Update Status ")]))),_:1},8,["disabled","loading","onClick"])])]})),_:1},8,["modelValue"])),N(u,{modelValue:e.showWarning,"onUpdate:modelValue":a[3]||(a[3]=a=>e.showWarning=a),class:V(e.showNotesWarning&&"hidden"),size:"xs","hide-header":"","hide-footer":""},{default:S((()=>[0==e.warningType?(f(),y("div",ye,[a[8]||(a[8]=I("img",{src:z},null,-1)),a[9]||(a[9]=I("h6",{class:"text-3xl font-medium"},"Proceed With Quote?",-1)),a[10]||(a[10]=I("p",{class:"text-grey-02 text-center"}," Ensure the payout is correct, then make sure to send the Customer Portal link to the customer for contract access and review. ",-1)),I("div",ke,[I("a",{href:"",onClick:a[1]||(a[1]=O(((...a)=>e.handleCancelUpdate&&e.handleCancelUpdate(...a)),["prevent"])),class:"px-6 py-4 hover:text-teal-03"}," Cancel "),N(d,{loading:e.loading,color:"teal",onClick:e.handleUpdateStatus},{default:S((()=>a[7]||(a[7]=[x(" Yes, proceed ")]))),_:1},8,["loading","onClick"])])])):$("",!0),1==e.warningType?(f(),y("div",Se,[a[12]||(a[12]=I("img",{src:z},null,-1)),a[13]||(a[13]=I("h6",{class:"text-3xl font-medium"},"Change Status?",-1)),a[14]||(a[14]=I("p",{class:"text-grey-02 text-center"}," Your reconciled quantity will be reset to the original quoted quantity. ",-1)),I("div",we,[N(d,{loading:e.loading,color:"teal",onClick:e.handleUpdateStatus},{default:S((()=>a[11]||(a[11]=[x(" Yes, change status ")]))),_:1},8,["loading","onClick"]),I("a",{href:"",onClick:a[2]||(a[2]=O(((...a)=>e.handleCancelUpdate&&e.handleCancelUpdate(...a)),["prevent"])),class:"px-6 py-4 hover:text-teal-03"}," Cancel ")])])):$("",!0)])),_:1},8,["modelValue","class"]),N(r,{onProceed:e.handleUpdateStatus},null,8,["onProceed"])])}]])},props:{status:{type:Object,default:()=>({id:null,name:null,short_name:null})},statusNameKey:{type:String,default:"name"},statusShortNameKey:{type:String,default:"short_name"},statusIdKey:{type:String,default:"id"},loading:{type:Boolean,default:!1},quoteId:{type:String,required:!0},disabled:{type:Boolean,default:!1},order:{type:Object,default:void 0}},emits:["updateStatus"],setup(e,{emit:a}){const{statuses:l,loading:i,getQuoteStatuses:t,updateQuoteStatus:n}=u(),s=m(!1),o=g((()=>({id:e.status[e.statusIdKey]||"",name:e.status[e.statusNameKey]||"Quote Status",short_name:e.status[e.statusShortNameKey]||"Quote Status"})));return j((async()=>{await t()})),{modalFormUpdateStatus:s,currentStatus:o,loadingQuoteStatus:i,handleUpdateStatus:async(e=!1)=>{s.value=!0},handleConfirmUpdateStatus:()=>{s.value=!1,a("updateStatus",!0)}}}}),Ce={class:"flex flex-wrap items-center gap-4"},Le={class:"quote-status"},Ie={class:"quote-status__status"},Ve={class:"quote-status__status-badge"},Ne={class:"block"},Ue=["disabled"];var $e=W(xe,[["render",function(e,a,l,i,t,n){const s=_("BulkQuoteDetailFormStatus"),o=b("loading");return f(),y("div",null,[I("div",Ce,[a[3]||(a[3]=I("label",{class:"font-medium"},"Status:",-1)),w((f(),y("div",Le,[I("div",Ie,[I("div",Ve,[I("span",Ne,U(e.currentStatus.short_name),1)])]),I("button",{class:V(["quote-status__action",e.disabled&&"quote-status__action--disabled"]),onClick:a[0]||(a[0]=(...a)=>e.handleUpdateStatus&&e.handleUpdateStatus(...a)),disabled:e.disabled,tabindex:"0"},a[2]||(a[2]=[I("i",{class:"material-icons"},"edit",-1)]),10,Ue)])),[[o,e.loadingQuoteStatus||e.loading]])]),N(s,{modelValue:e.modalFormUpdateStatus,"onUpdate:modelValue":a[1]||(a[1]=a=>e.modalFormUpdateStatus=a),quoteId:e.quoteId,status:e.currentStatus,order:e.order,onUpdateStatus:e.handleConfirmUpdateStatus},null,8,["modelValue","quoteId","status","order","onUpdateStatus"])])}],["__scopeId","data-v-6eb997e4"]]);const Oe={class:"space-y-4"},je={key:0,class:"flex-width"},qe={key:1,class:"flex-width",style:{"min-width":"80px"}},Te={key:0},Be={key:0},Ae={key:1},Ke={key:1,class:"w-10"},Pe=["onClick"],De=["onMouseenter","onMouseleave"],Qe={__name:"BuybackShippingKitDownload",props:{id:"-",shippings:{type:Array,default:()=>[]}},setup(e){const a=c(),l=ge(),i=e,t=m([]),n=m([{key:"order_shipping_label",column_name:"Label",meta:{}},{key:"shipping_tracking",column_name:"Tracking Number",meta:{}},{key:"shipping_label_status",column_name:"Label Status",meta:{}},{key:"action",column_name:"",meta:{}}]),s=g((()=>{var e;return null!=(e=null==i?void 0:i.shippings)?e:[]}));v(s,(e=>{e&&e.length>0&&q((()=>{t.value=[...e]}))}),{immediate:!0}),v((()=>l.shippingKit.modal),(e=>{e&&s.value.length>0&&q((()=>{t.value=[...s.value]}))}));const o=g((()=>{var e,l,i;return null==(i=null==(l=null==(e=a.state)?void 0:e.shipping)?void 0:l.processing)?void 0:i.loadingDownload})),d=()=>{l.shippingKit.modal=!1},u=async()=>{await E(l.shippingKit,(async()=>{await l.$downloadBulkShippingKit({id:i.id,params:{order_shipping_label_id:s.value.map((e=>e.order_shipping_label))}}).then((()=>{h({message:"Download in progress... Feel free to navigate away or close the window",type:"info"}),a.dispatch("notification/closeNotification","NotificationShippingKitDownload",{root:!0}),a.commit("shipping/SET_PROCESSING_DOWNLOAD_SHIPPING_KIT_PROGRESS",{progress:1,path:null,type:"zip",loading:!0},{root:!0}),a.commit("notification/OPEN_NOTIFICATION","NotificationShippingKitDownload",{root:!0}),a.commit("notification/SET_NOTIFICATION_CLOSABLE",{name:"NotificationShippingKitDownload",closable:!1},{root:!0})}))}))};return(e,a)=>{const r=b("loading");return f(),k(K,{to:"body"},[N(F,{modelValue:A(l).shippingKit.modal,"onUpdate:modelValue":a[1]||(a[1]=e=>A(l).shippingKit.modal=e),size:"md","hide-footer":"",onClose:d},{header:S((()=>a[2]||(a[2]=[I("h5",{class:"text-2xl font-medium"}," Shipping Kit Download ",-1)]))),default:S((()=>[w((f(),y("div",Oe,[N(T,{name:"fade"},{default:S((()=>{var e;return[w(N(M,{view:"outlined",color:"teal",dense:"",onClick:u},{default:S((()=>a[3]||(a[3]=[I("div",{class:"flex items-center justify-center gap-x-4"},[I("span",{class:"material-icons"}," print "),I("span",null,"Bulk Download Shipping Kit")],-1)]))),_:1},512),[[B,((null==(e=t.value)?void 0:e.length)||0)>1]])]})),_:1}),N(ie,{selected:t.value,"onUpdate:selected":a[0]||(a[0]=e=>t.value=e),headers:n.value,items:s.value,"item-value":"order_shipping_label",selectable:s.value.length>1},{header:S((({header:e})=>["action"!==e.key?(f(),y("th",je,U(e.column_name),1)):(f(),y("th",qe,U(e.column_name),1))])),column:S((({row:e,key:t,preventRowClick:n,resetRowClick:s})=>["shipping_label_status"===t?(f(),y("td",Te,[(null==e?void 0:e.shipping_tracking)?(f(),y("span",Be,U("Available"))):(f(),y("span",Ae,U("Unavailable")))])):"action"===t?(f(),y("td",Ke,[I("a",{class:V(o.value?"opacity-50 cursor-not-allowed":"opacity-100"),color:"white",onClick:O((a=>(async e=>{await E(l.shippingKit,(async()=>{await l.$downloadShippingKit({id:i.id,params:{order_shipping_label_id:e.order_shipping_label}}).then((e=>{R(e)}))}))})(e)),["prevent"])},a[4]||(a[4]=[I("span",{class:"material-icons"}," print ",-1)]),10,Pe)])):(f(),y("td",{key:2,onMouseenter:n,onMouseleave:s},U(e[t]),41,De))])),_:1},8,["selected","headers","items","selectable"])])),[[r,A(l).shippingKit.isLoading]])])),_:1},8,["modelValue"])])}}};var Fe="/assets/show-original.c4e04b0d.svg";const Me=p({name:"ShippingLabelInfo",components:{Input:H,InputPhone:pe},props:{data:{type:Object,default:()=>({shipping_firstname:null,shipping_lastname:null,shipping_address1:null,shipping_suite:"",shipping_city:null,shipping_country:null,shipping_state:null,shipping_zip:null,shipping_phone:null,shipping_address_text:null,company_name:null,custom_fields:null})},isEasyOffer:{type:Boolean,default:!1}},emits:["update:data"],setup(e,{emit:a}){const l=P(e.data),i=m(null);Object.assign(l,{valid:l.shipping_address_text&&""!==l.shipping_address_text&&null!==l.shipping_address_text});const t={shipping_firstname:{required:ue},shipping_lastname:{required:ue},shipping_phone:{required:ue,invalidNumber:ne.withMessage("Phone number is invalid",(()=>{var e;return!l.shipping_phone||(null==(e=i.value)?void 0:e.isValid)}))},valid:{sameAs:re}},n=te(t,l,{$lazy:!0});return v((()=>o({},l)),(()=>{a("update:data",l)})),{phoneNumber:G,data:l,refInputPhone:i,validation:n,validate:()=>(n.value.$validate(),!n.value.$invalid),address:{valid:"valid",route:"shipping_address1",locality:"shipping_city",administrative_area_level_1:"shipping_state",formatted_address:"shipping_address_text",postal_code:"shipping_zip",country:"shipping_country",disallowCustomAddress:!0,subpremise:"shipping_suite"}}}}),We={class:"grid grid-cols-2 gap-6"},ze={key:0,class:"col-span-2"},Ee={class:"col-span-2"},Re={class:"col-span-2"},He={class:"col-span-2"};var Ge=W(Me,[["render",function(e,a,l,i,t,n){const s=_("Input"),o=_("InputPhone"),d=b("gmap");return f(),y("div",We,[I("div",null,[N(s,{modelValue:e.data.shipping_firstname,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.shipping_firstname=a),label:"First Name",block:"",view:e.validation.shipping_firstname.$invalid?"danger":"default"},null,8,["modelValue","view"]),(f(!0),y(C,null,L(e.validation.shipping_firstname.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},U(e.$message)+". ",1)))),128))]),I("div",null,[N(s,{modelValue:e.data.shipping_lastname,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.shipping_lastname=a),label:"Last Name",block:""},null,8,["modelValue"]),(f(!0),y(C,null,L(e.validation.shipping_lastname.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},U(e.$message)+". ",1)))),128))]),e.isEasyOffer?(f(),y("div",ze,[N(s,{modelValue:e.data.company_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.company_name=a),label:"Company Name",block:""},null,8,["modelValue"])])):$("",!0),I("div",Ee,[w(N(s,{modelValue:e.data.shipping_address_text,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.shipping_address_text=a),label:"Street Address",block:""},null,8,["modelValue"]),[[d,e.address]]),a[6]||(a[6]=I("small",null,"Street address, P.O box, company name, c/o.",-1)),(f(!0),y(C,null,L(e.validation.valid.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},U(e.$message)+". ",1)))),128))]),I("div",Re,[N(s,{modelValue:e.data.shipping_suite,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.shipping_suite=a),block:""},null,8,["modelValue"]),a[7]||(a[7]=I("small",null,"Apartment, suite, unit, building, floor, etc.",-1))]),I("div",He,[N(o,{ref:"refInputPhone",modelValue:e.data.shipping_phone,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.shipping_phone=a),label:"Phone",block:"","country-autofill-setting":""},null,8,["modelValue"]),(f(!0),y(C,null,L(e.validation.shipping_phone.$errors,((e,a)=>(f(),y("small",{class:"text-red-base block",key:a},U(e.$message)+". ",1)))),128))]),e.data.custom_fields&&e.isEasyOffer?(f(!0),y(C,{key:1},L(Object.entries(e.data.custom_fields),(([a,l])=>(f(),y("div",{key:a,class:"col-span-2"},[N(s,{modelValue:e.data.custom_fields[a],"onUpdate:modelValue":l=>e.data.custom_fields[a]=l,label:a,block:""},null,8,["modelValue","onUpdate:modelValue","label"])])))),128)):$("",!0)])}]]);const Ye={key:0,class:"border border-grey-01 rounded-xl p-6 w-full mb-6"},Je={key:1},Xe={class:"space-y-4"},Ze=["id"],ea={class:"flex items-center justify-between"},aa={class:"flex items-center justify-end gap-2"},la={class:"flex items-start gap-4"},ia={key:0,class:"flex-1 flex items-end gap-x-1"},ta={class:"flex-1"},na={key:1,class:"flex-1"},sa={key:0,class:"px-6 py-4"},oa={class:"flex justify-between"},da={class:"text-grey-02"},ua={class:"text-grey-02"},ra={class:"text-grey-02"},pa={key:2},ca={class:"bg-grey-01 bg-opacity-20 h-52 rounded-xl flex items-center justify-center"},ma={key:0,class:"text-grey-02"},ga={key:1,class:"text-grey-02"},va={class:"flex items-center justify-start"},ha={key:0},_a={key:1},ba={__name:"BuybackShippingInformation",props:{id:"-",statusOffer:{type:[Number,String],default:void 0},offerType:{type:String,default:"Mail-In"},shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},regenerateShippingLabel:{type:Function,default:()=>{}}},emits:["saved"],setup(e,{emit:a}){const l=ge(),i=e,t=a,n=me(),s=m({}),u=m(i.shippings),r=m({is_enable_multiple_shipping:0,label_qty:1}),p=m(0),c=m(!1),V=g((()=>{var e,a;return!(null==(a={default:[]}[null!=(e=null==i?void 0:i.offerType)?e:"default"])?void 0:a.includes(i.statusOffer))})),O=g((()=>V.value)),j=g((()=>{var e,a,l,t;return Number(null!=(a=null==(e=r.value)?void 0:e.label_qty)?a:1)-Number(null!=(t=null==(l=i.shippings)?void 0:l.length)?t:1)-Number(p.value)})),T=()=>{l.shippingInfo.modal=!1,s.value={},u.value={},p.value=0,r.value={is_enable_multiple_shipping:0,label_qty:1}},B=g((()=>["2"].includes(i.shippingLabelStatus))),K=()=>{var e,a;u.value=null!=(a=null==(e=i.shippings)?void 0:e.map((e=>d(o({},e),{couriers:[],courier_code:null,courier_name:null,setCourrier:!1,isLoading:!1}))))?a:[]},P=async e=>{var a;let i=[];return e.controller&&(null==(a=e.controller)||a.abort()),e.controller=new AbortController,await E(e,(()=>l.$actionCheckCustomTracking({number:null==e?void 0:e.custom_tracking,controller:null==e?void 0:e.controller}).then((a=>{i=a,(null==i?void 0:i.message)&&h({message:`The value of ${e.custom_tracking} is invalid`,type:"warning"})})))),Array.isArray(i)?i:[]},D=async()=>{await q();const e=document.querySelector(`#shipping-label-${u.value.length}`);await q(),e&&e.scrollIntoView({behavior:"smooth"})},Q=async()=>{j.value<=0||(p.value=p.value+1,u.value.push({order_shipping_label:null,created_at:null,shipping_tracking:null,custom_tracking:"",couriers:[],courier_code:null,courier_name:null,setCourrier:!1,isLoading:!1,controller:null}),await D())},W=J((async e=>{var a,l,i,t;return(null==e?void 0:e.setCourrier)?(e.isLoading=!0,e.courier_code=null,e.courier_name=null,e.couriers=await P(e),e.courier_code=null!=(l=null==(a=e.couriers[0])?void 0:a.courier_code)?l:null,e.courier_name=null!=(t=null==(i=e.couriers[0])?void 0:i.courier_name)?t:null,e.isLoading=!1,e):e}),300),z=async e=>{c.value=!0;const a={id:i.id,data:d(o({},(null==e?void 0:e.order_shipping_label)&&{order_shipping_label_id:e.order_shipping_label}),{shipping_tracking:e.custom_tracking,courier_code:null==e?void 0:e.courier_code,courier_name:null==e?void 0:e.courier_name,force_courier_code:0})};await E(e,(()=>l.$actionSaveCustomTracking(a).then((()=>{t("saved"),c.value=!1}))))};return v((()=>i.shippings),(async e=>{e&&e.length>0&&(await q(),K())}),{deep:!0,immediate:!0}),v((()=>l.shippingInfo.modal),(async()=>{l.shippingInfo.modal?(await(async()=>{l.shippingInfo.isLoading=!0,await n.actionAll(!0,(e=>{var a,l,t,n,s;const u=null!=(l=null==(a=e.param)?void 0:a.shipping_rules_multiple_label)?l:[];if(u.length){const a=u.find((e=>e.offer_type===i.offerType));r.value=d(o({},null!=a?a:{}),{is_enable_multiple_label:Number(null!=(n=null==(t=null==e?void 0:e.param)?void 0:t.is_enable_multiple_label)?n:0),label_qty:null!=(s=Number(null==a?void 0:a.label_qty))?s:1})}else r.value={is_enable_multiple_label:0,label_qty:1}})),l.shippingInfo.isLoading=!1})(),K()):u.value=[]})),(a,i)=>{const t=_("Tooltip"),n=b("loading");return f(),k(F,{modelValue:A(l).shippingInfo.modal,"onUpdate:modelValue":i[0]||(i[0]=e=>A(l).shippingInfo.modal=e),size:"md","hide-footer":!O.value,onClose:T},{header:S((()=>i[1]||(i[1]=[I("h5",{class:"text-2xl font-medium"}," Shipping Information ",-1)]))),default:S((()=>{var a,t,s,o,d,r,m,g,v,h;return[B.value?w((f(),y("div",Ye,[i[3]||(i[3]=I("div",{class:"flex items-center gap-2 mb-4"},[I("i",{class:"material-icons text-red-base icon-md"},"warning"),I("p",{class:"text-2xl font-bold"},"Regenerate Shiping Label")],-1)),i[4]||(i[4]=I("p",null,"Shipping label fails to generates. Once the root cause is resolved, you can use this option to regenerate both the shipping label and shipping kit. Once regenerated, the new tracking number and shipping kit will be automatically attached to the offer. ",-1)),N(M,{class:"btn btn-teal btn-outlined mt-6",rounded:"",dense:"",onClick:e.regenerateShippingLabel},{default:S((()=>i[2]||(i[2]=[I("div",{class:"flex items-center gap-2 px-2 py-1"},[I("i",{class:"material-icons text-base"},"refresh"),I("span",{class:"font-medium"},"Regenerate Shiping Label")],-1)]))),_:1},8,["onClick"])])),[[n,null==(t=null==(a=A(l))?void 0:a.shippingInfo)?void 0:t.isLoading]]):$("",!0),(null==(s=u.value)?void 0:s.length)?w((f(),y("div",Je,[I("div",Xe,[(f(!0),y(C,null,L(u.value,((e,a)=>{var l;return w((f(),y("div",{key:a,id:`shipping-label-${a+1}`,class:"border border-grey-01 rounded-xl p-5 space-y-4"},[I("div",ea,[i[7]||(i[7]=I("h5",{class:"font-medium text-xl"},U("Shipping Label #"),-1)),I("div",aa,[N(M,{disabled:!(null==e?void 0:e.custom_tracking)||!(null==e?void 0:e.custom_tracking.length)||(null==e?void 0:e.custom_tracking)&&(null==e?void 0:e.setCourrier)&&!e.courier_code,loading:e.isLoading,view:"outlined",color:"teal",dense:"",onClick:a=>(async e=>{var a,l,i,t,n;e.isLoading=!0;try{if(e.setCourrier&&e.courier_code&&e.courier_name)return await z(e),void(e.isLoading=!1);e.couriers=await P(e),e.setCourrier=!0,e.courier_code=null,e.courier_name=null,1===(null==(a=e.couriers)?void 0:a.length)&&(e.courier_code=null!=(i=null==(l=e.couriers[0])?void 0:l.courier_code)?i:null,e.courier_name=null!=(n=null==(t=e.couriers[0])?void 0:t.courier_name)?n:null,await z(e))}catch(s){console.error("Failed to save courier:",s)}finally{e.isLoading=!1}})(e)},{default:S((()=>i[5]||(i[5]=[x(" Save ")]))),_:2},1032,["disabled","loading","onClick"]),e.order_shipping_label?$("",!0):(f(),k(M,{key:0,disabled:e.isLoading,view:"outlined",color:"red",dense:"",onClick:e=>(async e=>{u.value.splice(e,1),await q(),p.value=p.value-1,await D()})(a)},{default:S((()=>i[6]||(i[6]=[I("span",{class:"material-icons"},"close",-1)]))),_:2},1032,["disabled","onClick"]))])]),I("div",la,[(null==e?void 0:e.shipping_tracking)?(f(),y("div",ia,[N(H,{modelValue:e.shipping_tracking,"onUpdate:modelValue":a=>e.shipping_tracking=a,disabled:"",block:""},{label:S((()=>i[8]||(i[8]=[I("span",{class:"font-medium"}," Tracking Number ",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue"]),N(M,{color:"teal",view:"outlined",icon:"",class:"btn-action w-16",style:{paddingRight:0,paddingLeft:0},onClick:a=>A(ce)(null==e?void 0:e.shipping_tracking)},{default:S((()=>i[9]||(i[9]=[I("span",{class:"material-icons"},"content_copy",-1)]))),_:2},1032,["onClick"])])):$("",!0),I("div",ta,[N(H,{modelValue:e.custom_tracking,"onUpdate:modelValue":a=>e.custom_tracking=a,disabled:!(null==e?void 0:e.setCourrier)&&e.isLoading,block:"",onInput:a=>A(W)(e)},{label:S((()=>i[10]||(i[10]=[I("span",{class:"font-medium"}," Custom Tracking Number ",-1)]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onInput"])]),(null==e?void 0:e.setCourrier)?(f(),y("div",na,[i[12]||(i[12]=I("label",{class:"font-medium"},"Carrier",-1)),N(Y,{modelValue:e.courier_code,"onUpdate:modelValue":a=>e.courier_code=a,items:e.couriers,by:"courier_code",name:"courier_name",block:"","no-border":"",placeholder:"Choose Carrier",disabled:e.isLoading,style:{width:"100%",maxHeight:"80px"},onChange:a=>{return l=a,(i=e).courier_name=l.courier_name,i;var l,i}},{"default-option":S((()=>i[11]||(i[11]=[I("option",{class:"select__option",value:"",selected:""},"Choose the Carrier",-1)]))),sheet:S((()=>{var a;return[(null==(a=null==e?void 0:e.couriers)?void 0:a.length)?$("",!0):(f(),y("div",sa," There is No Carrier "))]})),_:2},1032,["modelValue","onUpdate:modelValue","items","disabled","onChange"])])):$("",!0)]),I("div",oa,[I("div",null,[i[13]||(i[13]=I("p",{class:"block font-medium"},"Date Created",-1)),I("span",da,U(null!=(l=null==e?void 0:e.created_at)?l:"-"),1)]),I("div",null,[i[14]||(i[14]=I("p",{class:"block font-medium"},"Label Status",-1)),I("span",ua,U(e.status?"Available":"Unavailable"),1)]),I("div",null,[i[15]||(i[15]=I("p",{class:"block font-medium"},"Shipment Status",-1)),I("span",ra,U(e.shipping_status_summary||"No Shipping Information"),1)])])],8,Ze)),[[n,c.value&&e.isLoading]])})),128))])])),[[n,A(l).shippingInfo.isLoading]]):$("",!0),(null==(o=u.value)?void 0:o.length)||B.value?$("",!0):w((f(),y("div",pa,[I("div",ca,[(null==(r=null==(d=A(l))?void 0:d.shippingInfo)?void 0:r.isLoading)?$("",!0):(f(),y("span",ma," Tracking Number is not available ")),(null==(g=null==(m=A(l))?void 0:m.shippingInfo)?void 0:g.isLoading)?(f(),y("span",ga," Please wait... ")):$("",!0)])])),[[n,null==(h=null==(v=A(l))?void 0:v.shippingInfo)?void 0:h.isLoading]])]})),footer:S((()=>[I("div",va,[N(t,{placement:"top",disabled:j.value>0},{content:S((()=>{var e;return[(null==(e=A(l))?void 0:e.shippingInfo.isLoading)?(f(),y("div",_a," Please wait... ")):(f(),y("div",ha," Has reached maximum limit "))]})),default:S((()=>{var e;return[I("div",null,[N(M,{disabled:j.value<=0||(null==(e=A(l))?void 0:e.shippingInfo.isLoading),view:"outlined",color:"teal",dense:"",onClick:Q},{default:S((()=>i[16]||(i[16]=[I("span",{class:"material-icons"},"add",-1),x(" Add Custom Tracking ")]))),_:1},8,["disabled"])])]})),_:1},8,["disabled"])])])),_:1},8,["modelValue","hide-footer"])}}},fa={class:"space-y-8"},ya={class:"space-y-6"},ka={key:0,class:"text-grey-02 text-xs"},Sa={key:1,class:"text-red-04 text-xs"},wa={key:0},xa={rows:"8",class:"block w-full border border-grey-01 rounded-md px-4 py-4 text-grey-02"},Ca={class:"space-y-6"},La={class:"space-y-2"},Ia={class:"flex items-center justify-between gap-4"},Va={__name:"BuybackShippingAdditional",props:{id:"-",total:0,statusOffer:{type:[Number,String],default:void 0},shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},offerType:{type:String,default:"Mail-In"}},emits:["created","failed"],setup(e,{emit:a}){const l=ge(),i=e,t=a,n=me(),s=P({add_shipping_label_number:1}),u=m({is_enable_multiple_label:0,label_qty:1}),r=g((()=>s.add_shipping_label_number>=4?3:s.add_shipping_label_number>1?s.add_shipping_label_number:1)),p=g((()=>{var e,a;return null!=(a=null==(e=null==i?void 0:i.shippings[0])?void 0:e.shipping_tracking)?a:"e.g., 10000000000000000"})),c=g((()=>{var e;const a=V.value<0,l=s.add_shipping_label_number<=0,i=0==(null==(e=u.value)?void 0:e.is_enable_multiple_label)&&s.add_shipping_label_number>1;return a||i||l})),_=g((()=>{var e,a,l,t;return(null!=(a=null==(e=null==u?void 0:u.value)?void 0:e.label_qty)?a:1)-(null!=(t=null==(l=i.shippings)?void 0:l.length)?t:1)})),b=g((()=>({add_shipping_label_number:{required:se,minValue:oe(1),maxValue:de(_.value)}}))),w=te(b,s,{$lazy:!0}),V=g((()=>_.value-s.add_shipping_label_number)),O=e=>{var a;const l=Number(null==(a=null==e?void 0:e.target)?void 0:a.value),i=Number(_.value);l<=0?s.add_shipping_label_number=1:l>i&&(s.add_shipping_label_number=i)},j=async()=>{await w.value.$validate()},q=()=>{s.add_shipping_label_number=1,l.additionalShipping.modal=!1,w.value.$reset()},T=async()=>{await w.value.$validate()&&await E(l.additionalShipping,(async()=>{await l.$createMultipleLabels({id:i.id,data:s}).then((()=>{var e,a;h({message:null==(a=null==(e=l.additionalShipping)?void 0:e.result)?void 0:a.message,type:"info"}),t("created"),q()})).catch((()=>{t("failed")}))}))};return v((()=>l.additionalShipping.modal),(async e=>{e&&(l.additionalShipping.isLoading=!0,await n.actionAll(!0,(e=>{var a,l,t,n,s;const r=null!=(l=null==(a=e.param)?void 0:a.shipping_rules_multiple_label)?l:[];if(r.length){const a=r.find((e=>e.offer_type===i.offerType));u.value=d(o({},null!=a?a:{}),{is_enable_multiple_label:Number(null!=(n=null==(t=null==e?void 0:e.param)?void 0:t.is_enable_multiple_label)?n:0),label_qty:null!=(s=Number(null==a?void 0:a.label_qty))?s:1})}else u.value={is_enable_multiple_label:0,label_qty:1}})),l.additionalShipping.isLoading=!1)})),(a,i)=>(f(),k(F,{modelValue:A(l).additionalShipping.modal,"onUpdate:modelValue":i[1]||(i[1]=e=>A(l).additionalShipping.modal=e),size:"xs",onClose:q},{header:S((()=>i[2]||(i[2]=[I("h5",{class:"text-2xl font-medium"}," Additional Shipping Info ",-1)]))),default:S((()=>{var a,t,n;return[I("div",fa,[N(X,{color:"blue",view:"smooth",dense:""},{default:S((()=>i[3]||(i[3]=[I("div",{class:"flex items-center gap-x-4"},[I("span",{class:"material-icons",style:{"line-height":"1"}},"info"),I("p",null,"Labels will be created using the first shipping data")],-1)]))),_:1}),I("div",ya,[I("div",null,[N(H,{modelValue:s.add_shipping_label_number,"onUpdate:modelValue":i[0]||(i[0]=e=>s.add_shipping_label_number=e),disabled:A(l).additionalShipping.isLoading,view:A(w).add_shipping_label_number.$error?"danger":"default",type:"number",block:"",ltr:"",onInput:j,onChange:O},{label:S((()=>i[4]||(i[4]=[I("span",{class:"font-medium"},"Number of Additional Labels",-1)]))),_:1},8,["modelValue","disabled","view"]),I("p",null,[(f(!0),y(C,null,L(A(w).add_shipping_label_number.$errors,((e,a)=>(f(),y("small",{key:a,class:"text-red-04"},U(e.$message),1)))),128))]),A(w).add_shipping_label_number.$error||(null==(t=null==(a=A(l))?void 0:a.additionalShipping)?void 0:t.isLoading)?$("",!0):(f(),y(C,{key:0},[V.value>0?(f(),y("small",ka,U(V.value)+" "+U(V.value>1?"labels":"label")+" left to generate. ",1)):(f(),y("small",Sa,U("Has reached maximum limit")))],64))]),1==e.shippingLabelStatus?(f(),y("div",wa,[I("div",xa,[I("div",Ca,[i[7]||(i[7]=I("h6",{class:"font-medium text-lg text-grey-04"},"Preview:",-1)),I("div",La,[I("div",null,[i[5]||(i[5]=I("span",{class:"font-medium text-grey-04"},"Base Tracking:",-1)),x(" "+U(null!=(n=p.value)?n:"-"),1)]),i[6]||(i[6]=I("p",null,"New labels will have tracking numbers like:",-1)),I("div",null,[(f(!0),y(C,null,L(r.value,(e=>(f(),y("p",{key:e},U(p.value?`${p.value}-${e}`:`-${e}`)+" "+U(r.value===e&&r.value>1?".etc":""),1)))),128))])])])])])):$("",!0)])])]})),footer:S((()=>[I("div",Ia,[N(M,{disabled:A(l).additionalShipping.isLoading,color:"white",onClick:q},{default:S((()=>i[8]||(i[8]=[x(" Cancel ")]))),_:1},8,["disabled"]),N(M,{disabled:A(l).additionalShipping.isLoading||c.value,loading:A(l).additionalShipping.isLoading,color:"teal",onClick:T},{default:S((()=>i[9]||(i[9]=[x(" Create Labels ")]))),_:1},8,["disabled","loading"])])])),_:1},8,["modelValue"]))}},Na={__name:"BuybackShippingOptions",props:{id:"-",multiple:!1,total:0,statusOffer:{type:[Number,String],default:void 0},shippings:{type:Array,default:()=>[]},shippingLabelStatus:{type:String,default:""},regenerateShippingLabel:{type:Function,default:()=>{}}},emits:["succeed","failed"],setup(e,{emit:a}){const l=D(),i=ge(),t=e,n=a,s=g((()=>{var e,a;return(null==(e=null==l?void 0:l.name)?void 0:e.toLowerCase().includes("bulkquote"))?"Bulk Offer":(null==(a=null==l?void 0:l.name)?void 0:a.toLowerCase().includes("easyoffer"))?"Easy Offer":"Mail-In"})),o=e=>{1==e?i.shippingInfo.modal=!0:2==e&&(i.additionalShipping.modal=!0)},d=()=>{n("succeed")},u=()=>{n("failed")},r=()=>{n("succeed")};return(e,a)=>{const l=_("DropdownItem"),i=_("DropdownMenu"),n=_("Dropdown");return f(),y(C,null,[N(n,{trigger:"click",placement:"bottom-end","hide-on-click":"",onCommand:o},{dropdown:S((()=>[N(i,null,{default:S((()=>[N(l,{command:"1"},{default:S((()=>a[1]||(a[1]=[I("div",{class:"flex items-center gap-2 text-base"},[I("span",{class:"material-icons"},"local_shipping"),x(" Shipping Information ")],-1)]))),_:1}),2!=t.shippingLabelStatus?(f(),k(l,{key:0,command:"2"},{default:S((()=>a[2]||(a[2]=[I("div",{class:"flex items-center gap-2 text-base"},[I("span",{class:"material-icons"},"add"),x(" Additional Shipping Label ")],-1)]))),_:1})):$("",!0)])),_:1})])),default:S((()=>[N(M,{color:"teal",view:"outlined",dense:"",icon:"",class:"btn-action"},{default:S((()=>a[0]||(a[0]=[I("span",{class:"material-icons"},"more_horiz",-1)]))),_:1})])),_:1}),N(ba,{id:t.id,"status-offer":t.statusOffer,shippings:t.shippings,"offer-type":s.value,shippingLabelStatus:t.shippingLabelStatus,regenerateShippingLabel:t.regenerateShippingLabel,onSaved:r},null,8,["id","status-offer","shippings","offer-type","shippingLabelStatus","regenerateShippingLabel"]),N(Va,{id:t.id,total:t.total,"status-offer":t.statusOffer,shippings:t.shippings,shippingLabelStatus:t.shippingLabelStatus,"offer-type":s.value,onCreated:d,onFailed:u},null,8,["id","total","status-offer","shippings","shippingLabelStatus","offer-type"])],64)}}};var Ua="/assets/no-item.d2e9bfac.svg",$a="/assets/data-match-icon.5fe238bc.svg";export{$e as B,Ge as S,Qe as _,Fe as a,Na as b,Ua as c,$a as d,ge as u};
