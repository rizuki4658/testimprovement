var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,r=(e,a)=>{for(var t in a||(a={}))s.call(a,t)&&o(e,t,a[t]);if(l)for(var t of l(a))n.call(a,t)&&o(e,t,a[t]);return e};import{s as i,y as u,u as d,v as c,X as m}from"./index.ec266ec1.js";import{f}from"./date.f86face7.js";import{f as v}from"./format.f845777a.js";import{r as p,f as y,g as h,h as _}from"./vendor.f1efedad.js";const g=()=>{const e=h((()=>i.state.customer.statuses)),a=h((()=>e.value.map((e=>u(e,"customerTab",{statusId:e.id},"id","short_name")))));return{state:e,tab:a}},w=()=>{const{me:e,dateByTimezone:l}=d(),s=p({page:1,limit:10,search:"",sort_by:"",order_by:"",company:null,name:null,last_seen:null,from:null,to:null,date:null,status:1}),n=p({all:!1,delete:!1,restore:!1,csv:!1}),o=p({delete:!1,restore:!1}),u=y(null),g=y(null),w=p({disabledDate:e=>e.getTime()>l.value.getTime()}),b=y(!1),P=h((()=>{var a,t;return[{id:"date",name:"Date",value:s.date?`${_(s.date[0]).format((null==(a=e.value)?void 0:a.date_format)||"")} - ${_(s.date[1]).format((null==(t=e.value)?void 0:t.date_format)||"")}`:null,default:null}]})),O=h((()=>P.value.filter((e=>e.value)).length>0)),D=()=>{u.value=null},j=async(e=null,l=(()=>{}))=>{var o,u;n.all=!0,await i.dispatch("customer/all",(o=r({},s),u={status:e,date:null,from:s.date&&f(s.date[0])||null,to:s.date&&f(s.date[1])||null},a(o,t(u)))),c(l)&&l(),n.all=!1},I=h((()=>Object.assign({},r({},i.state.customer.all))));return{data:s,state:I,loading:n,modal:o,selected:u,filterList:P,isFiltered:O,filterDateRef:g,filterDateOptions:w,isDateShow:b,filterDateFocus:()=>{b.value?b.value=!1:(b.value=!0,g.value.focus())},clearFilter:e=>{if(!s.hasOwnProperty(e.id))return!1;s[e.id]=e.default},clearAllFilter:()=>{for(let e of P.value)s[e.id]=e.default},unsetData:D,openModal:(e,a=(()=>{}))=>{o[e]=!0,c(a)&&a()},actionAll:j,actionDelete:async(e,a=(()=>{}))=>{try{n.delete=!0,await i.dispatch("customer/delete",u.value),c(a)&&a(),o.delete=!1,D(),await j(e)}finally{n.delete=!1}},actionRestore:async(e,a=(()=>{}))=>{try{n.restore=!0,await i.dispatch("customer/restore",u.value),c(a)&&a(),o.restore=!1,D(),await j(e)}finally{n.restore=!1}},getCsv:async(e={},a=(()=>{}))=>{try{const t={extension:"csv"},{format:l,filters:s,filename:o}=e;n.csv=!0,Object.assign(t,s),l&&(t.extension=l);const r=await i.dispatch("customer/actionCsv",t);return c(a)&&a(),m(r,o||"customer-csv",v(l)),r}finally{n.csv=!1}}}},b=()=>{const e=p({first_name:null,last_name:null,email:null,use_company_name:!1,company:null,address1:null,city:null,state:null,zip:null,country:null,address_text:null,phone:null,suite:"",license_number:null}),a=y(!1);return{data:e,loading:a,action:async(t=(()=>{}))=>{try{a.value=!0;const l=await i.dispatch("customer/create",e);c(t)&&t(l)}finally{a.value=!1}}}},P=()=>{const e=y(!1);return{loading:e,action:async(a,t,l=(()=>{}))=>{try{e.value=!0;const s=await i.dispatch("customer/update",{id:a,data:t});c(l)&&l(s)}finally{e.value=!1}}}},O=e=>{const a=y(!1);return{state:h((()=>i.state.customer.paymentMethods)),loading:a,action:async(t,l=(()=>{}))=>{a.value=!0,"online"===e?await i.dispatch("customer/onlinePaymentMethods",t):await i.dispatch("customer/paymentMethods",t),c(l)&&l(),a.value=!1}}},D=()=>{const{me:e,dateByTimezone:a}=d(),t=p({page:1,limit:10,search:"",payment_method:[],from:null,to:null,sort_by:"",order_by:"",date:null,shipping_courier:[],statuses:[]}),l=h((()=>{var a,l;return[{id:"payment_method",name:"Payout Method",value:t.payment_method?t.payment_method.join(", "):null,default:[]},{id:"date",name:"Date",value:t.date?`${_(t.date[0]).format((null==(a=e.value)?void 0:a.date_format)||"")} - ${_(t.date[1]).format((null==(l=e.value)?void 0:l.date_format)||"")}`:null,default:null},{id:"shipping_courier",name:"Courier",value:t.shipping_courier?t.shipping_courier.join(", "):null,default:[]},{id:"statuses",name:"Status",value:t.statuses?t.statuses.map((e=>e.status_name)).join(", "):null,default:[]}]})),s=h((()=>l.value.filter((e=>e.value)).length>0)),n=y(null),o=p({disabledDate:e=>e.getTime()>a.value.getTime()});let r=!1;const m=y(!1),v=h((()=>[{name:"In-Store",category:"in-store"},{name:"Mail-In",category:"mail-in"},{name:"Invoice",category:"invoice"}].map((e=>u(e,"customerDetail",{category:e.category},"category","name"))))),g=h((()=>i.state.customer.detailOrders));return{tab:v,data:t,state:g,loading:m,filterDateRef:n,filterDateOptions:o,filterList:l,isFiltered:s,clearFilter:e=>{if(!t.hasOwnProperty(e.id))return!1;t[e.id]=e.default},clearAllFilter:()=>{for(let e of l.value)t[e.id]=e.default},filterDateFocus:()=>{r?r=!1:(r=!0,n.value.focus())},action:async(e,a,l=(()=>{}))=>{m.value=!0;const s=Object.assign({},t);s.from=s.date&&f(s.date[0])||null,s.to=s.date&&f(s.date[1])||null,Object.assign(s,{is_in_store:a?1:0}),Object.assign(s,{status_id:t.statuses?t.statuses.map((e=>e.id)):null}),delete s.date,await i.dispatch("customer/detailOrders",{id:e,data:s}),c(l)&&l(),m.value=!1}}},j=()=>{const{me:e,dateByTimezone:a}=d(),t=p({page:1,limit:10,search:"",from:null,to:null,sort_by:"",order_by:"",status_id:"all",date:null,sales_person:[]}),l=h((()=>i.state.buyback.invoice.statuses.map((e=>({id:e.id,name:e.short_name}))))),s=h((()=>{var a,s,n;return[{id:"sales_person",name:"Sales Person",value:t.sales_person.length>0?t.sales_person.map((e=>e.sales_person)).join(", "):null,default:[]},{id:"date",name:"Date",value:t.date?`${_(t.date[0]).format((null==(a=e.value)?void 0:a.date_format)||"")} - ${_(t.date[1]).format((null==(s=e.value)?void 0:s.date_format)||"")}`:null,default:null},{id:"status_id",name:"Status",value:t.status_id?null==(n=l.value.find((e=>e.id==t.status_id)))?void 0:n.name:"all",default:"all"}]})),n=h((()=>s.value.filter((e=>e.value)).length>0)),o=y(null),r=p({disabledDate:e=>e.getTime()>a.value.getTime()});let u=!1;const m=y(!1),v=y(!1),g=h((()=>i.state.customer.invoices)),w=h((()=>i.state.customer.sales_persons));return{data:t,loading:m,loadingSalesPerson:v,state:g,stateSalesPerson:w,filterDateRef:o,filterDateOptions:r,invoiceStatuses:l,filterList:s,isFiltered:n,action:async(e,a=(()=>{}))=>{m.value=!0;const l=Object.assign({},t);l.from=l.date&&f(l.date[0])||null,l.to=l.date&&f(l.date[1])||null,l.sales_person=l.sales_person.map((e=>e.id)),delete l.date,await i.dispatch("customer/showInvoice",{id:e,data:l}),c(a)&&a(),m.value=!1},actionSalesPerson:async(e,a=(()=>{}))=>{v.value=!0,await i.dispatch("customer/showSalesPerson"),c(a)&&a(),v.value=!1},filterDateFocus:()=>{u?u=!1:(u=!0,o.value.focus())},clearFilter:e=>{if(!t.hasOwnProperty(e.id))return!1;t[e.id]=e.default},clearAllFilter:()=>{for(let e of s.value)t[e.id]=e.default}}},I=()=>{const e=y(!1),a=y(null),t=h((()=>i.state.customer.show.data));return{data:a,state:t,loading:e,action:async(t,l=(()=>{}))=>{e.value=!0,a.value=await i.dispatch("customer/show",t),c(l)&&l(),e.value=!1}}},F=()=>{const e=y(!1),a=y(null),t=h((()=>i.state.customer.show.paymentInfo));return{data:a,state:t,loading:e,action:async(t,l=(()=>{}))=>{e.value=!0,a.value=await Promise.all([i.dispatch("customer/showPaymentInfo",t),i.dispatch("customer/showPaymentInfoBanks",t)]).then((e=>e[0]));try{i.dispatch("customer/showPaymentInfoCustom",t)}catch(s){}c(l)&&l(),e.value=!1},actionUpdate:async(a,t={},l=(()=>{}))=>{e.value=!0,e.value=!0,await i.dispatch("customer/updatePaymentInfo",{id:a,data:t}),c(l)&&l(),e.value=!1},actionUpdateCustom:async(a,t={},l=(()=>{}))=>{e.value=!0;try{await i.dispatch("customer/showPaymentInfoCustomUpdate",{id:a,data:t}),c(l)&&l()}catch(s){console.error(s)}finally{e.value=!1}}}},S=()=>{const e=p({}),a=p({form:!1,delete:!1}),t=p({all:!1,form:!1,delete:!1}),l=y(null),s=()=>{l.value=null;for(const[a]of Object.entries(e))delete e[a]},n=async(e,a=(()=>{}))=>{t.all=!0,await i.dispatch("customer/showPaymentInfoBanks",e),c(a)&&a(),t.all=!1};return{data:e,loading:t,modal:a,selected:l,openModal:(e,t=(()=>{}))=>{a[e]=!0,c(t)&&t()},unsetData:s,actionAll:n,actionCreate:async(l,o=(()=>{}))=>{try{t.form=!0,await i.dispatch("customer/showPaymentInfoBankCreate",{id:l,data:e}),c(o)&&o(),a.form=!1,s(),await n(l)}finally{t.form=!1}},actionUpdate:async(o,r=(()=>{}))=>{try{t.form=!0,await i.dispatch("customer/showPaymentInfoBankUpdate",{id:o,bank_id:l.value,data:e}),c(r)&&r(),a.form=!1,s(),await n(o)}finally{t.form=!1}},actionDelete:async(e,o=(()=>{}))=>{try{t.delete=!0,await i.dispatch("customer/showPaymentInfoBankDelete",l.value),c(o)&&o(),a.delete=!1,s(),await n(e)}finally{t.delete=!1}}}};export{b as a,I as b,F as c,S as d,P as e,g as f,w as g,j as h,D as i,O as u};
