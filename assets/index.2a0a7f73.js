var a=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(e,t,o)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(a,e)=>{for(var t in e||(e={}))l.call(e,t)&&r(a,t,e[t]);if(o)for(var t of o(e))s.call(e,t)&&r(a,t,e[t]);return a};import{u as n}from"./components.bc8fc588.js";import{k as d,r as c,g as p,m as u,o as m,n as g,w as b,B as f,t as y,K as v,U as x,D as w,F as h,a2 as _,a3 as k,I as D,S as C,a5 as S,ay as P,y as B,z as U,h as E,a0 as j,A as T,T as A,Q as I,_ as M}from"./vendor.f1efedad.js";import{p as N}from"./setting.a9fe6242.js";import{d as F,b as V,f as O,_ as L,e as R,P as Y,j as X,ap as $,u as q,r as H,aq as z,g as G,ad as K,am as Q}from"./index.161fb295.js";import{D as J}from"./DeviceTable.7f8160ea.js";import{C as W}from"./card.6a96327d.js";import{E as Z}from"./expandable-panel.d6d9382d.js";import{_ as aa}from"./breadcrumb.2d36d495.js";import{_ as ea}from"./tab.1390e648.js";import"./LoadingCard.105ff0f2.js";import"./catalog-not-found.379a4c88.js";const ta=d({name:"DeviceExportActiveData",components:{Modal:F,Button:V,Input:O},props:{exportFormats:{type:Array,default:()=>["csv","xml"]},exportFilename:{type:String,default:"Items Catalog"},format:{type:String,default:"csv"},loading:{type:Boolean,default:!1},show:{type:Boolean},disabled:{type:Boolean,default:!1},disabledReason:{type:String}},emits:["update:format","update:show","export"],setup(a,{emit:e}){const t=c({isShowModal:!1}),o=p({get:()=>a.show?a.show:t.isShowModal,set:a=>{t.isShowModal=a,e("update:show",a)}}),l=p({get:()=>a.format,set:a=>{e("update:format","string"==typeof a?a.toLowerCase():a)}}),s=p((()=>a.exportFormats.map((a=>({key:a,label:"string"==typeof a?a.toUpperCase():a})))));return{isShowModal:o,fileFormats:s,selectedFormat:l,closeModal:()=>o.value=!1,handleExport:()=>{e("export",!0)}}}}),oa={key:0,class:"flex items-center bg-orange-lighten text-orange-04 px-4 py-3 rounded-lg gap-3 mb-4"},la={class:"inline-block"},sa={class:"grid gap-4 my-4"},ra={class:"mb-2"},ia={class:"flex items-start gap-4 my-4"},na={class:"flex justify-between items-center"};const da=d({components:{Card:W,Checkbox:R,ExpandablePanel:Z,Breadcrumb:aa,Input:O,Button:V,Pagination:Y,DeviceExportActiveData:L(ta,[["render",function(a,e,t,o,l,s){const r=u("Input"),i=u("RadioButton"),n=u("RadioGroup"),d=u("Button"),c=u("Modal");return m(),g(c,{modelValue:a.isShowModal,"onUpdate:modelValue":e[3]||(e[3]=e=>a.isShowModal=e),title:"Export Active Data"},{default:b((()=>[f("div",null,[a.disabled&&a.disabledReason?(m(),y("div",oa,[e[4]||(e[4]=f("i",{class:"material-icons"},"warning",-1)),f("p",la,v(a.disabledReason),1)])):x("",!0),e[10]||(e[10]=f("div",{class:"flex items-center bg-blue-lighten text-blue-04 px-4 py-3 rounded-lg gap-4"},[f("p",{class:"inline-block"}," Catalog Data is also available through our API "),f("a",{href:"https://docs.reusely.com/reference/reusely-api-overview",rel:"noreferrer noopener",target:"_blank",class:"text-blue-04 hover:text-blue-03"},[f("i",{class:"material-icons"},"open_in_new")])],-1)),f("div",sa,[w(r,{"model-value":a.exportFilename,disabled:!0,placeholder:"report name",label:"Report Name"},null,8,["model-value"]),f("div",ra,[e[5]||(e[5]=f("label",null,"Export as",-1)),w(n,{modelValue:a.selectedFormat,"onUpdate:modelValue":e[0]||(e[0]=e=>a.selectedFormat=e),class:h(["radio--full"])},{default:b((()=>[(m(!0),y(_,null,k(a.fileFormats,(a=>(m(),g(i,{key:a.key,label:a.key,class:"cursor-pointer"},{default:b((()=>[D(v(a.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])]),f("div",ia,[e[9]||(e[9]=f("i",{class:"material-icons text-teal-04"},"info",-1)),f("p",null,[e[6]||(e[6]=f("span",{class:"font-semibold"},"Important Notes:",-1)),e[7]||(e[7]=D(" Download a CSV or XML file of the items you enabled in your Catalog. This file won't include conditions or prices columns. To download a file with your items conditions and prices, please go to your ")),f("a",{href:"#",onClick:e[1]||(e[1]=C((e=>a.$router.push({name:"integrationDataFeed"})),["prevent"])),class:"text-blue-04 hover:text-blue-03"}," Data Feed Settings "),e[8]||(e[8]=D(". "))])])])])),footer:b((()=>[f("div",na,[f("a",{href:"#",onClick:e[2]||(e[2]=C(((...e)=>a.closeModal&&a.closeModal(...e)),["prevent"])),class:"text-teal-04 hover:text-teal-03 py-4 px-6"},"Cancel"),w(d,{onClick:a.handleExport,loading:a.loading,disabled:a.disabled,color:"teal"},{default:b((()=>e[11]||(e[11]=[f("span",null,[f("i",{class:"material-icons"},"download"),D(" Export ")],-1)]))),_:1},8,["onClick","loading","disabled"])])])),_:1},8,["modelValue"])}]]),DeviceTable:J,Tab:ea,Alert:X},emits:["showNetworkSetting"],async setup(a,{emit:o}){const{data:l,exportData:s,state:r,brandsTab:n,loading:d,actionAll:c,actionUpdate:u,actionExportActiveCatalog:m,onLoadMoreTabs:g,loadingTabBrand:b}=N(),{state:f,loading:y,closeResultNotification:v}=$(),{backgroundProcessData:x,action:w,loading:h,me:_,isProPlan:k}=q(),{open:D}=Q(),C=S(),j=P("openNetworkSetting",(()=>{})),T=p((()=>window.location.origin)),A=p((()=>{if(!r.value.data)return[];return Object.entries(H(r.value.data)).map((([a,e])=>e)).flat().map((a=>{return o=i({},a),e(o,t({child:[]}));var o}))})),I=p((()=>r.value?{name:C.params.category,is_enable:r.value.is_enable,is_mac:C.params.category&&"mac"===C.params.category.toLowerCase()?1:0}:null)),F=p((()=>1==f.latestUploadedFile.is_export_product_catalog)),V=p((()=>z.value.uploadProgress>0&&z.value.uploadProgress<100)),O=B((()=>({limit:l.limit,page:l.page,route:C.params,search:l.search})),G((async()=>{"settingBuybackDeviceBrand"===C.name&&await c(C.params.category,"all"==C.params.brand?null:C.params.brand)}),500),{deep:!0});B((()=>({limit:l.limit,route:C.params})),(()=>{l.page=1,l.search=""}),{deep:!0}),U((()=>O()));const L=G((async()=>await c(C.params.category,"all"==C.params.brand?null:C.params.brand,null)),1e3);return await c(C.params.category,"all"==C.params.brand?null:C.params.brand),{state:r,loading:d,loadingISBN:y,loadingUser:h,me:_,brandsTab:n,isDisabledExportProductCatalog:F,breadcrumb:[{text:"Settings",to:{name:"setting"}},{text:"Catalog"}],data:l,exportData:s,origin:T,items:A,category:I,showIntercom:()=>{window.CustomerSupport.use("show")},updateBuybackDevice:async(a,e)=>{const{category:t}=C.params,{id:o,is_mac:l,is_enable:s,manufacturer:r,total_active:n}=a;await u(i({category_id:o,is_mac:l,is_enable:s,manufacturer:r,category:t},n<=1&&!l&&{is_forced:!0}),(a=>{200==a.status_code&&M({type:"success",message:"Item status updated"}),"function"==typeof e&&e(a)}),!0)},updateBuybackDeviceByCategory:async(a,e=(()=>{}))=>{const t=a.name?K(a.name):"",o=a.is_enable,l=a.is_mac;await u({category:t,is_enable:o,is_mac:l},(async a=>{a?e(a):(e(),await c(C.params.category,"all"==C.params.brand?null:C.params.brand),M({type:"success",message:"Item status updated"}))}))},updateAllBuybackDevice:L,backgroundProcessData:x,handleCloseNotification:async()=>{await v((async a=>{a||await w()}))},handleExportActiveCatalog:async()=>{k.value?(await m(),s.show=!1,M({message:"Your data is being exported.",type:"success"})):D({title:"Export Catalog Data by CSV, XML, and API",description:"Easily export your product catalog data, including category structure and item titles, in CSV, XML, or via our API. Seamlessly integrate this data into your buyback platform to power your catalog and streamline the trade-in process.",image_url:"/images/paywall/paywall-export-product-catalog.svg"})},openNetworkSetting:j,moment:E,priceUploadProcess:V,onScrolledTab:()=>g(),loadingTabBrand:b}}}),ca={class:"flex flex-wrap items-center justify-between"},pa={class:"flex flex-wrap items-center"},ua={class:"mx-2"},ma={class:"flex items-start gap-4"},ga={class:"flex-auto"},ba={class:"flex flex-auto justify-end gap-4"},fa={class:"flex items-center text-teal-03"};var ya=L(da,[["render",function(a,e,t,o,l,s){const r=u("Tab"),i=u("Button"),n=u("Alert"),d=u("Input"),c=u("DeviceTable"),p=u("Pagination"),h=u("DeviceExportActiveData"),_=j("loading");return m(),y("div",null,[T((m(),y("div",null,[w(r,{items:a.brandsTab,onScrollEnd:a.onScrolledTab},null,8,["items","onScrollEnd"])])),[[_,a.loading.all]]),w(A,{name:"fade"},{default:b((()=>[1==a.backgroundProcessData.data_process_notification?(m(),g(n,{key:0,color:"green",view:"smooth",class:"mb-5",dense:""},{left:b((()=>e[12]||(e[12]=[f("span",{class:"material-icons text-4xl"},"info",-1)]))),default:b((()=>[f("div",ca,[f("div",null,[f("p",null,[e[7]||(e[7]=D(" Total New Publisher: ")),f("b",null,v(a.backgroundProcessData.last_total_category_insert||0),1)]),f("p",null,[e[8]||(e[8]=D(" Total New ISBN: ")),f("b",null,v(a.backgroundProcessData.last_total_data_insert||0),1)])]),f("div",pa,[f("p",ua,[e[9]||(e[9]=D(" Last Updated: ")),f("b",null,v(a.backgroundProcessData.last_update_data?a.moment(a.backgroundProcessData.last_update_data,"YYYY-MM-DD HH:mm:ss").format(a.me.datetime_format):""),1)]),a.backgroundProcessData.last_total_data_invalid>0?(m(),g(i,{key:0,onClick:e[0]||(e[0]=e=>a.$router.push({name:"settingBuybackDeviceTab",params:{category:"books"},query:{isbn:"invalid"}})),class:"mx-2",dense:"",color:"red"},{default:b((()=>e[10]||(e[10]=[D(" Show Invalid Data ")]))),_:1})):x("",!0),w(i,{onClick:a.handleCloseNotification,loading:a.loadingISBN.closeResultNotification||a.loadingUser.me,color:"teal",view:"outlined",class:"mx-2",dense:""},{default:b((()=>e[11]||(e[11]=[f("i",{class:"material-icons"},"close",-1),D(" Close Notification")]))),_:1},8,["onClick","loading"])])])])),_:1})):x("",!0)])),_:1}),f("div",ma,[f("div",ga,[w(d,{modelValue:a.data.search,"onUpdate:modelValue":e[1]||(e[1]=e=>a.data.search=e),disabled:a.priceUploadProcess||a.loading.all,placeholder:"Search by brand name",class:"w-full mb-5",icon:"",block:""},{icon:b((()=>e[13]||(e[13]=[f("span",{class:"material-icons"},"search",-1)]))),_:1},8,["modelValue","disabled"])]),f("div",ba,[w(i,{disabled:a.priceUploadProcess||a.loading.all,color:"white",onClick:a.openNetworkSetting},{default:b((()=>[f("div",fa,[f("div",{class:"svg-load h-6 w-6 ml bg-teal-03",style:I(`-webkit-mask-image: url(${a.origin}/icon/settings/signal.svg)`)},null,4),e[14]||(e[14]=f("span",{class:"inline-block ml-4"},"Cell Carriers Settings",-1))])])),_:1},8,["disabled","onClick"]),w(i,{disabled:a.priceUploadProcess||a.loading.all,onClick:e[2]||(e[2]=e=>a.exportData.show=!0),color:"white"},{default:b((()=>e[15]||(e[15]=[f("span",{class:"text-teal-03"},[f("i",{class:"material-icons mr-2"},"download"),D("Export")],-1)]))),_:1},8,["disabled"])])]),T((m(),y("div",null,[a.items.length>0?(m(),g(c,{key:0,data:a.items,category:a.category,disabled:a.priceUploadProcess,onUpdateBuyback:a.updateBuybackDevice,onUpdateBuybackCategory:a.updateBuybackDeviceByCategory,onUpdateAll:a.updateAllBuybackDevice},null,8,["data","category","disabled","onUpdateBuyback","onUpdateBuybackCategory","onUpdateAll"])):(m(),g(c,{key:1,data:[],category:{}})),w(p,{page:a.data.page,"onUpdate:page":e[3]||(e[3]=e=>a.data.page=e),limit:a.data.limit,"onUpdate:limit":e[4]||(e[4]=e=>a.data.limit=e),data:a.state},null,8,["page","limit","data"])])),[[_,a.loading.all]]),w(h,{show:a.exportData.show,"onUpdate:show":e[5]||(e[5]=e=>a.exportData.show=e),format:a.exportData.format,"onUpdate:format":e[6]||(e[6]=e=>a.exportData.format=e),loading:a.exportData.loading,onExport:a.handleExportActiveCatalog,disabled:a.isDisabledExportProductCatalog,"disabled-reason":"The data export process is in progress"},null,8,["show","format","loading","onExport","disabled"])])}],["__scopeId","data-v-fce636be"]]),va=d({setup(){const{genSuspense:a}=n();return()=>a(ya)}});export{va as default};
