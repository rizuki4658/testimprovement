{"version":3,"file":"Returned.ffbbfa5f.js","sources":["../../src/views/invoice/detail/Returned.vue"],"sourcesContent":["<template>\n  <Card class=\"mb-6\" v-if=\"state.length != 0\">\n    <template #default>\n      <template v-if=\"state.length != 0\">\n        <ExpandablePanel v-for=\"(item, index) in state\" class=\"mb-4\" :key=\"index\">\n          <template #default>\n            <div v-for=\"(data, index) in item.details\" class=\"mb-4\" :key=\"index\">\n              <span class=\"font-bold\">\n                {{ data.order_items.product_name }} - {{ data.order_items.condition }} <small>({{ data.order_items.imei_sn }})</small>\n              </span>\n              <br>\n              <small>{{ data.order_items.is_mac == 1 ? data.order_items.processor_speed + ', ' + data.order_items.hard_drive + ', ' + data.order_items.memory : '' }} - <Currency :value=\"data.order_items.price\" /></small>\n            </div>\n            <Timeline v-if=\"item.refunds.length != 0\" class=\"ml-4\">\n              <TimelineItem v-for=\"(refund, indexDetail) in item.refunds\" view=\"filled\" color=\"blue\" :key=\"indexDetail\">\n                <template #content>\n                  <p class=\"font-bold text-dark mb-0\">{{ refund.payment_method }}: {{ money(refund.amount) }}\n<!--                    <template v-if=\"refund.payment_method === 'Paper Check'\"><Button view=\"smooth\" color=\"teal\" @click=\"invoiceReturnPrintCheck(refund.id)\" dense><span class=\"material-icons\">print</span></Button></template>-->\n                  </p>\n                  <small class=\"block\">{{ refund.created_at }}</small>\n                  <small class=\"block\">{{ refund.note }}</small>\n                </template>\n              </TimelineItem>\n            </Timeline>\n            <div v-else class=\"text-center\">\n              <span class=\"font-bold text-red-base\">There's no detail.</span>\n            </div>\n          </template>\n          <template #header=\"{ toggle }\">\n            <div @click=\"toggle\" class=\"flex justify-between items-center\">\n              <div>\n                <p><span class=\"font-bold\">Reason: </span>{{ item.reason }}</p>\n                <p>{{ item.refunds.length }} list item</p>\n              </div>\n              <div class=\"flex items-center\">\n                <p class=\"mx-3\" :class=\"[parseInt(item.due) == 0 ? 'text-green-03' : 'text-red-base']\">Due: <span class=\"font-bold\"><Currency :value=\"item.due\" /></span></p>\n                <p class=\"mx-3\">Total: <span class=\"font-bold\"><Currency :value=\"item.total\" /></span></p>\n                <Button v-if=\"item.due != 0\" view=\"outlined\" color=\"teal\" @click=\"openModalSelected('record', item)\" dense>Refund</Button>\n              </div>\n            </div>\n          </template>\n        </ExpandablePanel>\n        <!--          <span class=\"py-4 pl-4 pr-0 pr-0\" :class=\"[item.return_id ? 'text-red-base' : 'text-dark']\">{{ (item.amount).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) }}</span>-->\n      </template>\n      <div v-else class=\"text-center\">\n        <span class=\"font-bold text-red-base\">There's no payment history change.</span>\n      </div>\n    </template>\n  </Card>\n  <Modal v-model=\"modal.record\" title=\"Record Payout\">\n    <PaymentMethod ref=\"refPaymentMethod\" v-model:data=\"data\" :items=\"statePaymentMethod\">\n      <template #additional>\n        <Input v-model=\"dataRecord.amount\" type=\"number\" min=\"0\" label=\"Amount\" :currency=\"true\" class=\"w-full\" @keypress=\"filterNumber\" />\n      </template>\n    </PaymentMethod>\n    <template #footer>\n      <Button color=\"teal\" :loading=\"loading.record\" @click=\"createRecord\">Save Payout</Button>\n    </template>\n  </Modal>\n</template>\n\n<script>\nimport {defineComponent, nextTick, ref} from 'vue'\nimport { useRoute } from 'vue-router'\nimport { useShowReturn, useShowRecord, useShowPaymentMethod } from 'composable/invoice'\nimport { money, filterNumber } from 'utils/number'\nimport Button from 'bbUi/components/button/button.vue'\nimport Card from 'bbUi/components/card/card.vue'\nimport Input from 'bbUi/components/input/input.vue'\nimport Modal from 'bbUi/components/modal/modal.vue'\nimport Timeline from 'bbUi/components/timeline/timeline.vue'\nimport TimelineItem from 'bbUi/components/timeline-item/timeline-item.vue'\nimport ExpandablePanel from 'bbUi/components/expandable-panel/expandable-panel.vue'\nimport PaymentMethod from 'components/PaymentMethod.vue'\nimport RecordPaymentForm from 'components/Invoice/RecordPayment/Form.vue'\nimport Currency from 'components/Currency.vue'\n\nexport default defineComponent({\n  components: {\n    Button,\n    Card,\n    Input,\n    Modal,\n    Timeline,\n    TimelineItem,\n    ExpandablePanel,\n    PaymentMethod,\n    RecordPaymentForm,\n    Currency\n  },\n  async setup(props) {\n    const { state, selected, loading, modal, openModal, actionAll, actionRecord } = useShowReturn('invoice')\n    const { data: dataRecord, actionAll: actionAllRecord } = useShowRecord('invoice')\n    const { state: statePaymentMethod } = useShowPaymentMethod('invoice')\n    const route = useRoute()\n\n    await actionAll(route.params.buybackId)\n    const data = ref(null)\n    const refPaymentMethod = ref(null)\n    const openModalSelected = (target, item) => openModal(target, () => {\n      selected.value = item.id\n    })\n    const createRecord = async () => {\n      const isValid = await nextTick(() => refPaymentMethod.value.refChildComponent.validate())\n      if(isValid) {\n        await actionRecord(route.params.buybackId, {\n          amount: dataRecord.amount,\n          ...data.value\n        }, async () => {\n          await actionAllRecord(route.params.buybackId)\n        })\n      }\n    }\n\n    return {\n      data,\n      dataRecord,\n      state,\n      statePaymentMethod,\n      loading,\n      modal,\n      openModalSelected,\n      createRecord,\n      money,\n      filterNumber,\n      refPaymentMethod\n    }\n  }\n})\n</script>"],"names":["_sfc_main","defineComponent","components","Button","Card","Input","Modal","Timeline","TimelineItem","ExpandablePanel","PaymentMethod","RecordPaymentForm","Currency","[object Object]","props","state","selected","loading","modal","openModal","actionAll","actionRecord","useShowReturn","data","dataRecord","actionAllRecord","useShowRecord","statePaymentMethod","useShowPaymentMethod","route","useRoute","params","buybackId","ref","refPaymentMethod","openModalSelected","target","item","value","id","createRecord","async","nextTick","refChildComponent","validate","__spreadValues","amount","money","filterNumber","_hoisted_1","class","_hoisted_2","_hoisted_3","key","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_openBlock","_createElementBlock","_Fragment","default","_withCtx","_ctx","length","_renderList","index","_createBlock","_component_ExpandablePanel","details","index2","_createElementVNode","_createTextVNode","_toDisplayString","order_items","product_name","condition","_cache","is_mac","processor_speed","hard_drive","memory","_createVNode","_component_Currency","refunds","refund","indexDetail","_component_TimelineItem","view","color","content","payment_method","created_at","_hoisted_5","toggle","onClick","_hoisted_10","$event","_hoisted_11","_createCommentVNode","_component_Modal","modelValue","record","onUpdate:modelValue","_component_Button","_component_PaymentMethod","onUpdate:data","_component_Input","type","min","label","currency"],"mappings":"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"}