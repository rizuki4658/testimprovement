{"version":3,"file":"index.c6f34978.js","sources":["../../src/views/integration/share-a-sale/index.vue","../../src/views/integration/share-a-sale/index.js"],"sourcesContent":["<template>\n  <div>\n    <Input\n      v-model=\"data.shareasale_merchant_account_id\"\n      :view=\"\n        validation.shareasale_merchant_account_id.$invalid\n          ? 'danger'\n          : 'default'\n      \"\n      class=\"my-4\"\n      label=\"Share A Sale Merchant ID\"\n      placeholder=\"\"\n      block\n    />\n    <small\n      class=\"text-red-base block mb-4\"\n      v-for=\"(error, errorIndex) of validation.shareasale_merchant_account_id\n        .$errors\"\n      :key=\"errorIndex\"\n      >{{ error.$message }}.\n    </small>\n    <Input\n      v-model=\"data.shareasale_api_secret\"\n      :view=\"validation.shareasale_api_secret.$invalid ? 'danger' : 'default'\"\n      class=\"my-4\"\n      label=\"Share A Sale Private API Key\"\n      placeholder=\"\"\n      block\n    />\n    <small\n      class=\"text-red-base block mb-4\"\n      v-for=\"(error, errorIndex) of validation.shareasale_api_secret.$errors\"\n      :key=\"errorIndex\"\n      >{{ error.$message }}.\n    </small>\n    <Input\n      v-model=\"data.shareasale_token\"\n      :view=\"validation.shareasale_token.$invalid ? 'danger' : 'default'\"\n      class=\"my-4\"\n      label=\"Share A Sale Token\"\n      placeholder=\"\"\n      block\n    />\n    <small\n      class=\"text-red-base block mb-4\"\n      v-for=\"(error, errorIndex) of validation.shareasale_token.$errors\"\n      :key=\"errorIndex\"\n      >{{ error.$message }}.\n    </small>\n  </div>\n</template>\n\n<script>\nimport { defineComponent, computed, watch } from 'vue'\nimport { useShowAll } from 'composable/integration'\nimport { useVuelidate } from '@vuelidate/core'\nimport { required } from '@/validations/index'\nimport Button from 'bbUi/components/button/button.vue'\nimport Alert from 'bbUi/components/alert/alert.vue'\nimport Input from 'bbUi/components/input/input.vue'\nimport { ElMessage } from 'element-plus'\nimport { isFunction } from '@/utils/is'\n\nexport default defineComponent({\n  components: {\n    Button,\n    Alert,\n    Input\n  },\n  emits: ['ready'],\n  async setup(props, { emit }) {\n    const { state, data, actionAll, actionUpdate, loading } = useShowAll()\n\n    const rules = {\n      shareasale_merchant_account_id: {\n        required\n      },\n      shareasale_token: {\n        required\n      },\n      shareasale_api_secret: {\n        required\n      }\n    }\n    const validation = useVuelidate(rules, data, {\n      $lazy: true\n    })\n    const validate = () => {\n      validation.value.$validate()\n      return !validation.value.$invalid\n    }\n\n    const update = async (callback = () => {}) => {\n      const isValid = validate()\n      if (!isValid) return\n      const payload = Object.assign(\n        {},\n        {\n          shareasale_merchant_account_id: data.shareasale_merchant_account_id,\n          shareasale_token: data.shareasale_token,\n          shareasale_api_secret: data.shareasale_api_secret\n        }\n      )\n      await actionUpdate(payload, (response) => {\n        if (response.toLowerCase() === 'connection failed')\n          return ElMessage({\n            type: 'warning',\n            message: 'Invalid Share A Sale merchant ID'\n          })\n        ElMessage({\n          type: 'success',\n          message: 'Share A Sale integration updated!'\n        })\n        isFunction(callback) && callback()\n      })\n    }\n\n    watch(\n      () => ({ ...data }),\n      () => {\n        const isReady =\n          !!data.shareasale_merchant_account_id &&\n          !!data.shareasale_token &&\n          !!data.shareasale_api_secret\n        emit('ready', isReady)\n      }\n    )\n\n    await Promise.all([actionAll()])\n\n    return {\n      state,\n      data,\n      loading,\n      validation,\n      update\n    }\n  }\n})\n</script>\n","import { defineComponent, h, ref, reactive } from 'vue'\nimport { useSuspense } from 'composable/components'\nimport { useRoute, useRouter } from 'vue-router'\nimport Modal from 'bbUi/components/modal/modal.vue'\nimport Button from 'bbUi/components/button/button.vue'\nimport Index from './index.vue'\n\nexport default defineComponent({\n  async setup() {\n    const { genSuspense } = useSuspense()\n    const refComponent = ref(null)\n    const route = useRoute()\n    const router = useRouter()\n\n    const saveChanges = () => {\n      refComponent.value.update(() => {\n        router.push({\n          name: 'integration',\n          query: {\n            enable: route.query?.id || ''\n          }\n        })\n      })\n    }\n    const genSaveButton = () =>\n      h(\n        Button,\n        {\n          color: 'teal',\n          loading: refComponent.value && refComponent.value?.loading?.update,\n          onClick: saveChanges\n        },\n        {\n          default: () => 'Save'\n        }\n      )\n    const genComponent = () =>\n      genSuspense(\n        h(Index, {\n          ref: refComponent\n        })\n      )\n    const modalProps = reactive({\n      modelValue: true,\n      closeTo: {\n        name: 'integration',\n        query: {\n          reload: 1\n        }\n      },\n      size: 'xs'\n    })\n    const modalSlots = reactive({\n      header: () => 'Connect your ShareASale Account',\n      default: () => genComponent(),\n      footer: () => genSaveButton()\n    })\n\n    return () => h(Modal, modalProps, modalSlots)\n  }\n})\n"],"names":["defineComponent","components","Button","Alert","Input","emits","[object Object]","props","emit","state","data","actionAll","actionUpdate","loading","useShowAll","validation","useVuelidate","shareasale_merchant_account_id","required","shareasale_token","shareasale_api_secret","$lazy","watch","__spreadValues","isReady","Promise","all","update","async","callback","value","$validate","$invalid","payload","Object","assign","response","toLowerCase","ElMessage","type","message","_u","isFunction","_openBlock","_createElementBlock","_createVNode","_component_Input","modelValue","_ctx","onUpdate:modelValue","_cache","$event","class","label","placeholder","openBlock","_Fragment","_renderList","view","$errors","error","errorIndex","index","genSuspense","useSuspense","refComponent","ref","route","useRoute","router","useRouter","saveChanges","push","name","query","enable","_a","id","modalProps","reactive","closeTo","reload","size","modalSlots","header","default","h","Index","footer","genSaveButton","color","_b","onClick","Modal"],"mappings":"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"}